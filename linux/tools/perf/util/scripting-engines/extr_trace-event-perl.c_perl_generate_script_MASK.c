
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct tep_handle {int dummy; } ;
struct tep_format_field {char* name; int flags; struct tep_format_field* next; } ;
struct TYPE_2__ {struct tep_format_field* fields; } ;
struct tep_event {char* system; char* name; TYPE_1__ format; } ;
typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int *) ;
 int * FUNC_1 (char*,char*) ;
 int FUNC_2 (int *,char*,...) ;
 int FUNC_3 (char*,char*,char const*) ;
 int * VAR_6 ;
 int FUNC_4 (struct tep_handle*) ;
 struct tep_event** FUNC_5 (struct tep_handle*,int ) ;

__attribute__((used)) static int FUNC_6(struct tep_handle *VAR_7, const char *VAR_8)
{
 int VAR_9, VAR_10, VAR_11, VAR_12;
 struct tep_event **VAR_13;
 struct tep_event *VAR_14 = ((void*)0);
 struct tep_format_field *VAR_15;
 char VAR_16[VAR_0];
 FILE *VAR_17;

 FUNC_3(VAR_16, "%s.pl", VAR_8);
 VAR_17 = FUNC_1(VAR_16, "w");
 if (VAR_17 == ((void*)0)) {
  FUNC_2(VAR_6, "couldn't open %s\n", VAR_16);
  return -1;
 }

 FUNC_2(VAR_17, "# perf script event handlers, "
  "generated by perf script -g perl\n");

 FUNC_2(VAR_17, "# Licensed under the terms of the GNU GPL"
  " License version 2\n\n");

 FUNC_2(VAR_17, "# The common_* event handler fields are the most useful "
  "fields common to\n");

 FUNC_2(VAR_17, "# all events.  They don't necessarily correspond to "
  "the 'common_*' fields\n");

 FUNC_2(VAR_17, "# in the format files.  Those fields not available as "
  "handler params can\n");

 FUNC_2(VAR_17, "# be retrieved using Perl functions of the form "
  "common_*($context).\n");

 FUNC_2(VAR_17, "# See Context.pm for the list of available "
  "functions.\n\n");

 FUNC_2(VAR_17, "use lib \"$ENV{'PERF_EXEC_PATH'}/scripts/perl/"
  "Perf-Trace-Util/lib\";\n");

 FUNC_2(VAR_17, "use lib \"./Perf-Trace-Util/lib\";\n");
 FUNC_2(VAR_17, "use Perf::Trace::Core;\n");
 FUNC_2(VAR_17, "use Perf::Trace::Context;\n");
 FUNC_2(VAR_17, "use Perf::Trace::Util;\n\n");

 FUNC_2(VAR_17, "sub trace_begin\n{\n\t# optional\n}\n\n");
 FUNC_2(VAR_17, "sub trace_end\n{\n\t# optional\n}\n");


 FUNC_2(VAR_17, "\nsub print_backtrace\n{\n	my $callchain = shift;\n	for my $node (@$callchain)\n	{\n		if(exists $node->{sym})\n		{\n			printf( \"\\t[\\%%x] \\%%s\\n\", $node->{ip}, $node->{sym}{name});\n		}\n		else\n		{\n			printf( \"\\t[\\%%x]\\n\", $node{ip});\n		}\n	}\n}\n\n");
 VAR_12 = FUNC_4(VAR_7);
 VAR_13 = FUNC_5(VAR_7, VAR_1);

 for (VAR_9 = 0; VAR_13 && VAR_9 < VAR_12; VAR_9++) {
  VAR_14 = VAR_13[VAR_9];
  FUNC_2(VAR_17, "sub %s::%s\n{\n", VAR_14->system, VAR_14->name);
  FUNC_2(VAR_17, "\tmy (");

  FUNC_2(VAR_17, "$event_name, ");
  FUNC_2(VAR_17, "$context, ");
  FUNC_2(VAR_17, "$common_cpu, ");
  FUNC_2(VAR_17, "$common_secs, ");
  FUNC_2(VAR_17, "$common_nsecs,\n");
  FUNC_2(VAR_17, "\t    $common_pid, ");
  FUNC_2(VAR_17, "$common_comm, ");
  FUNC_2(VAR_17, "$common_callchain,\n\t    ");

  VAR_10 = 0;
  VAR_11 = 0;

  for (VAR_15 = VAR_14->format.fields; VAR_15; VAR_15 = VAR_15->next) {
   if (VAR_10++)
    FUNC_2(VAR_17, ", ");
   if (++VAR_11 % 5 == 0)
    FUNC_2(VAR_17, "\n\t    ");

   FUNC_2(VAR_17, "$%s", VAR_15->name);
  }
  FUNC_2(VAR_17, ") = @_;\n\n");

  FUNC_2(VAR_17, "\tprint_header($event_name, $common_cpu, "
   "$common_secs, $common_nsecs,\n\t             "
   "$common_pid, $common_comm, $common_callchain);\n\n");

  FUNC_2(VAR_17, "\tprintf(\"");

  VAR_10 = 0;
  VAR_11 = 0;

  for (VAR_15 = VAR_14->format.fields; VAR_15; VAR_15 = VAR_15->next) {
   if (VAR_10++)
    FUNC_2(VAR_17, ", ");
   if (VAR_11 && VAR_11 % 4 == 0) {
    FUNC_2(VAR_17, "\".\n\t       \"");
   }
   VAR_11++;

   FUNC_2(VAR_17, "%s=", VAR_15->name);
   if (VAR_15->flags & VAR_4 ||
       VAR_15->flags & VAR_2 ||
       VAR_15->flags & VAR_5)
    FUNC_2(VAR_17, "%%s");
   else if (VAR_15->flags & VAR_3)
    FUNC_2(VAR_17, "%%d");
   else
    FUNC_2(VAR_17, "%%u");
  }

  FUNC_2(VAR_17, "\\n\",\n\t       ");

  VAR_10 = 0;
  VAR_11 = 0;

  for (VAR_15 = VAR_14->format.fields; VAR_15; VAR_15 = VAR_15->next) {
   if (VAR_10++)
    FUNC_2(VAR_17, ", ");

   if (++VAR_11 % 5 == 0)
    FUNC_2(VAR_17, "\n\t       ");

   if (VAR_15->flags & VAR_2) {
    if ((VAR_11 - 1) % 5 != 0) {
     FUNC_2(VAR_17, "\n\t       ");
     VAR_11 = 4;
    }
    FUNC_2(VAR_17, "flag_str(\"");
    FUNC_2(VAR_17, "%s::%s\", ", VAR_14->system,
     VAR_14->name);
    FUNC_2(VAR_17, "\"%s\", $%s)", VAR_15->name,
     VAR_15->name);
   } else if (VAR_15->flags & VAR_5) {
    if ((VAR_11 - 1) % 5 != 0) {
     FUNC_2(VAR_17, "\n\t       ");
     VAR_11 = 4;
    }
    FUNC_2(VAR_17, "symbol_str(\"");
    FUNC_2(VAR_17, "%s::%s\", ", VAR_14->system,
     VAR_14->name);
    FUNC_2(VAR_17, "\"%s\", $%s)", VAR_15->name,
     VAR_15->name);
   } else
    FUNC_2(VAR_17, "$%s", VAR_15->name);
  }

  FUNC_2(VAR_17, ");\n\n");

  FUNC_2(VAR_17, "\tprint_backtrace($common_callchain);\n");

  FUNC_2(VAR_17, "}\n\n");
 }

 FUNC_2(VAR_17, "sub trace_unhandled\n{\n\tmy ($event_name, $context, "
  "$common_cpu, $common_secs, $common_nsecs,\n\t    "
  "$common_pid, $common_comm, $common_callchain) = @_;\n\n");

 FUNC_2(VAR_17, "\tprint_header($event_name, $common_cpu, "
  "$common_secs, $common_nsecs,\n\t             $common_pid, "
  "$common_comm, $common_callchain);\n");
 FUNC_2(VAR_17, "\tprint_backtrace($common_callchain);\n");
 FUNC_2(VAR_17, "}\n\n");

 FUNC_2(VAR_17, "sub print_header\n{\n"
  "\tmy ($event_name, $cpu, $secs, $nsecs, $pid, $comm) = @_;\n\n"
  "\tprintf(\"%%-20s %%5u %%05u.%%09u %%8u %%-20s \",\n\t       "
  "$event_name, $cpu, $secs, $nsecs, $pid, $comm);\n}\n");

 FUNC_2(VAR_17,
  "\n# Packed byte string args of process_event():\n"
  "#\n"
  "# $event:\tunion perf_event\tutil/event.h\n"
  "# $attr:\tstruct perf_event_attr\tlinux/perf_event.h\n"
  "# $sample:\tstruct perf_sample\tutil/event.h\n"
  "# $raw_data:\tperf_sample->raw_data\tutil/event.h\n"
  "\n"
  "sub process_event\n"
  "{\n"
  "\tmy ($event, $attr, $sample, $raw_data) = @_;\n"
  "\n"
  "\tmy @event\t= unpack(\"LSS\", $event);\n"
  "\tmy @attr\t= unpack(\"LLQQQQQLLQQ\", $attr);\n"
  "\tmy @sample\t= unpack(\"QLLQQQQQLL\", $sample);\n"
  "\tmy @raw_data\t= unpack(\"C*\", $raw_data);\n"
  "\n"
  "\tuse Data::Dumper;\n"
  "\tprint Dumper \\@event, \\@attr, \\@sample, \\@raw_data;\n"
  "}\n");

 FUNC_0(VAR_17);

 FUNC_2(VAR_6, "generated Perl script: %s\n", VAR_16);

 return 0;
}
