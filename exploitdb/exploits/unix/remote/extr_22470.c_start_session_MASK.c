
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


typedef int session_data2 ;
typedef int session_data1 ;
typedef int response ;
typedef int buffer ;
struct TYPE_4__ {int type; int flags; void* length; } ;
struct TYPE_3__ {int* protocol; int command; int flags; int flags2; int pid; int uid; int mid; int tid; } ;
typedef TYPE_1__ SMB_HEADER ;
typedef TYPE_2__ NETBIOS_HEADER ;


 int FUNC_0 () ;
 void* FUNC_1 (int) ;
 int FUNC_2 (char*,char*,int) ;
 int FUNC_3 (char*,int,int) ;
 scalar_t__ FUNC_4 (int,char*,int) ;
 int FUNC_5 (int,int) ;
 scalar_t__ FUNC_6 (int,char*,int,int ) ;
 int FUNC_7 (int,int) ;

int
FUNC_8(int VAR_0)
{
 char VAR_1[1000];
 char VAR_2[4096];
 char VAR_3[] = "\x00\xff\x00\x00\x00\x00\x20\x02\x00\x01\x00\x00\x00\x00";
        char VAR_4[] = "\x00\x00\x00\x00\x5c\x5c\x69\x70\x63\x24\x25\x6e\x6f\x62\x6f\x64\x79"
                    "\x00\x00\x00\x00\x00\x00\x00\x49\x50\x43\x24";

        NETBIOS_HEADER *VAR_5;
        SMB_HEADER *VAR_6;

 FUNC_3(VAR_1, 0x00, sizeof(VAR_1));

        VAR_5 = (NETBIOS_HEADER *)VAR_1;
        VAR_6 = (SMB_HEADER *)(VAR_1 + sizeof(NETBIOS_HEADER));

        VAR_5->type = 0x00;
        VAR_5->flags = 0x00;
        VAR_5->length = FUNC_1(0x2E);

        VAR_6->protocol[0] = 0xFF;
        VAR_6->protocol[1] = 'S';
        VAR_6->protocol[2] = 'M';
        VAR_6->protocol[3] = 'B';
        VAR_6->command = 0x73;
        VAR_6->flags = 0x08;
        VAR_6->flags2 = 0x01;
        VAR_6->pid = FUNC_0() & 0xFFFF;
 VAR_6->uid = 100;
        VAR_6->mid = 0x01;

        FUNC_2(VAR_1 + sizeof(NETBIOS_HEADER) + sizeof(SMB_HEADER), VAR_3, sizeof(VAR_3) - 1);

 if(FUNC_7(VAR_0, 3) == 1)
  if (FUNC_6(VAR_0, VAR_1, 50, 0) < 0) return -1;

 FUNC_3(VAR_2, 0x00, sizeof(VAR_2));

 if (FUNC_5(VAR_0, 3) == 1)
  if (FUNC_4(VAR_0, VAR_2, sizeof(VAR_2) - 1) < 0) return -1;

        VAR_5 = (NETBIOS_HEADER *)VAR_2;
        VAR_6 = (SMB_HEADER *)(VAR_2 + sizeof(NETBIOS_HEADER));



        VAR_5 = (NETBIOS_HEADER *)VAR_1;
        VAR_6 = (SMB_HEADER *)(VAR_1 + sizeof(NETBIOS_HEADER));

        FUNC_3(VAR_1, 0x00, sizeof(VAR_1));

        VAR_5->type = 0x00;
        VAR_5->flags = 0x00;
        VAR_5->length = FUNC_1(0x3C);

        VAR_6->protocol[0] = 0xFF;
        VAR_6->protocol[1] = 'S';
        VAR_6->protocol[2] = 'M';
        VAR_6->protocol[3] = 'B';
        VAR_6->command = 0x70;
 VAR_6->pid = FUNC_0() & 0xFFFF;
 VAR_6->tid = 0x00;
        VAR_6->uid = 100;

 FUNC_2(VAR_1 + sizeof(NETBIOS_HEADER) + sizeof(SMB_HEADER), VAR_4, sizeof(VAR_4) - 1);

        if(FUNC_7(VAR_0, 3) == 1)
                if (FUNC_6(VAR_0, VAR_1, 64, 0) < 0) return -1;

        FUNC_3(VAR_2, 0x00, sizeof(VAR_2));

        if (FUNC_5(VAR_0, 3) == 1)
                if (FUNC_4(VAR_0, VAR_2, sizeof(VAR_2) - 1) < 0) return -1;

        VAR_5 = (NETBIOS_HEADER *)VAR_2;
        VAR_6 = (SMB_HEADER *)(VAR_2 + sizeof(NETBIOS_HEADER));

        if (VAR_5->type != 0x00) return -1;

        return 0;
}
