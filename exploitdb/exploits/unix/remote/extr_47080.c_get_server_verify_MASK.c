
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_1__ ;


typedef int uint16_t ;
struct TYPE_4__ {int challenge; } ;
typedef TYPE_1__ ssl_conn ;
typedef int buf ;


 int BUFSIZE ;
 int CHALLENGE_LENGTH ;
 unsigned char SSL2_MT_SERVER_VERIFY ;
 int exit (int) ;
 scalar_t__ memcmp (int ,unsigned char*,int) ;
 int ntohs (int ) ;
 int printf (char*,...) ;
 int read_ssl_packet (TYPE_1__*,unsigned char*,int) ;
 char* ssl_error (int ) ;

void get_server_verify(ssl_conn* ssl)
{
 unsigned char buf[BUFSIZE];
 int len;
 if (!(len = read_ssl_packet(ssl, buf, sizeof(buf)))) {
  printf("Server error: %s\n", ssl_error(ntohs(*(uint16_t*)&buf[1])));
  exit(1);
 }
 if (len != 1 + CHALLENGE_LENGTH) {
  printf("get server verify: Malformed packet size\n");
  exit(1);
 }
 if (buf[0] != SSL2_MT_SERVER_VERIFY) {
  printf("get server verify: Expected SSL2 MT SERVER VERIFY, got %x\n", (int)buf[0]);
  exit(1);
 }
 if (memcmp(ssl->challenge, &buf[1], CHALLENGE_LENGTH)) {
  printf("get server verify: Challenge strings don't match\n");
  exit(1);
 }
}
