
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_int8_t ;
typedef int u_int32_t ;
struct vtp_summary {int version; int code; int followers; int dom_len; int* domain; void* revision; } ;
struct vtp_subset {int version; int code; int seq; int dom_len; int* domain; void* revision; } ;
struct libnet_ether_addr {int ether_addr_octet; } ;
typedef int libnet_t ;
typedef int libnet_ptag_t ;
typedef int cisco_data ;


 scalar_t__ VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int* FUNC_0 (int,int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ,char*,char*) ;
 int FUNC_3 (int*) ;
 int FUNC_4 (int,char**,char*) ;
 void* FUNC_5 (int) ;
 int FUNC_6 (int,int,int,int*,int,int *,int ) ;
 int FUNC_7 (int*,int ,scalar_t__,int *,int ,int *,int ) ;
 int FUNC_8 (int *) ;
 struct libnet_ether_addr* FUNC_9 (int *) ;
 int * FUNC_10 (int ,char*,char*) ;
 int FUNC_11 (int *) ;
 char* FUNC_12 (int) ;
 int FUNC_13 (int*,...) ;
 int FUNC_14 (char*,char*) ;
 int VAR_3 ;
 int FUNC_15 (char*,char*) ;
 int FUNC_16 (char*) ;
 int FUNC_17 (char*) ;

int FUNC_18( int VAR_4, char *VAR_5[] )
{
    int VAR_6,VAR_7=0;
    extern char *VAR_8;
    libnet_ptag_t VAR_9;
    libnet_t *VAR_10;
    u_int32_t VAR_11=0, VAR_12;
    struct vtp_summary *VAR_13;
    struct vtp_subset *VAR_14;
    u_int8_t *VAR_15,*VAR_16, *VAR_17;
    u_int8_t VAR_18[]={ 0x00, 0x00, 0x0c, 0x20, 0x03 };
    u_int8_t VAR_19[6]={ 0x01,0x00,0x0c,0xcc,0xcc,0xcc };
    u_int8_t VAR_20[8]={ 0x22,0x00,0x11,0x22,0x11,0x00, 0x00,0x00 };
    struct libnet_ether_addr *VAR_21;
    char *VAR_22;
    char VAR_23[VAR_1];
    char *VAR_24;


     while ((VAR_6 = FUNC_4(VAR_4, VAR_5, "i:d:")) != -1)
     {
          switch (VAR_6) {
          case 'i':
          VAR_22=FUNC_12(FUNC_16(VAR_8));
          FUNC_15(VAR_22,VAR_8);
      VAR_7=1;
          break;

          case 'd':
          VAR_24=FUNC_12(FUNC_16(VAR_8));
          FUNC_15(VAR_24,VAR_8);
          break;

          default: FUNC_17(VAR_5[0]);
          }
     }
     if(!VAR_7) { FUNC_14("  %s -i <interface> -d <vtp domain>\n     must assign the interface\n",VAR_5[0]);FUNC_1(1);}



    VAR_10=FUNC_10(VAR_2,VAR_22,VAR_23);
    if (!VAR_10) {
             FUNC_2(VAR_3, "libnet_init: %s\n", VAR_23);
             return -1;
     }

    VAR_21=FUNC_9(VAR_10);

    VAR_11 = sizeof(VAR_18)+sizeof(struct vtp_summary);
    VAR_15 = FUNC_0(1,VAR_11);
    VAR_17 = VAR_15;
    FUNC_13(VAR_15,VAR_18,sizeof(VAR_18));
    VAR_17+=sizeof(VAR_18);
    VAR_13 = (struct vtp_summary *)VAR_17;
    VAR_13->version = 0x01;
    VAR_13->code = 0x01;
    VAR_13->followers = 0x01;
    VAR_13->dom_len = FUNC_16(VAR_24);
    FUNC_13(VAR_13->domain,VAR_24,FUNC_16(VAR_24));
    VAR_13->revision = FUNC_5(2000);
    VAR_9 = FUNC_6(
        0xaa,
        0xaa,
        0x03,
        VAR_15,
        VAR_11,
        VAR_10,
        0);
    VAR_9 = FUNC_7(
        VAR_19,
        VAR_21->ether_addr_octet,
        VAR_0 + VAR_11,
        ((void*)0),
        0,
        VAR_10,
        0);

     VAR_12 = FUNC_11(VAR_10);

     if (VAR_12 == -1) {
        FUNC_8(VAR_10);
        FUNC_3(VAR_15);
        return -1;
     }
     FUNC_8(VAR_10);


     VAR_11 = sizeof(VAR_18)+sizeof(struct vtp_subset);
     VAR_16 = FUNC_0(1,VAR_11);
     VAR_17 = VAR_16;
     FUNC_13(VAR_16,VAR_18,sizeof(VAR_18));
     VAR_17+=sizeof(VAR_18);

     VAR_14 = (struct vtp_subset *)VAR_17;
     VAR_14->version = 0x01;
     VAR_14->code = 0x02;
     VAR_14->seq = 0x01;
     VAR_14->dom_len = FUNC_16(VAR_24);
     FUNC_13(VAR_14->domain,VAR_24,FUNC_16(VAR_24));
     VAR_14->revision = FUNC_5(2000);


    VAR_9 = FUNC_6(
        0xaa,
        0xaa,
        0x03,
        VAR_16,
        VAR_11,
        VAR_10,
        0);
    VAR_9 = FUNC_7(
        VAR_19,
        VAR_21->ether_addr_octet,
        VAR_0 + VAR_11,
        ((void*)0),
        0,
        VAR_10,
        0);

     VAR_12 = FUNC_11(VAR_10);
     if (VAR_12 == -1) {
        FUNC_8(VAR_10);
        FUNC_3(VAR_15);
        return -1;
     }
     FUNC_8(VAR_10);
}
