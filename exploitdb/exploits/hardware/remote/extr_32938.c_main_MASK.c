
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct sockaddr_ll {int sll_halen; struct raw_packet* sll_addr; int sll_pkttype; int sll_hatype; int sll_ifindex; void* sll_protocol; int sll_family; } ;
struct sockaddr {int dummy; } ;
struct TYPE_4__ {char* ether_shost; void* ether_type; struct raw_packet* ether_dhost; } ;
struct raw_packet {char* payload; TYPE_2__ header; void* payload_len; void* type; } ;
struct TYPE_3__ {char* sa_data; } ;
struct ifreq {int ifr_ifindex; TYPE_1__ ifr_hwaddr; int ifr_name; } ;
typedef int socket_address ;
typedef int packet ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 scalar_t__ VAR_3 ;
 scalar_t__ VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int FUNC_0 (void*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ,char*,...) ;
 scalar_t__ FUNC_3 () ;
 int FUNC_4 () ;
 void* FUNC_5 (int) ;
 void* FUNC_6 (scalar_t__) ;
 int FUNC_7 (int,int ,struct ifreq*) ;
 int FUNC_8 (char*,char*,int) ;
 int FUNC_9 (struct raw_packet*,int,int) ;
 scalar_t__ FUNC_10 (void*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int,struct raw_packet*,int,int ,int *,int *) ;
 int FUNC_14 (int,struct raw_packet*,int,int ,struct sockaddr*,int) ;
 int FUNC_15 (int ) ;
 int FUNC_16 (int ,int ,void*) ;
 int VAR_12 ;
 int FUNC_17 (int ,char*,int ) ;

int FUNC_18(int VAR_13, char *VAR_14[])
{
 int VAR_15, VAR_16, VAR_17, VAR_18;
 char VAR_19[VAR_2];
 struct ifreq VAR_20;
 struct sockaddr_ll VAR_21;
    struct raw_packet VAR_22;

    FUNC_9(&VAR_22, 0, sizeof(VAR_22));

 if (VAR_13 < 2)
 {
  FUNC_2(VAR_12, "usage : %s [IFNAME]\n", VAR_14[0]);
  FUNC_1(1);
 }

 VAR_15 = FUNC_16(VAR_0, VAR_11, FUNC_6(VAR_3));
 if (VAR_15 == -1)
 {
  if(FUNC_3() != 0)
  {
   FUNC_2(VAR_12, "You should probably run this program as root.\n");
  }
  FUNC_11("socket");
  FUNC_1(1);
 }
    FUNC_15(FUNC_4());

 FUNC_17(VAR_20.ifr_name, VAR_14[1], VAR_5);
 VAR_16 = FUNC_7(VAR_15, VAR_9, &VAR_20);
 if(VAR_16 < 0)
 {
  FUNC_11("ioctl");
  FUNC_1(1);
 }
 FUNC_8(VAR_19, VAR_20.ifr_hwaddr.sa_data, VAR_2);


 VAR_16 = FUNC_7(VAR_15, VAR_10, &VAR_20);
 if(VAR_16 < 0)
    {
  FUNC_11("ioctl");
  FUNC_1(1);
 }


    FUNC_8(VAR_22.header.ether_shost, VAR_19, VAR_2);

    FUNC_9(VAR_22.header.ether_dhost, 0xFF, VAR_2);

    FUNC_8(VAR_22.payload, "\x45\xD1\xBB\x33\x9B\x07\xA6\x61\x8B\x21\x14\xDB\xC0\xD7\x78\x3E", 0x10);
    VAR_22.payload_len = FUNC_5(0x10);

    VAR_22.header.ether_type = FUNC_6(VAR_4);

    VAR_22.type = FUNC_5(VAR_8);

    VAR_21.sll_family = VAR_7;
    VAR_21.sll_protocol = FUNC_6(VAR_4);
    VAR_21.sll_ifindex = VAR_20.ifr_ifindex;
    VAR_21.sll_hatype = VAR_1;
    VAR_21.sll_pkttype = VAR_6;

    VAR_21.sll_halen = VAR_2;
    FUNC_9(VAR_21.sll_addr, 0xFF, VAR_2);

    VAR_16 = FUNC_14(VAR_15, &VAR_22, 0x10 + 24, 0, (struct sockaddr *)&VAR_21, sizeof(VAR_21));
    if (VAR_16 == -1)
    {
        FUNC_11("sendto");
        FUNC_1(1);
    }

    do {
        FUNC_9(&VAR_22, 0, sizeof(VAR_22));
        VAR_16 = FUNC_13(VAR_15, &VAR_22, sizeof(VAR_22), 0, ((void*)0), ((void*)0));
        if (VAR_16 == -1)
        {
            FUNC_11("recvfrom");
            FUNC_1(1);
        }
    } while (FUNC_10(VAR_22.header.ether_type) != VAR_4);

    if (VAR_16 < sizeof(VAR_22) - sizeof(VAR_22.payload))
    {
        FUNC_2(VAR_12, "packet is too short: %d bytes\n", VAR_16);
        FUNC_1(1);
    }

    VAR_18 = FUNC_0(VAR_22.payload_len);
    FUNC_12("received packet: %d bytes (payload len = %d) from ", VAR_16, VAR_18);
    for (VAR_17 = 0; VAR_17 < VAR_2; VAR_17++)
        FUNC_12("%02X%c", VAR_22.header.ether_shost[VAR_17], VAR_17 == VAR_2-1 ? '\n' : ':');

    for (VAR_17 = 0; (VAR_17 < VAR_18) && (VAR_17 < sizeof(VAR_22.payload)); VAR_17++)
    {
        FUNC_12("%02X ", VAR_22.payload[VAR_17]);
        if ((VAR_17+1) % 16 == 0)
            FUNC_12("\n");
    }
    FUNC_12("\n");
 return 0;
}
