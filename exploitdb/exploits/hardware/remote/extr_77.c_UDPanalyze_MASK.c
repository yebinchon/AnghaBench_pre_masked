
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_8__ TYPE_4__ ;
typedef struct TYPE_7__ TYPE_3__ ;
typedef struct TYPE_6__ TYPE_2__ ;
typedef struct TYPE_5__ TYPE_1__ ;


struct TYPE_8__ {int verbose; } ;
struct TYPE_7__ {unsigned int PC_start; unsigned int PC_end; unsigned int IO_start; unsigned int IO_end; int * name; } ;
struct TYPE_6__ {int guess; unsigned int addrc; unsigned int lastaddr; TYPE_1__* addrs; } ;
struct TYPE_5__ {unsigned int a; int count; } ;


 int VAR_0 ;
 TYPE_4__ VAR_1 ;
 TYPE_3__* VAR_2 ;
 int FUNC_0 (int ) ;
 TYPE_2__ VAR_3 ;
 int FUNC_1 (unsigned char*,unsigned char*,unsigned int) ;
 int FUNC_2 (unsigned int) ;
 int FUNC_3 (char*,...) ;
 int VAR_4 ;

void FUNC_4(unsigned char *VAR_5, unsigned int VAR_6,
unsigned char *VAR_7, unsigned int VAR_8) {
unsigned char *VAR_9;
int VAR_10=0;
int VAR_11=0;

unsigned char *VAR_12;
unsigned char *VAR_13;
unsigned int VAR_14;

unsigned int VAR_15;
unsigned int VAR_16;
unsigned int VAR_17;
unsigned int VAR_18;


VAR_12=((void*)0);
VAR_13=((void*)0);
VAR_14=0;

if ((!FUNC_1(VAR_5,VAR_7,VAR_8))) {
if (VAR_1.verbose>1) FUNC_3("Payload found!\n");
VAR_12=VAR_5;
}

VAR_9=VAR_5;
while ((VAR_5+VAR_6-4)>VAR_9) {

if ( (VAR_9[0]==0xfd) && (VAR_9[1]==0x01) && (VAR_9[2]==0x10) && (VAR_9[3]==0xDF) ) {
if (VAR_1.verbose>1) FUNC_3("REDZONE MATCH!\n");
else { FUNC_3("!"); FUNC_0(VAR_4); }
VAR_10=1;
VAR_9+=4;
}

switch (VAR_10) {
case 1:
if (VAR_1.verbose)
FUNC_3("MEMORY BLOCK\n");
VAR_10++;
VAR_9+=4;
break;

case 2:
if (VAR_1.verbose)
FUNC_3("\tPID : %08X\n",FUNC_2(*(unsigned int *)VAR_9));
VAR_10++;
VAR_9+=4;
break;

case 3:
if (VAR_1.verbose)
FUNC_3("\tAlloc Check: %08X\n",FUNC_2(*(unsigned int *)VAR_9));
VAR_10++;
VAR_9+=4;
break;

case 4:
VAR_15=FUNC_2(*(unsigned int *)VAR_9);
if (VAR_1.verbose)
FUNC_3("\tAlloc Name : %08X\n",VAR_15);
VAR_10++;
VAR_9+=4;
break;

case 5:
VAR_16=FUNC_2(*(unsigned int *)VAR_9);
if (VAR_1.verbose)
FUNC_3("\tAlloc PC : %08X\n",VAR_16);
VAR_10++;
VAR_9+=4;
break;

case 6:
VAR_17=FUNC_2(*(unsigned int *)VAR_9);
if (VAR_1.verbose)
FUNC_3("\tNEXT Block : %08X\n",VAR_17);
if (VAR_13==((void*)0)) {
if (VAR_1.verbose) FUNC_3("Assigning as block2_next_field\n");
VAR_13=VAR_9;
} else if (VAR_14==0) {
if (VAR_1.verbose) FUNC_3("Assigning as block3_next_val\n");
VAR_14=VAR_17;
}
VAR_10++;
VAR_9+=4;
break;

case 7:
VAR_18=FUNC_2(*(unsigned int *)VAR_9);
if (VAR_1.verbose)
FUNC_3("\tPREV Block : %08X\n",VAR_18);
VAR_10++;
VAR_9+=4;
break;

case 8:
if (VAR_1.verbose)
FUNC_3("\tBlock Size : %8u words",
FUNC_2(*(unsigned int *)VAR_9)&0x7FFFFFFF);
if (FUNC_2(*(unsigned int *)VAR_9)&0x80000000) {
if (VAR_1.verbose)
FUNC_3(" (Block in use)\n");
} else {
if (VAR_1.verbose)
FUNC_3(" (Block NOT in use)\n");
}
VAR_10++;
VAR_9+=4;
break;

case 9:
if (VAR_1.verbose)
FUNC_3("\tReferences : %8u\n",FUNC_2(*(unsigned int *)VAR_9));
VAR_10++;
VAR_9+=4;
break;

case 10:
if (VAR_1.verbose)
FUNC_3("\tLast DeAlc : %08X\n",FUNC_2(*(unsigned int *)VAR_9));
VAR_10=100;
VAR_9+=4;
break;




case 100:

VAR_11=0;
while ((VAR_3.guess==-1)&&(VAR_2[VAR_11].name!=((void*)0))) {
if (
(VAR_15>=VAR_2[VAR_11].PC_start) &&
(VAR_15<=VAR_2[VAR_11].PC_end) &&
(VAR_16>=VAR_2[VAR_11].PC_start) &&
(VAR_16<=VAR_2[VAR_11].PC_end) &&
(VAR_17>=VAR_2[VAR_11].IO_start) &&
(VAR_17<=VAR_2[VAR_11].IO_end) &&
(VAR_18>=VAR_2[VAR_11].IO_start) &&
(VAR_18<=VAR_2[VAR_11].IO_end)
) {
VAR_3.guess=VAR_11;
break;
}
VAR_11++;
}
VAR_10=0;
VAR_9+=4;
break;

default:
VAR_9+=1;

}
}

if ( (VAR_12!=((void*)0)) && (VAR_13!=((void*)0)) && (VAR_14!=0) ) {
unsigned int VAR_19;
unsigned int VAR_20;
unsigned int VAR_21;
int VAR_22=0;

VAR_19=(unsigned int)((void*)VAR_13 - (void*)VAR_12);
VAR_20=VAR_14-VAR_19;

if (VAR_1.verbose) {
FUNC_3("\n");
FUNC_3("Delta between opcode_begin (%p) "
"and block2_next_field (%p) is %u\n",
(void*)VAR_13, (void*)VAR_12, VAR_19);
FUNC_3("The third block is at 0x%08X\n", VAR_14);
FUNC_3("Therefore, the code should be located at 0x%08X\n",VAR_20);
}

for (VAR_21=0;VAR_21<VAR_3.addrc;VAR_21++) {
if (VAR_3.addrs[VAR_21].a==VAR_20) {
VAR_3.addrs[VAR_21].count++;
VAR_22++;
break;
}
}
if ((VAR_22==0)&&(VAR_3.addrc<VAR_0-1)) {
VAR_3.addrs[VAR_3.addrc++].a=VAR_20;
VAR_3.addrs[VAR_3.addrc].count=1;
VAR_3.lastaddr=VAR_20;
}
}
}
