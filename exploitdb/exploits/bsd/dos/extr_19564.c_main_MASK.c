
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct tcphdr {int th_dport; int th_seq; int th_ack; int th_off; int th_flags; int th_sum; void* th_win; void* th_sport; } ;
struct TYPE_2__ {int s_addr; } ;
struct ip {int ip_v; int ip_hl; int ip_tos; int ip_off; int ip_ttl; TYPE_1__ ip_dst; TYPE_1__ ip_src; scalar_t__ ip_sum; scalar_t__ ip_p; void* ip_id; void* ip_len; } ;


 scalar_t__ VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 unsigned long FUNC_0 (int) ;
 void* FUNC_1 (int) ;
 int FUNC_2 (char*) ;
 char* FUNC_3 (TYPE_1__) ;
 unsigned char* FUNC_4 (int) ;
 int FUNC_5 (void*,void*,int) ;
 int FUNC_6 (unsigned char*,int,int) ;
 int FUNC_7 (scalar_t__) ;
 void FUNC_8 (char*) ;
 int FUNC_9 (char*,...) ;

int FUNC_10(int VAR_9, char *VAR_10[])
{
  int FUNC_11(unsigned short *, int);
  int FUNC_12(void);
  int FUNC_13(int, unsigned char *, int);
  unsigned long VAR_11 = FUNC_0(0x44000001);
  unsigned char *VAR_12;
  int VAR_13, VAR_14;
  struct ip *VAR_15;
  struct tcphdr *VAR_16;

  if (VAR_9 != 2) {
    FUNC_9("Quid custodiet ipsos custodes?\n");
    FUNC_9("Usage: %s <destination IP>\n", VAR_10[0]);
    return;
  }

  VAR_12 = FUNC_4(1500);
  FUNC_6(VAR_12, 0x00, 1500);

  if ((VAR_13 = FUNC_12()) < 0)
     return FUNC_8("socket");

  VAR_15 = (struct ip *) VAR_12;
  VAR_15->ip_v = 0x4;
  VAR_15->ip_hl = 0x5 + (VAR_3 / 4);
  VAR_15->ip_tos = 0x32;
  VAR_15->ip_len = FUNC_1(VAR_2);
  VAR_15->ip_id = FUNC_1(0xbeef);
  VAR_15->ip_off = 0x0;
  VAR_15->ip_ttl = 0xff;
  VAR_15->ip_p = VAR_0;
  VAR_15->ip_sum = 0;
  VAR_15->ip_src.s_addr = VAR_5;
  VAR_15->ip_dst.s_addr = FUNC_2(VAR_10[1]);



  VAR_16 = (struct tcphdr *) (VAR_12 + VAR_1 + VAR_3);
  VAR_16->th_sport = FUNC_1(80);
  VAR_16->th_dport = 0xbeef;
  VAR_16->th_seq = 0x12345678;
  VAR_16->th_ack = 0x87654321;
  VAR_16->th_off = 5;
  VAR_16->th_flags = VAR_7 | VAR_8;
  VAR_16->th_win = FUNC_1(8192);
  VAR_16->th_sum = 0;


  FUNC_5((void *) (VAR_12 + VAR_1), (void *) &VAR_11, VAR_3);


  VAR_14 = FUNC_11((unsigned short *) &(VAR_15->ip_src), 8)
     + FUNC_11((unsigned short *) VAR_16, VAR_6 + VAR_4)
     + FUNC_7(VAR_0 + VAR_6);
  while (VAR_14 >> 16) VAR_14 = (VAR_14 & 0xffff) + (VAR_14 >> 16);
  VAR_16->th_sum = ~VAR_14;

  FUNC_9("Sending %s -> ", FUNC_3(VAR_15->ip_src));
  FUNC_9("%s\n", FUNC_3(VAR_15->ip_dst));

  if (FUNC_13(VAR_13, VAR_12, VAR_2) != VAR_2)
     FUNC_8("sendto");
}
