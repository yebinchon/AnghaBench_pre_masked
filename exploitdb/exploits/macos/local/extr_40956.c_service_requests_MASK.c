
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int name; } ;
struct TYPE_4__ {int msgh_local_port; int msgh_remote_port; } ;
struct service_open_mig {TYPE_1__ owningTask; TYPE_2__ Head; } ;
typedef int mach_port_t ;
typedef scalar_t__ kern_return_t ;


 scalar_t__ VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (int) ;
 char* FUNC_1 (scalar_t__) ;
 scalar_t__ FUNC_2 (TYPE_2__*,int ,int ,size_t,int,int ,int ) ;
 struct service_open_mig* FUNC_3 (size_t) ;
 int FUNC_4 (struct service_open_mig*,int ,size_t) ;
 int FUNC_5 (char*,...) ;
 int FUNC_6 (int,char*) ;

void FUNC_7(mach_port_t VAR_2) {
  size_t VAR_3 = 0x1000;
  struct service_open_mig* VAR_4 = FUNC_3(VAR_3);
  FUNC_4(VAR_4, 0, VAR_3);

  FUNC_5("receiving on port set\n");
  kern_return_t VAR_5 = FUNC_2(&VAR_4->Head,
                               VAR_1,
                               0,
                               VAR_3,
                               VAR_2,
                               0,
                               0);

  if (VAR_5 != VAR_0) {
    FUNC_5("error receiving on port set: %s\n", FUNC_1(VAR_5));
    return;
  }

  mach_port_t VAR_6 = VAR_4->Head.msgh_local_port;

  FUNC_5("got a message on the port set from port: local(0x%x) remote(0x%x)\n", VAR_4->Head.msgh_local_port, VAR_4->Head.msgh_remote_port);
 mach_port_t VAR_7 = VAR_4->owningTask.name;
 FUNC_5("got task port: 0x%x\n", VAR_7);

 FUNC_6(VAR_7, "touch /tmp/hello_from_fake_kernel");

  FUNC_5("did that work?\n");
 FUNC_5("leaking some refs so we don't kernel panic");

 for(int VAR_8 = 0; VAR_8 < 0x100; VAR_8++) {
  FUNC_0(VAR_6);
  }

}
