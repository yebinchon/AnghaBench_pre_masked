
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_6__ TYPE_3__ ;
typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


typedef int uint32_t ;
struct TYPE_5__ {int msgh_size; int msgh_bits; void* msgh_remote_port; } ;
struct ping_send_msg {TYPE_2__ hdr; int member_0; } ;
struct TYPE_6__ {int msgh_size; void* msgh_local_port; void* msgh_remote_port; } ;
struct ping_rcv_msg {TYPE_3__ hdr; int member_0; } ;
struct TYPE_4__ {int* address; int size; } ;
struct ool_rcv_msg {TYPE_3__ hdr; TYPE_1__ desc; int member_0; } ;
typedef int ping_rcv ;
typedef int ping ;
typedef int msg ;
typedef void* mach_port_t ;
typedef int kern_return_t ;


 int FUNC_0 (char*) ;
 int FUNC_1 (char*,int ) ;
 int FUNC_2 (int ,int ) ;
 int VAR_0 ;
 int FUNC_3 (TYPE_3__*) ;
 int FUNC_4 (TYPE_2__*) ;
 int FUNC_5 (char*,int volatile,...) ;

void FUNC_6(mach_port_t VAR_1) {
  kern_return_t VAR_2;


  struct ool_rcv_msg VAR_3 = {0};
  VAR_3.hdr.msgh_local_port = VAR_1;
  VAR_3.hdr.msgh_size = sizeof(VAR_3);
  VAR_2 = FUNC_3(&VAR_3.hdr);
  FUNC_1("parent receiving child OOL message", VAR_2);

  volatile uint32_t* VAR_4 = VAR_3.desc.address;
  uint32_t VAR_5 = VAR_3.desc.size;

  FUNC_5("[+] parent got an OOL descriptor for %x bytes, mapped COW at: %p\n", VAR_5, (void*) VAR_4);

  FUNC_5("[+] parent reads: %08x\n", *VAR_4);

  FUNC_0("telling child to try to change what I see!");

  mach_port_t VAR_6 = VAR_3.hdr.msgh_remote_port;

  struct ping_send_msg VAR_7 = {0};
  VAR_7.hdr.msgh_size = sizeof(VAR_7);
  VAR_7.hdr.msgh_remote_port = VAR_6;
  VAR_7.hdr.msgh_bits = FUNC_2(VAR_0, 0);

  VAR_2 = FUNC_4(&VAR_7.hdr);
  FUNC_1("parent sending ping to child", VAR_2);


  struct ping_rcv_msg VAR_8 = {0};
  VAR_8.hdr.msgh_size = sizeof(VAR_8);
  VAR_8.hdr.msgh_local_port = VAR_1;
  VAR_2 = FUNC_3(&VAR_8.hdr);
  FUNC_1("parent receiving ping to try another read", VAR_2);

  FUNC_0("parent got ping message from child, lets try to read again...");

  FUNC_5("[+] parent reads: %08x\n", *VAR_4);
}
