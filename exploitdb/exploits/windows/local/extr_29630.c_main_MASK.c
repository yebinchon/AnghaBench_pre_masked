
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef char WCHAR ;
struct TYPE_2__ {char* FileName; int FileNameLength; int Action; int NextEntryOffset; } ;
typedef scalar_t__ HANDLE ;
typedef TYPE_1__ FILE_NOTIFY_INFORMATION ;
typedef int DWORD ;


 int FUNC_0 (char*,int ) ;
 scalar_t__ FUNC_1 (char*,int ,int,int *,int ,int ,int *) ;





 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 scalar_t__ VAR_12 ;
 int VAR_13 ;
 int FUNC_2 (scalar_t__,char*,int,int,int,int *,int *,int *) ;
 int FUNC_3 (int ,char*) ;
 int FUNC_4 (char*,char*) ;
 int VAR_14 ;
 int VAR_15 ;
 int FUNC_5 (char*,char*,char*) ;

int FUNC_6(int VAR_16, char *VAR_17[]){
    HANDLE VAR_18;

 char VAR_19[1024];
 FILE_NOTIFY_INFORMATION * VAR_20;
 int VAR_21;
 WCHAR * VAR_22 = ((void*)0);

 if(VAR_16 != 2) {
  FUNC_4(
"Usage: %s <directory_path>\n"
" Monitor directory changes with all subdirectories\n"
" For any files, including ones you have no access\n"
" (as on January, 2007)\n"
"(c) Vladimir Dubrovin, 3APA3A\n"
" http://securityvulns.com\n"
" http://securityvulns.ru\n"
"This approach is not reliable and should not be used for audit and another critical operations.\n",
 VAR_17[0]);
  return 1;
 }

 FUNC_0(VAR_17[1], 0);
 VAR_18 = FUNC_1(
   VAR_17[1],
   VAR_1,
   VAR_11|VAR_10,
   ((void*)0),
   VAR_13,
   VAR_0,
   ((void*)0)
 );
 if(VAR_18 == VAR_12){
  FUNC_3(VAR_15, "Failed to open dir\n");
  return 2;
 }
 for(;;){
     if(!FUNC_2(
  VAR_18,
  VAR_19,
  1022,
  1,
  VAR_4 | VAR_5 | VAR_6 |
   VAR_2 | VAR_9 | VAR_7 |
   VAR_3 | VAR_8
  ,
  (DWORD *)&VAR_21,
  ((void*)0),
  ((void*)0)
  )) {
   FUNC_3(VAR_14, "Failed to read directory changes\n");
   break;
  }
  for (VAR_20 = (FILE_NOTIFY_INFORMATION *)VAR_19; ;){
   VAR_20->FileName[VAR_20->FileNameLength/2] = 0;
   switch(VAR_20->Action){
   case 132:
    VAR_22 = L"added";
    break;
   case 130:
    VAR_22 = L"removed";
    break;
   case 131:
    VAR_22 = L"accessed/modified";
    break;
   case 128:
    VAR_22 = L"renamed (old name)";
    break;
   case 129:
    VAR_22 = L"renamed (new name)";
    break;
   default:
    VAR_22 = L"(unknown)";
   }
      FUNC_5(L"File %s: %s\n", VAR_22, VAR_20->FileName);
      if(!VAR_20->NextEntryOffset) break;
      VAR_20 = (FILE_NOTIFY_INFORMATION *)(((char *)VAR_20) + VAR_20->NextEntryOffset);
  }
 }
 return 0;

}
