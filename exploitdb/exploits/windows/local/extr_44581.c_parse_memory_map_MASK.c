
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_14__ TYPE_7__ ;
typedef struct TYPE_13__ TYPE_6__ ;
typedef struct TYPE_12__ TYPE_5__ ;
typedef struct TYPE_11__ TYPE_4__ ;
typedef struct TYPE_10__ TYPE_3__ ;
typedef struct TYPE_9__ TYPE_2__ ;
typedef struct TYPE_8__ TYPE_1__ ;


struct memory_region {int size; int address; } ;
struct TYPE_14__ {int Count; TYPE_6__* List; } ;
struct TYPE_12__ {int Count; TYPE_4__* PartialDescriptors; } ;
struct TYPE_13__ {TYPE_5__ PartialResourceList; } ;
struct TYPE_8__ {int QuadPart; } ;
struct TYPE_9__ {int Length; TYPE_1__ Start; } ;
struct TYPE_10__ {TYPE_2__ Memory; } ;
struct TYPE_11__ {int Type; TYPE_3__ u; } ;
typedef char* LPTSTR ;
typedef int * LPBYTE ;
typedef int * HKEY ;
typedef scalar_t__ DWORD ;
typedef TYPE_7__ CM_RESOURCE_LIST ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (int ,char*,int **) ;
 int FUNC_1 (int *,char*,int ,scalar_t__*,int *,scalar_t__*) ;
 scalar_t__ FUNC_2 (scalar_t__) ;
 int FUNC_3 (char*) ;

DWORD FUNC_4(struct memory_region *VAR_2) {
 HKEY VAR_3 = ((void*)0);
 LPTSTR VAR_4 = L"Hardware\\ResourceMap\\System Resources\\Physical Memory";
 LPTSTR VAR_5 = L".Translated";
 LPBYTE VAR_6 = ((void*)0);
 DWORD VAR_7 = 0, VAR_8 = 0, VAR_9 = 0;;

 if (!(FUNC_0(VAR_1, VAR_4, &VAR_3) == VAR_0))
 {
  FUNC_3("[*] Could not get reg key\n");
  return 0;
 }

 if (!(FUNC_1(VAR_3, VAR_5, 0, &VAR_9, ((void*)0), &VAR_7) == VAR_0))
 {
  FUNC_3("[*] Could not query hardware key\n");
  return 0;
 }

 VAR_6 = (LPBYTE)FUNC_2(VAR_7);
 FUNC_1(VAR_3, VAR_5, 0, &VAR_9, VAR_6, &VAR_7);

 CM_RESOURCE_LIST *VAR_10 = (CM_RESOURCE_LIST *)VAR_6;

 for (int VAR_11 = 0; VAR_11 < VAR_10->Count; VAR_11++) {
  for (int VAR_12 = 0; VAR_12 < VAR_10->List[0].PartialResourceList.Count; VAR_12++) {
   if (VAR_10->List[VAR_11].PartialResourceList.PartialDescriptors[VAR_12].Type == 3) {
    VAR_2->address = VAR_10->List[VAR_11].PartialResourceList.PartialDescriptors[VAR_12].u.Memory.Start.QuadPart;
    VAR_2->size = VAR_10->List[VAR_11].PartialResourceList.PartialDescriptors[VAR_12].u.Memory.Length;
    VAR_2++;
    VAR_8++;
   }
  }
 }

 return VAR_8;
}
