
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int FUNC_0 (int,int *,int ) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,int ) ;
 int FUNC_3 (char const*) ;
 int FUNC_4 (char*) ;
 int FUNC_5 (char*,char const*,char const*) ;
 int FUNC_6 (char*) ;
 scalar_t__ FUNC_7 (int) ;
 int FUNC_8 (char const*,char const*) ;
 int VAR_0 ;
 int FUNC_9 (char*) ;

int
FUNC_10 (int VAR_1, char *VAR_2[])
{
 FUNC_6 ("eMule/xMule/LMule OP_SERVERMESSAGE "
   "Format String Vulnerabilitytion Vulnerability\n"
  "proof of concept code\n"
  "Copyright (C) 2003 RÃ©mi Denis-Courmont "
   "<exploit@simutrans.fr.st>\n");
 if (VAR_1 > 3)
  return FUNC_9 (VAR_2[0]);
 else
 {
  int VAR_3;
  const char *VAR_4, *VAR_5;

  VAR_5 = (VAR_1 < 2) ? "4661" : VAR_2[2];
  VAR_4 = (VAR_1 < 3) ? ((void*)0) : VAR_2[3];
  FUNC_5 ("Binding to [%s]:%s ...\n",
   (VAR_4 != ((void*)0)) ? VAR_4 : "any", VAR_5);
  VAR_3 = FUNC_8 (VAR_4, VAR_5);
  if (VAR_3 == -1)
  {
   FUNC_3 (VAR_4);
   return 1;
  }

  while (1)
  {
   int VAR_6;

   FUNC_2 ("Waiting for a client to connect ... ", VAR_0);
   VAR_6 = FUNC_0 (VAR_3, ((void*)0), 0);
   if (VAR_6 == -1)
   {
    FUNC_6 ("");
    FUNC_4 ("Error");
    continue;
   }
   FUNC_6 ("OK");
   FUNC_2 ("Sending server message ... ", VAR_0);
   if (FUNC_7 (VAR_6))
   {
    FUNC_6 ("");
    FUNC_4 ("Error");
   }
   else
    FUNC_6 ("Done");
   FUNC_1 (VAR_6);
  }
 }

 return 0;
}
