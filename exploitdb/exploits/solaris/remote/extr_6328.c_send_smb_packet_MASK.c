
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct tcphdr {int doff; int ack; int psh; int window; int dest; int source; } ;
struct sockaddr_in {int sin_port; } ;
struct sockaddr {int dummy; } ;


 int VAR_0 ;
 char VAR_1 ;
 int FUNC_0 (int) ;
 scalar_t__ FUNC_1 (int ) ;
 int FUNC_2 (char*,int ,int ) ;
 int FUNC_3 (int,char*,int,int ,struct sockaddr*,int) ;
 int FUNC_4 (char*,char*) ;
 int FUNC_5 (char*) ;

void FUNC_6(int VAR_2,
                     struct sockaddr_in *VAR_3,
                     char VAR_4,
       char *VAR_5) {

   char *VAR_6 = (char*)FUNC_1(VAR_0);
   int VAR_7 = 0;
   struct tcphdr *VAR_8;
   char *VAR_9;
   int VAR_10;

   if (VAR_6) {
      FUNC_2(VAR_6, 0, VAR_0);

      VAR_8 = (struct tcphdr*)VAR_6;
      VAR_8->source = VAR_3->sin_port;
      VAR_8->dest = VAR_3->sin_port;
      VAR_8->doff = sizeof(struct tcphdr) / 4;
      VAR_8->ack = 1;
      VAR_8->psh = 1;
      VAR_8->window = FUNC_0(32768);

      VAR_9 = VAR_6 + sizeof(struct tcphdr);

      VAR_7 = 4;

      FUNC_4(VAR_9 + VAR_7, "\xffSMB");
      VAR_7 += 4;


      VAR_9[VAR_7++] = VAR_4;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = 0x18;


      VAR_9[VAR_7++] = 0x80;
      VAR_9[VAR_7++] = 0x01;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = VAR_1;
      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = VAR_1;


      VAR_9[VAR_7++] = FUNC_5(VAR_5) & 0xff;
      VAR_9[VAR_7++] = (FUNC_5(VAR_5) >> 8) & 0xff;

      VAR_9[VAR_7++] = 0x02;

      if (VAR_5) {

         FUNC_4(VAR_9 + VAR_7, VAR_5);
         VAR_7 += FUNC_5(VAR_5);
      }
      VAR_9[VAR_7++] = 0x00;


      VAR_9[3] = (VAR_7 - 4) & 0xff;
      VAR_9[2] = ((VAR_7 - 4) >> 8) & 0xff;


      VAR_10 = FUNC_3(VAR_2, VAR_6, sizeof(struct tcphdr) + VAR_7, 0,
                 (struct sockaddr*)VAR_3, sizeof(struct sockaddr_in));
   }

}
