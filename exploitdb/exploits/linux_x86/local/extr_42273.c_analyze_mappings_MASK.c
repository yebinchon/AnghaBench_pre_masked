
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int ssize_t ;
typedef int buf ;


 scalar_t__ VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 scalar_t__ FUNC_0 (int const) ;
 int FUNC_1 () ;
 scalar_t__ VAR_6 ;
 int FUNC_2 (int) ;
 int FUNC_3 (int ,char*) ;
 char* FUNC_4 (char*,char,int) ;
 int FUNC_5 (char*,int ) ;
 int FUNC_6 (int const,char*,int) ;
 int VAR_7 ;
 char* FUNC_7 (char const*,char) ;
 int FUNC_8 (char*,char const* const) ;
 int FUNC_9 (char*) ;
 char* FUNC_10 (char*,char) ;
 size_t FUNC_11 (char const*,char**,int) ;
 int const FUNC_12 (int ,char*,int const) ;

__attribute__((used)) static void
FUNC_13(const char * const VAR_8)
{
    if (!VAR_8) FUNC_1();
    if (FUNC_7(VAR_8, ' ')) FUNC_1();
    int VAR_9 = VAR_2;
    int VAR_10 = 0;

    const int VAR_11 = FUNC_5("/proc/self/maps", VAR_4);
    if (VAR_11 <= -1) FUNC_1();

    static char VAR_12[4096] = " ";
    char * VAR_13 = VAR_12;
    for (;;) {
        if (VAR_13 >= VAR_12 + sizeof(VAR_12)) FUNC_1();
        const ssize_t VAR_14 = FUNC_6(VAR_11, VAR_13, VAR_12 + sizeof(VAR_12) - VAR_13);
        if (VAR_14 <= 0) {
            if (VAR_14 == 0) break;
            if (VAR_14 != -1) FUNC_1();
            if (VAR_6 != VAR_0 && VAR_6 != VAR_1) FUNC_1();
            continue;
        }
        VAR_13 += VAR_14;
    }
    *VAR_13 = '\0';
    if (FUNC_4(VAR_12, '\0', sizeof(VAR_12)) != VAR_13) FUNC_1();

    size_t VAR_15 = 0;
    size_t VAR_16 = 0;
    size_t VAR_17 = 0;
    size_t VAR_18 = 0;
    const char * VAR_19 = VAR_12;
    for (;;) {
        char * const VAR_20 = FUNC_7(VAR_19, '\n');
        if (!VAR_20) FUNC_1();
        *VAR_20 = '\0';

        VAR_13 = ((void*)0);
        const size_t VAR_21 = FUNC_11(VAR_19, &VAR_13, 16);
        if (VAR_13 <= VAR_19 || *VAR_13 != '-') FUNC_1();
        if (VAR_21 <= 0) FUNC_1();

        VAR_19 = VAR_13 + 1;
        VAR_13 = ((void*)0);
        const size_t VAR_22 = FUNC_11(VAR_19, &VAR_13, 16);
        if (VAR_13 <= VAR_19 || *VAR_13 != ' ') FUNC_1();
        if (VAR_22 <= VAR_21) FUNC_1();

        VAR_13 = FUNC_10(VAR_13 + 1, ' ');
        if (!VAR_13) FUNC_1();
        VAR_13++;

        if (!FUNC_8(VAR_13, VAR_8)) {
            VAR_15 = VAR_22;
            if (VAR_21 == 0x08048000) {
                FUNC_3(VAR_7, "Please recompile with -fpie -pie\n");
                FUNC_1();
            }
        } else if (!FUNC_8(VAR_13, "[heap]")) {
            if (!VAR_17) VAR_17 = VAR_21;
            else {
                if (VAR_18) FUNC_1();
                VAR_18 = VAR_21;
                VAR_10 = 1;
            }
        } else if (!FUNC_8(VAR_13, "[stack]")) {
            if (!VAR_18) VAR_18 = VAR_21;
            else {
                FUNC_1();
            }
        } else if (*VAR_13 == '/') {
            if (!VAR_16) VAR_16 = VAR_21;
        }

        *VAR_20 = '\n';
        VAR_19 = VAR_20 + 1;
        if (*VAR_19 == '\0') break;
    }
    if (!VAR_15) FUNC_1();
    if (!VAR_16) FUNC_1();
    if (!VAR_18) {
        if (!VAR_17) FUNC_1();
        VAR_18 = VAR_17;
        VAR_17 = 0;
    }

    if (VAR_15 <= VAR_16 && VAR_16 - VAR_15 <= 4096) {
        FUNC_3(VAR_7, "CVE-2017-1000370 triggered\n");
        VAR_9 = VAR_3;
        VAR_10 = 1;
    }
    if (VAR_15 <= VAR_18 && VAR_18 - VAR_15 <= 4096) {
        FUNC_3(VAR_7, "CVE-2017-1000371 triggered\n");
        VAR_9 = VAR_3;
        VAR_10 = 1;
    }
    if (VAR_10) {
        const ssize_t VAR_23 = FUNC_9(VAR_12);
        if (VAR_23 <= 0) FUNC_1();
        if (FUNC_12(VAR_5, VAR_12, VAR_23) != VAR_23) FUNC_1();
    }
    if (FUNC_0(VAR_11)) FUNC_1();
    FUNC_2(VAR_9);
}
