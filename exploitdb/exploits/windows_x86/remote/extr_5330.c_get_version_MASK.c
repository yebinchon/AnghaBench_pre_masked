
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int bufmax ;
typedef int WebBanner ;
typedef int Version ;
struct TYPE_2__ {char* t; } ;
typedef int SOCKET ;
typedef int ModJK ;


 int FUNC_0 (char*,int) ;
 int FUNC_1 (char*,int ,int) ;
 int FUNC_2 (char*,...) ;
 int FUNC_3 (int,char*,int,int ) ;
 int FUNC_4 (int,char*,int,int ) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,char*,int) ;
 char* FUNC_7 (char*,char*) ;
 TYPE_1__* VAR_0 ;

int FUNC_8(char * VAR_1, int VAR_2, int * VAR_3)
{

 char VAR_4[4096], * VAR_5, *VAR_6, VAR_7[1000], VAR_8[1000], VAR_9[1000];
 int VAR_10,VAR_11,VAR_12;
 SOCKET VAR_13;

 FUNC_1(VAR_4,0,sizeof(VAR_4));
 FUNC_1(VAR_7,0,sizeof(VAR_7));
 FUNC_1(VAR_8,0,sizeof(VAR_8));
 FUNC_1(VAR_9,0,sizeof(VAR_9));
 VAR_13 = FUNC_0(VAR_1, VAR_2);

 if (VAR_13 == -1) return -1;
 FUNC_4(VAR_13, "GET /a.html HTTP/1.0\r\n\r\n",(int)FUNC_5("GET /a.html HTTP/1.0\r\n\r\n"),0);

 if ((VAR_10 = FUNC_3(VAR_13, VAR_4, sizeof(VAR_4),0 )) <= 0) return -1;
 VAR_4[sizeof(VAR_4)-1]=0;

 if((VAR_5=FUNC_7(VAR_4,"Server:"))==((void*)0)) return -1;
 if((VAR_6=FUNC_7(VAR_5,"\r\n"))==((void*)0)) return -1;

 FUNC_6(VAR_7, VAR_5, VAR_6-VAR_5);
 if((VAR_5=FUNC_7(VAR_7,"Win32"))==((void*)0))
 {
  FUNC_2("   [-] OS is not a Win32\n");
  return -1;
 }

 if((VAR_5=FUNC_7(VAR_7,"Apache/"))==((void*)0))
 {
  FUNC_2("   [-] No Apache\n");
  return -1;
 }
 if(VAR_5+FUNC_5("Apache/")>VAR_7+FUNC_5(VAR_7)-1) return -1;
 VAR_5+=FUNC_5("Apache/");
 if((VAR_6=FUNC_7(VAR_5," "))==((void*)0)) return -1;

 FUNC_6(VAR_8, VAR_5, VAR_6-VAR_5);

 FUNC_2("   [+] Version of Apache is %s\n", VAR_8);

 VAR_12=0;
 for(VAR_11=0; VAR_0[VAR_11].t!=0;VAR_11++)
 {
  if(FUNC_7(VAR_0[VAR_11].t,VAR_8)!=((void*)0))
  {
   VAR_12=1;
   break;
  }
 }
 if(VAR_12==0)
 {
  FUNC_2("   [-] This version of Apache is UNSUPPORTED\n");
  return -1;
 }
 FUNC_2("   [+] This version of Apache is SUPPORTED\n");

 FUNC_6(VAR_7, VAR_5, VAR_6-VAR_5);

 if((VAR_5=FUNC_7(VAR_7,"mod_jk2/"))==((void*)0))
 {
  FUNC_2("   [-] No mod_jk2\n");
  return -1;
 }
 if((VAR_6=FUNC_7(VAR_5," "))==((void*)0)) VAR_6=VAR_7+FUNC_5(VAR_7);

 FUNC_6(VAR_9, VAR_5, VAR_6-VAR_5);

 FUNC_2("   [+] mod_jk2 is %s\n", VAR_9);
 VAR_12=0;
 for(VAR_11=0; VAR_0[VAR_11].t!=0;VAR_11++)
 {
  if(FUNC_7(VAR_0[VAR_11].t,VAR_9)!=((void*)0))
  {
   *VAR_3=VAR_11;
   VAR_12=1;
   break;
  }
 }
 if(VAR_12==0)
 {
  FUNC_2("   [-] This version of mod_jk2 is UNSUPPORTED\n");
  return -1;
 }
 FUNC_2("   [+] This version of mod_jk2 is SUPPORTED\n");
 return 0;
}
