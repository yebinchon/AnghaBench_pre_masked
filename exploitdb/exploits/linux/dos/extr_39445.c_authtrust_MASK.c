
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef scalar_t__ u_long ;
struct savekey {scalar_t__ keyid; struct savekey* next; int flags; scalar_t__ keylen; scalar_t__ type; scalar_t__ lifetime; } ;
typedef scalar_t__ keyid_t ;


 size_t FUNC_0 (scalar_t__) ;
 int VAR_0 ;
 scalar_t__ FUNC_1 () ;
 struct savekey* VAR_1 ;
 scalar_t__ VAR_2 ;
 int VAR_3 ;
 scalar_t__ VAR_4 ;
 scalar_t__ VAR_5 ;
 scalar_t__ VAR_6 ;
 struct savekey** VAR_7 ;

void
FUNC_2(
 keyid_t VAR_8,
 u_long VAR_9
 )
{
 struct savekey *VAR_10;





 VAR_10 = VAR_7[FUNC_0(VAR_8)];
 while (VAR_10 != 0) {
  if (VAR_8 == VAR_10->keyid)
      break;

  VAR_10 = VAR_10->next;
 }
 if (VAR_10 == 0 && !VAR_9)
  return;






 if (VAR_10 != 0) {
  if (VAR_5 == VAR_8) {
   VAR_4 = 0;
   VAR_5 = 0;
  }






  if (VAR_9 > 0) {
   VAR_10->flags |= VAR_0;
   if (VAR_9 > 1)
    VAR_10->lifetime = VAR_6 + VAR_9;
   else
    VAR_10->lifetime = 0;
   return;
  }
  VAR_10->flags &= ~VAR_0; {
   struct savekey *VAR_11;

   VAR_11 = VAR_7[FUNC_0(VAR_8)];
   if (VAR_11 == VAR_10) {
    VAR_7[FUNC_0(VAR_8)] = VAR_10->next;
   } else {
    while (VAR_11->next != VAR_10)
        VAR_11 = VAR_11->next;
    VAR_11->next = VAR_10->next;
   }
   VAR_3--;

   VAR_10->next = VAR_1;
   VAR_1 = VAR_10;
   VAR_2++;
  }
  return;
 }






 if (VAR_2 == 0)
     if (FUNC_1() == 0)
  return;

 VAR_10 = VAR_1;
 VAR_1 = VAR_10->next;
 VAR_2--;
 VAR_10->keyid = VAR_8;
 VAR_10->type = 0;
 VAR_10->keylen = 0;
 VAR_10->flags = VAR_0;
 VAR_10->next = VAR_7[FUNC_0(VAR_8)];
 VAR_7[FUNC_0(VAR_8)] = VAR_10;
 VAR_3++;
 return;
}
