
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
void FUNC_0(void)
{
__asm volatile(".globl _ring0\n"
 "_ring0:\n"
 ".intel_syntax noprefix\n"
 ".code64\n"

 "mov esp, ecx\n"

 "push rax\n"
 "push rbx\n"
 "push rcx\n"
 "push rdx\n"

 "mov rcx, qword ptr [rbx+8]\n"
 "test rcx, rcx\n"
 "jz skip_write\n"
 "mov dword ptr [rcx], 0\n"
 "skip_write:\n"

 "mov ecx, 0x176\n"
 "mov eax, dword ptr [rbx]\n"
 "mov edx, dword ptr [rbx+4]\n"
 "wrmsr\n"
 "pop rdx\n"
 "pop rcx\n"
 "pop rbx\n"
 "pop rax\n"
 "sti\n"
 "sysexit\n"
 ".code32\n"
 ".att_syntax prefix\n"
        ".global _ring0_end\n"
 "_ring0_end:\n"
 );
}
