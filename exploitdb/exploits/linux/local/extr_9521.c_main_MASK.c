
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_node; int s_net; } ;
struct sockaddr_at {int sat_zero; int sat_port; TYPE_1__ sat_addr; int sat_family; } ;
struct sockaddr {int dummy; } ;
typedef int sat ;


 int AF_APPLETALK ;
 int ATADDR_ANYNET ;
 int ATADDR_ANYNODE ;
 int ATADDR_ANYPORT ;
 int EXIT_FAILURE ;
 int EXIT_SUCCESS ;
 int SOCK_DGRAM ;
 scalar_t__ bind (int,struct sockaddr*,int) ;
 int close (int) ;
 int dump (unsigned char*,int) ;
 int getpid () ;
 scalar_t__ getsockname (int,struct sockaddr*,int*) ;
 int htons (int ) ;
 int kernop (int) ;
 scalar_t__ memcmp (int ,char*,int) ;
 int memcpy (char**,int *,int) ;
 int memset (struct sockaddr_at*,int ,int) ;
 int perror (char*) ;
 int socket (int ,int ,int ) ;
 int srand (int) ;
 int time (int *) ;
 int usleep (int) ;

int main(void)
{
    struct sockaddr_at sat;
    int s, len = sizeof(sat), occ = 500;
    char prev_zero[sizeof(sat.sat_zero)] = { 0 };

    s = socket(AF_APPLETALK, SOCK_DGRAM, 0);
    if ( s == -1 )
    {
        perror("socket");
        return EXIT_FAILURE;
    }

    memset(&sat, 0, sizeof(sat));
    sat.sat_family = AF_APPLETALK;
    sat.sat_addr.s_net = htons(ATADDR_ANYNET);
    sat.sat_addr.s_node = ATADDR_ANYNODE;
    sat.sat_port = ATADDR_ANYPORT;

    if ( bind(s, (struct sockaddr *) &sat, len) < 0 )
    {
        perror("bind");
        return EXIT_FAILURE;
    }

    srand(time(((void*)0)) ^ getpid());

    while ( --occ )
    {
        kernop(s);

        if ( getsockname(s, (struct sockaddr *) &sat, &len) == 0 )
        {
            if ( memcmp(sat.sat_zero, prev_zero, sizeof(sat.sat_zero)) != 0 )
            {
                dump((unsigned char *) &sat.sat_zero, sizeof(sat.sat_zero));
                memcpy(&prev_zero, &sat.sat_zero, sizeof(sat.sat_zero));
                usleep(5000);
            }
        }
    }

    close(s);

    return EXIT_SUCCESS;
}
