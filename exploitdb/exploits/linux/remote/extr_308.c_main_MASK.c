
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int victim ;
struct TYPE_2__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int confess ;


 int VAR_0 ;
 unsigned int VAR_1 ;
 int VAR_2 ;
 unsigned int VAR_3 ;
 unsigned int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_0 (int) ;
 int FUNC_1 (int,struct sockaddr*,unsigned int*) ;
 unsigned int FUNC_2 (int ) ;
 int FUNC_3 () ;
 int FUNC_4 (int,struct sockaddr*,int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (char*) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (int ,char*,...) ;
 unsigned int FUNC_9 (int,char**,char*) ;
 int FUNC_10 (int ) ;
 int FUNC_11 (unsigned int) ;
 char* FUNC_12 (TYPE_1__) ;
 int FUNC_13 (int,int ) ;
 int FUNC_14 (char*) ;
 int FUNC_15 (struct sockaddr_in*,int ,int) ;
 int VAR_9 ;
 int VAR_10 ;
 int FUNC_16 (int,unsigned int,unsigned int) ;
 int FUNC_17 (int,int ) ;
 int FUNC_18 (char*,unsigned int) ;
 int FUNC_19 (int,int ,int ,unsigned int*,int) ;
 int FUNC_20 (int) ;
 int FUNC_21 (int ,int ,int ) ;
 int VAR_11 ;

int
FUNC_22(int VAR_12, char **VAR_13)
{
unsigned int VAR_14 = 0, VAR_15 = 0, VAR_16 = 1;
unsigned int VAR_17 = VAR_4;
unsigned int VAR_18, VAR_19;

signed int VAR_20, VAR_21;

static char *VAR_22, *VAR_23;

struct sockaddr_in VAR_24;
struct sockaddr_in VAR_25;


if(VAR_12 < 2) {
FUNC_3();
FUNC_7(VAR_22);
FUNC_0(1);
}FUNC_3();


while((VAR_19 = FUNC_9(VAR_12, VAR_13, "a:o:")) != -1) {
switch(VAR_19)
{
case 'a':
VAR_14 = FUNC_2(VAR_9);
break;
case 'o':
VAR_15 = FUNC_2(VAR_9);
break;
default:
VAR_14 = VAR_1;
VAR_15 = VAR_3;
}
}

if((VAR_21 = FUNC_21(VAR_0, VAR_5, 0)) == -1) {
FUNC_6("Could not create socket");
}

if(FUNC_19(VAR_21,VAR_6,VAR_7, &VAR_16, sizeof(int)) == -1) {
FUNC_6("Could not re-use socket");
}

FUNC_15(&VAR_25, 0, sizeof(VAR_25));

VAR_25.sin_family = VAR_0;
VAR_25.sin_port = FUNC_11(VAR_17);
VAR_25.sin_addr.s_addr = FUNC_10(VAR_2);

if(FUNC_4(VAR_21, (struct sockaddr *)&VAR_25, sizeof(struct sockaddr)) == -1) {
FUNC_6("Could not bind socket");
}

if(FUNC_13(VAR_21, 0) == -1) {
FUNC_6("Could not listen on socket");
}

FUNC_18(" -> Listening for a connection on port %d\n", VAR_17);

VAR_18 = sizeof(VAR_24);
VAR_20 = FUNC_1(VAR_21, (struct sockaddr *)&VAR_24, &VAR_18);

FUNC_8(VAR_11, " -> Action: Attaching from host[%s]\n", FUNC_12(VAR_24.sin_addr));

if(FUNC_16(VAR_20, VAR_14, VAR_15) == 1) {
FUNC_8(VAR_11, "Could not prep package\n");
FUNC_0(1);
}

if(FUNC_17(VAR_20, VAR_10) == 1) {
FUNC_8(VAR_11, "Could not send package\n");
FUNC_0(1);
}
FUNC_20(2);

FUNC_8(VAR_11, " -> Test complete\n\n");

FUNC_5(VAR_20); FUNC_14(VAR_23);

return VAR_8;
}
