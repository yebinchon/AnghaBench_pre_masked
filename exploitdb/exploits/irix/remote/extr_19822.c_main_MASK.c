
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 int VAR_0 ;
 int VAR_1 ;
 char VAR_2 ;
 unsigned int FUNC_0 (char*) ;
 char* VAR_3 ;
 char* VAR_4 ;
 unsigned int* VAR_5 ;
 char* VAR_6 ;
 char* VAR_7 ;
 int FUNC_1 (int) ;
 char* VAR_8 ;
 char* FUNC_2 () ;
 int FUNC_3 (int,char**,char*) ;
 char FUNC_4 (char*) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (unsigned int) ;
 int FUNC_8 (char*,char*) ;
 int VAR_9 ;
 int FUNC_9 (int ,int ,int ) ;
 int FUNC_10 (char*,char*) ;
 char FUNC_11 (char*) ;

FUNC_12(int VAR_10,char **VAR_11){
    int VAR_12,VAR_13,VAR_14,VAR_15;
    unsigned int VAR_16,VAR_17,VAR_18;
    char *VAR_19;
    char VAR_20[20];
    extern char *VAR_21;
    extern int VAR_22;

    if(VAR_10<2) {FUNC_5(VAR_11[0]);FUNC_1(0);}
    VAR_22=2;
    VAR_16=40;
    VAR_13=VAR_14=VAR_15=0;
    while((VAR_12=FUNC_3(VAR_10,VAR_11,"u:i:p"))!=-1)
        switch(VAR_12){
        case 'u': FUNC_10(VAR_20,VAR_21);
                  VAR_13=1;
                  break;
        case 'i': VAR_14=62;
                  VAR_18=FUNC_0(VAR_21);
                  break;
        case 'p': VAR_15=1;
                  break;
        case '?':
        default : FUNC_5(VAR_11[0]);
                  FUNC_1(1);
        }

    VAR_9=FUNC_9(VAR_0,VAR_1,0);
    VAR_2=FUNC_4(VAR_11[1]);
    FUNC_6(&VAR_8[4],&VAR_2,4);

    if(!(VAR_19=FUNC_2())){
        FUNC_8("error: can't get system ID for %s.\n",VAR_11[1]);
        FUNC_1(1);
    }
    if(!VAR_15){
        FUNC_6(&VAR_7[0x0d],VAR_19,VAR_19[0]+1);
        FUNC_6(&VAR_7[0x0d+VAR_19[0]+1],&VAR_6[0],27);
        VAR_16+=VAR_19[0]+1;

        if(!VAR_13) FUNC_10(VAR_20,"lsd");
        VAR_7[VAR_16++]=FUNC_11(VAR_20);
        FUNC_10(&VAR_7[VAR_16],VAR_20);VAR_16+=FUNC_11(VAR_20);
        FUNC_6(&VAR_7[VAR_16],&VAR_4[0],200);
        VAR_16+=200;
        VAR_17=VAR_16-15;
        if(VAR_14){
            VAR_7[VAR_17++]='u';
            VAR_7[VAR_17++]='s';
            VAR_7[VAR_17++]='e';
            VAR_7[VAR_17++]='r';
            VAR_7[VAR_16++]=0x02;
            VAR_7[VAR_16++]=VAR_18>>8;
            VAR_7[VAR_16++]=VAR_18&0xff;
        }
        else VAR_7[VAR_16++]=0x00;

        FUNC_6(&VAR_7[VAR_16],&VAR_3[0],39);
        VAR_16+=39;
        VAR_5[10]=VAR_16>>8;
        VAR_5[11]=VAR_16&0xff;
        FUNC_7(VAR_16);
    }
}
