
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_2__ TYPE_1__ ;


typedef int sock_buffer ;
struct TYPE_2__ {int bytes_read_total; unsigned char expected_payload_size; size_t bytes_read_payload; scalar_t__ payload; int socket; } ;


 TYPE_1__ VAR_0 ;
 int FUNC_0 () ;
 int FUNC_1 () ;
 int FUNC_2 (int ,void*,int,int ) ;

int FUNC_3(void)
{
    unsigned char VAR_1[2048];
    int VAR_2;
    int VAR_3;

    VAR_3 = FUNC_2(VAR_0.socket, (void *)VAR_1, sizeof(VAR_1), 0);

    if (VAR_3 <= 0)
        return VAR_3;

    for (VAR_2=0; VAR_2<VAR_3; VAR_2++) {
        VAR_0.bytes_read_total++;

        switch(VAR_0.bytes_read_total)
        {
        case 1:
            VAR_0.expected_payload_size = 0;
            break;
        case 2:
            break;
        case 3:
            VAR_0.expected_payload_size = VAR_1[VAR_2] << 8;
            break;
        case 4:
            VAR_0.expected_payload_size |= VAR_1[VAR_2];
            FUNC_0();
            break;
        default:
            ((unsigned char *)VAR_0.payload)[VAR_0.bytes_read_payload] = VAR_1[VAR_2];
            VAR_0.bytes_read_payload++;
            if (VAR_0.bytes_read_payload == VAR_0.expected_payload_size)
                FUNC_1();
            break;
        }
    }

    return VAR_3;
}
