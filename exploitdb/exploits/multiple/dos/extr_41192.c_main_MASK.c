
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_6__ TYPE_1__ ;


struct TYPE_6__ {int next; } ;
typedef TYPE_1__ mbedtls_x509_crt ;
typedef int mbedtls_ssl_context ;
typedef int mbedtls_ssl_config ;
typedef int mbedtls_pk_context ;
typedef int mbedtls_net_context ;
typedef int mbedtls_entropy_context ;
typedef int mbedtls_ctr_drbg_context ;
typedef int buf ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 int FUNC_0 (int *) ;
 int FUNC_1 (int *) ;
 int VAR_6 ;
 int FUNC_2 (int *,int ,int *,unsigned char const*,int ) ;
 int FUNC_3 (int *) ;
 int VAR_7 ;
 int FUNC_4 (int *) ;
 int FUNC_5 (int *,int *,int *,int ,int *) ;
 int FUNC_6 (int *,int *,char*,int ) ;
 int FUNC_7 (int *) ;
 int FUNC_8 (int *) ;
 int VAR_8 ;
 int FUNC_9 (int *,unsigned char*,int ) ;
 int FUNC_10 (int *) ;
 int FUNC_11 (int *) ;
 int FUNC_12 (int *,unsigned char const*,int ,int *,int ) ;
 int FUNC_13 (int *) ;
 int FUNC_14 (int *,int ,int *) ;
 int FUNC_15 (int *,int*) ;
 int FUNC_16 (int *,TYPE_1__*,int *) ;
 int FUNC_17 (int *,int ,int *) ;
 int FUNC_18 (int *,int ,int ,int ) ;
 int FUNC_19 (int *) ;
 int FUNC_20 (int *) ;
 int FUNC_21 (int *) ;
 int FUNC_22 (char*) ;
 int FUNC_23 (int *) ;
 int FUNC_24 (int *) ;
 int FUNC_25 (int *) ;
 int FUNC_26 (int *,int *,int (*) (int *,unsigned char*,int ),int ,int *) ;
 int FUNC_27 (int *,int *) ;
 scalar_t__ VAR_9 ;
 int VAR_10 ;
 scalar_t__ VAR_11 ;
 int VAR_12 ;
 scalar_t__ VAR_13 ;
 int VAR_14 ;
 int FUNC_28 (TYPE_1__*) ;
 int FUNC_29 (TYPE_1__*) ;
 int FUNC_30 (TYPE_1__*,unsigned char const*,int ) ;
 int FUNC_31 (char*,char*) ;
 int FUNC_32 (char const*) ;
 scalar_t__ FUNC_33 (char*,char*,int) ;
 int FUNC_34 (int *,char*,int) ;

int FUNC_35( void )
{
    int VAR_15;
    mbedtls_net_context VAR_16, VAR_17;
    char VAR_18[1024];
    const char *VAR_19 = "ssl_server";

    int VAR_20[2];
    mbedtls_entropy_context VAR_21;
    mbedtls_ctr_drbg_context VAR_22;
    mbedtls_ssl_context VAR_23;
    mbedtls_ssl_config VAR_24;
    mbedtls_x509_crt VAR_25;
    mbedtls_pk_context VAR_26;

    FUNC_8( &VAR_16 );
    FUNC_8( &VAR_17 );
    FUNC_24( &VAR_23 );
    FUNC_20( &VAR_24 );
    FUNC_29( &VAR_25 );
    FUNC_11( &VAR_26 );
    FUNC_4( &VAR_21 );
    FUNC_1( &VAR_22 );

    VAR_15 = FUNC_30( &VAR_25, (const unsigned char *) VAR_11,
                          VAR_12 );
    if( VAR_15 != 0 )
    {
        goto exit;
    }

    VAR_15 = FUNC_30( &VAR_25, (const unsigned char *) VAR_9,
                          VAR_10 );
    if( VAR_15 != 0 )
    {
        goto exit;
    }

    VAR_15 = FUNC_12( &VAR_26, (const unsigned char *) VAR_13,
                         VAR_14, ((void*)0), 0 );
    if( VAR_15 != 0 )
    {
        goto exit;
    }

    if( ( VAR_15 = FUNC_6( &VAR_16, ((void*)0), "8888", VAR_2 ) ) != 0 )
    {
        goto exit;
    }

    if( ( VAR_15 = FUNC_2( &VAR_22, VAR_7, &VAR_21,
                               (const unsigned char *) VAR_19,
                               FUNC_32( VAR_19 ) ) ) != 0 )
    {
        goto exit;
    }

    if( ( VAR_15 = FUNC_18( &VAR_24,
                    VAR_3,
                    VAR_5,
                    VAR_4 ) ) != 0 )
    {
        goto exit;
    }

    FUNC_17( &VAR_24, VAR_6, &VAR_22 );


    FUNC_14( &VAR_24, VAR_25.next, ((void*)0) );
    if( ( VAR_15 = FUNC_16( &VAR_24, &VAR_25, &VAR_26 ) ) != 0 )
    {
        goto exit;
    }

    VAR_20[0] = FUNC_22( "TLS-DHE-RSA-WITH-AES-256-GCM-SHA384" );
    VAR_20[1] = 0;
    FUNC_15( &VAR_24, VAR_20 );

    if( ( VAR_15 = FUNC_27( &VAR_23, &VAR_24 ) ) != 0 )
    {
        goto exit;
    }

reset:

    FUNC_7( &VAR_17 );

    FUNC_25( &VAR_23 );

    if( ( VAR_15 = FUNC_5( &VAR_16, &VAR_17,
                                    ((void*)0), 0, ((void*)0) ) ) != 0 )
    {
        goto exit;
    }

    FUNC_31(VAR_18, "220 ok\n");
    VAR_15 = FUNC_34( &VAR_17, VAR_18, sizeof(VAR_18));

    if ( VAR_15 < 5 ) {
        goto exit;
    }

    if ( FUNC_33(VAR_18, "EHLO ", 5) != 0 ) {
        goto exit;
    }

    FUNC_31(VAR_18, "250-SIZE 157286400\n250-8BITMIME\n250-STARTTLS\n250-ENHANCEDSTATUSCODES\n250-PIPELINING\n250-CHUNKING\n250 SMTPUTF8\n");
    VAR_15 = FUNC_34( &VAR_17, VAR_18, sizeof(VAR_18));

    if ( VAR_15 < 8 ) {
        goto exit;
    }

    if ( FUNC_33(VAR_18, "STARTTLS", 8) != 0 ) {
        goto exit;
    }
    FUNC_31(VAR_18, "220 ok\n");
    VAR_15 = FUNC_9( &VAR_17, (unsigned char*)VAR_18, FUNC_32(VAR_18) );
    if ( VAR_15 < 0 ) {
        goto exit;
    }

    FUNC_26( &VAR_23, &VAR_17, FUNC_9, VAR_8, ((void*)0) );


    while( ( VAR_15 = FUNC_23( &VAR_23 ) ) != 0 )
    {
        if( VAR_15 != VAR_0 && VAR_15 != VAR_1 )
        {
            goto reset;
        }
    }

    while( ( VAR_15 = FUNC_13( &VAR_23 ) ) < 0 )
    {
        if( VAR_15 != VAR_0 &&
            VAR_15 != VAR_1 )
        {
            goto reset;
        }
    }


    VAR_15 = 0;
    goto reset;

exit:

    FUNC_7( &VAR_17 );
    FUNC_7( &VAR_16 );

    FUNC_28( &VAR_25 );
    FUNC_10( &VAR_26 );
    FUNC_21( &VAR_23 );
    FUNC_19( &VAR_24 );
    FUNC_0( &VAR_22 );
    FUNC_3( &VAR_21 );

    return( VAR_15 );
}
